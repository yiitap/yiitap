var Fk=Object.defineProperty;var Rk=(t,e,n)=>e in t?Fk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Oe=(t,e,n)=>Rk(t,typeof e!="symbol"?e+"":e,n);import{c as Fo,i as xi,k as gr,f as yt,a as U,b as Ye,u as Mk,v as Qe,r as Ct,d as Xe,e as Qt,m as ne,g as Oa,h as hm,j as Ia,l as Fs,n as ye,o as fm,p as qn,q as Ei,z as Ok,s as al,t as gh,w as jr,x as Ik,y as m0,A as If,B as Lk,C as Pk,D as Lf,E as Ut,F as jn,G as Tr,H as Kn,I as Di,J as HD,K as _n,L as Dr,M as Vt,N as dm,O as ol,P as Pf,Q as my,R as $f,S as _r,T as yy,U as Lt,V as Lu,W as Xn,X as $k,Y as Bk,Z as Uk}from"./vendor-utils-OFPaKtuk.js";function OV(t){let e=".",n="__",r="--",i;if(t){let p=t.blockPrefix;p&&(e=p),p=t.elementPrefix,p&&(n=p),p=t.modifierPrefix,p&&(r=p)}const s={install(p){i=p.c;const g=p.context;g.bem={},g.bem.b=null,g.bem.els=null}};function a(p){let g,m;return{before(y){g=y.bem.b,m=y.bem.els,y.bem.els=null},after(y){y.bem.b=g,y.bem.els=m},$({context:y,props:b}){return p=typeof p=="string"?p:p({context:y,props:b}),y.bem.b=p,`${(b==null?void 0:b.bPrefix)||e}${y.bem.b}`}}}function o(p){let g;return{before(m){g=m.bem.els},after(m){m.bem.els=g},$({context:m,props:y}){return p=typeof p=="string"?p:p({context:m,props:y}),m.bem.els=p.split(",").map(b=>b.trim()),m.bem.els.map(b=>`${(y==null?void 0:y.bPrefix)||e}${m.bem.b}${n}${b}`).join(", ")}}}function u(p){return{$({context:g,props:m}){p=typeof p=="string"?p:p({context:g,props:m});const y=p.split(",").map(E=>E.trim());function b(E){return y.map(w=>`&${(m==null?void 0:m.bPrefix)||e}${g.bem.b}${E!==void 0?`${n}${E}`:""}${r}${w}`).join(", ")}const v=g.bem.els;return v!==null?b(v[0]):b()}}}function l(p){return{$({context:g,props:m}){p=typeof p=="string"?p:p({context:g,props:m});const y=g.bem.els;return`&:not(${(m==null?void 0:m.bPrefix)||e}${g.bem.b}${y!==null&&y.length>0?`${n}${y[0]}`:""}${r}${p})`}}}return Object.assign(s,{cB:(...p)=>i(a(p[0]),p[1],p[2]),cE:(...p)=>i(o(p[0]),p[1],p[2]),cM:(...p)=>i(u(p[0]),p[1],p[2]),cNotM:(...p)=>i(l(p[0]),p[1],p[2])}),s}function Gk(t){let e=0;for(let n=0;n<t.length;++n)t[n]==="&"&&++e;return e}const YD=/\s*,(?![^(]*\))\s*/g,zk=/\s+/g;function Wk(t,e){const n=[];return e.split(YD).forEach(r=>{let i=Gk(r);if(i){if(i===1){t.forEach(a=>{n.push(r.replace("&",a))});return}}else{t.forEach(a=>{n.push((a&&a+" ")+r)});return}let s=[r];for(;i--;){const a=[];s.forEach(o=>{t.forEach(u=>{a.push(o.replace("&",u))})}),s=a}s.forEach(a=>n.push(a))}),n}function Hk(t,e){const n=[];return e.split(YD).forEach(r=>{t.forEach(i=>{n.push((i&&i+" ")+r)})}),n}function Yk(t){let e=[""];return t.forEach(n=>{n=n&&n.trim(),n&&(n.includes("&")?e=Wk(e,n):e=Hk(e,n))}),e.join(", ").replace(zk," ")}function vy(t){if(!t)return;const e=t.parentElement;e&&e.removeChild(t)}function Bf(t,e){return(e??document.head).querySelector(`style[cssr-id="${t}"]`)}function Vk(t){const e=document.createElement("style");return e.setAttribute("cssr-id",t),e}function Rl(t){return t?/^\s*@(s|m)/.test(t):!1}const qk=/[A-Z]/g;function VD(t){return t.replace(qk,e=>"-"+e.toLowerCase())}function Xk(t,e="  "){return typeof t=="object"&&t!==null?` {
`+Object.entries(t).map(n=>e+`  ${VD(n[0])}: ${n[1]};`).join(`
`)+`
`+e+"}":`: ${t};`}function jk(t,e,n){return typeof t=="function"?t({context:e.context,props:n}):t}function by(t,e,n,r){if(!e)return"";const i=jk(e,n,r);if(!i)return"";if(typeof i=="string")return`${t} {
${i}
}`;const s=Object.keys(i);if(s.length===0)return n.config.keepEmptyBlock?t+` {
}`:"";const a=t?[t+" {"]:[];return s.forEach(o=>{const u=i[o];if(o==="raw"){a.push(`
`+u+`
`);return}o=VD(o),u!=null&&a.push(`  ${o}${Xk(u)}`)}),t&&a.push("}"),a.join(`
`)}function y0(t,e,n){t&&t.forEach(r=>{if(Array.isArray(r))y0(r,e,n);else if(typeof r=="function"){const i=r(e);Array.isArray(i)?y0(i,e,n):i&&n(i)}else r&&n(r)})}function qD(t,e,n,r,i){const s=t.$;let a="";if(!s||typeof s=="string")Rl(s)?a=s:e.push(s);else if(typeof s=="function"){const l=s({context:r.context,props:i});Rl(l)?a=l:e.push(l)}else if(s.before&&s.before(r.context),!s.$||typeof s.$=="string")Rl(s.$)?a=s.$:e.push(s.$);else if(s.$){const l=s.$({context:r.context,props:i});Rl(l)?a=l:e.push(l)}const o=Yk(e),u=by(o,t.props,r,i);a?n.push(`${a} {`):u.length&&n.push(u),t.children&&y0(t.children,{context:r.context,props:i},l=>{if(typeof l=="string"){const c=by(o,{raw:l},r,i);n.push(c)}else qD(l,e,n,r,i)}),e.pop(),a&&n.push("}"),s&&s.after&&s.after(r.context)}function Kk(t,e,n){const r=[];return qD(t,[],r,e,n),r.join(`

`)}function Jk(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}typeof window<"u"&&(window.__cssrContext={});function Zk(t,e,n,r){const{els:i}=e;if(n===void 0)i.forEach(vy),e.els=[];else{const s=Bf(n,r);s&&i.includes(s)&&(vy(s),e.els=i.filter(a=>a!==s))}}function xy(t,e){t.push(e)}function Qk(t,e,n,r,i,s,a,o,u){let l;if(n===void 0&&(l=e.render(r),n=Jk(l)),u){u.adapter(n,l??e.render(r));return}o===void 0&&(o=document.head);const c=Bf(n,o);if(c!==null&&!s)return c;const h=c??Vk(n);if(l===void 0&&(l=e.render(r)),h.textContent=l,c!==null)return c;if(a){const d=o.querySelector(`meta[name="${a}"]`);if(d)return o.insertBefore(h,d),xy(e.els,h),h}return i?o.insertBefore(h,o.querySelector("style, link")):o.appendChild(h),xy(e.els,h),h}function eS(t){return Kk(this,this.instance,t)}function tS(t={}){const{id:e,ssr:n,props:r,head:i=!1,force:s=!1,anchorMetaName:a,parent:o}=t;return Qk(this.instance,this,e,r,i,s,a,o,n)}function nS(t={}){const{id:e,parent:n}=t;Zk(this.instance,this,e,n)}const Ml=function(t,e,n,r){return{instance:t,$:e,props:n,children:r,els:[],render:eS,mount:tS,unmount:nS}},rS=function(t,e,n,r){return Array.isArray(e)?Ml(t,{$:null},null,e):Array.isArray(n)?Ml(t,e,null,n):Array.isArray(r)?Ml(t,e,n,r):Ml(t,e,n,null)};function IV(t={}){const e={c:(...n)=>rS(e,...n),use:(n,...r)=>n.install(e,...r),find:Bf,context:{},config:t};return e}function LV(t,e){if(t===void 0)return!1;if(e){const{context:{ids:n}}=e;return n.has(t)}return Bf(t)!==null}let mh=[];const XD=new WeakMap;function iS(){mh.forEach(t=>t(...XD.get(t))),mh=[]}function PV(t,...e){XD.set(t,e),!mh.includes(t)&&mh.push(t)===1&&requestAnimationFrame(iS)}function $V(t,e){let{target:n}=t;for(;n;){if(n.dataset&&n.dataset[e]!==void 0)return!0;n=n.parentElement}return!1}function BV(t){return t.composedPath()[0]||null}function UV(t){return typeof t=="string"?t.endsWith("px")?Number(t.slice(0,t.length-2)):Number(t):t}function GV(t){if(t!=null)return typeof t=="number"?`${t}px`:t.endsWith("px")?t:`${t}px`}function zV(t,e){const n=t.trim().split(/\s+/g),r={top:n[0]};switch(n.length){case 1:r.right=n[0],r.bottom=n[0],r.left=n[0];break;case 2:r.right=n[1],r.left=n[1],r.bottom=n[0];break;case 3:r.right=n[1],r.bottom=n[2],r.left=n[1];break;case 4:r.right=n[1],r.bottom=n[2],r.left=n[3];break;default:throw new Error("[seemly/getMargin]:"+t+" is not a valid value.")}return e===void 0?r:r[e]}function WV(t,e){const[n,r]=t.split(" ");return{row:n,col:r||n}}const Ey={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32",transparent:"#0000"};function sS(t,e,n){e/=100,n/=100;let r=(i,s=(i+t/60)%6)=>n-n*e*Math.max(Math.min(s,4-s,1),0);return[r(5)*255,r(3)*255,r(1)*255]}function aS(t,e,n){e/=100,n/=100;let r=e*Math.min(n,1-n),i=(s,a=(s+t/30)%12)=>n-r*Math.max(Math.min(a-3,9-a,1),-1);return[i(0)*255,i(8)*255,i(4)*255]}const Jr="^\\s*",Zr="\\s*$",Hi="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))%\\s*",Yn="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",ms="([0-9A-Fa-f])",ys="([0-9A-Fa-f]{2})",jD=new RegExp(`${Jr}hsl\\s*\\(${Yn},${Hi},${Hi}\\)${Zr}`),KD=new RegExp(`${Jr}hsv\\s*\\(${Yn},${Hi},${Hi}\\)${Zr}`),JD=new RegExp(`${Jr}hsla\\s*\\(${Yn},${Hi},${Hi},${Yn}\\)${Zr}`),ZD=new RegExp(`${Jr}hsva\\s*\\(${Yn},${Hi},${Hi},${Yn}\\)${Zr}`),oS=new RegExp(`${Jr}rgb\\s*\\(${Yn},${Yn},${Yn}\\)${Zr}`),uS=new RegExp(`${Jr}rgba\\s*\\(${Yn},${Yn},${Yn},${Yn}\\)${Zr}`),lS=new RegExp(`${Jr}#${ms}${ms}${ms}${Zr}`),cS=new RegExp(`${Jr}#${ys}${ys}${ys}${Zr}`),hS=new RegExp(`${Jr}#${ms}${ms}${ms}${ms}${Zr}`),fS=new RegExp(`${Jr}#${ys}${ys}${ys}${ys}${Zr}`);function An(t){return parseInt(t,16)}function dS(t){try{let e;if(e=JD.exec(t))return[yh(e[1]),Pi(e[5]),Pi(e[9]),ws(e[13])];if(e=jD.exec(t))return[yh(e[1]),Pi(e[5]),Pi(e[9]),1];throw new Error(`[seemly/hsla]: Invalid color value ${t}.`)}catch(e){throw e}}function pS(t){try{let e;if(e=ZD.exec(t))return[yh(e[1]),Pi(e[5]),Pi(e[9]),ws(e[13])];if(e=KD.exec(t))return[yh(e[1]),Pi(e[5]),Pi(e[9]),1];throw new Error(`[seemly/hsva]: Invalid color value ${t}.`)}catch(e){throw e}}function Pu(t){try{let e;if(e=cS.exec(t))return[An(e[1]),An(e[2]),An(e[3]),1];if(e=oS.exec(t))return[hn(e[1]),hn(e[5]),hn(e[9]),1];if(e=uS.exec(t))return[hn(e[1]),hn(e[5]),hn(e[9]),ws(e[13])];if(e=lS.exec(t))return[An(e[1]+e[1]),An(e[2]+e[2]),An(e[3]+e[3]),1];if(e=fS.exec(t))return[An(e[1]),An(e[2]),An(e[3]),ws(An(e[4])/255)];if(e=hS.exec(t))return[An(e[1]+e[1]),An(e[2]+e[2]),An(e[3]+e[3]),ws(An(e[4]+e[4])/255)];if(t in Ey)return Pu(Ey[t]);if(jD.test(t)||JD.test(t)){const[n,r,i,s]=dS(t);return[...aS(n,r,i),s]}else if(KD.test(t)||ZD.test(t)){const[n,r,i,s]=pS(t);return[...sS(n,r,i),s]}throw new Error(`[seemly/rgba]: Invalid color value ${t}.`)}catch(e){throw e}}function gS(t){return t>1?1:t<0?0:t}function v0(t,e,n,r){return`rgba(${hn(t)}, ${hn(e)}, ${hn(n)}, ${gS(r)})`}function Id(t,e,n,r,i){return hn((t*e*(1-r)+n*r)/i)}function HV(t,e){Array.isArray(t)||(t=Pu(t)),Array.isArray(e)||(e=Pu(e));const n=t[3],r=e[3],i=ws(n+r-n*r);return v0(Id(t[0],n,e[0],r,i),Id(t[1],n,e[1],r,i),Id(t[2],n,e[2],r,i),i)}function YV(t,e){const[n,r,i,s=1]=Array.isArray(t)?t:Pu(t);return typeof e.alpha=="number"?v0(n,r,i,e.alpha):v0(n,r,i,s)}function VV(t,e){const[n,r,i,s=1]=Array.isArray(t)?t:Pu(t),{lightness:a=1,alpha:o=1}=e;return mS([n*a,r*a,i*a,s*o])}function ws(t){const e=Math.round(Number(t)*100)/100;return e>1?1:e<0?0:e}function yh(t){const e=Math.round(Number(t));return e>=360||e<0?0:e}function hn(t){const e=Math.round(Number(t));return e>255?255:e<0?0:e}function Pi(t){const e=Math.round(Number(t));return e>100?100:e<0?0:e}function mS(t){const[e,n,r]=t;return 3 in t?`rgba(${hn(e)}, ${hn(n)}, ${hn(r)}, ${ws(t[3])})`:`rgba(${hn(e)}, ${hn(n)}, ${hn(r)}, 1)`}function qV(t=8){return Math.random().toString(16).slice(2,2+t)}function kc(t){return t.composedPath()[0]}const yS={mousemoveoutside:new WeakMap,clickoutside:new WeakMap};function vS(t,e,n){if(t==="mousemoveoutside"){const r=i=>{e.contains(kc(i))||n(i)};return{mousemove:r,touchstart:r}}else if(t==="clickoutside"){let r=!1;const i=a=>{r=!e.contains(kc(a))},s=a=>{r&&(e.contains(kc(a))||n(a))};return{mousedown:i,mouseup:s,touchstart:i,touchend:s}}return console.error(`[evtd/create-trap-handler]: name \`${t}\` is invalid. This could be a bug of evtd.`),{}}function QD(t,e,n){const r=yS[t];let i=r.get(e);i===void 0&&r.set(e,i=new WeakMap);let s=i.get(n);return s===void 0&&i.set(n,s=vS(t,e,n)),s}function bS(t,e,n,r){if(t==="mousemoveoutside"||t==="clickoutside"){const i=QD(t,e,n);return Object.keys(i).forEach(s=>{DS(s,document,i[s],r)}),!0}return!1}function xS(t,e,n,r){if(t==="mousemoveoutside"||t==="clickoutside"){const i=QD(t,e,n);return Object.keys(i).forEach(s=>{wS(s,document,i[s],r)}),!0}return!1}function ES(){if(typeof window>"u")return{on:()=>{},off:()=>{}};const t=new WeakMap,e=new WeakMap;function n(){t.set(this,!0)}function r(){t.set(this,!0),e.set(this,!0)}function i(D,k,F){const M=D[k];return D[k]=function(){return F.apply(D,arguments),M.apply(D,arguments)},D}function s(D,k){D[k]=Event.prototype[k]}const a=new WeakMap,o=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function u(){var D;return(D=a.get(this))!==null&&D!==void 0?D:null}function l(D,k){o!==void 0&&Object.defineProperty(D,"currentTarget",{configurable:!0,enumerable:!0,get:k??o.get})}const c={bubble:{},capture:{}},h={};function d(){const D=function(k){const{type:F,eventPhase:M,bubbles:S}=k,R=kc(k);if(M===2)return;const I=M===1?"capture":"bubble";let x=R;const _=[];for(;x===null&&(x=window),_.push(x),x!==window;)x=x.parentNode||null;const C=c.capture[F],A=c.bubble[F];if(i(k,"stopPropagation",n),i(k,"stopImmediatePropagation",r),l(k,u),I==="capture"){if(C===void 0)return;for(let T=_.length-1;T>=0&&!t.has(k);--T){const O=_[T],L=C.get(O);if(L!==void 0){a.set(k,O);for(const P of L){if(e.has(k))break;P(k)}}if(T===0&&!S&&A!==void 0){const P=A.get(O);if(P!==void 0)for(const Y of P){if(e.has(k))break;Y(k)}}}}else if(I==="bubble"){if(A===void 0)return;for(let T=0;T<_.length&&!t.has(k);++T){const O=_[T],L=A.get(O);if(L!==void 0){a.set(k,O);for(const P of L){if(e.has(k))break;P(k)}}}}s(k,"stopPropagation"),s(k,"stopImmediatePropagation"),l(k)};return D.displayName="evtdUnifiedHandler",D}function f(){const D=function(k){const{type:F,eventPhase:M}=k;if(M!==2)return;const S=h[F];S!==void 0&&S.forEach(R=>R(k))};return D.displayName="evtdUnifiedWindowEventHandler",D}const p=d(),g=f();function m(D,k){const F=c[D];return F[k]===void 0&&(F[k]=new Map,window.addEventListener(k,p,D==="capture")),F[k]}function y(D){return h[D]===void 0&&(h[D]=new Set,window.addEventListener(D,g)),h[D]}function b(D,k){let F=D.get(k);return F===void 0&&D.set(k,F=new Set),F}function v(D,k,F,M){const S=c[k][F];if(S!==void 0){const R=S.get(D);if(R!==void 0&&R.has(M))return!0}return!1}function E(D,k){const F=h[D];return!!(F!==void 0&&F.has(k))}function w(D,k,F,M){let S;if(typeof M=="object"&&M.once===!0?S=C=>{N(D,k,S,M),F(C)}:S=F,bS(D,k,S,M))return;const I=M===!0||typeof M=="object"&&M.capture===!0?"capture":"bubble",x=m(I,D),_=b(x,k);if(_.has(S)||_.add(S),k===window){const C=y(D);C.has(S)||C.add(S)}}function N(D,k,F,M){if(xS(D,k,F,M))return;const R=M===!0||typeof M=="object"&&M.capture===!0,I=R?"capture":"bubble",x=m(I,D),_=b(x,k);if(k===window&&!v(k,R?"bubble":"capture",D,F)&&E(D,F)){const A=h[D];A.delete(F),A.size===0&&(window.removeEventListener(D,g),h[D]=void 0)}_.has(F)&&_.delete(F),_.size===0&&x.delete(k),x.size===0&&(window.removeEventListener(D,p,I==="capture"),c[I][D]=void 0)}return{on:w,off:N}}const{on:DS,off:wS}=ES();var _s=[],_S=function(){return _s.some(function(t){return t.activeTargets.length>0})},CS=function(){return _s.some(function(t){return t.skippedTargets.length>0})},Dy="ResizeObserver loop completed with undelivered notifications.",AS=function(){var t;typeof ErrorEvent=="function"?t=new ErrorEvent("error",{message:Dy}):(t=document.createEvent("Event"),t.initEvent("error",!1,!1),t.message=Dy),window.dispatchEvent(t)},$u;(function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})($u||($u={}));var Cs=function(t){return Object.freeze(t)},TS=function(){function t(e,n){this.inlineSize=e,this.blockSize=n,Cs(this)}return t}(),e2=function(){function t(e,n,r,i){return this.x=e,this.y=n,this.width=r,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Cs(this)}return t.prototype.toJSON=function(){var e=this,n=e.x,r=e.y,i=e.top,s=e.right,a=e.bottom,o=e.left,u=e.width,l=e.height;return{x:n,y:r,top:i,right:s,bottom:a,left:o,width:u,height:l}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),pm=function(t){return t instanceof SVGElement&&"getBBox"in t},t2=function(t){if(pm(t)){var e=t.getBBox(),n=e.width,r=e.height;return!n&&!r}var i=t,s=i.offsetWidth,a=i.offsetHeight;return!(s||a||t.getClientRects().length)},wy=function(t){var e;if(t instanceof Element)return!0;var n=(e=t==null?void 0:t.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(n&&t instanceof n.Element)},kS=function(t){switch(t.tagName){case"INPUT":if(t.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},Cu=typeof window<"u"?window:{},Ol=new WeakMap,_y=/auto|scroll/,SS=/^tb|vertical/,NS=/msie|trident/i.test(Cu.navigator&&Cu.navigator.userAgent),Or=function(t){return parseFloat(t||"0")},ba=function(t,e,n){return t===void 0&&(t=0),e===void 0&&(e=0),n===void 0&&(n=!1),new TS((n?e:t)||0,(n?t:e)||0)},Cy=Cs({devicePixelContentBoxSize:ba(),borderBoxSize:ba(),contentBoxSize:ba(),contentRect:new e2(0,0,0,0)}),n2=function(t,e){if(e===void 0&&(e=!1),Ol.has(t)&&!e)return Ol.get(t);if(t2(t))return Ol.set(t,Cy),Cy;var n=getComputedStyle(t),r=pm(t)&&t.ownerSVGElement&&t.getBBox(),i=!NS&&n.boxSizing==="border-box",s=SS.test(n.writingMode||""),a=!r&&_y.test(n.overflowY||""),o=!r&&_y.test(n.overflowX||""),u=r?0:Or(n.paddingTop),l=r?0:Or(n.paddingRight),c=r?0:Or(n.paddingBottom),h=r?0:Or(n.paddingLeft),d=r?0:Or(n.borderTopWidth),f=r?0:Or(n.borderRightWidth),p=r?0:Or(n.borderBottomWidth),g=r?0:Or(n.borderLeftWidth),m=h+l,y=u+c,b=g+f,v=d+p,E=o?t.offsetHeight-v-t.clientHeight:0,w=a?t.offsetWidth-b-t.clientWidth:0,N=i?m+b:0,D=i?y+v:0,k=r?r.width:Or(n.width)-N-w,F=r?r.height:Or(n.height)-D-E,M=k+m+w+b,S=F+y+E+v,R=Cs({devicePixelContentBoxSize:ba(Math.round(k*devicePixelRatio),Math.round(F*devicePixelRatio),s),borderBoxSize:ba(M,S,s),contentBoxSize:ba(k,F,s),contentRect:new e2(h,u,k,F)});return Ol.set(t,R),R},r2=function(t,e,n){var r=n2(t,n),i=r.borderBoxSize,s=r.contentBoxSize,a=r.devicePixelContentBoxSize;switch(e){case $u.DEVICE_PIXEL_CONTENT_BOX:return a;case $u.BORDER_BOX:return i;default:return s}},FS=function(){function t(e){var n=n2(e);this.target=e,this.contentRect=n.contentRect,this.borderBoxSize=Cs([n.borderBoxSize]),this.contentBoxSize=Cs([n.contentBoxSize]),this.devicePixelContentBoxSize=Cs([n.devicePixelContentBoxSize])}return t}(),i2=function(t){if(t2(t))return 1/0;for(var e=0,n=t.parentNode;n;)e+=1,n=n.parentNode;return e},RS=function(){var t=1/0,e=[];_s.forEach(function(a){if(a.activeTargets.length!==0){var o=[];a.activeTargets.forEach(function(l){var c=new FS(l.target),h=i2(l.target);o.push(c),l.lastReportedSize=r2(l.target,l.observedBox),h<t&&(t=h)}),e.push(function(){a.callback.call(a.observer,o,a.observer)}),a.activeTargets.splice(0,a.activeTargets.length)}});for(var n=0,r=e;n<r.length;n++){var i=r[n];i()}return t},Ay=function(t){_s.forEach(function(n){n.activeTargets.splice(0,n.activeTargets.length),n.skippedTargets.splice(0,n.skippedTargets.length),n.observationTargets.forEach(function(i){i.isActive()&&(i2(i.target)>t?n.activeTargets.push(i):n.skippedTargets.push(i))})})},MS=function(){var t=0;for(Ay(t);_S();)t=RS(),Ay(t);return CS()&&AS(),t>0},Ld,s2=[],OS=function(){return s2.splice(0).forEach(function(t){return t()})},IS=function(t){if(!Ld){var e=0,n=document.createTextNode(""),r={characterData:!0};new MutationObserver(function(){return OS()}).observe(n,r),Ld=function(){n.textContent="".concat(e?e--:e++)}}s2.push(t),Ld()},LS=function(t){IS(function(){requestAnimationFrame(t)})},Sc=0,PS=function(){return!!Sc},$S=250,BS={attributes:!0,characterData:!0,childList:!0,subtree:!0},Ty=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],ky=function(t){return t===void 0&&(t=0),Date.now()+t},Pd=!1,US=function(){function t(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return t.prototype.run=function(e){var n=this;if(e===void 0&&(e=$S),!Pd){Pd=!0;var r=ky(e);LS(function(){var i=!1;try{i=MS()}finally{if(Pd=!1,e=r-ky(),!PS())return;i?n.run(1e3):e>0?n.run(e):n.start()}})}},t.prototype.schedule=function(){this.stop(),this.run()},t.prototype.observe=function(){var e=this,n=function(){return e.observer&&e.observer.observe(document.body,BS)};document.body?n():Cu.addEventListener("DOMContentLoaded",n)},t.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),Ty.forEach(function(n){return Cu.addEventListener(n,e.listener,!0)}))},t.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),Ty.forEach(function(n){return Cu.removeEventListener(n,e.listener,!0)}),this.stopped=!0)},t}(),b0=new US,Sy=function(t){!Sc&&t>0&&b0.start(),Sc+=t,!Sc&&b0.stop()},GS=function(t){return!pm(t)&&!kS(t)&&getComputedStyle(t).display==="inline"},zS=function(){function t(e,n){this.target=e,this.observedBox=n||$u.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){var e=r2(this.target,this.observedBox,!0);return GS(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},t}(),WS=function(){function t(e,n){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=n}return t}(),Il=new WeakMap,Ny=function(t,e){for(var n=0;n<t.length;n+=1)if(t[n].target===e)return n;return-1},Ll=function(){function t(){}return t.connect=function(e,n){var r=new WS(e,n);Il.set(e,r)},t.observe=function(e,n,r){var i=Il.get(e),s=i.observationTargets.length===0;Ny(i.observationTargets,n)<0&&(s&&_s.push(i),i.observationTargets.push(new zS(n,r&&r.box)),Sy(1),b0.schedule())},t.unobserve=function(e,n){var r=Il.get(e),i=Ny(r.observationTargets,n),s=r.observationTargets.length===1;i>=0&&(s&&_s.splice(_s.indexOf(r),1),r.observationTargets.splice(i,1),Sy(-1))},t.disconnect=function(e){var n=this,r=Il.get(e);r.observationTargets.slice().forEach(function(i){return n.unobserve(e,i.target)}),r.activeTargets.splice(0,r.activeTargets.length)},t}(),XV=function(){function t(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Ll.connect(this,e)}return t.prototype.observe=function(e,n){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!wy(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Ll.observe(this,e,n)},t.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!wy(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Ll.unobserve(this,e)},t.prototype.disconnect=function(){Ll.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}();function $d(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}function lo(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let i;if(r==="formatting"&&t.formattingValues){const a=t.defaultFormattingWidth||t.defaultWidth,o=n!=null&&n.width?String(n.width):a;i=t.formattingValues[o]||t.formattingValues[a]}else{const a=t.defaultWidth,o=n!=null&&n.width?String(n.width):t.defaultWidth;i=t.values[o]||t.values[a]}const s=t.argumentCallback?t.argumentCallback(e):e;return i[s]}}function co(t){return(e,n={})=>{const r=n.width,i=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],s=e.match(i);if(!s)return null;const a=s[0],o=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(o)?YS(o,h=>h.test(a)):HS(o,h=>h.test(a));let l;l=t.valueCallback?t.valueCallback(u):u,l=n.valueCallback?n.valueCallback(l):l;const c=e.slice(a.length);return{value:l,rest:c}}}function HS(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function YS(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function VS(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const i=r[0],s=e.match(t.parsePattern);if(!s)return null;let a=t.valueCallback?t.valueCallback(s[0]):s[0];a=n.valueCallback?n.valueCallback(a):a;const o=e.slice(i.length);return{value:a,rest:o}}}const qS={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},XS=(t,e,n)=>{let r;const i=qS[t];return typeof i=="string"?r=i:e===1?r=i.one:r=i.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},jS={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},KS=(t,e,n,r)=>jS[t],JS={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ZS={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},QS={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},e3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},t3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},n3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},r3=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},i3={ordinalNumber:r3,era:lo({values:JS,defaultWidth:"wide"}),quarter:lo({values:ZS,defaultWidth:"wide",argumentCallback:t=>t-1}),month:lo({values:QS,defaultWidth:"wide"}),day:lo({values:e3,defaultWidth:"wide"}),dayPeriod:lo({values:t3,defaultWidth:"wide",formattingValues:n3,defaultFormattingWidth:"wide"})},s3=/^(\d+)(th|st|nd|rd)?/i,a3=/\d+/i,o3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},u3={any:[/^b/i,/^(a|c)/i]},l3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},c3={any:[/1/i,/2/i,/3/i,/4/i]},h3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},f3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},d3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},p3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},g3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},m3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},y3={ordinalNumber:VS({matchPattern:s3,parsePattern:a3,valueCallback:t=>parseInt(t,10)}),era:co({matchPatterns:o3,defaultMatchWidth:"wide",parsePatterns:u3,defaultParseWidth:"any"}),quarter:co({matchPatterns:l3,defaultMatchWidth:"wide",parsePatterns:c3,defaultParseWidth:"any",valueCallback:t=>t+1}),month:co({matchPatterns:h3,defaultMatchWidth:"wide",parsePatterns:f3,defaultParseWidth:"any"}),day:co({matchPatterns:d3,defaultMatchWidth:"wide",parsePatterns:p3,defaultParseWidth:"any"}),dayPeriod:co({matchPatterns:g3,defaultMatchWidth:"any",parsePatterns:m3,defaultParseWidth:"any"})},v3={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},b3={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},x3={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},E3={date:$d({formats:v3,defaultWidth:"full"}),time:$d({formats:b3,defaultWidth:"full"}),dateTime:$d({formats:x3,defaultWidth:"full"})},jV={code:"en-US",formatDistance:XS,formatLong:E3,formatRelative:KS,localize:i3,match:y3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Fy(t){return Array.isArray(t)?t:[t]}const x0={STOP:"STOP"};function a2(t,e){const n=e(t);t.children!==void 0&&n!==x0.STOP&&t.children.forEach(r=>a2(r,e))}function D3(t,e={}){const{preserveGroup:n=!1}=e,r=[],i=n?a=>{a.isLeaf||(r.push(a.key),s(a.children))}:a=>{a.isLeaf||(a.isGroup||r.push(a.key),s(a.children))};function s(a){a.forEach(i)}return s(t),r}function w3(t,e){const{isLeaf:n}=t;return n!==void 0?n:!e(t)}function _3(t){return t.children}function C3(t){return t.key}function A3(){return!1}function T3(t,e){const{isLeaf:n}=t;return!(n===!1&&!Array.isArray(e(t)))}function k3(t){return t.disabled===!0}function S3(t,e){return t.isLeaf===!1&&!Array.isArray(e(t))}function Bd(t){var e;return t==null?[]:Array.isArray(t)?t:(e=t.checkedKeys)!==null&&e!==void 0?e:[]}function Ud(t){var e;return t==null||Array.isArray(t)?[]:(e=t.indeterminateKeys)!==null&&e!==void 0?e:[]}function N3(t,e){const n=new Set(t);return e.forEach(r=>{n.has(r)||n.add(r)}),Array.from(n)}function F3(t,e){const n=new Set(t);return e.forEach(r=>{n.has(r)&&n.delete(r)}),Array.from(n)}function R3(t){return(t==null?void 0:t.type)==="group"}function KV(t){const e=new Map;return t.forEach((n,r)=>{e.set(n.key,r)}),n=>{var r;return(r=e.get(n))!==null&&r!==void 0?r:null}}class M3 extends Error{constructor(){super(),this.message="SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded."}}function O3(t,e,n,r){return vh(e.concat(t),n,r,!1)}function I3(t,e){const n=new Set;return t.forEach(r=>{const i=e.treeNodeMap.get(r);if(i!==void 0){let s=i.parent;for(;s!==null&&!(s.disabled||n.has(s.key));)n.add(s.key),s=s.parent}}),n}function L3(t,e,n,r){const i=vh(e,n,r,!1),s=vh(t,n,r,!0),a=I3(t,n),o=[];return i.forEach(u=>{(s.has(u)||a.has(u))&&o.push(u)}),o.forEach(u=>i.delete(u)),i}function Gd(t,e){const{checkedKeys:n,keysToCheck:r,keysToUncheck:i,indeterminateKeys:s,cascade:a,leafOnly:o,checkStrategy:u,allowNotLoaded:l}=t;if(!a)return r!==void 0?{checkedKeys:N3(n,r),indeterminateKeys:Array.from(s)}:i!==void 0?{checkedKeys:F3(n,i),indeterminateKeys:Array.from(s)}:{checkedKeys:Array.from(n),indeterminateKeys:Array.from(s)};const{levelTreeNodeMap:c}=e;let h;i!==void 0?h=L3(i,n,e,l):r!==void 0?h=O3(r,n,e,l):h=vh(n,e,l,!1);const d=u==="parent",f=u==="child"||o,p=h,g=new Set,m=Math.max.apply(null,Array.from(c.keys()));for(let y=m;y>=0;y-=1){const b=y===0,v=c.get(y);for(const E of v){if(E.isLeaf)continue;const{key:w,shallowLoaded:N}=E;if(f&&N&&E.children.forEach(M=>{!M.disabled&&!M.isLeaf&&M.shallowLoaded&&p.has(M.key)&&p.delete(M.key)}),E.disabled||!N)continue;let D=!0,k=!1,F=!0;for(const M of E.children){const S=M.key;if(!M.disabled){if(F&&(F=!1),p.has(S))k=!0;else if(g.has(S)){k=!0,D=!1;break}else if(D=!1,k)break}}D&&!F?(d&&E.children.forEach(M=>{!M.disabled&&p.has(M.key)&&p.delete(M.key)}),p.add(w)):k&&g.add(w),b&&f&&p.has(w)&&p.delete(w)}}return{checkedKeys:Array.from(p),indeterminateKeys:Array.from(g)}}function vh(t,e,n,r){const{treeNodeMap:i,getChildren:s}=e,a=new Set,o=new Set(t);return t.forEach(u=>{const l=i.get(u);l!==void 0&&a2(l,c=>{if(c.disabled)return x0.STOP;const{key:h}=c;if(!a.has(h)&&(a.add(h),o.add(h),S3(c.rawNode,s))){if(r)return x0.STOP;if(!n)throw new M3}})}),o}function P3(t,{includeGroup:e=!1,includeSelf:n=!0},r){var i;const s=r.treeNodeMap;let a=t==null?null:(i=s.get(t))!==null&&i!==void 0?i:null;const o={keyPath:[],treeNodePath:[],treeNode:a};if(a!=null&&a.ignored)return o.treeNode=null,o;for(;a;)!a.ignored&&(e||!a.isGroup)&&o.treeNodePath.push(a),a=a.parent;return o.treeNodePath.reverse(),n||o.treeNodePath.pop(),o.keyPath=o.treeNodePath.map(u=>u.key),o}function $3(t){if(t.length===0)return null;const e=t[0];return e.isGroup||e.ignored||e.disabled?e.getNext():e}function B3(t,e){const n=t.siblings,r=n.length,{index:i}=t;return e?n[(i+1)%r]:i===n.length-1?null:n[i+1]}function Ry(t,e,{loop:n=!1,includeDisabled:r=!1}={}){const i=e==="prev"?U3:B3,s={reverse:e==="prev"};let a=!1,o=null;function u(l){if(l!==null){if(l===t){if(!a)a=!0;else if(!t.disabled&&!t.isGroup){o=t;return}}else if((!l.disabled||r)&&!l.ignored&&!l.isGroup){o=l;return}if(l.isGroup){const c=gm(l,s);c!==null?o=c:u(i(l,n))}else{const c=i(l,!1);if(c!==null)u(c);else{const h=G3(l);h!=null&&h.isGroup?u(i(h,n)):n&&u(i(l,!0))}}}}return u(t),o}function U3(t,e){const n=t.siblings,r=n.length,{index:i}=t;return e?n[(i-1+r)%r]:i===0?null:n[i-1]}function G3(t){return t.parent}function gm(t,e={}){const{reverse:n=!1}=e,{children:r}=t;if(r){const{length:i}=r,s=n?i-1:0,a=n?-1:i,o=n?-1:1;for(let u=s;u!==a;u+=o){const l=r[u];if(!l.disabled&&!l.ignored)if(l.isGroup){const c=gm(l,e);if(c!==null)return c}else return l}}return null}const z3={getChild(){return this.ignored?null:gm(this)},getParent(){const{parent:t}=this;return t!=null&&t.isGroup?t.getParent():t},getNext(t={}){return Ry(this,"next",t)},getPrev(t={}){return Ry(this,"prev",t)}};function W3(t,e){const n=e?new Set(e):void 0,r=[];function i(s){s.forEach(a=>{r.push(a),!(a.isLeaf||!a.children||a.ignored)&&(a.isGroup||n===void 0||n.has(a.key))&&i(a.children)})}return i(t),r}function H3(t,e){const n=t.key;for(;e;){if(e.key===n)return!0;e=e.parent}return!1}function o2(t,e,n,r,i,s=null,a=0){const o=[];return t.forEach((u,l)=>{var c;const h=Object.create(r);if(h.rawNode=u,h.siblings=o,h.level=a,h.index=l,h.isFirstChild=l===0,h.isLastChild=l+1===t.length,h.parent=s,!h.ignored){const d=i(u);Array.isArray(d)&&(h.children=o2(d,e,n,r,i,h,a+1))}o.push(h),e.set(h.key,h),n.has(a)||n.set(a,[]),(c=n.get(a))===null||c===void 0||c.push(h)}),o}function JV(t,e={}){var n;const r=new Map,i=new Map,{getDisabled:s=k3,getIgnored:a=A3,getIsGroup:o=R3,getKey:u=C3}=e,l=(n=e.getChildren)!==null&&n!==void 0?n:_3,c=e.ignoreEmptyChildren?E=>{const w=l(E);return Array.isArray(w)?w.length?w:null:w}:l,h=Object.assign({get key(){return u(this.rawNode)},get disabled(){return s(this.rawNode)},get isGroup(){return o(this.rawNode)},get isLeaf(){return w3(this.rawNode,c)},get shallowLoaded(){return T3(this.rawNode,c)},get ignored(){return a(this.rawNode)},contains(E){return H3(this,E)}},z3),d=o2(t,r,i,h,c);function f(E){if(E==null)return null;const w=r.get(E);return w&&!w.isGroup&&!w.ignored?w:null}function p(E){if(E==null)return null;const w=r.get(E);return w&&!w.ignored?w:null}function g(E,w){const N=p(E);return N?N.getPrev(w):null}function m(E,w){const N=p(E);return N?N.getNext(w):null}function y(E){const w=p(E);return w?w.getParent():null}function b(E){const w=p(E);return w?w.getChild():null}const v={treeNodes:d,treeNodeMap:r,levelTreeNodeMap:i,maxLevel:Math.max(...i.keys()),getChildren:c,getFlattenedNodes(E){return W3(d,E)},getNode:f,getPrev:g,getNext:m,getParent:y,getChild:b,getFirstAvailableNode(){return $3(d)},getPath(E,w={}){return P3(E,w,v)},getCheckedKeys(E,w={}){const{cascade:N=!0,leafOnly:D=!1,checkStrategy:k="all",allowNotLoaded:F=!1}=w;return Gd({checkedKeys:Bd(E),indeterminateKeys:Ud(E),cascade:N,leafOnly:D,checkStrategy:k,allowNotLoaded:F},v)},check(E,w,N={}){const{cascade:D=!0,leafOnly:k=!1,checkStrategy:F="all",allowNotLoaded:M=!1}=N;return Gd({checkedKeys:Bd(w),indeterminateKeys:Ud(w),keysToCheck:E==null?[]:Fy(E),cascade:D,leafOnly:k,checkStrategy:F,allowNotLoaded:M},v)},uncheck(E,w,N={}){const{cascade:D=!0,leafOnly:k=!1,checkStrategy:F="all",allowNotLoaded:M=!1}=N;return Gd({checkedKeys:Bd(w),indeterminateKeys:Ud(w),keysToUncheck:E==null?[]:Fy(E),cascade:D,leafOnly:k,checkStrategy:F,allowNotLoaded:M},v)},getNonLeafKeys(E={}){return D3(d,E)}};return v}function vs(){return vs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vs.apply(this,arguments)}function Y3(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Bu(t,e)}function E0(t){return E0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},E0(t)}function Bu(t,e){return Bu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Bu(t,e)}function V3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nc(t,e,n){return V3()?Nc=Reflect.construct.bind():Nc=function(i,s,a){var o=[null];o.push.apply(o,s);var u=Function.bind.apply(i,o),l=new u;return a&&Bu(l,a.prototype),l},Nc.apply(null,arguments)}function q3(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function D0(t){var e=typeof Map=="function"?new Map:void 0;return D0=function(r){if(r===null||!q3(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(r))return e.get(r);e.set(r,i)}function i(){return Nc(r,arguments,E0(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Bu(i,r)},D0(t)}var X3=/%[sdj%]/g,j3=function(){};function w0(t){if(!t||!t.length)return null;var e={};return t.forEach(function(n){var r=n.field;e[r]=e[r]||[],e[r].push(n)}),e}function Vn(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=0,s=n.length;if(typeof t=="function")return t.apply(null,n);if(typeof t=="string"){var a=t.replace(X3,function(o){if(o==="%%")return"%";if(i>=s)return o;switch(o){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch{return"[Circular]"}break;default:return o}});return a}return t}function K3(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function Rt(t,e){return!!(t==null||e==="array"&&Array.isArray(t)&&!t.length||K3(e)&&typeof t=="string"&&!t)}function J3(t,e,n){var r=[],i=0,s=t.length;function a(o){r.push.apply(r,o||[]),i++,i===s&&n(r)}t.forEach(function(o){e(o,a)})}function My(t,e,n){var r=0,i=t.length;function s(a){if(a&&a.length){n(a);return}var o=r;r=r+1,o<i?e(t[o],s):n([])}s([])}function Z3(t){var e=[];return Object.keys(t).forEach(function(n){e.push.apply(e,t[n]||[])}),e}var Oy=function(t){Y3(e,t);function e(n,r){var i;return i=t.call(this,"Async Validation Error")||this,i.errors=n,i.fields=r,i}return e}(D0(Error));function Q3(t,e,n,r,i){if(e.first){var s=new Promise(function(d,f){var p=function(y){return r(y),y.length?f(new Oy(y,w0(y))):d(i)},g=Z3(t);My(g,n,p)});return s.catch(function(d){return d}),s}var a=e.firstFields===!0?Object.keys(t):e.firstFields||[],o=Object.keys(t),u=o.length,l=0,c=[],h=new Promise(function(d,f){var p=function(m){if(c.push.apply(c,m),l++,l===u)return r(c),c.length?f(new Oy(c,w0(c))):d(i)};o.length||(r(c),d(i)),o.forEach(function(g){var m=t[g];a.indexOf(g)!==-1?My(m,n,p):J3(m,n,p)})});return h.catch(function(d){return d}),h}function eN(t){return!!(t&&t.message!==void 0)}function tN(t,e){for(var n=t,r=0;r<e.length;r++){if(n==null)return n;n=n[e[r]]}return n}function Iy(t,e){return function(n){var r;return t.fullFields?r=tN(e,t.fullFields):r=e[n.field||t.fullField],eN(n)?(n.field=n.field||t.fullField,n.fieldValue=r,n):{message:typeof n=="function"?n():n,fieldValue:r,field:n.field||t.fullField}}}function Ly(t,e){if(e){for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];typeof r=="object"&&typeof t[n]=="object"?t[n]=vs({},t[n],r):t[n]=r}}return t}var u2=function(e,n,r,i,s,a){e.required&&(!r.hasOwnProperty(e.field)||Rt(n,a||e.type))&&i.push(Vn(s.messages.required,e.fullField))},nN=function(e,n,r,i,s){(/^\s+$/.test(n)||n==="")&&i.push(Vn(s.messages.whitespace,e.fullField))},Pl,rN=function(){if(Pl)return Pl;var t="[a-fA-F\\d:]",e=function(E){return E&&E.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""},n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",r="[a-fA-F\\d]{1,4}",i=(`
(?:
(?:`+r+":){7}(?:"+r+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+r+":){6}(?:"+n+"|:"+r+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+r+":){5}(?::"+n+"|(?::"+r+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+r+":){4}(?:(?::"+r+"){0,1}:"+n+"|(?::"+r+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+r+":){3}(?:(?::"+r+"){0,2}:"+n+"|(?::"+r+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+r+":){2}(?:(?::"+r+"){0,3}:"+n+"|(?::"+r+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+r+":){1}(?:(?::"+r+"){0,4}:"+n+"|(?::"+r+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+r+"){0,5}:"+n+"|(?::"+r+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),s=new RegExp("(?:^"+n+"$)|(?:^"+i+"$)"),a=new RegExp("^"+n+"$"),o=new RegExp("^"+i+"$"),u=function(E){return E&&E.exact?s:new RegExp("(?:"+e(E)+n+e(E)+")|(?:"+e(E)+i+e(E)+")","g")};u.v4=function(v){return v&&v.exact?a:new RegExp(""+e(v)+n+e(v),"g")},u.v6=function(v){return v&&v.exact?o:new RegExp(""+e(v)+i+e(v),"g")};var l="(?:(?:[a-z]+:)?//)",c="(?:\\S+(?::\\S*)?@)?",h=u.v4().source,d=u.v6().source,f="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",p="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",g="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",m="(?::\\d{2,5})?",y='(?:[/?#][^\\s"]*)?',b="(?:"+l+"|www\\.)"+c+"(?:localhost|"+h+"|"+d+"|"+f+p+g+")"+m+y;return Pl=new RegExp("(?:^"+b+"$)","i"),Pl},Py={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Ro={integer:function(e){return Ro.number(e)&&parseInt(e,10)===e},float:function(e){return Ro.number(e)&&!Ro.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return typeof e=="object"&&!Ro.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(Py.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(rN())},hex:function(e){return typeof e=="string"&&!!e.match(Py.hex)}},iN=function(e,n,r,i,s){if(e.required&&n===void 0){u2(e,n,r,i,s);return}var a=["integer","float","array","regexp","object","method","email","number","date","url","hex"],o=e.type;a.indexOf(o)>-1?Ro[o](n)||i.push(Vn(s.messages.types[o],e.fullField,e.type)):o&&typeof n!==e.type&&i.push(Vn(s.messages.types[o],e.fullField,e.type))},sN=function(e,n,r,i,s){var a=typeof e.len=="number",o=typeof e.min=="number",u=typeof e.max=="number",l=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,c=n,h=null,d=typeof n=="number",f=typeof n=="string",p=Array.isArray(n);if(d?h="number":f?h="string":p&&(h="array"),!h)return!1;p&&(c=n.length),f&&(c=n.replace(l,"_").length),a?c!==e.len&&i.push(Vn(s.messages[h].len,e.fullField,e.len)):o&&!u&&c<e.min?i.push(Vn(s.messages[h].min,e.fullField,e.min)):u&&!o&&c>e.max?i.push(Vn(s.messages[h].max,e.fullField,e.max)):o&&u&&(c<e.min||c>e.max)&&i.push(Vn(s.messages[h].range,e.fullField,e.min,e.max))},Qs="enum",aN=function(e,n,r,i,s){e[Qs]=Array.isArray(e[Qs])?e[Qs]:[],e[Qs].indexOf(n)===-1&&i.push(Vn(s.messages[Qs],e.fullField,e[Qs].join(", ")))},oN=function(e,n,r,i,s){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(n)||i.push(Vn(s.messages.pattern.mismatch,e.fullField,n,e.pattern));else if(typeof e.pattern=="string"){var a=new RegExp(e.pattern);a.test(n)||i.push(Vn(s.messages.pattern.mismatch,e.fullField,n,e.pattern))}}},Re={required:u2,whitespace:nN,type:iN,range:sN,enum:aN,pattern:oN},uN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n,"string")&&!e.required)return r();Re.required(e,n,i,a,s,"string"),Rt(n,"string")||(Re.type(e,n,i,a,s),Re.range(e,n,i,a,s),Re.pattern(e,n,i,a,s),e.whitespace===!0&&Re.whitespace(e,n,i,a,s))}r(a)},lN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s),n!==void 0&&Re.type(e,n,i,a,s)}r(a)},cN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(n===""&&(n=void 0),Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s),n!==void 0&&(Re.type(e,n,i,a,s),Re.range(e,n,i,a,s))}r(a)},hN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s),n!==void 0&&Re.type(e,n,i,a,s)}r(a)},fN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s),Rt(n)||Re.type(e,n,i,a,s)}r(a)},dN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s),n!==void 0&&(Re.type(e,n,i,a,s),Re.range(e,n,i,a,s))}r(a)},pN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s),n!==void 0&&(Re.type(e,n,i,a,s),Re.range(e,n,i,a,s))}r(a)},gN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(n==null&&!e.required)return r();Re.required(e,n,i,a,s,"array"),n!=null&&(Re.type(e,n,i,a,s),Re.range(e,n,i,a,s))}r(a)},mN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s),n!==void 0&&Re.type(e,n,i,a,s)}r(a)},yN="enum",vN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s),n!==void 0&&Re[yN](e,n,i,a,s)}r(a)},bN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n,"string")&&!e.required)return r();Re.required(e,n,i,a,s),Rt(n,"string")||Re.pattern(e,n,i,a,s)}r(a)},xN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n,"date")&&!e.required)return r();if(Re.required(e,n,i,a,s),!Rt(n,"date")){var u;n instanceof Date?u=n:u=new Date(n),Re.type(e,u,i,a,s),u&&Re.range(e,u.getTime(),i,a,s)}}r(a)},EN=function(e,n,r,i,s){var a=[],o=Array.isArray(n)?"array":typeof n;Re.required(e,n,i,a,s,o),r(a)},zd=function(e,n,r,i,s){var a=e.type,o=[],u=e.required||!e.required&&i.hasOwnProperty(e.field);if(u){if(Rt(n,a)&&!e.required)return r();Re.required(e,n,i,o,s,a),Rt(n,a)||Re.type(e,n,i,o,s)}r(o)},DN=function(e,n,r,i,s){var a=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Rt(n)&&!e.required)return r();Re.required(e,n,i,a,s)}r(a)},Au={string:uN,method:lN,number:cN,boolean:hN,regexp:fN,integer:dN,float:pN,array:gN,object:mN,enum:vN,pattern:bN,date:xN,url:zd,hex:zd,email:zd,required:EN,any:DN};function _0(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var C0=_0(),Uf=function(){function t(n){this.rules=null,this._messages=C0,this.define(n)}var e=t.prototype;return e.define=function(r){var i=this;if(!r)throw new Error("Cannot configure a schema with no rules");if(typeof r!="object"||Array.isArray(r))throw new Error("Rules must be an object");this.rules={},Object.keys(r).forEach(function(s){var a=r[s];i.rules[s]=Array.isArray(a)?a:[a]})},e.messages=function(r){return r&&(this._messages=Ly(_0(),r)),this._messages},e.validate=function(r,i,s){var a=this;i===void 0&&(i={}),s===void 0&&(s=function(){});var o=r,u=i,l=s;if(typeof u=="function"&&(l=u,u={}),!this.rules||Object.keys(this.rules).length===0)return l&&l(null,o),Promise.resolve(o);function c(g){var m=[],y={};function b(E){if(Array.isArray(E)){var w;m=(w=m).concat.apply(w,E)}else m.push(E)}for(var v=0;v<g.length;v++)b(g[v]);m.length?(y=w0(m),l(m,y)):l(null,o)}if(u.messages){var h=this.messages();h===C0&&(h=_0()),Ly(h,u.messages),u.messages=h}else u.messages=this.messages();var d={},f=u.keys||Object.keys(this.rules);f.forEach(function(g){var m=a.rules[g],y=o[g];m.forEach(function(b){var v=b;typeof v.transform=="function"&&(o===r&&(o=vs({},o)),y=o[g]=v.transform(y)),typeof v=="function"?v={validator:v}:v=vs({},v),v.validator=a.getValidationMethod(v),v.validator&&(v.field=g,v.fullField=v.fullField||g,v.type=a.getType(v),d[g]=d[g]||[],d[g].push({rule:v,value:y,source:o,field:g}))})});var p={};return Q3(d,u,function(g,m){var y=g.rule,b=(y.type==="object"||y.type==="array")&&(typeof y.fields=="object"||typeof y.defaultField=="object");b=b&&(y.required||!y.required&&g.value),y.field=g.field;function v(N,D){return vs({},D,{fullField:y.fullField+"."+N,fullFields:y.fullFields?[].concat(y.fullFields,[N]):[N]})}function E(N){N===void 0&&(N=[]);var D=Array.isArray(N)?N:[N];!u.suppressWarning&&D.length&&t.warning("async-validator:",D),D.length&&y.message!==void 0&&(D=[].concat(y.message));var k=D.map(Iy(y,o));if(u.first&&k.length)return p[y.field]=1,m(k);if(!b)m(k);else{if(y.required&&!g.value)return y.message!==void 0?k=[].concat(y.message).map(Iy(y,o)):u.error&&(k=[u.error(y,Vn(u.messages.required,y.field))]),m(k);var F={};y.defaultField&&Object.keys(g.value).map(function(R){F[R]=y.defaultField}),F=vs({},F,g.rule.fields);var M={};Object.keys(F).forEach(function(R){var I=F[R],x=Array.isArray(I)?I:[I];M[R]=x.map(v.bind(null,R))});var S=new t(M);S.messages(u.messages),g.rule.options&&(g.rule.options.messages=u.messages,g.rule.options.error=u.error),S.validate(g.value,g.rule.options||u,function(R){var I=[];k&&k.length&&I.push.apply(I,k),R&&R.length&&I.push.apply(I,R),m(I.length?I:null)})}}var w;if(y.asyncValidator)w=y.asyncValidator(y,g.value,E,g.source,u);else if(y.validator){try{w=y.validator(y,g.value,E,g.source,u)}catch(N){console.error==null||console.error(N),u.suppressValidatorError||setTimeout(function(){throw N},0),E(N.message)}w===!0?E():w===!1?E(typeof y.message=="function"?y.message(y.fullField||y.field):y.message||(y.fullField||y.field)+" fails"):w instanceof Array?E(w):w instanceof Error&&E(w.message)}w&&w.then&&w.then(function(){return E()},function(N){return E(N)})},function(g){c(g)},o)},e.getType=function(r){if(r.type===void 0&&r.pattern instanceof RegExp&&(r.type="pattern"),typeof r.validator!="function"&&r.type&&!Au.hasOwnProperty(r.type))throw new Error(Vn("Unknown rule type %s",r.type));return r.type||"string"},e.getValidationMethod=function(r){if(typeof r.validator=="function")return r.validator;var i=Object.keys(r),s=i.indexOf("message");return s!==-1&&i.splice(s,1),i.length===1&&i[0]==="required"?Au.required:Au[this.getType(r)]||void 0},t}();Uf.register=function(e,n){if(typeof n!="function")throw new Error("Cannot register a validator by type, validator is not a function");Au[e]=n};Uf.warning=j3;Uf.messages=C0;Uf.validators=Au;function qt(t){this.content=t}qt.prototype={constructor:qt,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),s=r.content.slice();return i==-1?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new qt(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new qt(n)},addToStart:function(t,e){return new qt([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new qt(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),s=r.find(t);return i.splice(s==-1?i.length:s,0,e,n),new qt(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=qt.from(t),t.size?new qt(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=qt.from(t),t.size?new qt(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=qt.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};qt.from=function(t){if(t instanceof qt)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new qt(e)};function l2(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),s=e.child(r);if(i==s){n+=i.nodeSize;continue}if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(let a=0;i.text[a]==s.text[a];a++)n++;return n}if(i.content.size||s.content.size){let a=l2(i.content,s.content,n+1);if(a!=null)return a}n+=i.nodeSize}}function c2(t,e,n,r){for(let i=t.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:n,b:r};let a=t.child(--i),o=e.child(--s),u=a.nodeSize;if(a==o){n-=u,r-=u;continue}if(!a.sameMarkup(o))return{a:n,b:r};if(a.isText&&a.text!=o.text){let l=0,c=Math.min(a.text.length,o.text.length);for(;l<c&&a.text[a.text.length-l-1]==o.text[o.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(a.content.size||o.content.size){let l=c2(a.content,o.content,n-1,r-1);if(l)return l}n-=u,r-=u}}class te{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,s){for(let a=0,o=0;o<n;a++){let u=this.content[a],l=o+u.nodeSize;if(l>e&&r(u,i+o,s||null,a)!==!1&&u.content.size){let c=o+1;u.nodesBetween(Math.max(0,e-c),Math.min(u.content.size,n-c),r,i+c)}o=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let s="",a=!0;return this.nodesBetween(e,n,(o,u)=>{let l=o.isText?o.text.slice(Math.max(e,u)-u,n-u):o.isLeaf?i?typeof i=="function"?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&l||o.isTextblock)&&r&&(a?a=!1:s+=r),s+=l},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new te(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let s=0,a=0;a<n;s++){let o=this.content[s],u=a+o.nodeSize;u>e&&((a<e||u>n)&&(o.isText?o=o.cut(Math.max(0,e-a),Math.min(o.text.length,n-a)):o=o.cut(Math.max(0,e-a-1),Math.min(o.content.size,n-a-1))),r.push(o),i+=o.nodeSize),a=u}return new te(r,i)}cutByIndex(e,n){return e==n?te.empty:e==0&&n==this.content.length?this:new te(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new te(i,s)}addToStart(e){return new te([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new te(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return l2(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return c2(this,e,n,r)}findIndex(e,n=-1){if(e==0)return $l(0,e);if(e==this.size)return $l(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),a=i+s.nodeSize;if(a>=e)return a==e||n>0?$l(r+1,a):$l(r,i);i=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return te.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new te(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return te.empty;let n,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(n||(n=e.slice(0,i)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new te(n||e,r)}static from(e){if(!e)return te.empty;if(e instanceof te)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new te([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}te.empty=new te([],0);const Wd={index:0,offset:0};function $l(t,e){return Wd.index=t,Wd.offset=e,Wd}function bh(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!bh(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!bh(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}class et{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&bh(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return et.none;if(e instanceof et)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}}et.none=[];class xh extends Error{}class se{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=f2(this.content,e+this.openStart,n);return r&&new se(r,this.openStart,this.openEnd)}removeBetween(e,n){return new se(h2(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return se.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new se(te.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)i++;return new se(e,r,i)}}se.empty=new se(te.empty,0,0);function h2(t,e,n){let{index:r,offset:i}=t.findIndex(e),s=t.maybeChild(r),{index:a,offset:o}=t.findIndex(n);if(i==e||s.isText){if(o!=n&&!t.child(a).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=a)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(h2(s.content,e-i-1,n-i-1)))}function f2(t,e,n,r){let{index:i,offset:s}=t.findIndex(e),a=t.maybeChild(i);if(s==e||a.isText)return t.cut(0,e).append(n).append(t.cut(e));let o=f2(a.content,e-s-1,n);return o&&t.replaceChild(i,a.copy(o))}function wN(t,e,n){if(n.openStart>t.depth)throw new xh("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new xh("Inconsistent open depths");return d2(t,e,n,0)}function d2(t,e,n,r){let i=t.index(r),s=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let a=d2(t,e,n,r+1);return s.copy(s.content.replaceChild(i,a))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let a=t.parent,o=a.content;return Ts(a,o.cut(0,t.parentOffset).append(n.content).append(o.cut(e.parentOffset)))}else{let{start:a,end:o}=_N(n,t);return Ts(s,g2(t,a,o,e,r))}else return Ts(s,Eh(t,e,r))}function p2(t,e){if(!e.type.compatibleContent(t.type))throw new xh("Cannot join "+e.type.name+" onto "+t.type.name)}function A0(t,e,n){let r=t.node(n);return p2(r,e.node(n)),r}function As(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Tu(t,e,n,r){let i=(e||t).node(n),s=0,a=e?e.index(n):i.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(As(t.nodeAfter,r),s++));for(let o=s;o<a;o++)As(i.child(o),r);e&&e.depth==n&&e.textOffset&&As(e.nodeBefore,r)}function Ts(t,e){return t.type.checkContent(e),t.copy(e)}function g2(t,e,n,r,i){let s=t.depth>i&&A0(t,e,i+1),a=r.depth>i&&A0(n,r,i+1),o=[];return Tu(null,t,i,o),s&&a&&e.index(i)==n.index(i)?(p2(s,a),As(Ts(s,g2(t,e,n,r,i+1)),o)):(s&&As(Ts(s,Eh(t,e,i+1)),o),Tu(e,n,i,o),a&&As(Ts(a,Eh(n,r,i+1)),o)),Tu(r,null,i,o),new te(o)}function Eh(t,e,n){let r=[];if(Tu(null,t,n,r),t.depth>n){let i=A0(t,e,n+1);As(Ts(i,Eh(t,e,n+1)),r)}return Tu(e,null,n,r),new te(r)}function _N(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)i=e.node(s).copy(te.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class Uu{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return et.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let o=r;r=i,i=o}let s=r.marks;for(var a=0;a<s.length;a++)s[a].type.spec.inclusive===!1&&(!i||!s[a].isInSet(i.marks))&&(s=s[a--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Dh(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,s=n;for(let a=e;;){let{index:o,offset:u}=a.content.findIndex(s),l=s-u;if(r.push(a,o,i+u),!l||(a=a.child(o),a.isText))break;s=l-1,i+=u+1}return new Uu(n,r,s)}static resolveCached(e,n){let r=$y.get(e);if(r)for(let s=0;s<r.elts.length;s++){let a=r.elts[s];if(a.pos==n)return a}else $y.set(e,r=new CN);let i=r.elts[r.i]=Uu.resolve(e,n);return r.i=(r.i+1)%AN,i}}class CN{constructor(){this.elts=[],this.i=0}}const AN=12,$y=new WeakMap;class Dh{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const TN=Object.create(null);let xa=class T0{constructor(e,n,r,i=et.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||te.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&bh(this.attrs,n||e.defaultAttrs||TN)&&et.sameSet(this.marks,r||et.none)}copy(e=null){return e==this.content?this:new T0(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new T0(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return se.empty;let i=this.resolve(e),s=this.resolve(n),a=r?0:i.sharedDepth(n),o=i.start(a),l=i.node(a).content.cut(i.pos-o,s.pos-o);return new se(l,i.depth-a,s.depth-a)}replace(e,n,r){return wN(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return Uu.resolveCached(this,e)}resolveNoCache(e){return Uu.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),m2(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=te.empty,i=0,s=r.childCount){let a=this.contentMatchAt(e).matchFragment(r,i,s),o=a&&a.matchFragment(this.content,n);if(!o||!o.validEnd)return!1;for(let u=i;u<s;u++)if(!this.type.allowsMarks(r.child(u).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),a=s&&s.matchFragment(this.content,n);return a?a.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=et.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!et.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=te.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,i,r);return s.type.checkAttrs(s.attrs),s}};xa.prototype.text=void 0;class wh extends xa{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):m2(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new wh(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new wh(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function m2(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Rs{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new kN(e,n);if(r.next==null)return Rs.empty;let i=y2(r);r.next&&r.err("Unexpected trailing text");let s=IN(ON(i));return LN(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let s=n;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function s(a,o){let u=a.matchFragment(e,r);if(u&&(!n||u.validEnd))return te.from(o.map(l=>l.createAndFill()));for(let l=0;l<a.next.length;l++){let{type:c,next:h}=a.next[l];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(h)==-1){i.push(h);let d=s(h,o.concat(c));if(d)return d}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let a=[];for(let o=i;o.type;o=o.via)a.push(o.type);return a.reverse()}for(let a=0;a<s.next.length;a++){let{type:o,next:u}=s.next[a];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in n)&&(!i.type||u.validEnd)&&(r.push({match:o.contentMatch,type:o,via:i}),n[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let a=0;a<r.next.length;a++)s+=(a?", ":"")+r.next[a].type.name+"->"+e.indexOf(r.next[a].next);return s}).join(`
`)}}Rs.empty=new Rs(!0);class kN{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function y2(t){let e=[];do e.push(SN(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function SN(t){let e=[];do e.push(NN(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function NN(t){let e=MN(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=FN(t,e);else break;return e}function By(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function FN(t,e){let n=By(t),r=n;return t.eat(",")&&(t.next!="}"?r=By(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function RN(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let s in n){let a=n[s];a.isInGroup(e)&&i.push(a)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function MN(t){if(t.eat("(")){let e=y2(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=RN(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function ON(t){let e=[[]];return i(s(t,0),n()),e;function n(){return e.push([])-1}function r(a,o,u){let l={term:u,to:o};return e[a].push(l),l}function i(a,o){a.forEach(u=>u.to=o)}function s(a,o){if(a.type=="choice")return a.exprs.reduce((u,l)=>u.concat(s(l,o)),[]);if(a.type=="seq")for(let u=0;;u++){let l=s(a.exprs[u],o);if(u==a.exprs.length-1)return l;i(l,o=n())}else if(a.type=="star"){let u=n();return r(o,u),i(s(a.expr,u),u),[r(u)]}else if(a.type=="plus"){let u=n();return i(s(a.expr,o),u),i(s(a.expr,u),u),[r(u)]}else{if(a.type=="opt")return[r(o)].concat(s(a.expr,o));if(a.type=="range"){let u=o;for(let l=0;l<a.min;l++){let c=n();i(s(a.expr,u),c),u=c}if(a.max==-1)i(s(a.expr,u),u);else for(let l=a.min;l<a.max;l++){let c=n();r(u,c),i(s(a.expr,u),c),u=c}return[r(u)]}else{if(a.type=="name")return[r(o,void 0,a.value)];throw new Error("Unknown expr type")}}}}function v2(t,e){return e-t}function Uy(t,e){let n=[];return r(e),n.sort(v2);function r(i){let s=t[i];if(s.length==1&&!s[0].term)return r(s[0].to);n.push(i);for(let a=0;a<s.length;a++){let{term:o,to:u}=s[a];!o&&n.indexOf(u)==-1&&r(u)}}}function IN(t){let e=Object.create(null);return n(Uy(t,0));function n(r){let i=[];r.forEach(a=>{t[a].forEach(({term:o,to:u})=>{if(!o)return;let l;for(let c=0;c<i.length;c++)i[c][0]==o&&(l=i[c][1]);Uy(t,u).forEach(c=>{l||i.push([o,l=[]]),l.indexOf(c)==-1&&l.push(c)})})});let s=e[r.join(",")]=new Rs(r.indexOf(t.length-1)>-1);for(let a=0;a<i.length;a++){let o=i[a][1].sort(v2);s.next.push({type:i[a][0],next:e[o.join(",")]||n(o)})}return s}}function LN(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],s=!i.validEnd,a=[];for(let o=0;o<i.next.length;o++){let{type:u,next:l}=i.next[o];a.push(u.name),s&&!(u.isText||u.hasRequiredAttrs())&&(s=!1),r.indexOf(l)==-1&&r.push(l)}s&&e.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function b2(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function x2(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let s=t[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function E2(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let s=t[i];s.validate&&s.validate(e[i])}}function D2(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new $N(t,r,e[r]);return n}let Gy=class w2{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=D2(e,r.attrs),this.defaultAttrs=b2(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Rs.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:x2(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new xa(this,this.computeAttrs(e),te.from(n),et.setFrom(r))}createChecked(e=null,n,r){return n=te.from(n),this.checkContent(n),new xa(this,this.computeAttrs(e),n,et.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=te.from(n),n.size){let a=this.contentMatch.fillBefore(n);if(!a)return null;n=a.append(n)}let i=this.contentMatch.matchFragment(n),s=i&&i.fillBefore(te.empty,!0);return s?new xa(this,e,n.append(s),et.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){E2(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:et.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,a)=>r[s]=new w2(s,n,a));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function PN(t,e,n){let r=n.split("|");return i=>{let s=i===null?"null":typeof i;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${s}`)}}class $N{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?PN(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Gf{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=D2(e,i.attrs),this.excluded=null;let s=b2(this.attrs);this.instance=s?new et(this,s):null}create(e=null){return!e&&this.instance?this.instance:new et(this,x2(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((s,a)=>r[s]=new Gf(s,i++,n,a)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){E2(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class ZV{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=qt.from(e.nodes),n.marks=qt.from(e.marks||{}),this.nodes=Gy.compile(this.spec.nodes,this),this.marks=Gf.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],a=s.spec.content||"",o=s.spec.marks;if(s.contentMatch=r[a]||(r[a]=Rs.parse(a,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=o=="_"?null:o?zy(this,o.split(" ")):o==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],a=s.spec.excludes;s.excluded=a==null?[s]:a==""?[]:zy(this,a.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Gy){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new wh(r,r.defaultAttrs,e,et.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return xa.fromJSON(this,e)}markFromJSON(e){return et.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function zy(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],s=t.marks[i],a=s;if(s)n.push(s);else for(let o in t.marks){let u=t.marks[o];(i=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(i)>-1)&&n.push(a=u)}if(!a)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function BN(t){return t.tag!=null}function UN(t){return t.style!=null}let GN=class k0{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(BN(i))this.tags.push(i);else if(UN(i)){let s=/[^=]*/.exec(i.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let r=new Hy(this,n,!1);return r.addAll(e,et.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new Hy(this,n,!0);return r.addAll(e,et.none,n.from,n.to),se.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(HN(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let a=s.getAttrs(e);if(a===!1)continue;s.attrs=a||void 0}return s}}}matchStyle(e,n,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let a=this.styles[s],o=a.style;if(!(o.indexOf(e)!=0||a.context&&!r.matchesContext(a.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=n))){if(a.getAttrs){let u=a.getAttrs(n);if(u===!1)continue;a.attrs=u||void 0}return a}}}static schemaRules(e){let n=[];function r(i){let s=i.priority==null?50:i.priority,a=0;for(;a<n.length;a++){let o=n[a];if((o.priority==null?50:o.priority)<s)break}n.splice(a,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(a=>{r(a=Yy(a)),a.mark||a.ignore||a.clearMark||(a.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(a=>{r(a=Yy(a)),a.node||a.ignore||a.mark||(a.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new k0(e,k0.schemaRules(e)))}};const _2={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},zN={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},C2={ol:!0,ul:!0},Gu=1,S0=2,Fc=4;function Wy(t,e,n){return e!=null?(e?Gu:0)|(e==="full"?S0:0):t&&t.whitespace=="pre"?Gu|S0:n&-5}class Bl{constructor(e,n,r,i,s,a){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=a,this.content=[],this.activeMarks=et.none,this.match=s||(a&Fc?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(te.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Gu)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let n=te.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(te.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!_2.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Hy{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,s,a=Wy(null,n.preserveWhitespace,0)|(r?Fc:0);i?s=new Bl(i.type,i.attrs,et.none,!0,n.topMatch||i.type.contentMatch,a):r?s=new Bl(null,null,et.none,!0,null,a):s=new Bl(e.schema.topNodeType,null,et.none,!0,null,a),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,s=i.options&S0?"full":this.localPreserveWS||(i.options&Gu)>0;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(s)s!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let a=i.content[i.content.length-1],o=e.previousSibling;(!a||o&&o.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let a=e.nodeName.toLowerCase(),o;C2.hasOwnProperty(a)&&this.parser.normalizeLists&&WN(e);let u=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,r));e:if(u?u.ignore:zN.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,n);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(e=u.skip);let l,c=this.needsBlock;if(_2.hasOwnProperty(a))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),l=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let h=u&&u.skip?n:this.readStyles(e,n);h&&this.addAll(e,h),l&&this.sync(s),this.needsBlock=c}else{let l=this.readStyles(e,n);l&&this.addElementByRule(e,u,l,u.consuming===!1?o:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],a=r.getPropertyValue(s);if(a)for(let o=void 0;;){let u=this.parser.matchStyle(s,a,this,o);if(!u)break;if(u.ignore)return null;if(u.clearMark?n=n.filter(l=>!u.clearMark(l)):n=n.concat(this.parser.schema.marks[u.mark].create(u.attrs)),u.consuming===!1)o=u;else break}}return n}addElementByRule(e,n,r,i){let s,a;if(n.node)if(a=this.parser.schema.nodes[n.node],a.isLeaf)this.insertNode(a.create(n.attrs),r)||this.leafFallback(e,r);else{let u=this.enter(a,n.attrs||null,r,n.preserveWhitespace);u&&(s=!0,r=u)}else{let u=this.parser.schema.marks[n.mark];r=r.concat(u.create(n.attrs))}let o=this.top;if(a&&a.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(u=>this.insertNode(u,r));else{let u=e;typeof n.contentElement=="string"?u=e.querySelector(n.contentElement):typeof n.contentElement=="function"?u=n.contentElement(e):n.contentElement&&(u=n.contentElement),this.findAround(e,u,!0),this.addAll(u,r),this.findAround(e,u,!1)}s&&this.sync(o)&&this.open--}addAll(e,n,r,i){let s=r||0;for(let a=r?e.childNodes[r]:e.firstChild,o=i==null?null:e.childNodes[i];a!=o;a=a.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(a,n);this.findAtPoint(e,s)}findPlace(e,n){let r,i;for(let s=this.open;s>=0;s--){let a=this.nodes[s],o=a.findWrapping(e);if(o&&(!r||r.length>o.length)&&(r=o,i=a,!o.length)||a.solid)break}if(!r)return null;this.sync(i);for(let s=0;s<r.length;s++)n=this.enterInner(r[s],null,n,!1);return n}insertNode(e,n){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(n=this.enterInner(i,null,n))}let r=this.findPlace(e,n);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let s=et.none;for(let a of r.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):Vy(a.type,e.type))&&(s=a.addToSet(s));return i.content.push(e.mark(s)),!0}return!1}enter(e,n,r,i){let s=this.findPlace(e.create(n),r);return s&&(s=this.enterInner(e,n,r,!0,i)),s}enterInner(e,n,r,i=!1,s){this.closeExtra();let a=this.top;a.match=a.match&&a.match.matchType(e);let o=Wy(e,s,a.options);a.options&Fc&&a.content.length==0&&(o|=Fc);let u=et.none;return r=r.filter(l=>(a.type?a.type.allowsMarkType(l.type):Vy(l.type,e))?(u=l.addToSet(u),!1):!0),this.nodes.push(new Bl(e,n,u,i,null,o)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Gu)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),a=(o,u)=>{for(;o>=0;o--){let l=n[o];if(l==""){if(o==n.length-1||o==0)continue;for(;u>=s;u--)if(a(o-1,u))return!0;return!1}else{let c=u>0||u==0&&i?this.nodes[u].type:r&&u>=s?r.node(u-s).type:null;if(!c||c.name!=l&&!c.isInGroup(l))return!1;u--}}return!0};return a(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function WN(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&C2.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function HN(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Yy(t){let e={};for(let n in t)e[n]=t[n];return e}function Vy(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let s=[],a=o=>{s.push(o);for(let u=0;u<o.edgeCount;u++){let{type:l,next:c}=o.edge(u);if(l==e||s.indexOf(c)<0&&a(c))return!0}};if(a(i.contentMatch))return!0}}class zf{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Hd(n).createDocumentFragment());let i=r,s=[];return e.forEach(a=>{if(s.length||a.marks.length){let o=0,u=0;for(;o<s.length&&u<a.marks.length;){let l=a.marks[u];if(!this.marks[l.type.name]){u++;continue}if(!l.eq(s[o][0])||l.type.spec.spanning===!1)break;o++,u++}for(;o<s.length;)i=s.pop()[1];for(;u<a.marks.length;){let l=a.marks[u++],c=this.serializeMark(l,a.isInline,n);c&&(s.push([l,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(a,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=Rc(Hd(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&Rc(Hd(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return Rc(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new zf(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=qy(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return qy(e.marks)}}function qy(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Hd(t){return t.document||window.document}const Xy=new WeakMap;function YN(t){let e=Xy.get(t);return e===void 0&&Xy.set(t,e=VN(t)),e}function VN(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function Rc(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=YN(r))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a=i.indexOf(" ");a>0&&(n=i.slice(0,a),i=i.slice(a+1));let o,u=n?t.createElementNS(n,i):t.createElement(i),l=e[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let h in l)if(l[h]!=null){let d=h.indexOf(" ");d>0?u.setAttributeNS(h.slice(0,d),h.slice(d+1),l[h]):u.setAttribute(h,l[h])}}for(let h=c;h<e.length;h++){let d=e[h];if(d===0){if(h<e.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}else{let{dom:f,contentDOM:p}=Rc(t,d,n,r);if(u.appendChild(f),p){if(o)throw new RangeError("Multiple content holes");o=p}}}return{dom:u,contentDOM:o}}const A2=65535,T2=Math.pow(2,16);function qN(t,e){return t+e*T2}function jy(t){return t&A2}function XN(t){return(t-(t&A2))/T2}const k2=1,S2=2,Mc=4,N2=8;class N0{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&N2)>0}get deletedBefore(){return(this.delInfo&(k2|Mc))>0}get deletedAfter(){return(this.delInfo&(S2|Mc))>0}get deletedAcross(){return(this.delInfo&Mc)>0}}class Wn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Wn.empty)return Wn.empty}recover(e){let n=0,r=jy(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+XN(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,s=this.inverted?2:1,a=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let u=this.ranges[o]-(this.inverted?i:0);if(u>e)break;let l=this.ranges[o+s],c=this.ranges[o+a],h=u+l;if(e<=h){let d=l?e==u?-1:e==h?1:n:n,f=u+i+(d<0?0:c);if(r)return f;let p=e==(n<0?u:h)?null:qN(o/3,e-u),g=e==u?S2:e==h?k2:Mc;return(n<0?e!=u:e!=h)&&(g|=N2),new N0(f,g,p)}i+=c-l}return r?e+i:new N0(e+i,0,null)}touches(e,n){let r=0,i=jy(n),s=this.inverted?2:1,a=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let u=this.ranges[o]-(this.inverted?r:0);if(u>e)break;let l=this.ranges[o+s],c=u+l;if(e<=c&&o==i*3)return!0;r+=this.ranges[o+a]-l}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let a=this.ranges[i],o=a-(this.inverted?s:0),u=a+(this.inverted?0:s),l=this.ranges[i+n],c=this.ranges[i+r];e(o,o+l,u,u+c),s+=c-l}}invert(){return new Wn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Wn.empty:new Wn(e<0?[0,-e,0]:[0,0,e])}}Wn.empty=new Wn([]);class _h{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new _h(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new _h;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let s=this.from;s<this.to;s++){let a=this._maps[s],o=a.mapResult(e,n);if(o.recover!=null){let u=this.getMirror(s);if(u!=null&&u>s&&u<this.to){s=u,e=this._maps[u].recover(o.recover);continue}}i|=o.delInfo,e=o.pos}return r?e:new N0(e,i,null)}}const Yd=Object.create(null);let pn=class{getMap(){return Wn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Yd[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Yd)throw new RangeError("Duplicate use of step JSON ID "+e);return Yd[e]=n,n.prototype.jsonID=e,n}};class _t{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new _t(e,null)}static fail(e){return new _t(null,e)}static fromReplace(e,n,r,i){try{return _t.ok(e.replace(n,r,i))}catch(s){if(s instanceof xh)return _t.fail(s.message);throw s}}}function mm(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(mm(s.content,e,s))),s.isInline&&(s=e(s,n,i)),r.push(s)}return te.fromArray(r)}class $i extends pn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new se(mm(n.content,(a,o)=>!a.isAtom||!o.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),i),n.openStart,n.openEnd);return _t.fromReplace(e,this.from,this.to,s)}invert(){return new zr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new $i(n.pos,r.pos,this.mark)}merge(e){return e instanceof $i&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new $i(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new $i(n.from,n.to,e.markFromJSON(n.mark))}}pn.jsonID("addMark",$i);class zr extends pn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new se(mm(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return _t.fromReplace(e,this.from,this.to,r)}invert(){return new $i(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new zr(n.pos,r.pos,this.mark)}merge(e){return e instanceof zr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new zr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new zr(n.from,n.to,e.markFromJSON(n.mark))}}pn.jsonID("removeMark",zr);class Bi extends pn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return _t.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return _t.fromReplace(e,this.pos,this.pos+1,new se(te.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new Bi(this.pos,n.marks[i]);return new Bi(this.pos,this.mark)}}return new La(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Bi(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Bi(n.pos,e.markFromJSON(n.mark))}}pn.jsonID("addNodeMark",Bi);class La extends pn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return _t.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return _t.fromReplace(e,this.pos,this.pos+1,new se(te.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Bi(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new La(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new La(n.pos,e.markFromJSON(n.mark))}}pn.jsonID("removeNodeMark",La);class Jt extends pn{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&F0(e,this.from,this.to)?_t.fail("Structure replace would overwrite content"):_t.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Wn([this.from,this.to-this.from,this.slice.size])}invert(e){return new Jt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Jt(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Jt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?se.empty:new se(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Jt(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?se.empty:new se(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Jt(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Jt(n.from,n.to,se.fromJSON(e,n.slice),!!n.structure)}}pn.jsonID("replace",Jt);class en extends pn{constructor(e,n,r,i,s,a,o=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=a,this.structure=o}apply(e){if(this.structure&&(F0(e,this.from,this.gapFrom)||F0(e,this.gapTo,this.to)))return _t.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return _t.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?_t.fromReplace(e,this.from,this.to,r):_t.fail("Content does not fit in gap")}getMap(){return new Wn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new en(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||s>r.pos?null:new en(n.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new en(n.from,n.to,n.gapFrom,n.gapTo,se.fromJSON(e,n.slice),n.insert,!!n.structure)}}pn.jsonID("replaceAround",en);function F0(t,e,n){let r=t.resolve(e),i=n-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let a=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,i--}}return!1}function jN(t,e,n,r){let i=[],s=[],a,o;t.doc.nodesBetween(e,n,(u,l,c)=>{if(!u.isInline)return;let h=u.marks;if(!r.isInSet(h)&&c.type.allowsMarkType(r.type)){let d=Math.max(l,e),f=Math.min(l+u.nodeSize,n),p=r.addToSet(h);for(let g=0;g<h.length;g++)h[g].isInSet(p)||(a&&a.to==d&&a.mark.eq(h[g])?a.to=f:i.push(a=new zr(d,f,h[g])));o&&o.to==d?o.to=f:s.push(o=new $i(d,f,r))}}),i.forEach(u=>t.step(u)),s.forEach(u=>t.step(u))}function KN(t,e,n,r){let i=[],s=0;t.doc.nodesBetween(e,n,(a,o)=>{if(!a.isInline)return;s++;let u=null;if(r instanceof Gf){let l=a.marks,c;for(;c=r.isInSet(l);)(u||(u=[])).push(c),l=c.removeFromSet(l)}else r?r.isInSet(a.marks)&&(u=[r]):u=a.marks;if(u&&u.length){let l=Math.min(o+a.nodeSize,n);for(let c=0;c<u.length;c++){let h=u[c],d;for(let f=0;f<i.length;f++){let p=i[f];p.step==s-1&&h.eq(i[f].style)&&(d=p)}d?(d.to=l,d.step=s):i.push({style:h,from:Math.max(o,e),to:l,step:s})}}}),i.forEach(a=>t.step(new zr(a.from,a.to,a.style)))}function ym(t,e,n,r=n.contentMatch,i=!0){let s=t.doc.nodeAt(e),a=[],o=e+1;for(let u=0;u<s.childCount;u++){let l=s.child(u),c=o+l.nodeSize,h=r.matchType(l.type);if(!h)a.push(new Jt(o,c,se.empty));else{r=h;for(let d=0;d<l.marks.length;d++)n.allowsMarkType(l.marks[d].type)||t.step(new zr(o,c,l.marks[d]));if(i&&l.isText&&n.whitespace!="pre"){let d,f=/\r?\n|\r/g,p;for(;d=f.exec(l.text);)p||(p=new se(te.from(n.schema.text(" ",n.allowedMarks(l.marks))),0,0)),a.push(new Jt(o+d.index,o+d.index+d[0].length,p))}}o=c}if(!r.validEnd){let u=r.fillBefore(te.empty,!0);t.replace(o,o,new se(u,0,0))}for(let u=a.length-1;u>=0;u--)t.step(a[u])}function JN(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function ul(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),s=t.$from.index(r),a=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(s,a,n))return r;if(r==0||i.type.spec.isolating||!JN(i,s,a))break}return null}function ZN(t,e,n){let{$from:r,$to:i,depth:s}=e,a=r.before(s+1),o=i.after(s+1),u=a,l=o,c=te.empty,h=0;for(let p=s,g=!1;p>n;p--)g||r.index(p)>0?(g=!0,c=te.from(r.node(p).copy(c)),h++):u--;let d=te.empty,f=0;for(let p=s,g=!1;p>n;p--)g||i.after(p+1)<i.end(p)?(g=!0,d=te.from(i.node(p).copy(d)),f++):l++;t.step(new en(u,l,a,o,new se(c.append(d),h,f),c.size-h,!0))}function F2(t,e,n=null,r=t){let i=QN(t,e),s=i&&eF(r,e);return s?i.map(Ky).concat({type:e,attrs:n}).concat(s.map(Ky)):null}function Ky(t){return{type:t,attrs:null}}function QN(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.contentMatchAt(r).findWrapping(e);if(!s)return null;let a=s.length?s[0]:e;return n.canReplaceWith(r,i,a)?s:null}function eF(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.child(r),a=e.contentMatch.findWrapping(s.type);if(!a)return null;let u=(a.length?a[a.length-1]:e).contentMatch;for(let l=r;u&&l<i;l++)u=u.matchType(n.child(l).type);return!u||!u.validEnd?null:a}function tF(t,e,n){let r=te.empty;for(let a=n.length-1;a>=0;a--){if(r.size){let o=n[a].type.contentMatch.matchFragment(r);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=te.from(n[a].type.create(n[a].attrs,r))}let i=e.start,s=e.end;t.step(new en(i,s,i,s,new se(r,0,0),n.length,!0))}function nF(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(a,o)=>{let u=typeof i=="function"?i(a):i;if(a.isTextblock&&!a.hasMarkup(r,u)&&rF(t.doc,t.mapping.slice(s).map(o),r)){let l=null;if(r.schema.linebreakReplacement){let f=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);f&&!p?l=!1:!f&&p&&(l=!0)}l===!1&&M2(t,a,o,s),ym(t,t.mapping.slice(s).map(o,1),r,void 0,l===null);let c=t.mapping.slice(s),h=c.map(o,1),d=c.map(o+a.nodeSize,1);return t.step(new en(h,d,h+1,d-1,new se(te.from(r.create(u,null,a.marks)),0,0),1,!0)),l===!0&&R2(t,a,o,s),!1}})}function R2(t,e,n,r){e.forEach((i,s)=>{if(i.isText){let a,o=/\r?\n|\r/g;for(;a=o.exec(i.text);){let u=t.mapping.slice(r).map(n+1+s+a.index);t.replaceWith(u,u+1,e.type.schema.linebreakReplacement.create())}}})}function M2(t,e,n,r){e.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let a=t.mapping.slice(r).map(n+1+s);t.replaceWith(a,a+1,e.type.schema.text(`
`))}})}function rF(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function iF(t,e,n,r,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let a=n.create(r,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,a);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new en(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new se(te.from(a),0,0),1,!0))}function ku(t,e,n=1,r){let i=t.resolve(e),s=i.depth-n,a=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!a.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let l=i.depth-1,c=n-2;l>s;l--,c--){let h=i.node(l),d=i.index(l);if(h.type.spec.isolating)return!1;let f=h.content.cutByIndex(d,h.childCount),p=r&&r[c+1];p&&(f=f.replaceChild(0,p.type.create(p.attrs)));let g=r&&r[c]||h;if(!h.canReplace(d+1,h.childCount)||!g.type.validContent(f))return!1}let o=i.indexAfter(s),u=r&&r[0];return i.node(s).canReplaceWith(o,o,u?u.type:i.node(s+1).type)}function sF(t,e,n=1,r){let i=t.doc.resolve(e),s=te.empty,a=te.empty;for(let o=i.depth,u=i.depth-n,l=n-1;o>u;o--,l--){s=te.from(i.node(o).copy(s));let c=r&&r[l];a=te.from(c?c.type.create(c.attrs,a):i.node(o).copy(a))}t.step(new Jt(e,e,new se(s.append(a),n,n),!0))}function ll(t,e){let n=t.resolve(e),r=n.index();return O2(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function aF(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),a=s.type==r?t.type.schema.nodes.text:s.type;if(n=n.matchType(a),!n||!t.type.allowsMarks(s.marks))return!1}return n.validEnd}function O2(t,e){return!!(t&&e&&!t.isLeaf&&aF(t,e))}function I2(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let s,a,o=r.index(i);if(i==r.depth?(s=r.nodeBefore,a=r.nodeAfter):n>0?(s=r.node(i+1),o++,a=r.node(i).maybeChild(o)):(s=r.node(i).maybeChild(o-1),a=r.node(i+1)),s&&!s.isTextblock&&O2(s,a)&&r.node(i).canReplace(o,o+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function oF(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,s=t.doc.resolve(e-n),a=s.node().type;if(i&&a.inlineContent){let c=a.whitespace=="pre",h=!!a.contentMatch.matchType(i);c&&!h?r=!1:!c&&h&&(r=!0)}let o=t.steps.length;if(r===!1){let c=t.doc.resolve(e+n);M2(t,c.node(),c.before(),o)}a.inlineContent&&ym(t,e+n-1,a,s.node().contentMatchAt(s.index()),r==null);let u=t.mapping.slice(o),l=u.map(e-n);if(t.step(new Jt(l,u.map(e+n,-1),se.empty,!0)),r===!0){let c=t.doc.resolve(l);R2(t,c.node(),c.before(),t.steps.length)}return t}function uF(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,n))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,n))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function lF(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let s=0;s<n.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let a=r.depth;a>=0;a--){let o=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,u=r.index(a)+(o>0?1:0),l=r.node(a),c=!1;if(s==1)c=l.canReplace(u,u,i);else{let h=l.contentMatchAt(u).findWrapping(i.firstChild.type);c=h&&l.canReplaceWith(u,u,h[0])}if(c)return o==0?r.pos:o<0?r.before(a+1):r.after(a+1)}return null}function Wf(t,e,n=e,r=se.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),s=t.resolve(n);return L2(i,s,r)?new Jt(e,n,r):new cF(i,s,r).fit()}function L2(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class cF{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=te.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=te.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let l=this.findFittable();l?this.placeNodes(l):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,a=r.depth,o=i.depth;for(;a&&o&&s.childCount==1;)s=s.firstChild.content,a--,o--;let u=new se(s,a,o);return e>-1?new en(r.pos,e,this.$to.pos,this.$to.end(),u,n):u.size||r.pos!=this.$to.pos?new Jt(r.pos,i.pos,u):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=n.firstChild;if(n.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}n=s.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=Vd(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let a=i.firstChild;for(let o=this.depth;o>=0;o--){let{type:u,match:l}=this.frontier[o],c,h=null;if(n==1&&(a?l.matchType(a.type)||(h=l.fillBefore(te.from(a),!1)):s&&u.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:o,parent:s,inject:h};if(n==2&&a&&(c=l.findWrapping(a.type)))return{sliceDepth:r,frontierDepth:o,parent:s,wrap:c};if(s&&l.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Vd(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new se(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Vd(e,n);if(i.childCount<=1&&n>0){let s=e.size-n<=n+i.size;this.unplaced=new se(Mo(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new se(Mo(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let g=0;g<s.length;g++)this.openFrontierNode(s[g]);let a=this.unplaced,o=r?r.content:a.content,u=a.openStart-e,l=0,c=[],{match:h,type:d}=this.frontier[n];if(i){for(let g=0;g<i.childCount;g++)c.push(i.child(g));h=h.matchFragment(i)}let f=o.size+e-(a.content.size-a.openEnd);for(;l<o.childCount;){let g=o.child(l),m=h.matchType(g.type);if(!m)break;l++,(l>1||u==0||g.content.size)&&(h=m,c.push(P2(g.mark(d.allowedMarks(g.marks)),l==1?u:0,l==o.childCount?f:-1)))}let p=l==o.childCount;p||(f=-1),this.placed=Oo(this.placed,n,te.from(c)),this.frontier[n].match=h,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,m=o;g<f;g++){let y=m.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),m=y.content}this.unplaced=p?e==0?se.empty:new se(Mo(a.content,e-1,1),e-1,f<0?a.openEnd:e-1):new se(Mo(a.content,e,l),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!qd(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),a=qd(e,n,i,r,s);if(a){for(let o=n-1;o>=0;o--){let{match:u,type:l}=this.frontier[o],c=qd(e,o,l,u,!0);if(!c||c.childCount)continue e}return{depth:n,fit:a,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Oo(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Oo(this.placed,this.depth,te.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(te.empty,!0);n.childCount&&(this.placed=Oo(this.placed,this.frontier.length,n))}}function Mo(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Mo(t.firstChild.content,e-1,n)))}function Oo(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Oo(t.lastChild.content,e-1,n)))}function Vd(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function P2(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,P2(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(te.empty,!0)))),t.copy(r)}function qd(t,e,n,r,i){let s=t.node(e),a=i?t.indexAfter(e):t.index(e);if(a==s.childCount&&!n.compatibleContent(s.type))return null;let o=r.fillBefore(s.content,!0,a);return o&&!hF(n,s.content,a)?o:null}function hF(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function fF(t){return t.spec.defining||t.spec.definingForContent}function dF(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),s=t.doc.resolve(n);if(L2(i,s,r))return t.step(new Jt(e,n,r));let a=B2(i,t.doc.resolve(n));a[a.length-1]==0&&a.pop();let o=-(i.depth+1);a.unshift(o);for(let d=i.depth,f=i.pos-1;d>0;d--,f--){let p=i.node(d).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;a.indexOf(d)>-1?o=d:i.before(d)==f&&a.splice(1,0,-d)}let u=a.indexOf(o),l=[],c=r.openStart;for(let d=r.content,f=0;;f++){let p=d.firstChild;if(l.push(p),f==r.openStart)break;d=p.content}for(let d=c-1;d>=0;d--){let f=l[d],p=fF(f.type);if(p&&!f.sameMarkup(i.node(Math.abs(o)-1)))c=d;else if(p||!f.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let f=(d+c+1)%(r.openStart+1),p=l[f];if(p)for(let g=0;g<a.length;g++){let m=a[(g+u)%a.length],y=!0;m<0&&(y=!1,m=-m);let b=i.node(m-1),v=i.index(m-1);if(b.canReplaceWith(v,v,p.type,p.marks))return t.replace(i.before(m),y?s.after(m):n,new se($2(r.content,0,r.openStart,f),f,r.openEnd))}}let h=t.steps.length;for(let d=a.length-1;d>=0&&(t.replace(e,n,r),!(t.steps.length>h));d--){let f=a[d];f<0||(e=i.before(f),n=s.after(f))}}function $2(t,e,n,r,i){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy($2(s.content,e+1,n,r,s)))}if(e>r){let s=i.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(te.empty,!0))}return t}function pF(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=uF(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new se(te.from(r),0,0))}function gF(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),s=B2(r,i);for(let a=0;a<s.length;a++){let o=s[a],u=a==s.length-1;if(u&&o==0||r.node(o).type.contentMatch.validEnd)return t.delete(r.start(o),i.end(o));if(o>0&&(u||r.node(o-1).canReplace(r.index(o-1),i.indexAfter(o-1))))return t.delete(r.before(o),i.after(o))}for(let a=1;a<=r.depth&&a<=i.depth;a++)if(e-r.start(a)==r.depth-a&&n>r.end(a)&&i.end(a)-n!=i.depth-a&&r.start(a-1)==i.start(a-1)&&r.node(a-1).canReplace(r.index(a-1),i.index(a-1)))return t.delete(r.before(a),n);t.delete(e,n)}function B2(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&n.push(i)}return n}class Ea extends pn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return _t.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return _t.fromReplace(e,this.pos,this.pos+1,new se(te.from(i),0,n.isLeaf?0:1))}getMap(){return Wn.empty}invert(e){return new Ea(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ea(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ea(n.pos,n.attr,n.value)}}pn.jsonID("attr",Ea);class zu extends pn{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return _t.ok(r)}getMap(){return Wn.empty}invert(e){return new zu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new zu(n.attr,n.value)}}pn.jsonID("docAttr",zu);let Pa=class extends Error{};Pa=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Pa.prototype=Object.create(Error.prototype);Pa.prototype.constructor=Pa;Pa.prototype.name="TransformError";let eq=class{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new _h}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Pa(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=se.empty){let i=Wf(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new se(te.from(r),0,0))}delete(e,n){return this.replace(e,n,se.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return dF(this,e,n,r),this}replaceRangeWith(e,n,r){return pF(this,e,n,r),this}deleteRange(e,n){return gF(this,e,n),this}lift(e,n){return ZN(this,e,n),this}join(e,n=1){return oF(this,e,n),this}wrap(e,n){return tF(this,e,n),this}setBlockType(e,n=e,r,i=null){return nF(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return iF(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new Ea(e,n,r)),this}setDocAttribute(e,n){return this.step(new zu(e,n)),this}addNodeMark(e,n){return this.step(new Bi(e,n)),this}removeNodeMark(e,n){if(!(n instanceof et)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new La(e,n)),this}split(e,n=1,r){return sF(this,e,n,r),this}addMark(e,n,r){return jN(this,e,n,r),this}removeMark(e,n,r){return KN(this,e,n,r),this}clearIncompatible(e,n,r){return ym(this,e,n,r),this}};const Xd=Object.create(null);let nt=class{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new mF(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=se.empty){let r=n.content.lastChild,i=null;for(let o=0;o<n.openEnd;o++)i=r,r=r.lastChild;let s=e.steps.length,a=this.ranges;for(let o=0;o<a.length;o++){let{$from:u,$to:l}=a[o],c=e.mapping.slice(s);e.replaceRange(c.map(u.pos),c.map(l.pos),o?se.empty:n),o==0&&Qy(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:a,$to:o}=i[s],u=e.mapping.slice(r),l=u.map(a.pos),c=u.map(o.pos);s?e.deleteRange(l,c):(e.replaceRangeWith(l,c,n),Qy(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new rt(e):la(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let a=n<0?la(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):la(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(a)return a}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new ur(e.node(0))}static atStart(e){return la(e,e,0,0,1)||new ur(e)}static atEnd(e){return la(e,e,e.content.size,e.childCount,-1)||new ur(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Xd[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Xd)throw new RangeError("Duplicate use of selection JSON ID "+e);return Xd[e]=n,n.prototype.jsonID=e,n}getBookmark(){return rt.between(this.$anchor,this.$head).getBookmark()}};nt.prototype.visible=!0;let mF=class{constructor(e,n){this.$from=e,this.$to=n}},Jy=!1;function Zy(t){!Jy&&!t.parent.inlineContent&&(Jy=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class rt extends nt{constructor(e,n=e){Zy(e),Zy(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return nt.near(r);let i=e.resolve(n.map(this.anchor));return new rt(i.parent.inlineContent?i:r,r)}replace(e,n=se.empty){if(super.replace(e,n),n==se.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof rt&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Hf(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new rt(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let s=nt.findFrom(n,r,!0)||nt.findFrom(n,-r,!0);if(s)n=s.$head;else return nt.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(nt.findFrom(e,-r,!0)||nt.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new rt(e,n)}}nt.jsonID("text",rt);class Hf{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Hf(e.map(this.anchor),e.map(this.head))}resolve(e){return rt.between(e.resolve(this.anchor),e.resolve(this.head))}}class Ae extends nt{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),s=e.resolve(i);return r?nt.near(s):new Ae(s)}content(){return new se(te.from(this.node),0,0)}eq(e){return e instanceof Ae&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new vm(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ae(e.resolve(n.anchor))}static create(e,n){return new Ae(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Ae.prototype.visible=!1;nt.jsonID("node",Ae);class vm{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Hf(r,r):new vm(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&Ae.isSelectable(r)?new Ae(n):nt.near(n)}}class ur extends nt{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=se.empty){if(n==se.empty){e.delete(0,e.doc.content.size);let r=nt.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new ur(e)}map(e){return new ur(e)}eq(e){return e instanceof ur}getBookmark(){return yF}}nt.jsonID("all",ur);const yF={map(){return this},resolve(t){return new ur(t)}};function la(t,e,n,r,i,s=!1){if(e.inlineContent)return rt.create(t,n);for(let a=r-(i>0?0:1);i>0?a<e.childCount:a>=0;a+=i){let o=e.child(a);if(o.isAtom){if(!s&&Ae.isSelectable(o))return Ae.create(t,n-(i<0?o.nodeSize:0))}else{let u=la(t,o,n+i,i<0?o.childCount:0,i,s);if(u)return u}n+=o.nodeSize*i}return null}function Qy(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof Jt||i instanceof en))return;let s=t.mapping.maps[r],a;s.forEach((o,u,l,c)=>{a==null&&(a=c)}),t.setSelection(nt.near(t.doc.resolve(a),n))}function ev(t,e){return!e||!t?t:t.bind(e)}class Ul{constructor(e,n,r){this.name=e,this.init=ev(n.init,r),this.apply=ev(n.apply,r)}}new Ul("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Ul("selection",{init(t,e){return t.selection||nt.atStart(e.doc)},apply(t){return t.selection}}),new Ul("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Ul("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}});function U2(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=U2(i,e,{})),n[r]=i}return n}class iq{constructor(e){this.spec=e,this.props={},e.props&&U2(e.props,this,this.props),this.key=e.key?e.key.key:G2("plugin")}getState(e){return e[this.key]}}const jd=Object.create(null);function G2(t){return t in jd?t+"$"+ ++jd[t]:(jd[t]=0,t+"$")}class sq{constructor(e="key"){this.key=G2(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const z2=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function W2(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const vF=(t,e,n)=>{let r=W2(t,n);if(!r)return!1;let i=bm(r);if(!i){let a=r.blockRange(),o=a&&ul(a);return o==null?!1:(e&&e(t.tr.lift(a,o).scrollIntoView()),!0)}let s=i.nodeBefore;if(V2(t,i,e,-1))return!0;if(r.parent.content.size==0&&($a(s,"end")||Ae.isSelectable(s)))for(let a=r.depth;;a--){let o=Wf(t.doc,r.before(a),r.after(a),se.empty);if(o&&o.slice.size<o.to-o.from){if(e){let u=t.tr.step(o);u.setSelection($a(s,"end")?nt.findFrom(u.doc.resolve(u.mapping.map(i.pos,-1)),-1):Ae.create(u.doc,i.pos-s.nodeSize)),e(u.scrollIntoView())}return!0}if(a==1||r.node(a-1).childCount>1)break}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},aq=(t,e,n)=>{let r=W2(t,n);if(!r)return!1;let i=bm(r);return i?H2(t,i,e):!1},oq=(t,e,n)=>{let r=Y2(t,n);if(!r)return!1;let i=xm(r);return i?H2(t,i,e):!1};function H2(t,e,n){let r=e.nodeBefore,i=r,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let a=e.nodeAfter,o=a,u=e.pos+1;for(;!o.isTextblock;u++){if(o.type.spec.isolating)return!1;let c=o.firstChild;if(!c)return!1;o=c}let l=Wf(t.doc,s,u,se.empty);if(!l||l.from!=s||l instanceof Jt&&l.slice.size>=u-s)return!1;if(n){let c=t.tr.step(l);c.setSelection(rt.create(c.doc,s)),n(c.scrollIntoView())}return!0}function $a(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const bF=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=bm(r)}let a=s&&s.nodeBefore;return!a||!Ae.isSelectable(a)?!1:(e&&e(t.tr.setSelection(Ae.create(t.doc,s.pos-a.nodeSize)).scrollIntoView()),!0)};function bm(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Y2(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const xF=(t,e,n)=>{let r=Y2(t,n);if(!r)return!1;let i=xm(r);if(!i)return!1;let s=i.nodeAfter;if(V2(t,i,e,1))return!0;if(r.parent.content.size==0&&($a(s,"start")||Ae.isSelectable(s))){let a=Wf(t.doc,r.before(),r.after(),se.empty);if(a&&a.slice.size<a.to-a.from){if(e){let o=t.tr.step(a);o.setSelection($a(s,"start")?nt.findFrom(o.doc.resolve(o.mapping.map(i.pos)),1):Ae.create(o.doc,o.mapping.map(i.pos))),e(o.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},EF=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=xm(r)}let a=s&&s.nodeAfter;return!a||!Ae.isSelectable(a)?!1:(e&&e(t.tr.setSelection(Ae.create(t.doc,s.pos)).scrollIntoView()),!0)};function xm(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const uq=(t,e)=>{let n=t.selection,r=n instanceof Ae,i;if(r){if(n.node.isTextblock||!ll(t.doc,n.from))return!1;i=n.from}else if(i=I2(t.doc,n.from,-1),i==null)return!1;if(e){let s=t.tr.join(i);r&&s.setSelection(Ae.create(s.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},lq=(t,e)=>{let n=t.selection,r;if(n instanceof Ae){if(n.node.isTextblock||!ll(t.doc,n.to))return!1;r=n.to}else if(r=I2(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},cq=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),s=i&&ul(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},DF=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Em(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const hq=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),a=Em(i.contentMatchAt(s));if(!a||!i.canReplaceWith(s,s,a))return!1;if(e){let o=n.after(),u=t.tr.replaceWith(o,o,a.createAndFill());u.setSelection(nt.near(u.doc.resolve(o),1)),e(u.scrollIntoView())}return!0},wF=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof ur||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=Em(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let a=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,o=t.tr.insert(a,s.createAndFill());o.setSelection(rt.create(o.doc,a+1)),e(o.scrollIntoView())}return!0},_F=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(ku(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),i=r&&ul(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function CF(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof Ae&&e.selection.node.isBlock)return!r.parentOffset||!ku(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],a,o,u=!1,l=!1;for(let f=r.depth;;f--)if(r.node(f).isBlock){u=r.end(f)==r.pos+(r.depth-f),l=r.start(f)==r.pos-(r.depth-f),o=Em(r.node(f-1).contentMatchAt(r.indexAfter(f-1))),s.unshift(u&&o?{type:o}:null),a=f;break}else{if(f==1)return!1;s.unshift(null)}let c=e.tr;(e.selection instanceof rt||e.selection instanceof ur)&&c.deleteSelection();let h=c.mapping.map(r.pos),d=ku(c.doc,h,s.length,s);if(d||(s[0]=o?{type:o}:null,d=ku(c.doc,h,s.length,s)),c.split(h,s.length,s),!u&&l&&r.node(a).type!=o){let f=c.mapping.map(r.before(a)),p=c.doc.resolve(f);o&&r.node(a-1).canReplaceWith(p.index(),p.index()+1,o)&&c.setNodeMarkup(c.mapping.map(r.before(a)),o)}return n&&n(c.scrollIntoView()),!0}}const AF=CF(),fq=(t,e)=>{let{$from:n,to:r}=t.selection,i,s=n.sharedDepth(r);return s==0?!1:(i=n.before(s),e&&e(t.tr.setSelection(Ae.create(t.doc,i))),!0)};function TF(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||ll(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function V2(t,e,n,r){let i=e.nodeBefore,s=e.nodeAfter,a,o,u=i.type.spec.isolating||s.type.spec.isolating;if(!u&&TF(t,e,n))return!0;let l=!u&&e.parent.canReplace(e.index(),e.index()+1);if(l&&(a=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(a[0]||s.type).validEnd){if(n){let f=e.pos+s.nodeSize,p=te.empty;for(let y=a.length-1;y>=0;y--)p=te.from(a[y].create(null,p));p=te.from(i.copy(p));let g=t.tr.step(new en(e.pos-1,f,e.pos,f,new se(p,1,0),a.length,!0)),m=g.doc.resolve(f+2*a.length);m.nodeAfter&&m.nodeAfter.type==i.type&&ll(g.doc,m.pos)&&g.join(m.pos),n(g.scrollIntoView())}return!0}let c=s.type.spec.isolating||r>0&&u?null:nt.findFrom(e,1),h=c&&c.$from.blockRange(c.$to),d=h&&ul(h);if(d!=null&&d>=e.depth)return n&&n(t.tr.lift(h,d).scrollIntoView()),!0;if(l&&$a(s,"start",!0)&&$a(i,"end")){let f=i,p=[];for(;p.push(f),!f.isTextblock;)f=f.lastChild;let g=s,m=1;for(;!g.isTextblock;g=g.firstChild)m++;if(f.canReplace(f.childCount,f.childCount,g.content)){if(n){let y=te.empty;for(let v=p.length-1;v>=0;v--)y=te.from(p[v].copy(y));let b=t.tr.step(new en(e.pos-p.length,e.pos+s.nodeSize,e.pos+m,e.pos+s.nodeSize-m,new se(y,p.length,0),0,!0));n(b.scrollIntoView())}return!0}}return!1}function q2(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(n&&n(e.tr.setSelection(rt.create(e.doc,t<0?i.start(s):i.end(s)))),!0):!1}}const dq=q2(-1),pq=q2(1);function gq(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,a=i.blockRange(s),o=a&&F2(a,t,e);return o?(r&&r(n.tr.wrap(a,o).scrollIntoView()),!0):!1}}function mq(t,e=null){return function(n,r){let i=!1;for(let s=0;s<n.selection.ranges.length&&!i;s++){let{$from:{pos:a},$to:{pos:o}}=n.selection.ranges[s];n.doc.nodesBetween(a,o,(u,l)=>{if(i)return!1;if(!(!u.isTextblock||u.hasMarkup(t,e)))if(u.type==t)i=!0;else{let c=n.doc.resolve(l),h=c.index();i=c.parent.canReplaceWith(h,h+1,t)}})}if(!i)return!1;if(r){let s=n.tr;for(let a=0;a<n.selection.ranges.length;a++){let{$from:{pos:o},$to:{pos:u}}=n.selection.ranges[a];s.setBlockType(o,u,t,e)}r(s.scrollIntoView())}return!0}}function Dm(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}Dm(z2,vF,bF);Dm(z2,xF,EF);Dm(DF,wF,_F,AF);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function yq(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,a=i.blockRange(s);if(!a)return!1;let o=r?n.tr:null;return kF(o,a,t,e)?(r&&r(o.scrollIntoView()),!0):!1}}function kF(t,e,n,r=null){let i=!1,s=e,a=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let u=a.resolve(e.start-2);s=new Dh(u,u,e.depth),e.endIndex<e.parent.childCount&&(e=new Dh(e.$from,a.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let o=F2(s,n,r,e);return o?(t&&SF(t,e,o,i,n),!0):!1}function SF(t,e,n,r,i){let s=te.empty;for(let c=n.length-1;c>=0;c--)s=te.from(n[c].type.create(n[c].attrs,s));t.step(new en(e.start-(r?2:0),e.end,e.start,e.end,new se(s,0,0),n.length,!0));let a=0;for(let c=0;c<n.length;c++)n[c].type==i&&(a=c+1);let o=n.length-a,u=e.start+n.length-(r?2:0),l=e.parent;for(let c=e.startIndex,h=e.endIndex,d=!0;c<h;c++,d=!1)!d&&ku(t.doc,u,o)&&(t.split(u,o),u+=2*o),u+=l.child(c).nodeSize;return t}function vq(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,a=>a.childCount>0&&a.firstChild.type==t);return s?n?r.node(s.depth-1).type==t?NF(e,n,t,s):FF(e,n,s):!0:!1}}function NF(t,e,n,r){let i=t.tr,s=r.end,a=r.$to.end(r.depth);s<a&&(i.step(new en(s-1,a,s,a,new se(te.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Dh(i.doc.resolve(r.$from.pos),i.doc.resolve(a),r.depth));const o=ul(r);if(o==null)return!1;i.lift(r,o);let u=i.doc.resolve(i.mapping.map(s,-1)-1);return ll(i.doc,u.pos)&&u.nodeBefore.type==u.nodeAfter.type&&i.join(u.pos),e(i.scrollIntoView()),!0}function FF(t,e,n){let r=t.tr,i=n.parent;for(let f=n.end,p=n.endIndex-1,g=n.startIndex;p>g;p--)f-=i.child(p).nodeSize,r.delete(f-1,f+1);let s=r.doc.resolve(n.start),a=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let o=n.startIndex==0,u=n.endIndex==i.childCount,l=s.node(-1),c=s.index(-1);if(!l.canReplace(c+(o?0:1),c+1,a.content.append(u?te.empty:te.from(i))))return!1;let h=s.pos,d=h+a.nodeSize;return r.step(new en(h-(o?1:0),d+(u?1:0),h+1,d-1,new se((o?te.empty:te.from(i.copy(te.empty))).append(u?te.empty:te.from(i.copy(te.empty))),o?0:1,u?0:1),o?0:1)),e(r.scrollIntoView()),!0}function bq(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,l=>l.childCount>0&&l.firstChild.type==t);if(!s)return!1;let a=s.startIndex;if(a==0)return!1;let o=s.parent,u=o.child(a-1);if(u.type!=t)return!1;if(n){let l=u.lastChild&&u.lastChild.type==o.type,c=te.from(l?t.create():null),h=new se(te.from(t.create(null,te.from(o.type.create(null,c)))),l?3:1,0),d=s.start,f=s.end;n(e.tr.step(new en(d-(l?3:1),f,d,f,h,1,!0)).scrollIntoView())}return!0}}const Ws=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},X2=function(t,e,n,r){return n&&(tv(t,e,n,r,-1)||tv(t,e,n,r,1))},RF=/^(img|br|input|textarea|hr)$/i;function tv(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Ch(t))){let s=t.parentNode;if(!s||s.nodeType!=1||wm(t)||RF.test(t.nodeName)||t.contentEditable=="false")return!1;e=Ws(t)+(i<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.contentEditable=="false")return!1;e=i<0?Ch(t):0}else return!1}}function Ch(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function MF(t,e,n){for(let r=e==0,i=e==Ch(t);r||i;){if(t==n)return!0;let s=Ws(t);if(t=t.parentNode,!t)return!1;r=r&&s==0,i=i&&s==Ch(t)}}function wm(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const j2=function(t){return t.focusNode&&X2(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function K2(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}const Kr=typeof navigator<"u"?navigator:null,nv=typeof document<"u"?document:null,Qi=Kr&&Kr.userAgent||"",R0=/Edge\/(\d+)/.exec(Qi),J2=/MSIE \d/.exec(Qi),M0=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Qi),cl=!!(J2||M0||R0),Z2=J2?document.documentMode:M0?+M0[1]:R0?+R0[1]:0,Yf=!cl&&/gecko\/(\d+)/i.test(Qi);Yf&&+(/Firefox\/(\d+)/.exec(Qi)||[0,0])[1];const O0=!cl&&/Chrome\/(\d+)/.exec(Qi),es=!!O0,Q2=O0?+O0[1]:0,Hs=!cl&&!!Kr&&/Apple Computer/.test(Kr.vendor),_m=Hs&&(/Mobile\/\w+/.test(Qi)||!!Kr&&Kr.maxTouchPoints>2),sr=_m||(Kr?/Mac/.test(Kr.platform):!1),OF=Kr?/Win/.test(Kr.platform):!1,hl=/Android \d/.test(Qi),Cm=!!nv&&"webkitFontSmoothing"in nv.documentElement.style,IF=Cm?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function LF(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),s=i&&i.size==0,a=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(a<0)return null;let o=r.resolve(a),u,l;if(j2(n)){for(u=a;i&&!i.node;)i=i.parent;let h=i.node;if(i&&h.isAtom&&Ae.isSelectable(h)&&i.parent&&!(h.isInline&&MF(n.focusNode,n.focusOffset,i.dom))){let d=i.posBefore;l=new Ae(a==d?o:r.resolve(d))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let h=a,d=a;for(let f=0;f<n.rangeCount;f++){let p=n.getRangeAt(f);h=Math.min(h,t.docView.posFromDOM(p.startContainer,p.startOffset,1)),d=Math.max(d,t.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(h<0)return null;[u,a]=d==t.state.selection.anchor?[d,h]:[h,d],o=r.resolve(a)}else u=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(u<0)return null}let c=r.resolve(u);if(!l){let h=e=="pointer"||t.state.selection.head<o.pos&&!s?1:-1;l=tw(t,c,o,h)}return l}function ew(t){return t.editable?t.hasFocus():UF(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Am(t,e=!1){let n=t.state.selection;if(BF(t,n),!!ew(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&es){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&X2(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)$F(t);else{let{anchor:r,head:i}=n,s,a;rv&&!(n instanceof rt)&&(n.$from.parent.inlineContent||(s=iv(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(a=iv(t,n.to))),t.docView.setSelection(r,i,t,e),rv&&(s&&sv(s),a&&sv(a)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&PF(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const rv=Hs||es&&Q2<63;function iv(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(Hs&&i&&i.contentEditable=="false")return Kd(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Kd(i);if(s)return Kd(s)}}function Kd(t){return t.contentEditable="true",Hs&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function sv(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function PF(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!ew(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function $F(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,i=r.nodeName=="IMG";i?n.setStart(r.parentNode,Ws(r)+1):n.setStart(r,0),n.collapse(!0),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&cl&&Z2<=11&&(r.disabled=!0,r.disabled=!1)}function BF(t,e){if(e instanceof Ae){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(av(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else av(t)}function av(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function tw(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||rt.between(e,n,r)}function UF(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function I0(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&nt.findFrom(s,e)}function Oi(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function ov(t,e,n){let r=t.state.selection;if(r instanceof rt)if(n.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let a=t.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return Oi(t,new rt(r.$anchor,a))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=I0(t.state,e);return i&&i instanceof Ae?Oi(t,i):!1}else if(!(sr&&n.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,a;if(!s||s.isText)return!1;let o=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(a=t.docView.descAt(o))&&!a.contentDOM?Ae.isSelectable(s)?Oi(t,new Ae(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):Cm?Oi(t,new rt(t.state.doc.resolve(e<0?o:o+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Ae&&r.node.isInline)return Oi(t,new rt(e>0?r.$to:r.$from));{let i=I0(t.state,e);return i?Oi(t,i):!1}}}function Ah(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Su(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function ea(t,e){return e<0?GF(t):zF(t)}function GF(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,s,a=!1;for(Yf&&n.nodeType==1&&r<Ah(n)&&Su(n.childNodes[r],-1)&&(a=!0);;)if(r>0){if(n.nodeType!=1)break;{let o=n.childNodes[r-1];if(Su(o,-1))i=n,s=--r;else if(o.nodeType==3)n=o,r=n.nodeValue.length;else break}}else{if(nw(n))break;{let o=n.previousSibling;for(;o&&Su(o,-1);)i=n.parentNode,s=Ws(o),o=o.previousSibling;if(o)n=o,r=Ah(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}a?L0(t,n,r):i&&L0(t,i,s)}function zF(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Ah(n),s,a;for(;;)if(r<i){if(n.nodeType!=1)break;let o=n.childNodes[r];if(Su(o,1))s=n,a=++r;else break}else{if(nw(n))break;{let o=n.nextSibling;for(;o&&Su(o,1);)s=o.parentNode,a=Ws(o)+1,o=o.nextSibling;if(o)n=o,r=0,i=Ah(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}s&&L0(t,s,a)}function nw(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function WF(t,e){for(;t&&e==t.childNodes.length&&!wm(t);)e=Ws(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function HF(t,e){for(;t&&!e&&!wm(t);)e=Ws(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function L0(t,e,n){if(e.nodeType!=3){let s,a;(a=WF(e,n))?(e=a,n=0):(s=HF(e,n))&&(e=s,n=s.nodeValue.length)}let r=t.domSelection();if(!r)return;if(j2(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Am(t)},50)}function uv(t,e){let n=t.state.doc.resolve(e);if(!(es||OF)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),a=(s.top+s.bottom)/2;if(a>i.top&&a<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),a=(s.top+s.bottom)/2;if(a>i.top&&a<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function lv(t,e,n){let r=t.state.selection;if(r instanceof rt&&!r.empty||n.indexOf("s")>-1||sr&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let a=I0(t.state,e);if(a&&a instanceof Ae)return Oi(t,a)}if(!i.parent.inlineContent){let a=e<0?i:s,o=r instanceof ur?nt.near(a,e):nt.findFrom(a,e);return o?Oi(t,o):!1}return!1}function cv(t,e){if(!(t.state.selection instanceof rt))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let a=t.state.tr;return e<0?a.delete(n.pos-s.nodeSize,n.pos):a.delete(n.pos,n.pos+s.nodeSize),t.dispatch(a),!0}return!1}function hv(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function YF(t){if(!Hs||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;hv(t,r,"true"),setTimeout(()=>hv(t,r,"false"),20)}return!1}function VF(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function qF(t,e){let n=e.keyCode,r=VF(e);if(n==8||sr&&n==72&&r=="c")return cv(t,-1)||ea(t,-1);if(n==46&&!e.shiftKey||sr&&n==68&&r=="c")return cv(t,1)||ea(t,1);if(n==13||n==27)return!0;if(n==37||sr&&n==66&&r=="c"){let i=n==37?uv(t,t.state.selection.from)=="ltr"?-1:1:-1;return ov(t,i,r)||ea(t,i)}else if(n==39||sr&&n==70&&r=="c"){let i=n==39?uv(t,t.state.selection.from)=="ltr"?1:-1:1;return ov(t,i,r)||ea(t,i)}else{if(n==38||sr&&n==80&&r=="c")return lv(t,-1,r)||ea(t,-1);if(n==40||sr&&n==78&&r=="c")return YF(t)||lv(t,1,r)||ea(t,1);if(r==(sr?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function rw(t,e){t.someProp("transformCopied",f=>{e=f(e,t)});let n=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let f=r.firstChild;n.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let a=t.someProp("clipboardSerializer")||zf.fromSchema(t.state.schema),o=lw(),u=o.createElement("div");u.appendChild(a.serializeFragment(r,{document:o}));let l=u.firstChild,c,h=0;for(;l&&l.nodeType==1&&(c=uw[l.nodeName.toLowerCase()]);){for(let f=c.length-1;f>=0;f--){let p=o.createElement(c[f]);for(;u.firstChild;)p.appendChild(u.firstChild);u.appendChild(p),h++}l=u.firstChild}l&&l.nodeType==1&&l.setAttribute("data-pm-slice",`${i} ${s}${h?` -${h}`:""} ${JSON.stringify(n)}`);let d=t.someProp("clipboardTextSerializer",f=>f(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:u,text:d,slice:e}}function iw(t,e,n,r,i){let s=i.parent.type.spec.code,a,o;if(!n&&!e)return null;let u=e&&(r||s||!n);if(u){if(t.someProp("transformPastedText",d=>{e=d(e,s||r,t)}),s)return e?new se(te.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):se.empty;let h=t.someProp("clipboardTextParser",d=>d(e,i,r,t));if(h)o=h;else{let d=i.marks(),{schema:f}=t.state,p=zf.fromSchema(f);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let m=a.appendChild(document.createElement("p"));g&&m.appendChild(p.serializeNode(f.text(g,d)))})}}else t.someProp("transformPastedHTML",h=>{n=h(n,t)}),a=JF(n),Cm&&ZF(a);let l=a&&a.querySelector("[data-pm-slice]"),c=l&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(l.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let h=+c[3];h>0;h--){let d=a.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;a=d}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||GN.fromSchema(t.state.schema)).parseSlice(a,{preserveWhitespace:!!(u||c),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!XF.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)o=QF(fv(o,+c[1],+c[2]),c[4]);else if(o=se.maxOpen(jF(o.content,i),!0),o.openStart||o.openEnd){let h=0,d=0;for(let f=o.content.firstChild;h<o.openStart&&!f.type.spec.isolating;h++,f=f.firstChild);for(let f=o.content.lastChild;d<o.openEnd&&!f.type.spec.isolating;d++,f=f.lastChild);o=fv(o,h,d)}return t.someProp("transformPasted",h=>{o=h(o,t)}),o}const XF=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function jF(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),s,a=[];if(t.forEach(o=>{if(!a)return;let u=i.findWrapping(o.type),l;if(!u)return a=null;if(l=a.length&&s.length&&aw(u,s,o,a[a.length-1],0))a[a.length-1]=l;else{a.length&&(a[a.length-1]=ow(a[a.length-1],s.length));let c=sw(o,u);a.push(c),i=i.matchType(c.type),s=u}}),a)return te.from(a)}return t}function sw(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,te.from(t));return t}function aw(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=aw(t,e,n,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(te.from(sw(n,t,i+1))))}}function ow(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,ow(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(te.empty,!0);return t.copy(n.append(r))}function P0(t,e,n,r,i,s){let a=e<0?t.firstChild:t.lastChild,o=a.content;return t.childCount>1&&(s=0),i<r-1&&(o=P0(o,e,n,r,i+1,s)),i>=n&&(o=e<0?a.contentMatchAt(0).fillBefore(o,s<=i).append(o):o.append(a.contentMatchAt(a.childCount).fillBefore(te.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,a.copy(o))}function fv(t,e,n){return e<t.openStart&&(t=new se(P0(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new se(P0(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const uw={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let dv=null;function lw(){return dv||(dv=document.implementation.createHTMLDocument("title"))}let Jd=null;function KF(t){let e=window.trustedTypes;return e?(Jd||(Jd=e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Jd.createHTML(t)):t}function JF(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=lw().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&uw[r[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=KF(t),i)for(let s=0;s<i.length;s++)n=n.querySelector(i[s])||n;return n}function ZF(t){let e=t.querySelectorAll(es?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function QF(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:a}=t;for(let o=r.length-2;o>=0;o-=2){let u=n.nodes[r[o]];if(!u||u.hasRequiredAttrs())break;i=te.from(u.create(r[o+1],i)),s++,a++}return new se(i,s,a)}const kr={},Jn={};function Ui(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}Jn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!hw(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(hl&&es&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),_m&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,K2(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||qF(t,n)?n.preventDefault():Ui(t,"key")};Jn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Jn.keypress=(t,e)=>{let n=e;if(hw(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||sr&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof rt)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode);!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,i))&&t.dispatch(t.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};function Vf(t){return{left:t.clientX,top:t.clientY}}function eR(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function Tm(t,e,n,r,i){if(r==-1)return!1;let s=t.state.doc.resolve(r);for(let a=s.depth+1;a>0;a--)if(t.someProp(e,o=>a>s.depth?o(t,n,s.nodeAfter,s.before(a),i,!0):o(t,n,s.node(a),s.before(a),i,!1)))return!0;return!1}function Da(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function tR(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&Ae.isSelectable(r)?(Da(t,new Ae(n)),!0):!1}function nR(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof Ae&&(r=n.node);let s=t.state.doc.resolve(e);for(let a=s.depth+1;a>0;a--){let o=a>s.depth?s.nodeAfter:s.node(a);if(Ae.isSelectable(o)){r&&n.$from.depth>0&&a>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?i=s.before(n.$from.depth):i=s.before(a);break}}return i!=null?(Da(t,Ae.create(t.state.doc,i)),!0):!1}function rR(t,e,n,r,i){return Tm(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(i?nR(t,n):tR(t,n))}function iR(t,e,n,r){return Tm(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function sR(t,e,n,r){return Tm(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||aR(t,n,r)}function aR(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Da(t,rt.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let a=s>i.depth?i.nodeAfter:i.node(s),o=i.before(s);if(a.inlineContent)Da(t,rt.create(r,o+1,o+1+a.content.size));else if(Ae.isSelectable(a))Da(t,Ae.create(r,o));else continue;return!0}}function km(t){return Th(t)}const cw=sr?"metaKey":"ctrlKey";kr.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=km(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&eR(n,t.input.lastClick)&&!n[cw]&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:s};let a=t.posAtCoords(Vf(n));a&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new oR(t,a,n,!!r)):(s=="doubleClick"?iR:sR)(t,a.pos,a.inside,n)?n.preventDefault():Ui(t,"pointer"))};class oR{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[cw],this.allowDefault=r.shiftKey;let s,a;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),a=n.inside;else{let c=e.state.doc.resolve(n.pos);s=c.parent,a=c.depth?c.before():0}const o=i?null:r.target,u=o?e.docView.nearestDesc(o,!0):null;this.target=u&&u.dom.nodeType==1?u.dom:null;let{selection:l}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||l instanceof Ae&&l.from<=a&&l.to>a)&&(this.mightDrag={node:s,pos:a,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Yf&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ui(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Am(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Vf(e))),this.updateAllowDefault(e),this.allowDefault||!n?Ui(this.view,"pointer"):rR(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Hs&&this.mightDrag&&!this.mightDrag.node.isAtom||es&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Da(this.view,nt.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Ui(this.view,"pointer")}move(e){this.updateAllowDefault(e),Ui(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}kr.touchstart=t=>{t.input.lastTouch=Date.now(),km(t),Ui(t,"pointer")};kr.touchmove=t=>{t.input.lastTouch=Date.now(),Ui(t,"pointer")};kr.contextmenu=t=>km(t);function hw(t,e){return t.composing?!0:Hs&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const uR=hl?5e3:-1;Jn.compositionstart=Jn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof rt&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Th(t,!0),t.markCursor=null;else if(Th(t,!e.selection.empty),Yf&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let a=s<0?i.lastChild:i.childNodes[s-1];if(!a)break;if(a.nodeType==3){let o=t.domSelection();o&&o.collapse(a,a.nodeValue.length);break}else i=a,s=-1}}t.input.composing=!0}fw(t,uR)};Jn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,fw(t,20))};function fw(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Th(t),e))}function lR(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=cR());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function cR(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Th(t,e=!1){if(!(hl&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),lR(t),e||t.docView&&t.docView.dirty){let n=LF(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!t.state.selection.empty?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function hR(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Wu=cl&&Z2<15||_m&&IF<604;kr.copy=Jn.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let s=Wu?null:n.clipboardData,a=r.content(),{dom:o,text:u}=rw(t,a);s?(n.preventDefault(),s.clearData(),s.setData("text/html",o.innerHTML),s.setData("text/plain",u)):hR(t,o),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function fR(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function dR(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?$0(t,r.value,null,i,e):$0(t,r.textContent,r.innerHTML,i,e)},50)}function $0(t,e,n,r,i){let s=iw(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",u=>u(t,i,s||se.empty)))return!0;if(!s)return!1;let a=fR(s),o=a?t.state.tr.replaceSelectionWith(a,r):t.state.tr.replaceSelection(s);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function dw(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Jn.paste=(t,e)=>{let n=e;if(t.composing&&!hl)return;let r=Wu?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&$0(t,dw(r),r.getData("text/html"),i,n)?n.preventDefault():dR(t,n)};class pR{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const pw=sr?"altKey":"ctrlKey";kr.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(Vf(n)),a;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Ae?i.to-1:i.to))){if(r&&r.mightDrag)a=Ae.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let h=t.docView.nearestDesc(n.target,!0);h&&h.node.type.spec.draggable&&h!=t.docView&&(a=Ae.create(t.state.doc,h.posBefore))}}let o=(a||t.state.selection).content(),{dom:u,text:l,slice:c}=rw(t,o);(!n.dataTransfer.files.length||!es||Q2>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Wu?"Text":"text/html",u.innerHTML),n.dataTransfer.effectAllowed="copyMove",Wu||n.dataTransfer.setData("text/plain",l),t.dragging=new pR(c,!n[pw],a)};kr.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Jn.dragover=Jn.dragenter=(t,e)=>e.preventDefault();Jn.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(Vf(n));if(!i)return;let s=t.state.doc.resolve(i.pos),a=r&&r.slice;a?t.someProp("transformPasted",p=>{a=p(a,t)}):a=iw(t,dw(n.dataTransfer),Wu?null:n.dataTransfer.getData("text/html"),!1,s);let o=!!(r&&!n[pw]);if(t.someProp("handleDrop",p=>p(t,n,a||se.empty,o))){n.preventDefault();return}if(!a)return;n.preventDefault();let u=a?lF(t.state.doc,s.pos,a):s.pos;u==null&&(u=s.pos);let l=t.state.tr;if(o){let{node:p}=r;p?p.replace(l):l.deleteSelection()}let c=l.mapping.map(u),h=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,d=l.doc;if(h?l.replaceRangeWith(c,c,a.content.firstChild):l.replaceRange(c,c,a),l.doc.eq(d))return;let f=l.doc.resolve(c);if(h&&Ae.isSelectable(a.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(a.content.firstChild))l.setSelection(new Ae(f));else{let p=l.mapping.map(u);l.mapping.maps[l.mapping.maps.length-1].forEach((g,m,y,b)=>p=b),l.setSelection(tw(t,f,l.doc.resolve(p)))}t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))};kr.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Am(t)},20))};kr.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};kr.beforeinput=(t,e)=>{if(es&&hl&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,K2(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in Jn)kr[t]=Jn[t];function Hu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class kh{constructor(e,n){this.toDOM=e,this.spec=n||ks,this.side=this.spec.side||0}map(e,n,r,i){let{pos:s,deleted:a}=e.mapResult(n.from+i,this.side<0?-1:1);return a?null:new gi(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof kh&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Hu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Wi{constructor(e,n){this.attrs=e,this.spec=n||ks}map(e,n,r,i){let s=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,a=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=a?null:new gi(s,a,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Wi&&Hu(this.attrs,e.attrs)&&Hu(this.spec,e.spec)}static is(e){return e.type instanceof Wi}destroy(){}}class Sm{constructor(e,n){this.attrs=e,this.spec=n||ks}map(e,n,r,i){let s=e.mapResult(n.from+i,1);if(s.deleted)return null;let a=e.mapResult(n.to+i,-1);return a.deleted||a.pos<=s.pos?null:new gi(s.pos-r,a.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),s;return i==n.from&&!(s=e.child(r)).isText&&i+s.nodeSize==n.to}eq(e){return this==e||e instanceof Sm&&Hu(this.attrs,e.attrs)&&Hu(this.spec,e.spec)}destroy(){}}class gi{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new gi(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new gi(e,e,new kh(n,r))}static inline(e,n,r,i){return new gi(e,n,new Wi(r,i))}static node(e,n,r,i){return new gi(e,n,new Sm(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Wi}get widget(){return this.type instanceof kh}}const ca=[],ks={};class Kt{constructor(e,n){this.local=e.length?e:ca,this.children=n.length?n:ca}static create(e,n){return n.length?Sh(n,e,0,ks):vn}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,s){for(let a=0;a<this.local.length;a++){let o=this.local[a];o.from<=n&&o.to>=e&&(!s||s(o.spec))&&r.push(o.copy(o.from+i,o.to+i))}for(let a=0;a<this.children.length;a+=3)if(this.children[a]<n&&this.children[a+1]>e){let o=this.children[a]+1;this.children[a+2].findInner(e-o,n-o,r,i+o,s)}}map(e,n,r){return this==vn||e.maps.length==0?this:this.mapInner(e,n,0,0,r||ks)}mapInner(e,n,r,i,s){let a;for(let o=0;o<this.local.length;o++){let u=this.local[o].map(e,r,i);u&&u.type.valid(n,u)?(a||(a=[])).push(u):s.onRemove&&s.onRemove(this.local[o].spec)}return this.children.length?gR(this.children,a||[],e,n,r,i,s):a?new Kt(a.sort(Ss),ca):vn}add(e,n){return n.length?this==vn?Kt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,s=0;e.forEach((o,u)=>{let l=u+r,c;if(c=mw(n,o,l)){for(i||(i=this.children.slice());s<i.length&&i[s]<u;)s+=3;i[s]==u?i[s+2]=i[s+2].addInner(o,c,l+1):i.splice(s,0,u,u+o.nodeSize,Sh(c,o,l+1,ks)),s+=3}});let a=gw(s?yw(n):n,-r);for(let o=0;o<a.length;o++)a[o].type.valid(e,a[o])||a.splice(o--,1);return new Kt(a.length?this.local.concat(a).sort(Ss):this.local,i||this.children)}remove(e){return e.length==0||this==vn?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let a,o=r[s]+n,u=r[s+1]+n;for(let c=0,h;c<e.length;c++)(h=e[c])&&h.from>o&&h.to<u&&(e[c]=null,(a||(a=[])).push(h));if(!a)continue;r==this.children&&(r=this.children.slice());let l=r[s+2].removeInner(a,o+1);l!=vn?r[s+2]=l:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,a;s<e.length;s++)if(a=e[s])for(let o=0;o<i.length;o++)i[o].eq(a,n)&&(i==this.local&&(i=this.local.slice()),i.splice(o--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Kt(i,r):vn}forChild(e,n){if(this==vn)return this;if(n.isLeaf)return Kt.empty;let r,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(r=this.children[o+2]);break}let s=e+1,a=s+n.content.size;for(let o=0;o<this.local.length;o++){let u=this.local[o];if(u.from<a&&u.to>s&&u.type instanceof Wi){let l=Math.max(s,u.from)-s,c=Math.min(a,u.to)-s;l<c&&(i||(i=[])).push(u.copy(l,c))}}if(i){let o=new Kt(i.sort(Ss),ca);return r?new ps([o,r]):o}return r||vn}eq(e){if(this==e)return!0;if(!(e instanceof Kt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Nm(this.localsInner(e))}localsInner(e){if(this==vn)return ca;if(e.inlineContent||!this.local.some(Wi.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Wi||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Kt.empty=new Kt([],[]);Kt.removeOverlap=Nm;const vn=Kt.empty;class ps{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,ks));return ps.from(r)}forChild(e,n){if(n.isLeaf)return Kt.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,n);s!=vn&&(s instanceof ps?r=r.concat(s.members):r.push(s))}return ps.from(r)}eq(e){if(!(e instanceof ps)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!n)n=s;else{r&&(n=n.slice(),r=!1);for(let a=0;a<s.length;a++)n.push(s[a])}}return n?Nm(r?n:n.sort(Ss)):ca}static from(e){switch(e.length){case 0:return vn;case 1:return e[0];default:return new ps(e.every(n=>n instanceof Kt)?e:e.reduce((n,r)=>n.concat(r instanceof Kt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function gR(t,e,n,r,i,s,a){let o=t.slice();for(let l=0,c=s;l<n.maps.length;l++){let h=0;n.maps[l].forEach((d,f,p,g)=>{let m=g-p-(f-d);for(let y=0;y<o.length;y+=3){let b=o[y+1];if(b<0||d>b+c-h)continue;let v=o[y]+c-h;f>=v?o[y+1]=d<=v?-2:-1:d>=c&&m&&(o[y]+=m,o[y+1]+=m)}h+=m}),c=n.maps[l].map(c,-1)}let u=!1;for(let l=0;l<o.length;l+=3)if(o[l+1]<0){if(o[l+1]==-2){u=!0,o[l+1]=-1;continue}let c=n.map(t[l]+s),h=c-i;if(h<0||h>=r.content.size){u=!0;continue}let d=n.map(t[l+1]+s,-1),f=d-i,{index:p,offset:g}=r.content.findIndex(h),m=r.maybeChild(p);if(m&&g==h&&g+m.nodeSize==f){let y=o[l+2].mapInner(n,m,c+1,t[l]+s+1,a);y!=vn?(o[l]=h,o[l+1]=f,o[l+2]=y):(o[l+1]=-2,u=!0)}else u=!0}if(u){let l=mR(o,t,e,n,i,s,a),c=Sh(l,r,0,a);e=c.local;for(let h=0;h<o.length;h+=3)o[h+1]<0&&(o.splice(h,3),h-=3);for(let h=0,d=0;h<c.children.length;h+=3){let f=c.children[h];for(;d<o.length&&o[d]<f;)d+=3;o.splice(d,0,c.children[h],c.children[h+1],c.children[h+2])}}return new Kt(e.sort(Ss),o)}function gw(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new gi(i.from+e,i.to+e,i.type))}return n}function mR(t,e,n,r,i,s,a){function o(u,l){for(let c=0;c<u.local.length;c++){let h=u.local[c].map(r,i,l);h?n.push(h):a.onRemove&&a.onRemove(u.local[c].spec)}for(let c=0;c<u.children.length;c+=3)o(u.children[c+2],u.children[c]+l+1)}for(let u=0;u<t.length;u+=3)t[u+1]==-1&&o(t[u+2],e[u]+s+1);return n}function mw(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let s=0,a;s<t.length;s++)(a=t[s])&&a.from>n&&a.to<r&&((i||(i=[])).push(a),t[s]=null);return i}function yw(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Sh(t,e,n,r){let i=[],s=!1;e.forEach((o,u)=>{let l=mw(t,o,u+n);if(l){s=!0;let c=Sh(l,o,n+u+1,r);c!=vn&&i.push(u,u+o.nodeSize,c)}});let a=gw(s?yw(t):t,-n).sort(Ss);for(let o=0;o<a.length;o++)a[o].type.valid(e,a[o])||(r.onRemove&&r.onRemove(a[o].spec),a.splice(o--,1));return a.length||i.length?new Kt(a,i):vn}function Ss(t,e){return t.from-e.from||t.to-e.to}function Nm(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,r.to),pv(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),pv(e,i,r.copy(s.from,r.to)));break}}}return e}function pv(t,e,n){for(;e<t.length&&Ss(n,t[e])>0;)e++;t.splice(e,0,n)}const xq=()=>/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC2\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g;var Zd=new Map;function Eq(t){if(Zd.has(t))return Zd.get(t);var e=yR(t);return Zd.set(t,e),e}var yR=function(){var t=null;try{t=document.createElement("canvas").getContext("2d")}catch{}if(!t)return function(){return!1};var e=25,n=20,r=Math.floor(e/2);return t.font=r+"px Arial, Sans-Serif",t.textBaseline="top",t.canvas.width=n*2,t.canvas.height=e,function(i){t.clearRect(0,0,n*2,e),t.fillStyle="#FF0000",t.fillText(i,0,22),t.fillStyle="#0000FF",t.fillText(i,n,22);for(var s=t.getImageData(0,0,n,e).data,a=s.length,o=0;o<a&&!s[o+3];o+=4);if(o>=a)return!1;var u=n+o/4%n,l=Math.floor(o/4/n),c=t.getImageData(u,l,1,1).data;return!(s[o]!==c[0]||s[o+2]!==c[2]||t.measureText(i).width>=n)}}();const B0="RFC3986",U0={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},vR="RFC1738",bR=Array.isArray,Ir=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),Qd=1024,xR=(t,e,n,r,i)=>{if(t.length===0)return t;let s=t;if(typeof t=="symbol"?s=Symbol.prototype.toString.call(t):typeof t!="string"&&(s=String(t)),n==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<s.length;o+=Qd){const u=s.length>=Qd?s.slice(o,o+Qd):s,l=[];for(let c=0;c<u.length;++c){let h=u.charCodeAt(c);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||i===vR&&(h===40||h===41)){l[l.length]=u.charAt(c);continue}if(h<128){l[l.length]=Ir[h];continue}if(h<2048){l[l.length]=Ir[192|h>>6]+Ir[128|h&63];continue}if(h<55296||h>=57344){l[l.length]=Ir[224|h>>12]+Ir[128|h>>6&63]+Ir[128|h&63];continue}c+=1,h=65536+((h&1023)<<10|u.charCodeAt(c)&1023),l[l.length]=Ir[240|h>>18]+Ir[128|h>>12&63]+Ir[128|h>>6&63]+Ir[128|h&63]}a+=l.join("")}return a};function ER(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function gv(t,e){if(bR(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const DR=Object.prototype.hasOwnProperty,vw={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},$r=Array.isArray,wR=Array.prototype.push,bw=function(t,e){wR.apply(t,$r(e)?e:[e])},_R=Date.prototype.toISOString,Ft={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:xR,encodeValuesOnly:!1,format:B0,formatter:U0[B0],indices:!1,serializeDate(t){return _R.call(t)},skipNulls:!1,strictNullHandling:!1};function CR(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const ep={};function xw(t,e,n,r,i,s,a,o,u,l,c,h,d,f,p,g,m,y){let b=t,v=y,E=0,w=!1;for(;(v=v.get(ep))!==void 0&&!w;){const M=v.get(t);if(E+=1,typeof M<"u"){if(M===E)throw new RangeError("Cyclic object value");w=!0}typeof v.get(ep)>"u"&&(E=0)}if(typeof l=="function"?b=l(e,b):b instanceof Date?b=d==null?void 0:d(b):n==="comma"&&$r(b)&&(b=gv(b,function(M){return M instanceof Date?d==null?void 0:d(M):M})),b===null){if(s)return u&&!g?u(e,Ft.encoder,m,"key",f):e;b=""}if(CR(b)||ER(b)){if(u){const M=g?e:u(e,Ft.encoder,m,"key",f);return[(p==null?void 0:p(M))+"="+(p==null?void 0:p(u(b,Ft.encoder,m,"value",f)))]}return[(p==null?void 0:p(e))+"="+(p==null?void 0:p(String(b)))]}const N=[];if(typeof b>"u")return N;let D;if(n==="comma"&&$r(b))g&&u&&(b=gv(b,u)),D=[{value:b.length>0?b.join(",")||null:void 0}];else if($r(l))D=l;else{const M=Object.keys(b);D=c?M.sort(c):M}const k=o?String(e).replace(/\./g,"%2E"):String(e),F=r&&$r(b)&&b.length===1?k+"[]":k;if(i&&$r(b)&&b.length===0)return F+"[]";for(let M=0;M<D.length;++M){const S=D[M],R=typeof S=="object"&&typeof S.value<"u"?S.value:b[S];if(a&&R===null)continue;const I=h&&o?S.replace(/\./g,"%2E"):S,x=$r(b)?typeof n=="function"?n(F,I):F:F+(h?"."+I:"["+I+"]");y.set(t,E);const _=new WeakMap;_.set(ep,y),bw(N,xw(R,x,n,r,i,s,a,o,n==="comma"&&g&&$r(b)?null:u,l,c,h,d,f,p,g,m,_))}return N}function AR(t=Ft){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Ft.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=B0;if(typeof t.format<"u"){if(!DR.call(U0,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=U0[n];let i=Ft.filter;(typeof t.filter=="function"||$r(t.filter))&&(i=t.filter);let s;if(t.arrayFormat&&t.arrayFormat in vw?s=t.arrayFormat:"indices"in t?s=t.indices?"indices":"repeat":s=Ft.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Ft.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Ft.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Ft.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Ft.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Ft.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Ft.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Ft.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Ft.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Ft.encodeValuesOnly,filter:i,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Ft.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Ft.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Ft.strictNullHandling}}function TR(t,e={}){let n=t;const r=AR(e);let i,s;typeof r.filter=="function"?(s=r.filter,n=s("",n)):$r(r.filter)&&(s=r.filter,i=s);const a=[];if(typeof n!="object"||n===null)return"";const o=vw[r.arrayFormat],u=o==="comma"&&r.commaRoundTrip;i||(i=Object.keys(n)),r.sort&&i.sort(r.sort);const l=new WeakMap;for(let d=0;d<i.length;++d){const f=i[d];r.skipNulls&&n[f]===null||bw(a,xw(n[f],f,o,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const c=a.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),c.length>0?h+c:""}const ha="4.88.0";let mv=!1,Nu,Ew,Dw,G0,ww,_w,Cw,Aw,Tw;function kR(t,e={auto:!1}){if(mv)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Nu)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Nu}'\``);mv=e.auto,Nu=t.kind,Ew=t.fetch,Dw=t.FormData,G0=t.File,ww=t.ReadableStream,_w=t.getMultipartRequestOptions,Cw=t.getDefaultAgent,Aw=t.fileFromPath,Tw=t.isFsReadStream}class SR{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function NR({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,i,s;try{n=fetch,r=Request,i=Response,s=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:i,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new SR(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}Nu||kR(NR(),{auto:!0});class xe extends Error{}class nn extends xe{constructor(e,n,r,i){super(`${nn.makeMessage(e,n,r)}`),this.status=e,this.headers=i,this.request_id=i==null?void 0:i["x-request-id"],this.error=n;const s=n;this.code=s==null?void 0:s.code,this.param=s==null?void 0:s.param,this.type=s==null?void 0:s.type}static makeMessage(e,n,r){const i=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,r,i){if(!e||!i)return new qf({message:r,cause:W0(n)});const s=n==null?void 0:n.error;return e===400?new kw(e,s,r,i):e===401?new Sw(e,s,r,i):e===403?new Nw(e,s,r,i):e===404?new Fw(e,s,r,i):e===409?new Rw(e,s,r,i):e===422?new Mw(e,s,r,i):e===429?new Ow(e,s,r,i):e>=500?new Iw(e,s,r,i):new nn(e,s,r,i)}}class ar extends nn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class qf extends nn{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Fm extends qf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class kw extends nn{}class Sw extends nn{}class Nw extends nn{}class Fw extends nn{}class Rw extends nn{}class Mw extends nn{}class Ow extends nn{}class Iw extends nn{}class Lw extends xe{constructor(){super("Could not parse response content as the length limit was reached")}}class Pw extends xe{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Gl=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},ss=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Un;class Xf{constructor(){Un.set(this,void 0),this.buffer=new Uint8Array,Gl(this,Un,null,"f")}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;const i=[];let s;for(;(s=FR(this.buffer,ss(this,Un,"f")))!=null;){if(s.carriage&&ss(this,Un,"f")==null){Gl(this,Un,s.index,"f");continue}if(ss(this,Un,"f")!=null&&(s.index!==ss(this,Un,"f")+1||s.carriage)){i.push(this.decodeText(this.buffer.slice(0,ss(this,Un,"f")-1))),this.buffer=this.buffer.slice(ss(this,Un,"f")),Gl(this,Un,null,"f");continue}const a=ss(this,Un,"f")!==null?s.preceding-1:s.preceding,o=this.decodeText(this.buffer.slice(0,a));i.push(o),this.buffer=this.buffer.slice(s.index),Gl(this,Un,null,"f")}return i}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new xe(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new xe(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new xe("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Un=new WeakMap;Xf.NEWLINE_CHARS=new Set([`
`,"\r"]);Xf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function FR(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function RR(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}function $w(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Wr{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const a of MR(e,n))if(!s){if(a.data.startsWith("[DONE]")){s=!0;continue}if(a.event===null||a.event.startsWith("response.")){let o;try{o=JSON.parse(a.data)}catch(u){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),u}if(o&&o.error)throw new nn(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(u){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),u}if(a.event=="error")throw new nn(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}s=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{s||n.abort()}}return new Wr(i,n)}static fromReadableStream(e,n){let r=!1;async function*i(){const a=new Xf,o=$w(e);for await(const u of o)for(const l of a.decode(u))yield l;for(const u of a.flush())yield u}async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of i())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||n.abort()}}return new Wr(s,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),i=s=>({next:()=>{if(s.length===0){const a=r.next();e.push(a),n.push(a)}return s.shift()}});return[new Wr(()=>i(e),this.controller),new Wr(()=>i(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new ww({async start(){n=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:a}=await n.next();if(a)return i.close();const o=r.encode(JSON.stringify(s)+`
`);i.enqueue(o)}catch(s){i.error(s)}},async cancel(){var i;await((i=n.return)==null?void 0:i.call(n))}})}}async function*MR(t,e){if(!t.body)throw e.abort(),new xe("Attempted to iterate over a response with no body");const n=new IR,r=new Xf,i=$w(t.body);for await(const s of OR(i))for(const a of r.decode(s)){const o=n.decode(a);o&&(yield o)}for(const s of r.flush()){const a=n.decode(s);a&&(yield a)}}async function*OR(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let i=new Uint8Array(e.length+r.length);i.set(e),i.set(r,e.length),e=i;let s;for(;(s=RR(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}class IR{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,i]=LR(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}function LR(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const Bw=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",Uw=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&jf(t),jf=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",PR=t=>Uw(t)||Bw(t)||Tw(t);async function Gw(t,e,n){var i;if(t=await t,Uw(t))return t;if(Bw(t)){const s=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=jf(s)?[await s.arrayBuffer()]:[s];return new G0(a,e,n)}const r=await $R(t);if(e||(e=UR(t)??"unknown_file"),!(n!=null&&n.type)){const s=(i=r[0])==null?void 0:i.type;typeof s=="string"&&(n={...n,type:s})}return new G0(r,e,n)}async function $R(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(jf(t))e.push(await t.arrayBuffer());else if(GR(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${BR(t)}`);return e}function BR(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function UR(t){var e;return tp(t.name)||tp(t.filename)||((e=tp(t.path))==null?void 0:e.split(/[\\/]/).pop())}const tp=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},GR=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",yv=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Ba=async t=>{const e=await zR(t.body);return _w(e,t)},zR=async t=>{const e=new Dw;return await Promise.all(Object.entries(t||{}).map(([n,r])=>z0(e,n,r))),e},z0=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(PR(n)){const r=await Gw(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>z0(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,i])=>z0(t,`${e}[${r}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var wa={},WR=function(t,e,n,r,i){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n},HR=function(t,e,n,r){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},zl;async function zw(t){var a;const{response:e}=t;if(t.options.stream)return _a("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Wr.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type"),r=(a=n==null?void 0:n.split(";")[0])==null?void 0:a.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const o=await e.json();return _a("response",e.status,e.url,e.headers,o),Ww(o,e)}const s=await e.text();return _a("response",e.status,e.url,e.headers,s),s}function Ww(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Kf extends Promise{constructor(e,n=zw){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new Kf(this.responsePromise,async n=>Ww(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class YR{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:i,fetch:s}){this.baseURL=e,this.maxRetries=np("maxRetries",n),this.timeout=np("timeout",r),this.httpAgent=i,this.fetch=s??Ew}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...JR(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${tM()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async i=>{const s=i&&jf(i==null?void 0:i.body)?new DataView(await i.body.arrayBuffer()):(i==null?void 0:i.body)instanceof DataView?i.body:(i==null?void 0:i.body)instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i==null?void 0:i.body)?new DataView(i.body.buffer):i==null?void 0:i.body;return{method:e,path:n,...i,body:s}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){var p;e={...e};const{method:r,path:i,query:s,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:yv(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,u=this.calculateContentLength(o),l=this.buildURL(i,s);"timeout"in e&&np("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const c=e.httpAgent??this.httpAgent??Cw(l),h=e.timeout+1e3;typeof((p=c==null?void 0:c.options)==null?void 0:p.timeout)=="number"&&h>(c.options.timeout??0)&&(c.options.timeout=h),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const d=this.buildHeaders({options:e,headers:a,contentLength:u,retryCount:n});return{req:{method:r,...o&&{body:o},headers:d,...c&&{agent:c},signal:e.signal??null},url:l,timeout:e.timeout}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:i}){const s={};r&&(s["content-length"]=r);const a=this.defaultHeaders(e);return Ev(s,a),Ev(s,n),yv(e.body)&&Nu!=="node"&&delete s["content-type"],Hl(a,"x-stainless-retry-count")===void 0&&Hl(n,"x-stainless-retry-count")===void 0&&(s["x-stainless-retry-count"]=String(i)),Hl(a,"x-stainless-timeout")===void 0&&Hl(n,"x-stainless-timeout")===void 0&&e.timeout&&(s["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(s,n),s}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,i){return nn.generate(e,n,r,i)}request(e,n=null){return new Kf(this.makeRequest(e,n))}async makeRequest(e,n){var h,d;const r=await e,i=r.maxRetries??this.maxRetries;n==null&&(n=i),await this.prepareOptions(r);const{req:s,url:a,timeout:o}=this.buildRequest(r,{retryCount:i-n});if(await this.prepareRequest(s,{url:a,options:r}),_a("request",a,r,s.headers),(h=r.signal)!=null&&h.aborted)throw new ar;const u=new AbortController,l=await this.fetchWithTimeout(a,s,o,u).catch(W0);if(l instanceof Error){if((d=r.signal)!=null&&d.aborted)throw new ar;if(n)return this.retryRequest(r,n);throw l.name==="AbortError"?new Fm:new qf({cause:l})}const c=qR(l.headers);if(!l.ok){if(n&&this.shouldRetry(l)){const b=`retrying, ${n} attempts remaining`;return _a(`response (error; ${b})`,l.status,a,c),this.retryRequest(r,n,c)}const f=await l.text().catch(b=>W0(b).message),p=ZR(f),g=p?void 0:f;throw _a(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,l.status,a,c,g),this.makeStatusError(l.status,p,g,c)}return{response:l,options:r,controller:u}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new VR(this,r,e)}buildURL(e,n){const r=eM(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return Yw(i)||(n={...i,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new xe(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,i){const{signal:s,...a}=n||{};s&&s.addEventListener("abort",()=>i.abort());const o=setTimeout(()=>i.abort(),r),u={signal:i.signal,...a};return u.method&&(u.method=u.method.toUpperCase()),this.fetch.call(void 0,e,u).finally(()=>{clearTimeout(o)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let i;const s=r==null?void 0:r["retry-after-ms"];if(s){const o=parseFloat(s);Number.isNaN(o)||(i=o)}const a=r==null?void 0:r["retry-after"];if(a&&!i){const o=parseFloat(a);Number.isNaN(o)?i=Date.parse(a)-Date.now():i=o*1e3}if(!(i&&0<=i&&i<60*1e3)){const o=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,o)}return await fl(i),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const s=n-e,a=Math.min(.5*Math.pow(2,s),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${ha}`}}class Hw{constructor(e,n,r,i){zl.set(this,void 0),WR(this,zl,e),this.options=i,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new xe("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[i,s]of r)e.url.searchParams.set(i,s);n.query=void 0,n.path=e.url.toString()}return await HR(this,zl,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(zl=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class VR extends Kf{constructor(e,n,r){super(n,async i=>new r(e,i.response,await zw(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const qR=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),XR={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Gt=t=>typeof t=="object"&&t!==null&&!Yw(t)&&Object.keys(t).every(e=>Vw(XR,e)),jR=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ha,"X-Stainless-OS":bv(Deno.build.os),"X-Stainless-Arch":vv(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ha,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ha,"X-Stainless-OS":bv(process.platform),"X-Stainless-Arch":vv(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=KR();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ha,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ha,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function KR(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const i=r[1]||0,s=r[2]||0,a=r[3]||0;return{browser:e,version:`${i}.${s}.${a}`}}}return null}const vv=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",bv=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let xv;const JR=()=>xv??(xv=jR()),ZR=t=>{try{return JSON.parse(t)}catch{return}},QR=/^[a-z][a-z0-9+.-]*:/i,eM=t=>QR.test(t),fl=t=>new Promise(e=>setTimeout(e,t)),np=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new xe(`${t} must be an integer`);if(e<0)throw new xe(`${t} must be a positive integer`);return e},W0=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},Wl=t=>{var e,n,r,i;if(typeof process<"u")return((e=wa==null?void 0:wa[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(i=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:i.trim()};function Yw(t){if(!t)return!0;for(const e in t)return!1;return!0}function Vw(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ev(t,e){for(const n in e){if(!Vw(e,n))continue;const r=n.toLowerCase();if(!r)continue;const i=e[n];i===null?delete t[r]:i!==void 0&&(t[r]=i)}}const Dv=new Set(["authorization","api-key"]);function _a(t,...e){if(typeof process<"u"&&(wa==null?void 0:wa.DEBUG)==="true"){const n=e.map(r=>{if(!r)return r;if(r.headers){const s={...r,headers:{...r.headers}};for(const a in r.headers)Dv.has(a.toLowerCase())&&(s.headers[a]="REDACTED");return s}let i=null;for(const s in r)Dv.has(s.toLowerCase())&&(i??(i={...r}),i[s]="REDACTED");return i??r});console.log(`OpenAI:DEBUG:${t}`,...n)}}const tM=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),nM=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",rM=t=>typeof(t==null?void 0:t.get)=="function",Hl=(t,e)=>{var r;const n=e.toLowerCase();if(rM(t)){const i=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(s,a,o)=>a+o.toUpperCase());for(const s of[e,n,e.toUpperCase(),i]){const a=t.get(s);if(a)return a}}for(const[i,s]of Object.entries(t))if(i.toLowerCase()===n)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${e} header, using the first entry.`),s[0]):s};function rp(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class Rm extends Hw{constructor(e,n,r,i){super(e,n,r,i),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Rn extends Hw{constructor(e,n,r,i){super(e,n,r,i),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class Pe{constructor(e){this._client=e}}let qw=class extends Pe{list(e,n={},r){return Gt(n)?this.list(e,{},n):this._client.getAPIList(`/chat/completions/${e}/messages`,iM,{query:n,...r})}},Jf=class extends Pe{constructor(){super(...arguments),this.messages=new qw(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return Gt(e)?this.list({},e):this._client.getAPIList("/chat/completions",Zf,{query:e,...n})}del(e,n){return this._client.delete(`/chat/completions/${e}`,n)}};class Zf extends Rn{}class iM extends Rn{}Jf.ChatCompletionsPage=Zf;Jf.Messages=qw;let Qf=class extends Pe{constructor(){super(...arguments),this.completions=new Jf(this._client)}};Qf.Completions=Jf;Qf.ChatCompletionsPage=Zf;class Xw extends Pe{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class jw extends Pe{create(e,n){return this._client.post("/audio/transcriptions",Ba({body:e,...n,__metadata:{model:e.model}}))}}class Kw extends Pe{create(e,n){return this._client.post("/audio/translations",Ba({body:e,...n,__metadata:{model:e.model}}))}}class dl extends Pe{constructor(){super(...arguments),this.transcriptions=new jw(this._client),this.translations=new Kw(this._client),this.speech=new Xw(this._client)}}dl.Transcriptions=jw;dl.Translations=Kw;dl.Speech=Xw;class Mm extends Pe{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return Gt(e)?this.list({},e):this._client.getAPIList("/batches",Om,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class Om extends Rn{}Mm.BatchesPage=Om;class Im extends Pe{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return Gt(e)?this.list({},e):this._client.getAPIList("/assistants",Lm,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Lm extends Rn{}Im.AssistantsPage=Lm;function wv(t){return typeof t.parse=="function"}const Ca=t=>(t==null?void 0:t.role)==="assistant",Jw=t=>(t==null?void 0:t.role)==="function",Zw=t=>(t==null?void 0:t.role)==="tool";var fr=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},ct=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},H0,Oc,Ic,Io,Lo,Lc,Po,ci,$o,Nh,Fh,fa,Qw;class Pm{constructor(){H0.add(this),this.controller=new AbortController,Oc.set(this,void 0),Ic.set(this,()=>{}),Io.set(this,()=>{}),Lo.set(this,void 0),Lc.set(this,()=>{}),Po.set(this,()=>{}),ci.set(this,{}),$o.set(this,!1),Nh.set(this,!1),Fh.set(this,!1),fa.set(this,!1),fr(this,Oc,new Promise((e,n)=>{fr(this,Ic,e,"f"),fr(this,Io,n,"f")}),"f"),fr(this,Lo,new Promise((e,n)=>{fr(this,Lc,e,"f"),fr(this,Po,n,"f")}),"f"),ct(this,Oc,"f").catch(()=>{}),ct(this,Lo,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ct(this,H0,"m",Qw).bind(this))},0)}_connected(){this.ended||(ct(this,Ic,"f").call(this),this._emit("connect"))}get ended(){return ct(this,$o,"f")}get errored(){return ct(this,Nh,"f")}get aborted(){return ct(this,Fh,"f")}abort(){this.controller.abort()}on(e,n){return(ct(this,ci,"f")[e]||(ct(this,ci,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=ct(this,ci,"f")[e];if(!r)return this;const i=r.findIndex(s=>s.listener===n);return i>=0&&r.splice(i,1),this}once(e,n){return(ct(this,ci,"f")[e]||(ct(this,ci,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{fr(this,fa,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){fr(this,fa,!0,"f"),await ct(this,Lo,"f")}_emit(e,...n){if(ct(this,$o,"f"))return;e==="end"&&(fr(this,$o,!0,"f"),ct(this,Lc,"f").call(this));const r=ct(this,ci,"f")[e];if(r&&(ct(this,ci,"f")[e]=r.filter(i=>!i.once),r.forEach(({listener:i})=>i(...n))),e==="abort"){const i=n[0];!ct(this,fa,"f")&&!(r!=null&&r.length)&&Promise.reject(i),ct(this,Io,"f").call(this,i),ct(this,Po,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=n[0];!ct(this,fa,"f")&&!(r!=null&&r.length)&&Promise.reject(i),ct(this,Io,"f").call(this,i),ct(this,Po,"f").call(this,i),this._emit("end")}}_emitFinal(){}}Oc=new WeakMap,Ic=new WeakMap,Io=new WeakMap,Lo=new WeakMap,Lc=new WeakMap,Po=new WeakMap,ci=new WeakMap,$o=new WeakMap,Nh=new WeakMap,Fh=new WeakMap,fa=new WeakMap,H0=new WeakSet,Qw=function(e){if(fr(this,Nh,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ar),e instanceof ar)return fr(this,Fh,!0,"f"),this._emit("abort",e);if(e instanceof xe)return this._emit("error",e);if(e instanceof Error){const n=new xe(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new xe(String(e)))};function $m(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function pl(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function sM(t,e){return!e||!e_(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Bm(t,e)}function Bm(t,e){const n=t.choices.map(r=>{var i;if(r.finish_reason==="length")throw new Lw;if(r.finish_reason==="content_filter")throw new Pw;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((i=r.message.tool_calls)==null?void 0:i.map(s=>oM(e,s)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?aM(e,r.message.content):null}}});return{...t,choices:n}}function aM(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function oM(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(i=>{var s;return((s=i.function)==null?void 0:s.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:pl(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function uM(t,e){var r;if(!t)return!1;const n=(r=t.tools)==null?void 0:r.find(i=>{var s;return((s=i.function)==null?void 0:s.name)===e.function.name});return pl(n)||(n==null?void 0:n.function.strict)||!1}function e_(t){var e;return $m(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>pl(n)||n.type==="function"&&n.function.strict===!0))??!1}function lM(t){for(const e of t??[]){if(e.type!=="function")throw new xe(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new xe(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var kn=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},un,Y0,Rh,V0,q0,X0,t_,j0;const _v=10;class n_ extends Pm{constructor(){super(...arguments),un.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(Jw(e)||Zw(e))&&e.content)this._emit("functionCallResult",e.content);else if(Ca(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Ca(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new xe("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),kn(this,un,"m",Y0).call(this)}async finalMessage(){return await this.done(),kn(this,un,"m",Rh).call(this)}async finalFunctionCall(){return await this.done(),kn(this,un,"m",V0).call(this)}async finalFunctionCallResult(){return await this.done(),kn(this,un,"m",q0).call(this)}async totalUsage(){return await this.done(),kn(this,un,"m",X0).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=kn(this,un,"m",Rh).call(this);n&&this._emit("finalMessage",n);const r=kn(this,un,"m",Y0).call(this);r&&this._emit("finalContent",r);const i=kn(this,un,"m",V0).call(this);i&&this._emit("finalFunctionCall",i);const s=kn(this,un,"m",q0).call(this);s!=null&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",kn(this,un,"m",X0).call(this))}async _createChatCompletion(e,n,r){const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),kn(this,un,"m",t_).call(this,n);const s=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Bm(s,n))}async _runChatCompletion(e,n,r){for(const i of n.messages)this._addMessage(i,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var d;const i="function",{function_call:s="auto",stream:a,...o}=n,u=typeof s!="string"&&(s==null?void 0:s.name),{maxChatCompletions:l=_v}=r||{},c={};for(const f of n.functions)c[f.name||f.function.name]=f;const h=n.functions.map(f=>({name:f.name||f.function.name,parameters:f.parameters,description:f.description}));for(const f of n.messages)this._addMessage(f,!1);for(let f=0;f<l;++f){const g=(d=(await this._createChatCompletion(e,{...o,function_call:s,functions:h,messages:[...this.messages]},r)).choices[0])==null?void 0:d.message;if(!g)throw new xe("missing message in ChatCompletion response");if(!g.function_call)return;const{name:m,arguments:y}=g.function_call,b=c[m];if(b){if(u&&u!==m){const N=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:i,name:m,content:N});continue}}else{const N=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${h.map(D=>JSON.stringify(D.name)).join(", ")}. Please try again`;this._addMessage({role:i,name:m,content:N});continue}let v;try{v=wv(b)?await b.parse(y):y}catch(N){this._addMessage({role:i,name:m,content:N instanceof Error?N.message:String(N)});continue}const E=await b.function(v,this),w=kn(this,un,"m",j0).call(this,E);if(this._addMessage({role:i,name:m,content:w}),u)return}}async _runTools(e,n,r){var f,p,g;const i="tool",{tool_choice:s="auto",stream:a,...o}=n,u=typeof s!="string"&&((f=s==null?void 0:s.function)==null?void 0:f.name),{maxChatCompletions:l=_v}=r||{},c=n.tools.map(m=>{if(pl(m)){if(!m.$callback)throw new xe("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:m.$callback,name:m.function.name,description:m.function.description||"",parameters:m.function.parameters,parse:m.$parseRaw,strict:!0}}}return m}),h={};for(const m of c)m.type==="function"&&(h[m.function.name||m.function.function.name]=m.function);const d="tools"in n?c.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description,strict:m.function.strict}}:m):void 0;for(const m of n.messages)this._addMessage(m,!1);for(let m=0;m<l;++m){const b=(p=(await this._createChatCompletion(e,{...o,tool_choice:s,tools:d,messages:[...this.messages]},r)).choices[0])==null?void 0:p.message;if(!b)throw new xe("missing message in ChatCompletion response");if(!((g=b.tool_calls)!=null&&g.length))return;for(const v of b.tool_calls){if(v.type!=="function")continue;const E=v.id,{name:w,arguments:N}=v.function,D=h[w];if(D){if(u&&u!==w){const S=`Invalid tool_call: ${JSON.stringify(w)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:i,tool_call_id:E,content:S});continue}}else{const S=`Invalid tool_call: ${JSON.stringify(w)}. Available options are: ${Object.keys(h).map(R=>JSON.stringify(R)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:E,content:S});continue}let k;try{k=wv(D)?await D.parse(N):N}catch(S){const R=S instanceof Error?S.message:String(S);this._addMessage({role:i,tool_call_id:E,content:R});continue}const F=await D.function(k,this),M=kn(this,un,"m",j0).call(this,F);if(this._addMessage({role:i,tool_call_id:E,content:M}),u)return}}}}un=new WeakSet,Y0=function(){return kn(this,un,"m",Rh).call(this).content??null},Rh=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Ca(n)){const{function_call:r,...i}=n,s={...i,content:n.content??null,refusal:n.refusal??null};return r&&(s.function_call=r),s}}throw new xe("stream ended without producing a ChatCompletionMessage with role=assistant")},V0=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const i=this.messages[r];if(Ca(i)&&(i!=null&&i.function_call))return i.function_call;if(Ca(i)&&((e=i==null?void 0:i.tool_calls)!=null&&e.length))return(n=i.tool_calls.at(-1))==null?void 0:n.function}},q0=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(Jw(n)&&n.content!=null||Zw(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var i;return r.role==="assistant"&&((i=r.tool_calls)==null?void 0:i.some(s=>s.type==="function"&&s.id===n.tool_call_id))}))return n.content}},X0=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},t_=function(e){if(e.n!=null&&e.n>1)throw new xe("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},j0=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Yu extends n_{static runFunctions(e,n,r){const i=new Yu,s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,n,s)),i}static runTools(e,n,r){const i=new Yu,s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,n,s)),i}_addMessage(e,n=!0){super._addMessage(e,n),Ca(e)&&e.content&&this._emit("content",e.content)}}const r_=1,i_=2,s_=4,a_=8,o_=16,u_=32,l_=64,c_=128,h_=256,f_=c_|h_,d_=o_|u_|f_|l_,p_=r_|i_|d_,g_=s_|a_,cM=p_|g_,Pt={STR:r_,NUM:i_,ARR:s_,OBJ:a_,NULL:o_,BOOL:u_,NAN:l_,INFINITY:c_,MINUS_INFINITY:h_,INF:f_,SPECIAL:d_,ATOM:p_,COLLECTION:g_,ALL:cM};class hM extends Error{}class fM extends Error{}function dM(t,e=Pt.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return pM(t.trim(),e)}const pM=(t,e)=>{const n=t.length;let r=0;const i=d=>{throw new hM(`${d} at position ${r}`)},s=d=>{throw new fM(`${d} at position ${r}`)},a=()=>(h(),r>=n&&i("Unexpected end of input"),t[r]==='"'?o():t[r]==="{"?u():t[r]==="["?l():t.substring(r,r+4)==="null"||Pt.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||Pt.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||Pt.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||Pt.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||Pt.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||Pt.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):c()),o=()=>{const d=r;let f=!1;for(r++;r<n&&(t[r]!=='"'||f&&t[r-1]==="\\");)f=t[r]==="\\"?!f:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(d,++r-Number(f)))}catch(p){s(String(p))}else if(Pt.STR&e)try{return JSON.parse(t.substring(d,r-Number(f))+'"')}catch{return JSON.parse(t.substring(d,t.lastIndexOf("\\"))+'"')}i("Unterminated string literal")},u=()=>{r++,h();const d={};try{for(;t[r]!=="}";){if(h(),r>=n&&Pt.OBJ&e)return d;const f=o();h(),r++;try{const p=a();Object.defineProperty(d,f,{value:p,writable:!0,enumerable:!0,configurable:!0})}catch(p){if(Pt.OBJ&e)return d;throw p}h(),t[r]===","&&r++}}catch{if(Pt.OBJ&e)return d;i("Expected '}' at end of object")}return r++,d},l=()=>{r++;const d=[];try{for(;t[r]!=="]";)d.push(a()),h(),t[r]===","&&r++}catch{if(Pt.ARR&e)return d;i("Expected ']' at end of array")}return r++,d},c=()=>{if(r===0){t==="-"&&Pt.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(t)}catch(f){if(Pt.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}s(String(f))}}const d=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(Pt.NUM&e)&&i("Unterminated number literal");try{return JSON.parse(t.substring(d,r))}catch{t.substring(d,r)==="-"&&Pt.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(t.substring(d,t.lastIndexOf("e")))}catch(p){s(String(p))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return a()},Cv=t=>dM(t,Pt.ALL^Pt.NUM);var ta=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},Ke=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},St,ui,na,Ni,ip,Yl,sp,ap,op,Vl,up,Av;class Vu extends n_{constructor(e){super(),St.add(this),ui.set(this,void 0),na.set(this,void 0),Ni.set(this,void 0),ta(this,ui,e,"f"),ta(this,na,[],"f")}get currentChatCompletionSnapshot(){return Ke(this,Ni,"f")}static fromReadableStream(e){const n=new Vu(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const i=new Vu(n);return i._run(()=>i._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createChatCompletion(e,n,r){var a;super._createChatCompletion;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Ke(this,St,"m",ip).call(this);const s=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of s)Ke(this,St,"m",sp).call(this,o);if((a=s.controller.signal)!=null&&a.aborted)throw new ar;return this._addChatCompletion(Ke(this,St,"m",Vl).call(this))}async _fromReadableStream(e,n){var a;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Ke(this,St,"m",ip).call(this),this._connected();const i=Wr.fromReadableStream(e,this.controller);let s;for await(const o of i)s&&s!==o.id&&this._addChatCompletion(Ke(this,St,"m",Vl).call(this)),Ke(this,St,"m",sp).call(this,o),s=o.id;if((a=i.controller.signal)!=null&&a.aborted)throw new ar;return this._addChatCompletion(Ke(this,St,"m",Vl).call(this))}[(ui=new WeakMap,na=new WeakMap,Ni=new WeakMap,St=new WeakSet,ip=function(){this.ended||ta(this,Ni,void 0,"f")},Yl=function(n){let r=Ke(this,na,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Ke(this,na,"f")[n.index]=r,r)},sp=function(n){var i,s,a,o,u,l,c,h,d,f,p,g,m,y,b;if(this.ended)return;const r=Ke(this,St,"m",Av).call(this,n);this._emit("chunk",n,r);for(const v of n.choices){const E=r.choices[v.index];v.delta.content!=null&&((i=E.message)==null?void 0:i.role)==="assistant"&&((s=E.message)!=null&&s.content)&&(this._emit("content",v.delta.content,E.message.content),this._emit("content.delta",{delta:v.delta.content,snapshot:E.message.content,parsed:E.message.parsed})),v.delta.refusal!=null&&((a=E.message)==null?void 0:a.role)==="assistant"&&((o=E.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:v.delta.refusal,snapshot:E.message.refusal}),((u=v.logprobs)==null?void 0:u.content)!=null&&((l=E.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(c=v.logprobs)==null?void 0:c.content,snapshot:((h=E.logprobs)==null?void 0:h.content)??[]}),((d=v.logprobs)==null?void 0:d.refusal)!=null&&((f=E.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=v.logprobs)==null?void 0:p.refusal,snapshot:((g=E.logprobs)==null?void 0:g.refusal)??[]});const w=Ke(this,St,"m",Yl).call(this,E);E.finish_reason&&(Ke(this,St,"m",op).call(this,E),w.current_tool_call_index!=null&&Ke(this,St,"m",ap).call(this,E,w.current_tool_call_index));for(const N of v.delta.tool_calls??[])w.current_tool_call_index!==N.index&&(Ke(this,St,"m",op).call(this,E),w.current_tool_call_index!=null&&Ke(this,St,"m",ap).call(this,E,w.current_tool_call_index)),w.current_tool_call_index=N.index;for(const N of v.delta.tool_calls??[]){const D=(m=E.message.tool_calls)==null?void 0:m[N.index];D!=null&&D.type&&((D==null?void 0:D.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(y=D.function)==null?void 0:y.name,index:N.index,arguments:D.function.arguments,parsed_arguments:D.function.parsed_arguments,arguments_delta:((b=N.function)==null?void 0:b.arguments)??""}):(D==null||D.type,void 0))}}},ap=function(n,r){var a,o,u;if(Ke(this,St,"m",Yl).call(this,n).done_tool_calls.has(r))return;const s=(a=n.message.tool_calls)==null?void 0:a[r];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const l=(u=(o=Ke(this,ui,"f"))==null?void 0:o.tools)==null?void 0:u.find(c=>c.type==="function"&&c.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:r,arguments:s.function.arguments,parsed_arguments:pl(l)?l.$parseRaw(s.function.arguments):l!=null&&l.function.strict?JSON.parse(s.function.arguments):null})}else s.type},op=function(n){var i,s;const r=Ke(this,St,"m",Yl).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const a=Ke(this,St,"m",up).call(this);this._emit("content.done",{content:n.message.content,parsed:a?a.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(i=n.logprobs)!=null&&i.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(s=n.logprobs)!=null&&s.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},Vl=function(){if(this.ended)throw new xe("stream has ended, this shouldn't happen");const n=Ke(this,Ni,"f");if(!n)throw new xe("request ended without sending any chunks");return ta(this,Ni,void 0,"f"),ta(this,na,[],"f"),gM(n,Ke(this,ui,"f"))},up=function(){var r;const n=(r=Ke(this,ui,"f"))==null?void 0:r.response_format;return $m(n)?n:null},Av=function(n){var r,i,s,a;let o=Ke(this,Ni,"f");const{choices:u,...l}=n;o?Object.assign(o,l):o=ta(this,Ni,{...l,choices:[]},"f");for(const{delta:c,finish_reason:h,index:d,logprobs:f=null,...p}of n.choices){let g=o.choices[d];if(g||(g=o.choices[d]={finish_reason:h,index:d,message:{},logprobs:f,...p}),f)if(!g.logprobs)g.logprobs=Object.assign({},f);else{const{content:N,refusal:D,...k}=f;Object.assign(g.logprobs,k),N&&((r=g.logprobs).content??(r.content=[]),g.logprobs.content.push(...N)),D&&((i=g.logprobs).refusal??(i.refusal=[]),g.logprobs.refusal.push(...D))}if(h&&(g.finish_reason=h,Ke(this,ui,"f")&&e_(Ke(this,ui,"f")))){if(h==="length")throw new Lw;if(h==="content_filter")throw new Pw}if(Object.assign(g,p),!c)continue;const{content:m,refusal:y,function_call:b,role:v,tool_calls:E,...w}=c;if(Object.assign(g.message,w),y&&(g.message.refusal=(g.message.refusal||"")+y),v&&(g.message.role=v),b&&(g.message.function_call?(b.name&&(g.message.function_call.name=b.name),b.arguments&&((s=g.message.function_call).arguments??(s.arguments=""),g.message.function_call.arguments+=b.arguments)):g.message.function_call=b),m&&(g.message.content=(g.message.content||"")+m,!g.message.refusal&&Ke(this,St,"m",up).call(this)&&(g.message.parsed=Cv(g.message.content))),E){g.message.tool_calls||(g.message.tool_calls=[]);for(const{index:N,id:D,type:k,function:F,...M}of E){const S=(a=g.message.tool_calls)[N]??(a[N]={});Object.assign(S,M),D&&(S.id=D),k&&(S.type=k),F&&(S.function??(S.function={name:F.name??"",arguments:""})),F!=null&&F.name&&(S.function.name=F.name),F!=null&&F.arguments&&(S.function.arguments+=F.arguments,uM(Ke(this,ui,"f"),S)&&(S.function.parsed_arguments=Cv(S.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",i=>{const s=n.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of n)i.resolve(void 0);n.length=0}),this.on("abort",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),this.on("error",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,a)=>n.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Wr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function gM(t,e){const{id:n,choices:r,created:i,model:s,system_fingerprint:a,...o}=t,u={...o,id:n,choices:r.map(({message:l,finish_reason:c,index:h,logprobs:d,...f})=>{if(!c)throw new xe(`missing finish_reason for choice ${h}`);const{content:p=null,function_call:g,tool_calls:m,...y}=l,b=l.role;if(!b)throw new xe(`missing role for choice ${h}`);if(g){const{arguments:v,name:E}=g;if(v==null)throw new xe(`missing function_call.arguments for choice ${h}`);if(!E)throw new xe(`missing function_call.name for choice ${h}`);return{...f,message:{content:p,function_call:{arguments:v,name:E},role:b,refusal:l.refusal??null},finish_reason:c,index:h,logprobs:d}}return m?{...f,index:h,finish_reason:c,logprobs:d,message:{...y,role:b,content:p,refusal:l.refusal??null,tool_calls:m.map((v,E)=>{const{function:w,type:N,id:D,...k}=v,{arguments:F,name:M,...S}=w||{};if(D==null)throw new xe(`missing choices[${h}].tool_calls[${E}].id
${ql(t)}`);if(N==null)throw new xe(`missing choices[${h}].tool_calls[${E}].type
${ql(t)}`);if(M==null)throw new xe(`missing choices[${h}].tool_calls[${E}].function.name
${ql(t)}`);if(F==null)throw new xe(`missing choices[${h}].tool_calls[${E}].function.arguments
${ql(t)}`);return{...k,id:D,type:N,function:{...S,name:M,arguments:F}}})}}:{...f,message:{...y,content:p,role:b,refusal:l.refusal??null},finish_reason:c,index:h,logprobs:d}}),created:i,model:s,object:"chat.completion",...a?{system_fingerprint:a}:{}};return sM(u,e)}function ql(t){return JSON.stringify(t)}class Aa extends Vu{static fromReadableStream(e){const n=new Aa(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const i=new Aa(null),s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,n,s)),i}static runTools(e,n,r){const i=new Aa(n),s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,n,s)),i}}let m_=class extends Pe{parse(e,n){return lM(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>Bm(r,e))}runFunctions(e,n){return e.stream?Aa.runFunctions(this._client,e,n):Yu.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?Aa.runTools(this._client,e,n):Yu.runTools(this._client,e,n)}stream(e,n){return Vu.createChatCompletion(this._client,e,n)}};class K0 extends Pe{constructor(){super(...arguments),this.completions=new m_(this._client)}}(function(t){t.Completions=m_})(K0||(K0={}));class y_ extends Pe{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Um extends Pe{constructor(){super(...arguments),this.sessions=new y_(this._client)}}Um.Sessions=y_;var pe=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},$n=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},Xt,J0,Br,Pc,pr,bs,pa,gs,Mh,Gn,$c,Bc,Fu,Bo,Uo,Tv,kv,Sv,Nv,Fv,Rv,Mv;class Er extends Pm{constructor(){super(...arguments),Xt.add(this),J0.set(this,[]),Br.set(this,{}),Pc.set(this,{}),pr.set(this,void 0),bs.set(this,void 0),pa.set(this,void 0),gs.set(this,void 0),Mh.set(this,void 0),Gn.set(this,void 0),$c.set(this,void 0),Bc.set(this,void 0),Fu.set(this,void 0)}[(J0=new WeakMap,Br=new WeakMap,Pc=new WeakMap,pr=new WeakMap,bs=new WeakMap,pa=new WeakMap,gs=new WeakMap,Mh=new WeakMap,Gn=new WeakMap,$c=new WeakMap,Bc=new WeakMap,Fu=new WeakMap,Xt=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",i=>{const s=n.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of n)i.resolve(void 0);n.length=0}),this.on("abort",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),this.on("error",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,a)=>n.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Er;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var s;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const i=Wr.fromReadableStream(e,this.controller);for await(const a of i)pe(this,Xt,"m",Bo).call(this,a);if((s=i.controller.signal)!=null&&s.aborted)throw new ar;return this._addRun(pe(this,Xt,"m",Uo).call(this))}toReadableStream(){return new Wr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,i,s){const a=new Er;return a._run(()=>a._runToolAssistantStream(e,n,r,i,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,n,r,i,s){var l;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...i,stream:!0},u=await e.submitToolOutputs(n,r,o,{...s,signal:this.controller.signal});this._connected();for await(const c of u)pe(this,Xt,"m",Bo).call(this,c);if((l=u.controller.signal)!=null&&l.aborted)throw new ar;return this._addRun(pe(this,Xt,"m",Uo).call(this))}static createThreadAssistantStream(e,n,r){const i=new Er;return i._run(()=>i._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}static createAssistantStream(e,n,r,i){const s=new Er;return s._run(()=>s._runAssistantStream(e,n,r,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return pe(this,$c,"f")}currentRun(){return pe(this,Bc,"f")}currentMessageSnapshot(){return pe(this,pr,"f")}currentRunStepSnapshot(){return pe(this,Fu,"f")}async finalRunSteps(){return await this.done(),Object.values(pe(this,Br,"f"))}async finalMessages(){return await this.done(),Object.values(pe(this,Pc,"f"))}async finalRun(){if(await this.done(),!pe(this,bs,"f"))throw Error("Final run was not received.");return pe(this,bs,"f")}async _createThreadAssistantStream(e,n,r){var o;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...n,stream:!0},a=await e.createAndRun(s,{...r,signal:this.controller.signal});this._connected();for await(const u of a)pe(this,Xt,"m",Bo).call(this,u);if((o=a.controller.signal)!=null&&o.aborted)throw new ar;return this._addRun(pe(this,Xt,"m",Uo).call(this))}async _createAssistantStream(e,n,r,i){var u;const s=i==null?void 0:i.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},o=await e.create(n,a,{...i,signal:this.controller.signal});this._connected();for await(const l of o)pe(this,Xt,"m",Bo).call(this,l);if((u=o.controller.signal)!=null&&u.aborted)throw new ar;return this._addRun(pe(this,Xt,"m",Uo).call(this))}static accumulateDelta(e,n){for(const[r,i]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=i;continue}let s=e[r];if(s==null){e[r]=i;continue}if(r==="index"||r==="type"){e[r]=i;continue}if(typeof s=="string"&&typeof i=="string")s+=i;else if(typeof s=="number"&&typeof i=="number")s+=i;else if(rp(s)&&rp(i))s=this.accumulateDelta(s,i);else if(Array.isArray(s)&&Array.isArray(i)){if(s.every(a=>typeof a=="string"||typeof a=="number")){s.push(...i);continue}for(const a of i){if(!rp(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const u=s[o];u==null?s.push(a):s[o]=this.accumulateDelta(u,a)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${i}, accValue: ${s}`);e[r]=s}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,i){return await this._createAssistantStream(n,e,r,i)}async _runToolAssistantStream(e,n,r,i,s){return await this._createToolAssistantStream(r,e,n,i,s)}}Bo=function(e){if(!this.ended)switch($n(this,$c,e,"f"),pe(this,Xt,"m",Sv).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":pe(this,Xt,"m",Mv).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":pe(this,Xt,"m",kv).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":pe(this,Xt,"m",Tv).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Uo=function(){if(this.ended)throw new xe("stream has ended, this shouldn't happen");if(!pe(this,bs,"f"))throw Error("Final run has not been received");return pe(this,bs,"f")},Tv=function(e){const[n,r]=pe(this,Xt,"m",Fv).call(this,e,pe(this,pr,"f"));$n(this,pr,n,"f"),pe(this,Pc,"f")[n.id]=n;for(const i of r){const s=n.content[i.index];(s==null?void 0:s.type)=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const i of e.data.delta.content){if(i.type=="text"&&i.text){let s=i.text,a=n.content[i.index];if(a&&a.type=="text")this._emit("textDelta",s,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(i.index!=pe(this,pa,"f")){if(pe(this,gs,"f"))switch(pe(this,gs,"f").type){case"text":this._emit("textDone",pe(this,gs,"f").text,pe(this,pr,"f"));break;case"image_file":this._emit("imageFileDone",pe(this,gs,"f").image_file,pe(this,pr,"f"));break}$n(this,pa,i.index,"f")}$n(this,gs,n.content[i.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(pe(this,pa,"f")!==void 0){const i=e.data.content[pe(this,pa,"f")];if(i)switch(i.type){case"image_file":this._emit("imageFileDone",i.image_file,pe(this,pr,"f"));break;case"text":this._emit("textDone",i.text,pe(this,pr,"f"));break}}pe(this,pr,"f")&&this._emit("messageDone",e.data),$n(this,pr,void 0,"f")}},kv=function(e){const n=pe(this,Xt,"m",Nv).call(this,e);switch($n(this,Fu,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const s of r.step_details.tool_calls)s.index==pe(this,Mh,"f")?this._emit("toolCallDelta",s,n.step_details.tool_calls[s.index]):(pe(this,Gn,"f")&&this._emit("toolCallDone",pe(this,Gn,"f")),$n(this,Mh,s.index,"f"),$n(this,Gn,n.step_details.tool_calls[s.index],"f"),pe(this,Gn,"f")&&this._emit("toolCallCreated",pe(this,Gn,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":$n(this,Fu,void 0,"f"),e.data.step_details.type=="tool_calls"&&pe(this,Gn,"f")&&(this._emit("toolCallDone",pe(this,Gn,"f")),$n(this,Gn,void 0,"f")),this._emit("runStepDone",e.data,n);break}},Sv=function(e){pe(this,J0,"f").push(e),this._emit("event",e)},Nv=function(e){switch(e.event){case"thread.run.step.created":return pe(this,Br,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=pe(this,Br,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const i=Er.accumulateDelta(n,r.delta);pe(this,Br,"f")[e.data.id]=i}return pe(this,Br,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":pe(this,Br,"f")[e.data.id]=e.data;break}if(pe(this,Br,"f")[e.data.id])return pe(this,Br,"f")[e.data.id];throw new Error("No snapshot available")},Fv=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(const s of i.delta.content)if(s.index in n.content){let a=n.content[s.index];n.content[s.index]=pe(this,Xt,"m",Rv).call(this,s,a)}else n.content[s.index]=s,r.push(s);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Rv=function(e,n){return Er.accumulateDelta(n,e)},Mv=function(e){switch($n(this,Bc,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":$n(this,bs,e.data,"f"),pe(this,Gn,"f")&&(this._emit("toolCallDone",pe(this,Gn,"f")),$n(this,Gn,void 0,"f"));break}};class Gm extends Pe{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,i){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n={},r){return Gt(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,zm,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class zm extends Rn{}Gm.MessagesPage=zm;class Wm extends Pe{retrieve(e,n,r,i={},s){return Gt(i)?this.retrieve(e,n,r,{},i):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:i,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n,r={},i){return Gt(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,Hm,{query:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}}class Hm extends Rn{}Wm.RunStepsPage=Hm;class gl extends Pe{constructor(){super(...arguments),this.steps=new Wm(this._client)}create(e,n,r){const{include:i,...s}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:i},body:s,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,i){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n={},r){return Gt(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,Ym,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const i=await this.create(e,n,r);return await this.poll(e,i.id,r)}createAndStream(e,n,r){return Er.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const i={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:s,response:a}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...i}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const u=a.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await fl(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,n,r){return Er.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,i){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,i){const s=await this.submitToolOutputs(e,n,r,i);return await this.poll(e,s.id,i)}submitToolOutputsStream(e,n,r,i){return Er.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,i)}}class Ym extends Rn{}gl.RunsPage=Ym;gl.Steps=Wm;gl.RunStepsPage=Hm;class Qa extends Pe{constructor(){super(...arguments),this.runs=new gl(this._client),this.messages=new Gm(this._client)}create(e={},n){return Gt(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return Er.createThreadAssistantStream(e,this._client.beta.threads,n)}}Qa.Runs=gl;Qa.RunsPage=Ym;Qa.Messages=Gm;Qa.MessagesPage=zm;class eo extends Pe{constructor(){super(...arguments),this.realtime=new Um(this._client),this.chat=new K0(this._client),this.assistants=new Im(this._client),this.threads=new Qa(this._client)}}eo.Realtime=Um;eo.Assistants=Im;eo.AssistantsPage=Lm;eo.Threads=Qa;class v_ extends Pe{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class b_ extends Pe{create(e,n){return this._client.post("/embeddings",{body:e,...n})}}let Vm=class extends Pe{create(e,n){return this._client.post("/files",Ba({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return Gt(e)?this.list({},e):this._client.getAPIList("/files",qm,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const i=new Set(["processed","error","deleted"]),s=Date.now();let a=await this.retrieve(e);for(;!a.status||!i.has(a.status);)if(await fl(n),a=await this.retrieve(e),Date.now()-s>r)throw new Fm({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return a}};class qm extends Rn{}Vm.FileObjectsPage=qm;class Xm extends Pe{list(e,n={},r){return Gt(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,jm,{query:n,...r})}}class jm extends Rn{}Xm.FineTuningJobCheckpointsPage=jm;class to extends Pe{constructor(){super(...arguments),this.checkpoints=new Xm(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return Gt(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Km,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return Gt(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Jm,{query:n,...r})}}class Km extends Rn{}class Jm extends Rn{}to.FineTuningJobsPage=Km;to.FineTuningJobEventsPage=Jm;to.Checkpoints=Xm;to.FineTuningJobCheckpointsPage=jm;class ml extends Pe{constructor(){super(...arguments),this.jobs=new to(this._client)}}ml.Jobs=to;ml.FineTuningJobsPage=Km;ml.FineTuningJobEventsPage=Jm;class x_ extends Pe{createVariation(e,n){return this._client.post("/images/variations",Ba({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Ba({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class Zm extends Pe{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",Qm,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class Qm extends Rm{}Zm.ModelsPage=Qm;class E_ extends Pe{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function mM(t,e){return!e||!vM(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:D_(t,e)}function D_(t,e){const n=t.output.map(i=>{if(i.type==="function_call")return{...i,parsed_arguments:EM(e,i)};if(i.type==="message"){const s=i.content.map(a=>a.type==="output_text"?{...a,parsed:yM(e,a.text)}:a);return{...i,content:s}}return i}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||w_(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const i of r.output)if(i.type==="message"){for(const s of i.content)if(s.type==="output_text"&&s.parsed!==null)return s.parsed}return null}}),r}function yM(t,e){var n,r,i,s;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((i=t.text)==null?void 0:i.format)?((s=t.text)==null?void 0:s.format).$parseRaw(e):JSON.parse(e)}function vM(t){var e;return!!$m((e=t.text)==null?void 0:e.format)}function bM(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function xM(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function EM(t,e){const n=xM(t.tools??[],e.name);return{...e,...e,parsed_arguments:bM(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function w_(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}class __ extends Pe{list(e,n={},r){return Gt(n)?this.list(e,{},n):this._client.getAPIList(`/responses/${e}/input_items`,wM,{query:n,...r})}}var ra=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},Fi=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ia,Xl,Ri,jl,Ov,Iv,Lv,Pv;class e1 extends Pm{constructor(e){super(),ia.add(this),Xl.set(this,void 0),Ri.set(this,void 0),jl.set(this,void 0),ra(this,Xl,e,"f")}static createResponse(e,n,r){const i=new e1(n);return i._run(()=>i._createResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createResponse(e,n,r){var a;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Fi(this,ia,"m",Ov).call(this);const s=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of s)Fi(this,ia,"m",Iv).call(this,o);if((a=s.controller.signal)!=null&&a.aborted)throw new ar;return Fi(this,ia,"m",Lv).call(this)}[(Xl=new WeakMap,Ri=new WeakMap,jl=new WeakMap,ia=new WeakSet,Ov=function(){this.ended||ra(this,Ri,void 0,"f")},Iv=function(n){if(this.ended)return;const r=Fi(this,ia,"m",Pv).call(this,n);switch(this._emit("event",n),n.type){case"response.output_text.delta":{const i=r.output[n.output_index];if(!i)throw new xe(`missing output at index ${n.output_index}`);if(i.type==="message"){const s=i.content[n.content_index];if(!s)throw new xe(`missing content at index ${n.content_index}`);if(s.type!=="output_text")throw new xe(`expected content to be 'output_text', got ${s.type}`);this._emit("response.output_text.delta",{...n,snapshot:s.text})}break}case"response.function_call_arguments.delta":{const i=r.output[n.output_index];if(!i)throw new xe(`missing output at index ${n.output_index}`);i.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...n,snapshot:i.arguments});break}default:this._emit(n.type,n);break}},Lv=function(){if(this.ended)throw new xe("stream has ended, this shouldn't happen");const n=Fi(this,Ri,"f");if(!n)throw new xe("request ended without sending any events");ra(this,Ri,void 0,"f");const r=DM(n,Fi(this,Xl,"f"));return ra(this,jl,r,"f"),r},Pv=function(n){let r=Fi(this,Ri,"f");if(!r){if(n.type!=="response.created")throw new xe(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=ra(this,Ri,n.response,"f"),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const i=r.output[n.output_index];if(!i)throw new xe(`missing output at index ${n.output_index}`);i.type==="message"&&i.content.push(n.part);break}case"response.output_text.delta":{const i=r.output[n.output_index];if(!i)throw new xe(`missing output at index ${n.output_index}`);if(i.type==="message"){const s=i.content[n.content_index];if(!s)throw new xe(`missing content at index ${n.content_index}`);if(s.type!=="output_text")throw new xe(`expected content to be 'output_text', got ${s.type}`);s.text+=n.delta}break}case"response.function_call_arguments.delta":{const i=r.output[n.output_index];if(!i)throw new xe(`missing output at index ${n.output_index}`);i.type==="function_call"&&(i.arguments+=n.delta);break}case"response.completed":{ra(this,Ri,n.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",i=>{const s=n.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of n)i.resolve(void 0);n.length=0}),this.on("abort",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),this.on("error",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,a)=>n.push({resolve:s,reject:a})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Fi(this,jl,"f");if(!e)throw new xe("stream ended without producing a ChatCompletion");return e}}function DM(t,e){return mM(t,e)}class t1 extends Pe{constructor(){super(...arguments),this.inputItems=new __(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&w_(r),r))}retrieve(e,n={},r){return Gt(n)?this.retrieve(e,{},n):this._client.get(`/responses/${e}`,{query:n,...r})}del(e,n){return this._client.delete(`/responses/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>D_(r,e))}stream(e,n){return e1.createResponse(this._client,e,n)}}class wM extends Rn{}t1.InputItems=__;class C_ extends Pe{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,Ba({body:n,...r}))}}class n1 extends Pe{constructor(){super(...arguments),this.parts=new C_(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}n1.Parts=C_;const _M=async t=>{const e=await Promise.allSettled(t),n=e.filter(i=>i.status==="rejected");if(n.length){for(const i of n)console.error(i.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const i of e)i.status==="fulfilled"&&r.push(i.value);return r};class ed extends Pe{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,i){return this._client.post(`/vector_stores/${e}/files/${n}`,{body:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n={},r){return Gt(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,td,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const i=await this.create(e,n,r);return await this.poll(e,i.id,r)}async poll(e,n,r){const i={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const s=await this.retrieve(e,n,{...r,headers:i}).withResponse(),a=s.data;switch(a.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const u=s.response.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await fl(o);break;case"failed":case"completed":return a}}}async upload(e,n,r){const i=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:i.id},r)}async uploadAndPoll(e,n,r){const i=await this.upload(e,n,r);return await this.poll(e,i.id,r)}content(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/files/${n}/content`,r1,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class td extends Rn{}class r1 extends Rm{}ed.VectorStoreFilesPage=td;ed.FileContentResponsesPage=r1;class A_ extends Pe{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const i=await this.create(e,n);return await this.poll(e,i.id,r)}listFiles(e,n,r={},i){return Gt(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,td,{query:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}async poll(e,n,r){const i={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:s,response:a}=await this.retrieve(e,n,{...r,headers:i}).withResponse();switch(s.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const u=a.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await fl(o);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},i){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=(i==null?void 0:i.maxConcurrency)??5,a=Math.min(s,n.length),o=this._client,u=n.values(),l=[...r];async function c(d){for(let f of d){const p=await o.files.create({file:f,purpose:"assistants"},i);l.push(p.id)}}const h=Array(a).fill(u).map(c);return await _M(h),await this.createAndPoll(e,{file_ids:l})}}class ts extends Pe{constructor(){super(...arguments),this.files=new ed(this._client),this.fileBatches=new A_(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return Gt(e)?this.list({},e):this._client.getAPIList("/vector_stores",i1,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}search(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/search`,s1,{body:n,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class i1 extends Rn{}class s1 extends Rm{}ts.VectorStoresPage=i1;ts.VectorStoreSearchResponsesPage=s1;ts.Files=ed;ts.VectorStoreFilesPage=td;ts.FileContentResponsesPage=r1;ts.FileBatches=A_;var T_;class Se extends YR{constructor({baseURL:e=Wl("OPENAI_BASE_URL"),apiKey:n=Wl("OPENAI_API_KEY"),organization:r=Wl("OPENAI_ORG_ID")??null,project:i=Wl("OPENAI_PROJECT_ID")??null,...s}={}){if(n===void 0)throw new xe("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:n,organization:r,project:i,...s,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&nM())throw new xe(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new v_(this),this.chat=new Qf(this),this.embeddings=new b_(this),this.files=new Vm(this),this.images=new x_(this),this.audio=new dl(this),this.moderations=new E_(this),this.models=new Zm(this),this.fineTuning=new ml(this),this.vectorStores=new ts(this),this.beta=new eo(this),this.batches=new Mm(this),this.uploads=new n1(this),this.responses=new t1(this),this._options=a,this.apiKey=n,this.organization=r,this.project=i}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return TR(e,{arrayFormat:"brackets"})}}T_=Se;Se.OpenAI=T_;Se.DEFAULT_TIMEOUT=6e5;Se.OpenAIError=xe;Se.APIError=nn;Se.APIConnectionError=qf;Se.APIConnectionTimeoutError=Fm;Se.APIUserAbortError=ar;Se.NotFoundError=Fw;Se.ConflictError=Rw;Se.RateLimitError=Ow;Se.BadRequestError=kw;Se.AuthenticationError=Sw;Se.InternalServerError=Iw;Se.PermissionDeniedError=Nw;Se.UnprocessableEntityError=Mw;Se.toFile=Gw;Se.fileFromPath=Aw;Se.Completions=v_;Se.Chat=Qf;Se.ChatCompletionsPage=Zf;Se.Embeddings=b_;Se.Files=Vm;Se.FileObjectsPage=qm;Se.Images=x_;Se.Audio=dl;Se.Moderations=E_;Se.Models=Zm;Se.ModelsPage=Qm;Se.FineTuning=ml;Se.VectorStores=ts;Se.VectorStoresPage=i1;Se.VectorStoreSearchResponsesPage=s1;Se.Beta=eo;Se.Batches=Mm;Se.BatchesPage=Om;Se.Uploads=n1;Se.Responses=t1;const $v={};function CM(t){let e=$v[t];if(e)return e;e=$v[t]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);e.push(r)}for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}function Ua(t,e){typeof e!="string"&&(e=Ua.defaultChars);const n=CM(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(r){let i="";for(let s=0,a=r.length;s<a;s+=3){const o=parseInt(r.slice(s+1,s+3),16);if(o<128){i+=n[o];continue}if((o&224)===192&&s+3<a){const u=parseInt(r.slice(s+4,s+6),16);if((u&192)===128){const l=o<<6&1984|u&63;l<128?i+="":i+=String.fromCharCode(l),s+=3;continue}}if((o&240)===224&&s+6<a){const u=parseInt(r.slice(s+4,s+6),16),l=parseInt(r.slice(s+7,s+9),16);if((u&192)===128&&(l&192)===128){const c=o<<12&61440|u<<6&4032|l&63;c<2048||c>=55296&&c<=57343?i+="":i+=String.fromCharCode(c),s+=6;continue}}if((o&248)===240&&s+9<a){const u=parseInt(r.slice(s+4,s+6),16),l=parseInt(r.slice(s+7,s+9),16),c=parseInt(r.slice(s+10,s+12),16);if((u&192)===128&&(l&192)===128&&(c&192)===128){let h=o<<18&1835008|u<<12&258048|l<<6&4032|c&63;h<65536||h>1114111?i+="":(h-=65536,i+=String.fromCharCode(55296+(h>>10),56320+(h&1023))),s+=9;continue}}i+=""}return i})}Ua.defaultChars=";/?:@&=+$,#";Ua.componentChars="";const Bv={};function AM(t){let e=Bv[t];if(e)return e;e=Bv[t]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?e.push(r):e.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<t.length;n++)e[t.charCodeAt(n)]=t[n];return e}function yl(t,e,n){typeof e!="string"&&(n=e,e=yl.defaultChars),typeof n>"u"&&(n=!0);const r=AM(e);let i="";for(let s=0,a=t.length;s<a;s++){const o=t.charCodeAt(s);if(n&&o===37&&s+2<a&&/^[0-9a-f]{2}$/i.test(t.slice(s+1,s+3))){i+=t.slice(s,s+3),s+=2;continue}if(o<128){i+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&s+1<a){const u=t.charCodeAt(s+1);if(u>=56320&&u<=57343){i+=encodeURIComponent(t[s]+t[s+1]),s++;continue}}i+="%EF%BF%BD";continue}i+=encodeURIComponent(t[s])}return i}yl.defaultChars=";/?:@&=+$,-_.!~*'()#";yl.componentChars="-_.!~*'()";function a1(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&t.hostname.indexOf(":")!==-1?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function Oh(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const TM=/^([a-z0-9.+-]+:)/i,kM=/:[0-9]*$/,SM=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,NM=["<",">",'"',"`"," ","\r",`
`,"	"],FM=["{","}","|","\\","^","`"].concat(NM),RM=["'"].concat(FM),Uv=["%","/","?",";","#"].concat(RM),Gv=["/","?","#"],MM=255,zv=/^[+a-z0-9A-Z_-]{0,63}$/,OM=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Wv={javascript:!0,"javascript:":!0},Hv={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function o1(t,e){if(t&&t instanceof Oh)return t;const n=new Oh;return n.parse(t,e),n}Oh.prototype.parse=function(t,e){let n,r,i,s=t;if(s=s.trim(),!e&&t.split("#").length===1){const l=SM.exec(s);if(l)return this.pathname=l[1],l[2]&&(this.search=l[2]),this}let a=TM.exec(s);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,s=s.substr(a.length)),(e||a||s.match(/^\/\/[^@\/]+@[^@\/]+/))&&(i=s.substr(0,2)==="//",i&&!(a&&Wv[a])&&(s=s.substr(2),this.slashes=!0)),!Wv[a]&&(i||a&&!Hv[a])){let l=-1;for(let p=0;p<Gv.length;p++)r=s.indexOf(Gv[p]),r!==-1&&(l===-1||r<l)&&(l=r);let c,h;l===-1?h=s.lastIndexOf("@"):h=s.lastIndexOf("@",l),h!==-1&&(c=s.slice(0,h),s=s.slice(h+1),this.auth=c),l=-1;for(let p=0;p<Uv.length;p++)r=s.indexOf(Uv[p]),r!==-1&&(l===-1||r<l)&&(l=r);l===-1&&(l=s.length),s[l-1]===":"&&l--;const d=s.slice(0,l);s=s.slice(l),this.parseHost(d),this.hostname=this.hostname||"";const f=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!f){const p=this.hostname.split(/\./);for(let g=0,m=p.length;g<m;g++){const y=p[g];if(y&&!y.match(zv)){let b="";for(let v=0,E=y.length;v<E;v++)y.charCodeAt(v)>127?b+="x":b+=y[v];if(!b.match(zv)){const v=p.slice(0,g),E=p.slice(g+1),w=y.match(OM);w&&(v.push(w[1]),E.unshift(w[2])),E.length&&(s=E.join(".")+s),this.hostname=v.join(".");break}}}}this.hostname.length>MM&&(this.hostname=""),f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=s.indexOf("#");o!==-1&&(this.hash=s.substr(o),s=s.slice(0,o));const u=s.indexOf("?");return u!==-1&&(this.search=s.substr(u),s=s.slice(0,u)),s&&(this.pathname=s),Hv[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};Oh.prototype.parseHost=function(t){let e=kM.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const IM=Object.freeze(Object.defineProperty({__proto__:null,decode:Ua,encode:yl,format:a1,parse:o1},Symbol.toStringTag,{value:"Module"})),k_=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,S_=/[\0-\x1F\x7F-\x9F]/,LM=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,u1=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,N_=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,F_=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,PM=Object.freeze(Object.defineProperty({__proto__:null,Any:k_,Cc:S_,Cf:LM,P:u1,S:N_,Z:F_},Symbol.toStringTag,{value:"Module"})),$M=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),BM=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var lp;const UM=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),GM=(lp=String.fromCodePoint)!==null&&lp!==void 0?lp:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function zM(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=UM.get(t))!==null&&e!==void 0?e:t}var $t;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})($t||($t={}));const WM=32;var Gi;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(Gi||(Gi={}));function Z0(t){return t>=$t.ZERO&&t<=$t.NINE}function HM(t){return t>=$t.UPPER_A&&t<=$t.UPPER_F||t>=$t.LOWER_A&&t<=$t.LOWER_F}function YM(t){return t>=$t.UPPER_A&&t<=$t.UPPER_Z||t>=$t.LOWER_A&&t<=$t.LOWER_Z||Z0(t)}function VM(t){return t===$t.EQUALS||YM(t)}var It;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(It||(It={}));var Li;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(Li||(Li={}));class qM{constructor(e,n,r){this.decodeTree=e,this.emitCodePoint=n,this.errors=r,this.state=It.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Li.Strict}startEntity(e){this.decodeMode=e,this.state=It.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case It.EntityStart:return e.charCodeAt(n)===$t.NUM?(this.state=It.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=It.NamedEntity,this.stateNamedEntity(e,n));case It.NumericStart:return this.stateNumericStart(e,n);case It.NumericDecimal:return this.stateNumericDecimal(e,n);case It.NumericHex:return this.stateNumericHex(e,n);case It.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|WM)===$t.LOWER_X?(this.state=It.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=It.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,r,i){if(n!==r){const s=r-n;this.result=this.result*Math.pow(i,s)+parseInt(e.substr(n,s),i),this.consumed+=s}}stateNumericHex(e,n){const r=n;for(;n<e.length;){const i=e.charCodeAt(n);if(Z0(i)||HM(i))n+=1;else return this.addToNumericResult(e,r,n,16),this.emitNumericEntity(i,3)}return this.addToNumericResult(e,r,n,16),-1}stateNumericDecimal(e,n){const r=n;for(;n<e.length;){const i=e.charCodeAt(n);if(Z0(i))n+=1;else return this.addToNumericResult(e,r,n,10),this.emitNumericEntity(i,2)}return this.addToNumericResult(e,r,n,10),-1}emitNumericEntity(e,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===$t.SEMI)this.consumed+=1;else if(this.decodeMode===Li.Strict)return 0;return this.emitCodePoint(zM(this.result),this.consumed),this.errors&&(e!==$t.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:r}=this;let i=r[this.treeIndex],s=(i&Gi.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const a=e.charCodeAt(n);if(this.treeIndex=XM(r,i,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return this.result===0||this.decodeMode===Li.Attribute&&(s===0||VM(a))?0:this.emitNotTerminatedNamedEntity();if(i=r[this.treeIndex],s=(i&Gi.VALUE_LENGTH)>>14,s!==0){if(a===$t.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==Li.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:r}=this,i=(r[n]&Gi.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,i,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,r){const{decodeTree:i}=this;return this.emitCodePoint(n===1?i[e]&~Gi.VALUE_LENGTH:i[e+1],r),n===3&&this.emitCodePoint(i[e+2],r),r}end(){var e;switch(this.state){case It.NamedEntity:return this.result!==0&&(this.decodeMode!==Li.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case It.NumericDecimal:return this.emitNumericEntity(0,2);case It.NumericHex:return this.emitNumericEntity(0,3);case It.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case It.EntityStart:return 0}}}function R_(t){let e="";const n=new qM(t,r=>e+=GM(r));return function(i,s){let a=0,o=0;for(;(o=i.indexOf("&",o))>=0;){e+=i.slice(a,o),n.startEntity(s);const l=n.write(i,o+1);if(l<0){a=o+n.end();break}a=o+l,o=l===0?a+1:a}const u=e+i.slice(a);return e="",u}}function XM(t,e,n,r){const i=(e&Gi.BRANCH_LENGTH)>>7,s=e&Gi.JUMP_TABLE;if(i===0)return s!==0&&r===s?n:-1;if(s){const u=r-s;return u<0||u>=i?-1:t[n+u]-1}let a=n,o=a+i-1;for(;a<=o;){const u=a+o>>>1,l=t[u];if(l<r)a=u+1;else if(l>r)o=u-1;else return t[u+i]}return-1}const jM=R_($M);R_(BM);function M_(t,e=Li.Legacy){return jM(t,e)}function KM(t){return Object.prototype.toString.call(t)}function l1(t){return KM(t)==="[object String]"}const JM=Object.prototype.hasOwnProperty;function ZM(t,e){return JM.call(t,e)}function nd(t){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){t[r]=n[r]})}}),t}function O_(t,e,n){return[].concat(t.slice(0,e),n,t.slice(e+1))}function c1(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function Ih(t){if(t>65535){t-=65536;const e=55296+(t>>10),n=56320+(t&1023);return String.fromCharCode(e,n)}return String.fromCharCode(t)}const I_=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,QM=/&([a-z#][a-z0-9]{1,31});/gi,eO=new RegExp(I_.source+"|"+QM.source,"gi"),tO=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function nO(t,e){if(e.charCodeAt(0)===35&&tO.test(e)){const r=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return c1(r)?Ih(r):t}const n=M_(t);return n!==t?n:t}function rO(t){return t.indexOf("\\")<0?t:t.replace(I_,"$1")}function Ga(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(eO,function(e,n,r){return n||nO(e,r)})}const iO=/[&<>"]/,sO=/[&<>"]/g,aO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function oO(t){return aO[t]}function Yi(t){return iO.test(t)?t.replace(sO,oO):t}const uO=/[.?*+^$[\]\\(){}|-]/g;function lO(t){return t.replace(uO,"\\$&")}function it(t){switch(t){case 9:case 32:return!0}return!1}function qu(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Xu(t){return u1.test(t)||N_.test(t)}function ju(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function rd(t){return t=t.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(t=t.replace(//g,"")),t.toLowerCase().toUpperCase()}const cO={mdurl:IM,ucmicro:PM},hO=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:O_,assign:nd,escapeHtml:Yi,escapeRE:lO,fromCodePoint:Ih,has:ZM,isMdAsciiPunct:ju,isPunctChar:Xu,isSpace:it,isString:l1,isValidEntityCode:c1,isWhiteSpace:qu,lib:cO,normalizeReference:rd,unescapeAll:Ga,unescapeMd:rO},Symbol.toStringTag,{value:"Module"}));function fO(t,e,n){let r,i,s,a;const o=t.posMax,u=t.pos;for(t.pos=e+1,r=1;t.pos<o;){if(s=t.src.charCodeAt(t.pos),s===93&&(r--,r===0)){i=!0;break}if(a=t.pos,t.md.inline.skipToken(t),s===91){if(a===t.pos-1)r++;else if(n)return t.pos=u,-1}}let l=-1;return i&&(l=t.pos),t.pos=u,l}function dO(t,e,n){let r,i=e;const s={ok:!1,pos:0,str:""};if(t.charCodeAt(i)===60){for(i++;i<n;){if(r=t.charCodeAt(i),r===10||r===60)return s;if(r===62)return s.pos=i+1,s.str=Ga(t.slice(e+1,i)),s.ok=!0,s;if(r===92&&i+1<n){i+=2;continue}i++}return s}let a=0;for(;i<n&&(r=t.charCodeAt(i),!(r===32||r<32||r===127));){if(r===92&&i+1<n){if(t.charCodeAt(i+1)===32)break;i+=2;continue}if(r===40&&(a++,a>32))return s;if(r===41){if(a===0)break;a--}i++}return e===i||a!==0||(s.str=Ga(t.slice(e,i)),s.pos=i,s.ok=!0),s}function pO(t,e,n,r){let i,s=e;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(s>=n)return a;let o=t.charCodeAt(s);if(o!==34&&o!==39&&o!==40)return a;e++,s++,o===40&&(o=41),a.marker=o}for(;s<n;){if(i=t.charCodeAt(s),i===a.marker)return a.pos=s+1,a.str+=Ga(t.slice(e,s)),a.ok=!0,a;if(i===40&&a.marker===41)return a;i===92&&s+1<n&&s++,s++}return a.can_continue=!0,a.str+=Ga(t.slice(e,s)),a}const gO=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:dO,parseLinkLabel:fO,parseLinkTitle:pO},Symbol.toStringTag,{value:"Module"})),Qr={};Qr.code_inline=function(t,e,n,r,i){const s=t[e];return"<code"+i.renderAttrs(s)+">"+Yi(s.content)+"</code>"};Qr.code_block=function(t,e,n,r,i){const s=t[e];return"<pre"+i.renderAttrs(s)+"><code>"+Yi(t[e].content)+`</code></pre>
`};Qr.fence=function(t,e,n,r,i){const s=t[e],a=s.info?Ga(s.info).trim():"";let o="",u="";if(a){const c=a.split(/(\s+)/g);o=c[0],u=c.slice(2).join("")}let l;if(n.highlight?l=n.highlight(s.content,o,u)||Yi(s.content):l=Yi(s.content),l.indexOf("<pre")===0)return l+`
`;if(a){const c=s.attrIndex("class"),h=s.attrs?s.attrs.slice():[];c<0?h.push(["class",n.langPrefix+o]):(h[c]=h[c].slice(),h[c][1]+=" "+n.langPrefix+o);const d={attrs:h};return`<pre><code${i.renderAttrs(d)}>${l}</code></pre>
`}return`<pre><code${i.renderAttrs(s)}>${l}</code></pre>
`};Qr.image=function(t,e,n,r,i){const s=t[e];return s.attrs[s.attrIndex("alt")][1]=i.renderInlineAsText(s.children,n,r),i.renderToken(t,e,n)};Qr.hardbreak=function(t,e,n){return n.xhtmlOut?`<br />
`:`<br>
`};Qr.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Qr.text=function(t,e){return Yi(t[e].content)};Qr.html_block=function(t,e){return t[e].content};Qr.html_inline=function(t,e){return t[e].content};function no(){this.rules=nd({},Qr)}no.prototype.renderAttrs=function(e){let n,r,i;if(!e.attrs)return"";for(i="",n=0,r=e.attrs.length;n<r;n++)i+=" "+Yi(e.attrs[n][0])+'="'+Yi(e.attrs[n][1])+'"';return i};no.prototype.renderToken=function(e,n,r){const i=e[n];let s="";if(i.hidden)return"";i.block&&i.nesting!==-1&&n&&e[n-1].hidden&&(s+=`
`),s+=(i.nesting===-1?"</":"<")+i.tag,s+=this.renderAttrs(i),i.nesting===0&&r.xhtmlOut&&(s+=" /");let a=!1;if(i.block&&(a=!0,i.nesting===1&&n+1<e.length)){const o=e[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===i.tag)&&(a=!1)}return s+=a?`>
`:">",s};no.prototype.renderInline=function(t,e,n){let r="";const i=this.rules;for(let s=0,a=t.length;s<a;s++){const o=t[s].type;typeof i[o]<"u"?r+=i[o](t,s,e,n,this):r+=this.renderToken(t,s,e)}return r};no.prototype.renderInlineAsText=function(t,e,n){let r="";for(let i=0,s=t.length;i<s;i++)switch(t[i].type){case"text":r+=t[i].content;break;case"image":r+=this.renderInlineAsText(t[i].children,e,n);break;case"html_inline":case"html_block":r+=t[i].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};no.prototype.render=function(t,e,n){let r="";const i=this.rules;for(let s=0,a=t.length;s<a;s++){const o=t[s].type;o==="inline"?r+=this.renderInline(t[s].children,e,n):typeof i[o]<"u"?r+=i[o](t,s,e,n,this):r+=this.renderToken(t,s,e,n)}return r};function Nn(){this.__rules__=[],this.__cache__=null}Nn.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1};Nn.prototype.__compile__=function(){const t=this,e=[""];t.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),t.__cache__={},e.forEach(function(n){t.__cache__[n]=[],t.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||t.__cache__[n].push(r.fn))})})};Nn.prototype.at=function(t,e,n){const r=this.__find__(t),i=n||{};if(r===-1)throw new Error("Parser rule not found: "+t);this.__rules__[r].fn=e,this.__rules__[r].alt=i.alt||[],this.__cache__=null};Nn.prototype.before=function(t,e,n,r){const i=this.__find__(t),s=r||{};if(i===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(i,0,{name:e,enabled:!0,fn:n,alt:s.alt||[]}),this.__cache__=null};Nn.prototype.after=function(t,e,n,r){const i=this.__find__(t),s=r||{};if(i===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(i+1,0,{name:e,enabled:!0,fn:n,alt:s.alt||[]}),this.__cache__=null};Nn.prototype.push=function(t,e,n){const r=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};Nn.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(r){const i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!0,n.push(r)},this),this.__cache__=null,n};Nn.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(t,e)};Nn.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);const n=[];return t.forEach(function(r){const i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!1,n.push(r)},this),this.__cache__=null,n};Nn.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};function Sr(t,e,n){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Sr.prototype.attrIndex=function(e){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,i=n.length;r<i;r++)if(n[r][0]===e)return r;return-1};Sr.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};Sr.prototype.attrSet=function(e,n){const r=this.attrIndex(e),i=[e,n];r<0?this.attrPush(i):this.attrs[r]=i};Sr.prototype.attrGet=function(e){const n=this.attrIndex(e);let r=null;return n>=0&&(r=this.attrs[n][1]),r};Sr.prototype.attrJoin=function(e,n){const r=this.attrIndex(e);r<0?this.attrPush([e,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function L_(t,e,n){this.src=t,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=e}L_.prototype.Token=Sr;const mO=/\r\n?|\n/g,yO=/\0/g;function vO(t){let e;e=t.src.replace(mO,`
`),e=e.replace(yO,""),t.src=e}function bO(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}function xO(t){const e=t.tokens;for(let n=0,r=e.length;n<r;n++){const i=e[n];i.type==="inline"&&t.md.inline.parse(i.content,t.md,t.env,i.children)}}function EO(t){return/^<a[>\s]/i.test(t)}function DO(t){return/^<\/a\s*>/i.test(t)}function wO(t){const e=t.tokens;if(t.md.options.linkify)for(let n=0,r=e.length;n<r;n++){if(e[n].type!=="inline"||!t.md.linkify.pretest(e[n].content))continue;let i=e[n].children,s=0;for(let a=i.length-1;a>=0;a--){const o=i[a];if(o.type==="link_close"){for(a--;i[a].level!==o.level&&i[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(EO(o.content)&&s>0&&s--,DO(o.content)&&s++),!(s>0)&&o.type==="text"&&t.md.linkify.test(o.content)){const u=o.content;let l=t.md.linkify.match(u);const c=[];let h=o.level,d=0;l.length>0&&l[0].index===0&&a>0&&i[a-1].type==="text_special"&&(l=l.slice(1));for(let f=0;f<l.length;f++){const p=l[f].url,g=t.md.normalizeLink(p);if(!t.md.validateLink(g))continue;let m=l[f].text;l[f].schema?l[f].schema==="mailto:"&&!/^mailto:/i.test(m)?m=t.md.normalizeLinkText("mailto:"+m).replace(/^mailto:/,""):m=t.md.normalizeLinkText(m):m=t.md.normalizeLinkText("http://"+m).replace(/^http:\/\//,"");const y=l[f].index;if(y>d){const w=new t.Token("text","",0);w.content=u.slice(d,y),w.level=h,c.push(w)}const b=new t.Token("link_open","a",1);b.attrs=[["href",g]],b.level=h++,b.markup="linkify",b.info="auto",c.push(b);const v=new t.Token("text","",0);v.content=m,v.level=h,c.push(v);const E=new t.Token("link_close","a",-1);E.level=--h,E.markup="linkify",E.info="auto",c.push(E),d=l[f].lastIndex}if(d<u.length){const f=new t.Token("text","",0);f.content=u.slice(d),f.level=h,c.push(f)}e[n].children=i=O_(i,a,c)}}}}const P_=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,_O=/\((c|tm|r)\)/i,CO=/\((c|tm|r)\)/ig,AO={c:"",r:"",tm:""};function TO(t,e){return AO[e.toLowerCase()]}function kO(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];r.type==="text"&&!e&&(r.content=r.content.replace(CO,TO)),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function SO(t){let e=0;for(let n=t.length-1;n>=0;n--){const r=t[n];r.type==="text"&&!e&&P_.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function NO(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)t.tokens[e].type==="inline"&&(_O.test(t.tokens[e].content)&&kO(t.tokens[e].children),P_.test(t.tokens[e].content)&&SO(t.tokens[e].children))}const FO=/['"]/,Yv=/['"]/g,Vv="";function Kl(t,e,n){return t.slice(0,e)+n+t.slice(e+1)}function RO(t,e){let n;const r=[];for(let i=0;i<t.length;i++){const s=t[i],a=t[i].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,s.type!=="text")continue;let o=s.content,u=0,l=o.length;e:for(;u<l;){Yv.lastIndex=u;const c=Yv.exec(o);if(!c)break;let h=!0,d=!0;u=c.index+1;const f=c[0]==="'";let p=32;if(c.index-1>=0)p=o.charCodeAt(c.index-1);else for(n=i-1;n>=0&&!(t[n].type==="softbreak"||t[n].type==="hardbreak");n--)if(t[n].content){p=t[n].content.charCodeAt(t[n].content.length-1);break}let g=32;if(u<l)g=o.charCodeAt(u);else for(n=i+1;n<t.length&&!(t[n].type==="softbreak"||t[n].type==="hardbreak");n++)if(t[n].content){g=t[n].content.charCodeAt(0);break}const m=ju(p)||Xu(String.fromCharCode(p)),y=ju(g)||Xu(String.fromCharCode(g)),b=qu(p),v=qu(g);if(v?h=!1:y&&(b||m||(h=!1)),b?d=!1:m&&(v||y||(d=!1)),g===34&&c[0]==='"'&&p>=48&&p<=57&&(d=h=!1),h&&d&&(h=m,d=y),!h&&!d){f&&(s.content=Kl(s.content,c.index,Vv));continue}if(d)for(n=r.length-1;n>=0;n--){let E=r[n];if(r[n].level<a)break;if(E.single===f&&r[n].level===a){E=r[n];let w,N;f?(w=e.md.options.quotes[2],N=e.md.options.quotes[3]):(w=e.md.options.quotes[0],N=e.md.options.quotes[1]),s.content=Kl(s.content,c.index,N),t[E.token].content=Kl(t[E.token].content,E.pos,w),u+=N.length-1,E.token===i&&(u+=w.length-1),o=s.content,l=o.length,r.length=n;continue e}}h?r.push({token:i,pos:c.index,single:f,level:a}):d&&f&&(s.content=Kl(s.content,c.index,Vv))}}}function MO(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)t.tokens[e].type!=="inline"||!FO.test(t.tokens[e].content)||RO(t.tokens[e].children,t)}function OO(t){let e,n;const r=t.tokens,i=r.length;for(let s=0;s<i;s++){if(r[s].type!=="inline")continue;const a=r[s].children,o=a.length;for(e=0;e<o;e++)a[e].type==="text_special"&&(a[e].type="text");for(e=n=0;e<o;e++)a[e].type==="text"&&e+1<o&&a[e+1].type==="text"?a[e+1].content=a[e].content+a[e+1].content:(e!==n&&(a[n]=a[e]),n++);e!==n&&(a.length=n)}}const cp=[["normalize",vO],["block",bO],["inline",xO],["linkify",wO],["replacements",NO],["smartquotes",MO],["text_join",OO]];function h1(){this.ruler=new Nn;for(let t=0;t<cp.length;t++)this.ruler.push(cp[t][0],cp[t][1])}h1.prototype.process=function(t){const e=this.ruler.getRules("");for(let n=0,r=e.length;n<r;n++)e[n](t)};h1.prototype.State=L_;function ei(t,e,n,r){this.src=t,this.md=e,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const i=this.src;for(let s=0,a=0,o=0,u=0,l=i.length,c=!1;a<l;a++){const h=i.charCodeAt(a);if(!c)if(it(h)){o++,h===9?u+=4-u%4:u++;continue}else c=!0;(h===10||a===l-1)&&(h!==10&&a++,this.bMarks.push(s),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(u),this.bsCount.push(0),c=!1,o=0,u=0,s=a+1)}this.bMarks.push(i.length),this.eMarks.push(i.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}ei.prototype.push=function(t,e,n){const r=new Sr(t,e,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};ei.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};ei.prototype.skipEmptyLines=function(e){for(let n=this.lineMax;e<n&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};ei.prototype.skipSpaces=function(e){for(let n=this.src.length;e<n;e++){const r=this.src.charCodeAt(e);if(!it(r))break}return e};ei.prototype.skipSpacesBack=function(e,n){if(e<=n)return e;for(;e>n;)if(!it(this.src.charCodeAt(--e)))return e+1;return e};ei.prototype.skipChars=function(e,n){for(let r=this.src.length;e<r&&this.src.charCodeAt(e)===n;e++);return e};ei.prototype.skipCharsBack=function(e,n,r){if(e<=r)return e;for(;e>r;)if(n!==this.src.charCodeAt(--e))return e+1;return e};ei.prototype.getLines=function(e,n,r,i){if(e>=n)return"";const s=new Array(n-e);for(let a=0,o=e;o<n;o++,a++){let u=0;const l=this.bMarks[o];let c=l,h;for(o+1<n||i?h=this.eMarks[o]+1:h=this.eMarks[o];c<h&&u<r;){const d=this.src.charCodeAt(c);if(it(d))d===9?u+=4-(u+this.bsCount[o])%4:u++;else if(c-l<this.tShift[o])u++;else break;c++}u>r?s[a]=new Array(u-r+1).join(" ")+this.src.slice(c,h):s[a]=this.src.slice(c,h)}return s.join("")};ei.prototype.Token=Sr;const IO=65536;function hp(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];return t.src.slice(n,r)}function qv(t){const e=[],n=t.length;let r=0,i=t.charCodeAt(r),s=!1,a=0,o="";for(;r<n;)i===124&&(s?(o+=t.substring(a,r-1),a=r):(e.push(o+t.substring(a,r)),o="",a=r+1)),s=i===92,r++,i=t.charCodeAt(r);return e.push(o+t.substring(a)),e}function LO(t,e,n,r){if(e+2>n)return!1;let i=e+1;if(t.sCount[i]<t.blkIndent||t.sCount[i]-t.blkIndent>=4)return!1;let s=t.bMarks[i]+t.tShift[i];if(s>=t.eMarks[i])return!1;const a=t.src.charCodeAt(s++);if(a!==124&&a!==45&&a!==58||s>=t.eMarks[i])return!1;const o=t.src.charCodeAt(s++);if(o!==124&&o!==45&&o!==58&&!it(o)||a===45&&it(o))return!1;for(;s<t.eMarks[i];){const E=t.src.charCodeAt(s);if(E!==124&&E!==45&&E!==58&&!it(E))return!1;s++}let u=hp(t,e+1),l=u.split("|");const c=[];for(let E=0;E<l.length;E++){const w=l[E].trim();if(!w){if(E===0||E===l.length-1)continue;return!1}if(!/^:?-+:?$/.test(w))return!1;w.charCodeAt(w.length-1)===58?c.push(w.charCodeAt(0)===58?"center":"right"):w.charCodeAt(0)===58?c.push("left"):c.push("")}if(u=hp(t,e).trim(),u.indexOf("|")===-1||t.sCount[e]-t.blkIndent>=4)return!1;l=qv(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop();const h=l.length;if(h===0||h!==c.length)return!1;if(r)return!0;const d=t.parentType;t.parentType="table";const f=t.md.block.ruler.getRules("blockquote"),p=t.push("table_open","table",1),g=[e,0];p.map=g;const m=t.push("thead_open","thead",1);m.map=[e,e+1];const y=t.push("tr_open","tr",1);y.map=[e,e+1];for(let E=0;E<l.length;E++){const w=t.push("th_open","th",1);c[E]&&(w.attrs=[["style","text-align:"+c[E]]]);const N=t.push("inline","",0);N.content=l[E].trim(),N.children=[],t.push("th_close","th",-1)}t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let b,v=0;for(i=e+2;i<n&&!(t.sCount[i]<t.blkIndent);i++){let E=!1;for(let N=0,D=f.length;N<D;N++)if(f[N](t,i,n,!0)){E=!0;break}if(E||(u=hp(t,i).trim(),!u)||t.sCount[i]-t.blkIndent>=4||(l=qv(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop(),v+=h-l.length,v>IO))break;if(i===e+2){const N=t.push("tbody_open","tbody",1);N.map=b=[e+2,0]}const w=t.push("tr_open","tr",1);w.map=[i,i+1];for(let N=0;N<h;N++){const D=t.push("td_open","td",1);c[N]&&(D.attrs=[["style","text-align:"+c[N]]]);const k=t.push("inline","",0);k.content=l[N]?l[N].trim():"",k.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return b&&(t.push("tbody_close","tbody",-1),b[1]=i),t.push("table_close","table",-1),g[1]=i,t.parentType=d,t.line=i,!0}function PO(t,e,n){if(t.sCount[e]-t.blkIndent<4)return!1;let r=e+1,i=r;for(;r<n;){if(t.isEmpty(r)){r++;continue}if(t.sCount[r]-t.blkIndent>=4){r++,i=r;continue}break}t.line=i;const s=t.push("code_block","code",0);return s.content=t.getLines(e,i,4+t.blkIndent,!1)+`
`,s.map=[e,t.line],!0}function $O(t,e,n,r){let i=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||i+3>s)return!1;const a=t.src.charCodeAt(i);if(a!==126&&a!==96)return!1;let o=i;i=t.skipChars(i,a);let u=i-o;if(u<3)return!1;const l=t.src.slice(o,i),c=t.src.slice(i,s);if(a===96&&c.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let h=e,d=!1;for(;h++,!(h>=n||(i=o=t.bMarks[h]+t.tShift[h],s=t.eMarks[h],i<s&&t.sCount[h]<t.blkIndent));)if(t.src.charCodeAt(i)===a&&!(t.sCount[h]-t.blkIndent>=4)&&(i=t.skipChars(i,a),!(i-o<u)&&(i=t.skipSpaces(i),!(i<s)))){d=!0;break}u=t.sCount[e],t.line=h+(d?1:0);const f=t.push("fence","code",0);return f.info=c,f.content=t.getLines(e+1,h,u,!0),f.markup=l,f.map=[e,t.line],!0}function BO(t,e,n,r){let i=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];const a=t.lineMax;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(i)!==62)return!1;if(r)return!0;const o=[],u=[],l=[],c=[],h=t.md.block.ruler.getRules("blockquote"),d=t.parentType;t.parentType="blockquote";let f=!1,p;for(p=e;p<n;p++){const v=t.sCount[p]<t.blkIndent;if(i=t.bMarks[p]+t.tShift[p],s=t.eMarks[p],i>=s)break;if(t.src.charCodeAt(i++)===62&&!v){let w=t.sCount[p]+1,N,D;t.src.charCodeAt(i)===32?(i++,w++,D=!1,N=!0):t.src.charCodeAt(i)===9?(N=!0,(t.bsCount[p]+w)%4===3?(i++,w++,D=!1):D=!0):N=!1;let k=w;for(o.push(t.bMarks[p]),t.bMarks[p]=i;i<s;){const F=t.src.charCodeAt(i);if(it(F))F===9?k+=4-(k+t.bsCount[p]+(D?1:0))%4:k++;else break;i++}f=i>=s,u.push(t.bsCount[p]),t.bsCount[p]=t.sCount[p]+1+(N?1:0),l.push(t.sCount[p]),t.sCount[p]=k-w,c.push(t.tShift[p]),t.tShift[p]=i-t.bMarks[p];continue}if(f)break;let E=!1;for(let w=0,N=h.length;w<N;w++)if(h[w](t,p,n,!0)){E=!0;break}if(E){t.lineMax=p,t.blkIndent!==0&&(o.push(t.bMarks[p]),u.push(t.bsCount[p]),c.push(t.tShift[p]),l.push(t.sCount[p]),t.sCount[p]-=t.blkIndent);break}o.push(t.bMarks[p]),u.push(t.bsCount[p]),c.push(t.tShift[p]),l.push(t.sCount[p]),t.sCount[p]=-1}const g=t.blkIndent;t.blkIndent=0;const m=t.push("blockquote_open","blockquote",1);m.markup=">";const y=[e,0];m.map=y,t.md.block.tokenize(t,e,p);const b=t.push("blockquote_close","blockquote",-1);b.markup=">",t.lineMax=a,t.parentType=d,y[1]=t.line;for(let v=0;v<c.length;v++)t.bMarks[v+e]=o[v],t.tShift[v+e]=c[v],t.sCount[v+e]=l[v],t.bsCount[v+e]=u[v];return t.blkIndent=g,!0}function UO(t,e,n,r){const i=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.bMarks[e]+t.tShift[e];const a=t.src.charCodeAt(s++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;s<i;){const l=t.src.charCodeAt(s++);if(l!==a&&!it(l))return!1;l===a&&o++}if(o<3)return!1;if(r)return!0;t.line=e+1;const u=t.push("hr","hr",0);return u.map=[e,t.line],u.markup=Array(o+1).join(String.fromCharCode(a)),!0}function Xv(t,e){const n=t.eMarks[e];let r=t.bMarks[e]+t.tShift[e];const i=t.src.charCodeAt(r++);if(i!==42&&i!==45&&i!==43)return-1;if(r<n){const s=t.src.charCodeAt(r);if(!it(s))return-1}return r}function jv(t,e){const n=t.bMarks[e]+t.tShift[e],r=t.eMarks[e];let i=n;if(i+1>=r)return-1;let s=t.src.charCodeAt(i++);if(s<48||s>57)return-1;for(;;){if(i>=r)return-1;if(s=t.src.charCodeAt(i++),s>=48&&s<=57){if(i-n>=10)return-1;continue}if(s===41||s===46)break;return-1}return i<r&&(s=t.src.charCodeAt(i),!it(s))?-1:i}function GO(t,e){const n=t.level+2;for(let r=e+2,i=t.tokens.length-2;r<i;r++)t.tokens[r].level===n&&t.tokens[r].type==="paragraph_open"&&(t.tokens[r+2].hidden=!0,t.tokens[r].hidden=!0,r+=2)}function zO(t,e,n,r){let i,s,a,o,u=e,l=!0;if(t.sCount[u]-t.blkIndent>=4||t.listIndent>=0&&t.sCount[u]-t.listIndent>=4&&t.sCount[u]<t.blkIndent)return!1;let c=!1;r&&t.parentType==="paragraph"&&t.sCount[u]>=t.blkIndent&&(c=!0);let h,d,f;if((f=jv(t,u))>=0){if(h=!0,a=t.bMarks[u]+t.tShift[u],d=Number(t.src.slice(a,f-1)),c&&d!==1)return!1}else if((f=Xv(t,u))>=0)h=!1;else return!1;if(c&&t.skipSpaces(f)>=t.eMarks[u])return!1;if(r)return!0;const p=t.src.charCodeAt(f-1),g=t.tokens.length;h?(o=t.push("ordered_list_open","ol",1),d!==1&&(o.attrs=[["start",d]])):o=t.push("bullet_list_open","ul",1);const m=[u,0];o.map=m,o.markup=String.fromCharCode(p);let y=!1;const b=t.md.block.ruler.getRules("list"),v=t.parentType;for(t.parentType="list";u<n;){s=f,i=t.eMarks[u];const E=t.sCount[u]+f-(t.bMarks[u]+t.tShift[u]);let w=E;for(;s<i;){const _=t.src.charCodeAt(s);if(_===9)w+=4-(w+t.bsCount[u])%4;else if(_===32)w++;else break;s++}const N=s;let D;N>=i?D=1:D=w-E,D>4&&(D=1);const k=E+D;o=t.push("list_item_open","li",1),o.markup=String.fromCharCode(p);const F=[u,0];o.map=F,h&&(o.info=t.src.slice(a,f-1));const M=t.tight,S=t.tShift[u],R=t.sCount[u],I=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=k,t.tight=!0,t.tShift[u]=N-t.bMarks[u],t.sCount[u]=w,N>=i&&t.isEmpty(u+1)?t.line=Math.min(t.line+2,n):t.md.block.tokenize(t,u,n,!0),(!t.tight||y)&&(l=!1),y=t.line-u>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=I,t.tShift[u]=S,t.sCount[u]=R,t.tight=M,o=t.push("list_item_close","li",-1),o.markup=String.fromCharCode(p),u=t.line,F[1]=u,u>=n||t.sCount[u]<t.blkIndent||t.sCount[u]-t.blkIndent>=4)break;let x=!1;for(let _=0,C=b.length;_<C;_++)if(b[_](t,u,n,!0)){x=!0;break}if(x)break;if(h){if(f=jv(t,u),f<0)break;a=t.bMarks[u]+t.tShift[u]}else if(f=Xv(t,u),f<0)break;if(p!==t.src.charCodeAt(f-1))break}return h?o=t.push("ordered_list_close","ol",-1):o=t.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(p),m[1]=u,t.line=u,t.parentType=v,l&&GO(t,g),!0}function WO(t,e,n,r){let i=t.bMarks[e]+t.tShift[e],s=t.eMarks[e],a=e+1;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(i)!==91)return!1;function o(b){const v=t.lineMax;if(b>=v||t.isEmpty(b))return null;let E=!1;if(t.sCount[b]-t.blkIndent>3&&(E=!0),t.sCount[b]<0&&(E=!0),!E){const D=t.md.block.ruler.getRules("reference"),k=t.parentType;t.parentType="reference";let F=!1;for(let M=0,S=D.length;M<S;M++)if(D[M](t,b,v,!0)){F=!0;break}if(t.parentType=k,F)return null}const w=t.bMarks[b]+t.tShift[b],N=t.eMarks[b];return t.src.slice(w,N+1)}let u=t.src.slice(i,s+1);s=u.length;let l=-1;for(i=1;i<s;i++){const b=u.charCodeAt(i);if(b===91)return!1;if(b===93){l=i;break}else if(b===10){const v=o(a);v!==null&&(u+=v,s=u.length,a++)}else if(b===92&&(i++,i<s&&u.charCodeAt(i)===10)){const v=o(a);v!==null&&(u+=v,s=u.length,a++)}}if(l<0||u.charCodeAt(l+1)!==58)return!1;for(i=l+2;i<s;i++){const b=u.charCodeAt(i);if(b===10){const v=o(a);v!==null&&(u+=v,s=u.length,a++)}else if(!it(b))break}const c=t.md.helpers.parseLinkDestination(u,i,s);if(!c.ok)return!1;const h=t.md.normalizeLink(c.str);if(!t.md.validateLink(h))return!1;i=c.pos;const d=i,f=a,p=i;for(;i<s;i++){const b=u.charCodeAt(i);if(b===10){const v=o(a);v!==null&&(u+=v,s=u.length,a++)}else if(!it(b))break}let g=t.md.helpers.parseLinkTitle(u,i,s);for(;g.can_continue;){const b=o(a);if(b===null)break;u+=b,i=s,s=u.length,a++,g=t.md.helpers.parseLinkTitle(u,i,s,g)}let m;for(i<s&&p!==i&&g.ok?(m=g.str,i=g.pos):(m="",i=d,a=f);i<s;){const b=u.charCodeAt(i);if(!it(b))break;i++}if(i<s&&u.charCodeAt(i)!==10&&m)for(m="",i=d,a=f;i<s;){const b=u.charCodeAt(i);if(!it(b))break;i++}if(i<s&&u.charCodeAt(i)!==10)return!1;const y=rd(u.slice(1,l));return y?(r||(typeof t.env.references>"u"&&(t.env.references={}),typeof t.env.references[y]>"u"&&(t.env.references[y]={title:m,href:h}),t.line=a),!0):!1}const HO=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],YO="[a-zA-Z_:][a-zA-Z0-9:._-]*",VO="[^\"'=<>`\\x00-\\x20]+",qO="'[^']*'",XO='"[^"]*"',jO="(?:"+VO+"|"+qO+"|"+XO+")",KO="(?:\\s+"+YO+"(?:\\s*=\\s*"+jO+")?)",$_="<[A-Za-z][A-Za-z0-9\\-]*"+KO+"*\\s*\\/?>",B_="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",JO="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",ZO="<[?][\\s\\S]*?[?]>",QO="<![A-Za-z][^>]*>",eI="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",tI=new RegExp("^(?:"+$_+"|"+B_+"|"+JO+"|"+ZO+"|"+QO+"|"+eI+")"),nI=new RegExp("^(?:"+$_+"|"+B_+")"),sa=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+HO.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(nI.source+"\\s*$"),/^$/,!1]];function rI(t,e,n,r){let i=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||!t.md.options.html||t.src.charCodeAt(i)!==60)return!1;let a=t.src.slice(i,s),o=0;for(;o<sa.length&&!sa[o][0].test(a);o++);if(o===sa.length)return!1;if(r)return sa[o][2];let u=e+1;if(!sa[o][1].test(a)){for(;u<n&&!(t.sCount[u]<t.blkIndent);u++)if(i=t.bMarks[u]+t.tShift[u],s=t.eMarks[u],a=t.src.slice(i,s),sa[o][1].test(a)){a.length!==0&&u++;break}}t.line=u;const l=t.push("html_block","",0);return l.map=[e,u],l.content=t.getLines(e,u,t.blkIndent,!0),!0}function iI(t,e,n,r){let i=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let a=t.src.charCodeAt(i);if(a!==35||i>=s)return!1;let o=1;for(a=t.src.charCodeAt(++i);a===35&&i<s&&o<=6;)o++,a=t.src.charCodeAt(++i);if(o>6||i<s&&!it(a))return!1;if(r)return!0;s=t.skipSpacesBack(s,i);const u=t.skipCharsBack(s,35,i);u>i&&it(t.src.charCodeAt(u-1))&&(s=u),t.line=e+1;const l=t.push("heading_open","h"+String(o),1);l.markup="########".slice(0,o),l.map=[e,t.line];const c=t.push("inline","",0);c.content=t.src.slice(i,s).trim(),c.map=[e,t.line],c.children=[];const h=t.push("heading_close","h"+String(o),-1);return h.markup="########".slice(0,o),!0}function sI(t,e,n){const r=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;const i=t.parentType;t.parentType="paragraph";let s=0,a,o=e+1;for(;o<n&&!t.isEmpty(o);o++){if(t.sCount[o]-t.blkIndent>3)continue;if(t.sCount[o]>=t.blkIndent){let f=t.bMarks[o]+t.tShift[o];const p=t.eMarks[o];if(f<p&&(a=t.src.charCodeAt(f),(a===45||a===61)&&(f=t.skipChars(f,a),f=t.skipSpaces(f),f>=p))){s=a===61?1:2;break}}if(t.sCount[o]<0)continue;let d=!1;for(let f=0,p=r.length;f<p;f++)if(r[f](t,o,n,!0)){d=!0;break}if(d)break}if(!s)return!1;const u=t.getLines(e,o,t.blkIndent,!1).trim();t.line=o+1;const l=t.push("heading_open","h"+String(s),1);l.markup=String.fromCharCode(a),l.map=[e,t.line];const c=t.push("inline","",0);c.content=u,c.map=[e,t.line-1],c.children=[];const h=t.push("heading_close","h"+String(s),-1);return h.markup=String.fromCharCode(a),t.parentType=i,!0}function aI(t,e,n){const r=t.md.block.ruler.getRules("paragraph"),i=t.parentType;let s=e+1;for(t.parentType="paragraph";s<n&&!t.isEmpty(s);s++){if(t.sCount[s]-t.blkIndent>3||t.sCount[s]<0)continue;let l=!1;for(let c=0,h=r.length;c<h;c++)if(r[c](t,s,n,!0)){l=!0;break}if(l)break}const a=t.getLines(e,s,t.blkIndent,!1).trim();t.line=s;const o=t.push("paragraph_open","p",1);o.map=[e,t.line];const u=t.push("inline","",0);return u.content=a,u.map=[e,t.line],u.children=[],t.push("paragraph_close","p",-1),t.parentType=i,!0}const Jl=[["table",LO,["paragraph","reference"]],["code",PO],["fence",$O,["paragraph","reference","blockquote","list"]],["blockquote",BO,["paragraph","reference","blockquote","list"]],["hr",UO,["paragraph","reference","blockquote","list"]],["list",zO,["paragraph","reference","blockquote"]],["reference",WO],["html_block",rI,["paragraph","reference","blockquote"]],["heading",iI,["paragraph","reference","blockquote"]],["lheading",sI],["paragraph",aI]];function id(){this.ruler=new Nn;for(let t=0;t<Jl.length;t++)this.ruler.push(Jl[t][0],Jl[t][1],{alt:(Jl[t][2]||[]).slice()})}id.prototype.tokenize=function(t,e,n){const r=this.ruler.getRules(""),i=r.length,s=t.md.options.maxNesting;let a=e,o=!1;for(;a<n&&(t.line=a=t.skipEmptyLines(a),!(a>=n||t.sCount[a]<t.blkIndent));){if(t.level>=s){t.line=n;break}const u=t.line;let l=!1;for(let c=0;c<i;c++)if(l=r[c](t,a,n,!1),l){if(u>=t.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");t.tight=!o,t.isEmpty(t.line-1)&&(o=!0),a=t.line,a<n&&t.isEmpty(a)&&(o=!0,a++,t.line=a)}};id.prototype.parse=function(t,e,n,r){if(!t)return;const i=new this.State(t,e,n,r);this.tokenize(i,i.line,i.lineMax)};id.prototype.State=ei;function vl(t,e,n,r){this.src=t,this.env=n,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}vl.prototype.pushPending=function(){const t=new Sr("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t};vl.prototype.push=function(t,e,n){this.pending&&this.pushPending();const r=new Sr(t,e,n);let i=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],i={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(i),r};vl.prototype.scanDelims=function(t,e){const n=this.posMax,r=this.src.charCodeAt(t),i=t>0?this.src.charCodeAt(t-1):32;let s=t;for(;s<n&&this.src.charCodeAt(s)===r;)s++;const a=s-t,o=s<n?this.src.charCodeAt(s):32,u=ju(i)||Xu(String.fromCharCode(i)),l=ju(o)||Xu(String.fromCharCode(o)),c=qu(i),h=qu(o),d=!h&&(!l||c||u),f=!c&&(!u||h||l);return{can_open:d&&(e||!f||u),can_close:f&&(e||!d||l),length:a}};vl.prototype.Token=Sr;function oI(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function uI(t,e){let n=t.pos;for(;n<t.posMax&&!oI(t.src.charCodeAt(n));)n++;return n===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}const lI=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function cI(t,e){if(!t.md.options.linkify||t.linkLevel>0)return!1;const n=t.pos,r=t.posMax;if(n+3>r||t.src.charCodeAt(n)!==58||t.src.charCodeAt(n+1)!==47||t.src.charCodeAt(n+2)!==47)return!1;const i=t.pending.match(lI);if(!i)return!1;const s=i[1],a=t.md.linkify.matchAtStart(t.src.slice(n-s.length));if(!a)return!1;let o=a.url;if(o.length<=s.length)return!1;o=o.replace(/\*+$/,"");const u=t.md.normalizeLink(o);if(!t.md.validateLink(u))return!1;if(!e){t.pending=t.pending.slice(0,-s.length);const l=t.push("link_open","a",1);l.attrs=[["href",u]],l.markup="linkify",l.info="auto";const c=t.push("text","",0);c.content=t.md.normalizeLinkText(o);const h=t.push("link_close","a",-1);h.markup="linkify",h.info="auto"}return t.pos+=o.length-s.length,!0}function hI(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==10)return!1;const r=t.pending.length-1,i=t.posMax;if(!e)if(r>=0&&t.pending.charCodeAt(r)===32)if(r>=1&&t.pending.charCodeAt(r-1)===32){let s=r-1;for(;s>=1&&t.pending.charCodeAt(s-1)===32;)s--;t.pending=t.pending.slice(0,s),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(n++;n<i&&it(t.src.charCodeAt(n));)n++;return t.pos=n,!0}const f1=[];for(let t=0;t<256;t++)f1.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){f1[t.charCodeAt(0)]=1});function fI(t,e){let n=t.pos;const r=t.posMax;if(t.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let i=t.src.charCodeAt(n);if(i===10){for(e||t.push("hardbreak","br",0),n++;n<r&&(i=t.src.charCodeAt(n),!!it(i));)n++;return t.pos=n,!0}let s=t.src[n];if(i>=55296&&i<=56319&&n+1<r){const o=t.src.charCodeAt(n+1);o>=56320&&o<=57343&&(s+=t.src[n+1],n++)}const a="\\"+s;if(!e){const o=t.push("text_special","",0);i<256&&f1[i]!==0?o.content=s:o.content=a,o.markup=a,o.info="escape"}return t.pos=n+1,!0}function dI(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==96)return!1;const i=n;n++;const s=t.posMax;for(;n<s&&t.src.charCodeAt(n)===96;)n++;const a=t.src.slice(i,n),o=a.length;if(t.backticksScanned&&(t.backticks[o]||0)<=i)return e||(t.pending+=a),t.pos+=o,!0;let u=n,l;for(;(l=t.src.indexOf("`",u))!==-1;){for(u=l+1;u<s&&t.src.charCodeAt(u)===96;)u++;const c=u-l;if(c===o){if(!e){const h=t.push("code_inline","code",0);h.markup=a,h.content=t.src.slice(n,l).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=u,!0}t.backticks[c]=l}return t.backticksScanned=!0,e||(t.pending+=a),t.pos+=o,!0}function pI(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e||r!==126)return!1;const i=t.scanDelims(t.pos,!0);let s=i.length;const a=String.fromCharCode(r);if(s<2)return!1;let o;s%2&&(o=t.push("text","",0),o.content=a,s--);for(let u=0;u<s;u+=2)o=t.push("text","",0),o.content=a+a,t.delimiters.push({marker:r,length:0,token:t.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return t.pos+=i.length,!0}function Kv(t,e){let n;const r=[],i=e.length;for(let s=0;s<i;s++){const a=e[s];if(a.marker!==126||a.end===-1)continue;const o=e[a.end];n=t.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=t.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",t.tokens[o.token-1].type==="text"&&t.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const s=r.pop();let a=s+1;for(;a<t.tokens.length&&t.tokens[a].type==="s_close";)a++;a--,s!==a&&(n=t.tokens[a],t.tokens[a]=t.tokens[s],t.tokens[s]=n)}}function gI(t){const e=t.tokens_meta,n=t.tokens_meta.length;Kv(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&Kv(t,e[r].delimiters)}const U_={tokenize:pI,postProcess:gI};function mI(t,e){const n=t.pos,r=t.src.charCodeAt(n);if(e||r!==95&&r!==42)return!1;const i=t.scanDelims(t.pos,r===42);for(let s=0;s<i.length;s++){const a=t.push("text","",0);a.content=String.fromCharCode(r),t.delimiters.push({marker:r,length:i.length,token:t.tokens.length-1,end:-1,open:i.can_open,close:i.can_close})}return t.pos+=i.length,!0}function Jv(t,e){const n=e.length;for(let r=n-1;r>=0;r--){const i=e[r];if(i.marker!==95&&i.marker!==42||i.end===-1)continue;const s=e[i.end],a=r>0&&e[r-1].end===i.end+1&&e[r-1].marker===i.marker&&e[r-1].token===i.token-1&&e[i.end+1].token===s.token+1,o=String.fromCharCode(i.marker),u=t.tokens[i.token];u.type=a?"strong_open":"em_open",u.tag=a?"strong":"em",u.nesting=1,u.markup=a?o+o:o,u.content="";const l=t.tokens[s.token];l.type=a?"strong_close":"em_close",l.tag=a?"strong":"em",l.nesting=-1,l.markup=a?o+o:o,l.content="",a&&(t.tokens[e[r-1].token].content="",t.tokens[e[i.end+1].token].content="",r--)}}function yI(t){const e=t.tokens_meta,n=t.tokens_meta.length;Jv(t,t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&Jv(t,e[r].delimiters)}const G_={tokenize:mI,postProcess:yI};function vI(t,e){let n,r,i,s,a="",o="",u=t.pos,l=!0;if(t.src.charCodeAt(t.pos)!==91)return!1;const c=t.pos,h=t.posMax,d=t.pos+1,f=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(f<0)return!1;let p=f+1;if(p<h&&t.src.charCodeAt(p)===40){for(l=!1,p++;p<h&&(n=t.src.charCodeAt(p),!(!it(n)&&n!==10));p++);if(p>=h)return!1;if(u=p,i=t.md.helpers.parseLinkDestination(t.src,p,t.posMax),i.ok){for(a=t.md.normalizeLink(i.str),t.md.validateLink(a)?p=i.pos:a="",u=p;p<h&&(n=t.src.charCodeAt(p),!(!it(n)&&n!==10));p++);if(i=t.md.helpers.parseLinkTitle(t.src,p,t.posMax),p<h&&u!==p&&i.ok)for(o=i.str,p=i.pos;p<h&&(n=t.src.charCodeAt(p),!(!it(n)&&n!==10));p++);}(p>=h||t.src.charCodeAt(p)!==41)&&(l=!0),p++}if(l){if(typeof t.env.references>"u")return!1;if(p<h&&t.src.charCodeAt(p)===91?(u=p+1,p=t.md.helpers.parseLinkLabel(t,p),p>=0?r=t.src.slice(u,p++):p=f+1):p=f+1,r||(r=t.src.slice(d,f)),s=t.env.references[rd(r)],!s)return t.pos=c,!1;a=s.href,o=s.title}if(!e){t.pos=d,t.posMax=f;const g=t.push("link_open","a",1),m=[["href",a]];g.attrs=m,o&&m.push(["title",o]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=p,t.posMax=h,!0}function bI(t,e){let n,r,i,s,a,o,u,l,c="";const h=t.pos,d=t.posMax;if(t.src.charCodeAt(t.pos)!==33||t.src.charCodeAt(t.pos+1)!==91)return!1;const f=t.pos+2,p=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(p<0)return!1;if(s=p+1,s<d&&t.src.charCodeAt(s)===40){for(s++;s<d&&(n=t.src.charCodeAt(s),!(!it(n)&&n!==10));s++);if(s>=d)return!1;for(l=s,o=t.md.helpers.parseLinkDestination(t.src,s,t.posMax),o.ok&&(c=t.md.normalizeLink(o.str),t.md.validateLink(c)?s=o.pos:c=""),l=s;s<d&&(n=t.src.charCodeAt(s),!(!it(n)&&n!==10));s++);if(o=t.md.helpers.parseLinkTitle(t.src,s,t.posMax),s<d&&l!==s&&o.ok)for(u=o.str,s=o.pos;s<d&&(n=t.src.charCodeAt(s),!(!it(n)&&n!==10));s++);else u="";if(s>=d||t.src.charCodeAt(s)!==41)return t.pos=h,!1;s++}else{if(typeof t.env.references>"u")return!1;if(s<d&&t.src.charCodeAt(s)===91?(l=s+1,s=t.md.helpers.parseLinkLabel(t,s),s>=0?i=t.src.slice(l,s++):s=p+1):s=p+1,i||(i=t.src.slice(f,p)),a=t.env.references[rd(i)],!a)return t.pos=h,!1;c=a.href,u=a.title}if(!e){r=t.src.slice(f,p);const g=[];t.md.inline.parse(r,t.md,t.env,g);const m=t.push("image","img",0),y=[["src",c],["alt",""]];m.attrs=y,m.children=g,m.content=r,u&&y.push(["title",u])}return t.pos=s,t.posMax=d,!0}const xI=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,EI=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function DI(t,e){let n=t.pos;if(t.src.charCodeAt(n)!==60)return!1;const r=t.pos,i=t.posMax;for(;;){if(++n>=i)return!1;const a=t.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const s=t.src.slice(r+1,n);if(EI.test(s)){const a=t.md.normalizeLink(s);if(!t.md.validateLink(a))return!1;if(!e){const o=t.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const u=t.push("text","",0);u.content=t.md.normalizeLinkText(s);const l=t.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return t.pos+=s.length+2,!0}if(xI.test(s)){const a=t.md.normalizeLink("mailto:"+s);if(!t.md.validateLink(a))return!1;if(!e){const o=t.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const u=t.push("text","",0);u.content=t.md.normalizeLinkText(s);const l=t.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return t.pos+=s.length+2,!0}return!1}function wI(t){return/^<a[>\s]/i.test(t)}function _I(t){return/^<\/a\s*>/i.test(t)}function CI(t){const e=t|32;return e>=97&&e<=122}function AI(t,e){if(!t.md.options.html)return!1;const n=t.posMax,r=t.pos;if(t.src.charCodeAt(r)!==60||r+2>=n)return!1;const i=t.src.charCodeAt(r+1);if(i!==33&&i!==63&&i!==47&&!CI(i))return!1;const s=t.src.slice(r).match(tI);if(!s)return!1;if(!e){const a=t.push("html_inline","",0);a.content=s[0],wI(a.content)&&t.linkLevel++,_I(a.content)&&t.linkLevel--}return t.pos+=s[0].length,!0}const TI=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,kI=/^&([a-z][a-z0-9]{1,31});/i;function SI(t,e){const n=t.pos,r=t.posMax;if(t.src.charCodeAt(n)!==38||n+1>=r)return!1;if(t.src.charCodeAt(n+1)===35){const s=t.src.slice(n).match(TI);if(s){if(!e){const a=s[1][0].toLowerCase()==="x"?parseInt(s[1].slice(1),16):parseInt(s[1],10),o=t.push("text_special","",0);o.content=c1(a)?Ih(a):Ih(65533),o.markup=s[0],o.info="entity"}return t.pos+=s[0].length,!0}}else{const s=t.src.slice(n).match(kI);if(s){const a=M_(s[0]);if(a!==s[0]){if(!e){const o=t.push("text_special","",0);o.content=a,o.markup=s[0],o.info="entity"}return t.pos+=s[0].length,!0}}}return!1}function Zv(t){const e={},n=t.length;if(!n)return;let r=0,i=-2;const s=[];for(let a=0;a<n;a++){const o=t[a];if(s.push(0),(t[r].marker!==o.marker||i!==o.token-1)&&(r=a),i=o.token,o.length=o.length||0,!o.close)continue;e.hasOwnProperty(o.marker)||(e[o.marker]=[-1,-1,-1,-1,-1,-1]);const u=e[o.marker][(o.open?3:0)+o.length%3];let l=r-s[r]-1,c=l;for(;l>u;l-=s[l]+1){const h=t[l];if(h.marker===o.marker&&h.open&&h.end<0){let d=!1;if((h.close||o.open)&&(h.length+o.length)%3===0&&(h.length%3!==0||o.length%3!==0)&&(d=!0),!d){const f=l>0&&!t[l-1].open?s[l-1]+1:0;s[a]=a-l+f,s[l]=f,o.open=!1,h.end=a,h.close=!1,c=-1,i=-2;break}}}c!==-1&&(e[o.marker][(o.open?3:0)+(o.length||0)%3]=c)}}function NI(t){const e=t.tokens_meta,n=t.tokens_meta.length;Zv(t.delimiters);for(let r=0;r<n;r++)e[r]&&e[r].delimiters&&Zv(e[r].delimiters)}function FI(t){let e,n,r=0;const i=t.tokens,s=t.tokens.length;for(e=n=0;e<s;e++)i[e].nesting<0&&r--,i[e].level=r,i[e].nesting>0&&r++,i[e].type==="text"&&e+1<s&&i[e+1].type==="text"?i[e+1].content=i[e].content+i[e+1].content:(e!==n&&(i[n]=i[e]),n++);e!==n&&(i.length=n)}const fp=[["text",uI],["linkify",cI],["newline",hI],["escape",fI],["backticks",dI],["strikethrough",U_.tokenize],["emphasis",G_.tokenize],["link",vI],["image",bI],["autolink",DI],["html_inline",AI],["entity",SI]],dp=[["balance_pairs",NI],["strikethrough",U_.postProcess],["emphasis",G_.postProcess],["fragments_join",FI]];function bl(){this.ruler=new Nn;for(let t=0;t<fp.length;t++)this.ruler.push(fp[t][0],fp[t][1]);this.ruler2=new Nn;for(let t=0;t<dp.length;t++)this.ruler2.push(dp[t][0],dp[t][1])}bl.prototype.skipToken=function(t){const e=t.pos,n=this.ruler.getRules(""),r=n.length,i=t.md.options.maxNesting,s=t.cache;if(typeof s[e]<"u"){t.pos=s[e];return}let a=!1;if(t.level<i){for(let o=0;o<r;o++)if(t.level++,a=n[o](t,!0),t.level--,a){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;a||t.pos++,s[e]=t.pos};bl.prototype.tokenize=function(t){const e=this.ruler.getRules(""),n=e.length,r=t.posMax,i=t.md.options.maxNesting;for(;t.pos<r;){const s=t.pos;let a=!1;if(t.level<i){for(let o=0;o<n;o++)if(a=e[o](t,!1),a){if(s>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(t.pos>=r)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};bl.prototype.parse=function(t,e,n,r){const i=new this.State(t,e,n,r);this.tokenize(i);const s=this.ruler2.getRules(""),a=s.length;for(let o=0;o<a;o++)s[o](i)};bl.prototype.State=vl;function RI(t){const e={};t=t||{},e.src_Any=k_.source,e.src_Cc=S_.source,e.src_Z=F_.source,e.src_P=u1.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const n="[><]";return e.src_pseudo_letter="(?:(?!"+n+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+n+"|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function Q0(t){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){t[r]=n[r]})}),t}function sd(t){return Object.prototype.toString.call(t)}function MI(t){return sd(t)==="[object String]"}function OI(t){return sd(t)==="[object Object]"}function II(t){return sd(t)==="[object RegExp]"}function Qv(t){return sd(t)==="[object Function]"}function LI(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const z_={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function PI(t){return Object.keys(t||{}).reduce(function(e,n){return e||z_.hasOwnProperty(n)},!1)}const $I={"http:":{validate:function(t,e,n){const r=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){const r=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?e>=3&&t[e-3]===":"||e>=3&&t[e-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){const r=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},BI="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",UI="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function GI(t){t.__index__=-1,t.__text_cache__=""}function zI(t){return function(e,n){const r=e.slice(n);return t.test(r)?r.match(t)[0].length:0}}function eb(){return function(t,e){e.normalize(t)}}function Lh(t){const e=t.re=RI(t.__opts__),n=t.__tlds__.slice();t.onCompile(),t.__tlds_replaced__||n.push(BI),n.push(e.src_xn),e.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");const i=[];t.__compiled__={};function s(o,u){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+u)}Object.keys(t.__schemas__).forEach(function(o){const u=t.__schemas__[o];if(u===null)return;const l={validate:null,link:null};if(t.__compiled__[o]=l,OI(u)){II(u.validate)?l.validate=zI(u.validate):Qv(u.validate)?l.validate=u.validate:s(o,u),Qv(u.normalize)?l.normalize=u.normalize:u.normalize?s(o,u):l.normalize=eb();return}if(MI(u)){i.push(o);return}s(o,u)}),i.forEach(function(o){t.__compiled__[t.__schemas__[o]]&&(t.__compiled__[o].validate=t.__compiled__[t.__schemas__[o]].validate,t.__compiled__[o].normalize=t.__compiled__[t.__schemas__[o]].normalize)}),t.__compiled__[""]={validate:null,normalize:eb()};const a=Object.keys(t.__compiled__).filter(function(o){return o.length>0&&t.__compiled__[o]}).map(LI).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+a+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+a+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),GI(t)}function WI(t,e){const n=t.__index__,r=t.__last_index__,i=t.__text_cache__.slice(n,r);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=r+e,this.raw=i,this.text=i,this.url=i}function eg(t,e){const n=new WI(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function Zn(t,e){if(!(this instanceof Zn))return new Zn(t,e);e||PI(t)&&(e=t,t={}),this.__opts__=Q0({},z_,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Q0({},$I,t),this.__compiled__={},this.__tlds__=UI,this.__tlds_replaced__=!1,this.re={},Lh(this)}Zn.prototype.add=function(e,n){return this.__schemas__[e]=n,Lh(this),this};Zn.prototype.set=function(e){return this.__opts__=Q0(this.__opts__,e),this};Zn.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let n,r,i,s,a,o,u,l,c;if(this.re.schema_test.test(e)){for(u=this.re.schema_search,u.lastIndex=0;(n=u.exec(e))!==null;)if(s=this.testSchemaAt(e,n[2],u.lastIndex),s){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+s;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&(i=e.match(this.re.email_fuzzy))!==null&&(a=i.index+i[1].length,o=i.index+i[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};Zn.prototype.pretest=function(e){return this.re.pretest.test(e)};Zn.prototype.testSchemaAt=function(e,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(e,r,this):0};Zn.prototype.match=function(e){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===e&&(n.push(eg(this,r)),r=this.__last_index__);let i=r?e.slice(r):e;for(;this.test(i);)n.push(eg(this,r)),i=i.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};Zn.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const n=this.re.schema_at_start.exec(e);if(!n)return null;const r=this.testSchemaAt(e,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,eg(this,0)):null};Zn.prototype.tlds=function(e,n){return e=Array.isArray(e)?e:[e],n?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(r,i,s){return r!==s[i-1]}).reverse(),Lh(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,Lh(this),this)};Zn.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};Zn.prototype.onCompile=function(){};const Ta=2147483647,Hr=36,d1=1,Ku=26,HI=38,YI=700,W_=72,H_=128,Y_="-",VI=/^xn--/,qI=/[^\0-\x7F]/,XI=/[\x2E\u3002\uFF0E\uFF61]/g,jI={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},pp=Hr-d1,Yr=Math.floor,gp=String.fromCharCode;function Ii(t){throw new RangeError(jI[t])}function KI(t,e){const n=[];let r=t.length;for(;r--;)n[r]=e(t[r]);return n}function V_(t,e){const n=t.split("@");let r="";n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(XI,".");const i=t.split("."),s=KI(i,e).join(".");return r+s}function q_(t){const e=[];let n=0;const r=t.length;for(;n<r;){const i=t.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){const s=t.charCodeAt(n++);(s&64512)==56320?e.push(((i&1023)<<10)+(s&1023)+65536):(e.push(i),n--)}else e.push(i)}return e}const JI=t=>String.fromCodePoint(...t),ZI=function(t){return t>=48&&t<58?26+(t-48):t>=65&&t<91?t-65:t>=97&&t<123?t-97:Hr},tb=function(t,e){return t+22+75*(t<26)-((e!=0)<<5)},X_=function(t,e,n){let r=0;for(t=n?Yr(t/YI):t>>1,t+=Yr(t/e);t>pp*Ku>>1;r+=Hr)t=Yr(t/pp);return Yr(r+(pp+1)*t/(t+HI))},j_=function(t){const e=[],n=t.length;let r=0,i=H_,s=W_,a=t.lastIndexOf(Y_);a<0&&(a=0);for(let o=0;o<a;++o)t.charCodeAt(o)>=128&&Ii("not-basic"),e.push(t.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const u=r;for(let c=1,h=Hr;;h+=Hr){o>=n&&Ii("invalid-input");const d=ZI(t.charCodeAt(o++));d>=Hr&&Ii("invalid-input"),d>Yr((Ta-r)/c)&&Ii("overflow"),r+=d*c;const f=h<=s?d1:h>=s+Ku?Ku:h-s;if(d<f)break;const p=Hr-f;c>Yr(Ta/p)&&Ii("overflow"),c*=p}const l=e.length+1;s=X_(r-u,l,u==0),Yr(r/l)>Ta-i&&Ii("overflow"),i+=Yr(r/l),r%=l,e.splice(r++,0,i)}return String.fromCodePoint(...e)},K_=function(t){const e=[];t=q_(t);const n=t.length;let r=H_,i=0,s=W_;for(const u of t)u<128&&e.push(gp(u));const a=e.length;let o=a;for(a&&e.push(Y_);o<n;){let u=Ta;for(const c of t)c>=r&&c<u&&(u=c);const l=o+1;u-r>Yr((Ta-i)/l)&&Ii("overflow"),i+=(u-r)*l,r=u;for(const c of t)if(c<r&&++i>Ta&&Ii("overflow"),c===r){let h=i;for(let d=Hr;;d+=Hr){const f=d<=s?d1:d>=s+Ku?Ku:d-s;if(h<f)break;const p=h-f,g=Hr-f;e.push(gp(tb(f+p%g,0))),h=Yr(p/g)}e.push(gp(tb(h,0))),s=X_(i,l,o===a),i=0,++o}++i,++r}return e.join("")},QI=function(t){return V_(t,function(e){return VI.test(e)?j_(e.slice(4).toLowerCase()):e})},eL=function(t){return V_(t,function(e){return qI.test(e)?"xn--"+K_(e):e})},J_={version:"2.3.1",ucs2:{decode:q_,encode:JI},decode:j_,encode:K_,toASCII:eL,toUnicode:QI},tL={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},nL={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},rL={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},iL={default:tL,zero:nL,commonmark:rL},sL=/^(vbscript|javascript|file|data):/,aL=/^data:image\/(gif|png|jpeg|webp);/;function oL(t){const e=t.trim().toLowerCase();return sL.test(e)?aL.test(e):!0}const Z_=["http:","https:","mailto:"];function uL(t){const e=o1(t,!0);if(e.hostname&&(!e.protocol||Z_.indexOf(e.protocol)>=0))try{e.hostname=J_.toASCII(e.hostname)}catch{}return yl(a1(e))}function lL(t){const e=o1(t,!0);if(e.hostname&&(!e.protocol||Z_.indexOf(e.protocol)>=0))try{e.hostname=J_.toUnicode(e.hostname)}catch{}return Ua(a1(e),Ua.defaultChars+"%")}function Cr(t,e){if(!(this instanceof Cr))return new Cr(t,e);e||l1(t)||(e=t||{},t="default"),this.inline=new bl,this.block=new id,this.core=new h1,this.renderer=new no,this.linkify=new Zn,this.validateLink=oL,this.normalizeLink=uL,this.normalizeLinkText=lL,this.utils=hO,this.helpers=nd({},gO),this.options={},this.configure(t),e&&this.set(e)}Cr.prototype.set=function(t){return nd(this.options,t),this};Cr.prototype.configure=function(t){const e=this;if(l1(t)){const n=t;if(t=iL[n],!t)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(n){t.components[n].rules&&e[n].ruler.enableOnly(t.components[n].rules),t.components[n].rules2&&e[n].ruler2.enableOnly(t.components[n].rules2)}),this};Cr.prototype.enable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(i){n=n.concat(this[i].ruler.enable(t,!0))},this),n=n.concat(this.inline.ruler2.enable(t,!0));const r=t.filter(function(i){return n.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};Cr.prototype.disable=function(t,e){let n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(i){n=n.concat(this[i].ruler.disable(t,!0))},this),n=n.concat(this.inline.ruler2.disable(t,!0));const r=t.filter(function(i){return n.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};Cr.prototype.use=function(t){const e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this};Cr.prototype.parse=function(t,e){if(typeof t!="string")throw new Error("Input data should be a String");const n=new this.core.State(t,this,e);return this.core.process(n),n.tokens};Cr.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};Cr.prototype.parseInline=function(t,e){const n=new this.core.State(t,this,e);return n.inlineMode=!0,this.core.process(n),n.tokens};Cr.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};var Fq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ad(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Uc={exports:{}},cL=Uc.exports,nb;function hL(){return nb||(nb=1,function(t,e){(function(n,r){t.exports=r()})(cL,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",a="second",o="minute",u="hour",l="day",c="week",h="month",d="quarter",f="year",p="date",g="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(x){var _=["th","st","nd","rd"],C=x%100;return"["+x+(_[(C-20)%10]||_[C]||_[0])+"]"}},v=function(x,_,C){var A=String(x);return!A||A.length>=_?x:""+Array(_+1-A.length).join(C)+x},E={s:v,z:function(x){var _=-x.utcOffset(),C=Math.abs(_),A=Math.floor(C/60),T=C%60;return(_<=0?"+":"-")+v(A,2,"0")+":"+v(T,2,"0")},m:function x(_,C){if(_.date()<C.date())return-x(C,_);var A=12*(C.year()-_.year())+(C.month()-_.month()),T=_.clone().add(A,h),O=C-T<0,L=_.clone().add(A+(O?-1:1),h);return+(-(A+(C-T)/(O?T-L:L-T))||0)},a:function(x){return x<0?Math.ceil(x)||0:Math.floor(x)},p:function(x){return{M:h,y:f,w:c,d:l,D:p,h:u,m:o,s:a,ms:s,Q:d}[x]||String(x||"").toLowerCase().replace(/s$/,"")},u:function(x){return x===void 0}},w="en",N={};N[w]=b;var D="$isDayjsObject",k=function(x){return x instanceof R||!(!x||!x[D])},F=function x(_,C,A){var T;if(!_)return w;if(typeof _=="string"){var O=_.toLowerCase();N[O]&&(T=O),C&&(N[O]=C,T=O);var L=_.split("-");if(!T&&L.length>1)return x(L[0])}else{var P=_.name;N[P]=_,T=P}return!A&&T&&(w=T),T||!A&&w},M=function(x,_){if(k(x))return x.clone();var C=typeof _=="object"?_:{};return C.date=x,C.args=arguments,new R(C)},S=E;S.l=F,S.i=k,S.w=function(x,_){return M(x,{locale:_.$L,utc:_.$u,x:_.$x,$offset:_.$offset})};var R=function(){function x(C){this.$L=F(C.locale,null,!0),this.parse(C),this.$x=this.$x||C.x||{},this[D]=!0}var _=x.prototype;return _.parse=function(C){this.$d=function(A){var T=A.date,O=A.utc;if(T===null)return new Date(NaN);if(S.u(T))return new Date;if(T instanceof Date)return new Date(T);if(typeof T=="string"&&!/Z$/i.test(T)){var L=T.match(m);if(L){var P=L[2]-1||0,Y=(L[7]||"0").substring(0,3);return O?new Date(Date.UTC(L[1],P,L[3]||1,L[4]||0,L[5]||0,L[6]||0,Y)):new Date(L[1],P,L[3]||1,L[4]||0,L[5]||0,L[6]||0,Y)}}return new Date(T)}(C),this.init()},_.init=function(){var C=this.$d;this.$y=C.getFullYear(),this.$M=C.getMonth(),this.$D=C.getDate(),this.$W=C.getDay(),this.$H=C.getHours(),this.$m=C.getMinutes(),this.$s=C.getSeconds(),this.$ms=C.getMilliseconds()},_.$utils=function(){return S},_.isValid=function(){return this.$d.toString()!==g},_.isSame=function(C,A){var T=M(C);return this.startOf(A)<=T&&T<=this.endOf(A)},_.isAfter=function(C,A){return M(C)<this.startOf(A)},_.isBefore=function(C,A){return this.endOf(A)<M(C)},_.$g=function(C,A,T){return S.u(C)?this[A]:this.set(T,C)},_.unix=function(){return Math.floor(this.valueOf()/1e3)},_.valueOf=function(){return this.$d.getTime()},_.startOf=function(C,A){var T=this,O=!!S.u(A)||A,L=S.p(C),P=function(B,H){var j=S.w(T.$u?Date.UTC(T.$y,H,B):new Date(T.$y,H,B),T);return O?j:j.endOf(l)},Y=function(B,H){return S.w(T.toDate()[B].apply(T.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(H)),T)},W=this.$W,X=this.$M,V=this.$D,q="set"+(this.$u?"UTC":"");switch(L){case f:return O?P(1,0):P(31,11);case h:return O?P(1,X):P(0,X+1);case c:var Z=this.$locale().weekStart||0,J=(W<Z?W+7:W)-Z;return P(O?V-J:V+(6-J),X);case l:case p:return Y(q+"Hours",0);case u:return Y(q+"Minutes",1);case o:return Y(q+"Seconds",2);case a:return Y(q+"Milliseconds",3);default:return this.clone()}},_.endOf=function(C){return this.startOf(C,!1)},_.$set=function(C,A){var T,O=S.p(C),L="set"+(this.$u?"UTC":""),P=(T={},T[l]=L+"Date",T[p]=L+"Date",T[h]=L+"Month",T[f]=L+"FullYear",T[u]=L+"Hours",T[o]=L+"Minutes",T[a]=L+"Seconds",T[s]=L+"Milliseconds",T)[O],Y=O===l?this.$D+(A-this.$W):A;if(O===h||O===f){var W=this.clone().set(p,1);W.$d[P](Y),W.init(),this.$d=W.set(p,Math.min(this.$D,W.daysInMonth())).$d}else P&&this.$d[P](Y);return this.init(),this},_.set=function(C,A){return this.clone().$set(C,A)},_.get=function(C){return this[S.p(C)]()},_.add=function(C,A){var T,O=this;C=Number(C);var L=S.p(A),P=function(X){var V=M(O);return S.w(V.date(V.date()+Math.round(X*C)),O)};if(L===h)return this.set(h,this.$M+C);if(L===f)return this.set(f,this.$y+C);if(L===l)return P(1);if(L===c)return P(7);var Y=(T={},T[o]=r,T[u]=i,T[a]=n,T)[L]||1,W=this.$d.getTime()+C*Y;return S.w(W,this)},_.subtract=function(C,A){return this.add(-1*C,A)},_.format=function(C){var A=this,T=this.$locale();if(!this.isValid())return T.invalidDate||g;var O=C||"YYYY-MM-DDTHH:mm:ssZ",L=S.z(this),P=this.$H,Y=this.$m,W=this.$M,X=T.weekdays,V=T.months,q=T.meridiem,Z=function(H,j,G,re){return H&&(H[j]||H(A,O))||G[j].slice(0,re)},J=function(H){return S.s(P%12||12,H,"0")},B=q||function(H,j,G){var re=H<12?"AM":"PM";return G?re.toLowerCase():re};return O.replace(y,function(H,j){return j||function(G){switch(G){case"YY":return String(A.$y).slice(-2);case"YYYY":return S.s(A.$y,4,"0");case"M":return W+1;case"MM":return S.s(W+1,2,"0");case"MMM":return Z(T.monthsShort,W,V,3);case"MMMM":return Z(V,W);case"D":return A.$D;case"DD":return S.s(A.$D,2,"0");case"d":return String(A.$W);case"dd":return Z(T.weekdaysMin,A.$W,X,2);case"ddd":return Z(T.weekdaysShort,A.$W,X,3);case"dddd":return X[A.$W];case"H":return String(P);case"HH":return S.s(P,2,"0");case"h":return J(1);case"hh":return J(2);case"a":return B(P,Y,!0);case"A":return B(P,Y,!1);case"m":return String(Y);case"mm":return S.s(Y,2,"0");case"s":return String(A.$s);case"ss":return S.s(A.$s,2,"0");case"SSS":return S.s(A.$ms,3,"0");case"Z":return L}return null}(H)||L.replace(":","")})},_.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},_.diff=function(C,A,T){var O,L=this,P=S.p(A),Y=M(C),W=(Y.utcOffset()-this.utcOffset())*r,X=this-Y,V=function(){return S.m(L,Y)};switch(P){case f:O=V()/12;break;case h:O=V();break;case d:O=V()/3;break;case c:O=(X-W)/6048e5;break;case l:O=(X-W)/864e5;break;case u:O=X/i;break;case o:O=X/r;break;case a:O=X/n;break;default:O=X}return T?O:S.a(O)},_.daysInMonth=function(){return this.endOf(h).$D},_.$locale=function(){return N[this.$L]},_.locale=function(C,A){if(!C)return this.$L;var T=this.clone(),O=F(C,A,!0);return O&&(T.$L=O),T},_.clone=function(){return S.w(this.$d,this)},_.toDate=function(){return new Date(this.valueOf())},_.toJSON=function(){return this.isValid()?this.toISOString():null},_.toISOString=function(){return this.$d.toISOString()},_.toString=function(){return this.$d.toUTCString()},x}(),I=R.prototype;return M.prototype=I,[["$ms",s],["$s",a],["$m",o],["$H",u],["$W",l],["$M",h],["$y",f],["$D",p]].forEach(function(x){I[x[1]]=function(_){return this.$g(_,x[0],x[1])}}),M.extend=function(x,_){return x.$i||(x(_,R,M),x.$i=!0),M},M.locale=F,M.isDayjs=k,M.unix=function(x){return M(1e3*x)},M.en=N[w],M.Ls=N,M.p={},M})}(Uc)),Uc.exports}var fL=hL();const Rq=ad(fL),Gc={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:t=>t>=255?255:t<0?0:t,g:t=>t>=255?255:t<0?0:t,b:t=>t>=255?255:t<0?0:t,h:t=>t%360,s:t=>t>=100?100:t<0?0:t,l:t=>t>=100?100:t<0?0:t,a:t=>t>=1?1:t<0?0:t},toLinear:t=>{const e=t/255;return t>.03928?Math.pow((e+.055)/1.055,2.4):e/12.92},hue2rgb:(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t),hsl2rgb:({h:t,s:e,l:n},r)=>{if(!e)return n*2.55;t/=360,e/=100,n/=100;const i=n<.5?n*(1+e):n+e-n*e,s=2*n-i;switch(r){case"r":return Gc.hue2rgb(s,i,t+1/3)*255;case"g":return Gc.hue2rgb(s,i,t)*255;case"b":return Gc.hue2rgb(s,i,t-1/3)*255}},rgb2hsl:({r:t,g:e,b:n},r)=>{t/=255,e/=255,n/=255;const i=Math.max(t,e,n),s=Math.min(t,e,n),a=(i+s)/2;if(r==="l")return a*100;if(i===s)return 0;const o=i-s,u=a>.5?o/(2-i-s):o/(i+s);if(r==="s")return u*100;switch(i){case t:return((e-n)/o+(e<n?6:0))*60;case e:return((n-t)/o+2)*60;case n:return((t-e)/o+4)*60;default:return-1}}},dL={clamp:(t,e,n)=>e>n?Math.min(e,Math.max(n,t)):Math.min(n,Math.max(e,t)),round:t=>Math.round(t*1e10)/1e10},pL={dec2hex:t=>{const e=Math.round(t).toString(16);return e.length>1?e:`0${e}`}},we={channel:Gc,lang:dL,unit:pL},Mi={};for(let t=0;t<=255;t++)Mi[t]=we.unit.dec2hex(t);const ln={ALL:0,RGB:1,HSL:2};let gL=class{constructor(){this.type=ln.ALL}get(){return this.type}set(e){if(this.type&&this.type!==e)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=e}reset(){this.type=ln.ALL}is(e){return this.type===e}};class mL{constructor(e,n){this.color=n,this.changed=!1,this.data=e,this.type=new gL}set(e,n){return this.color=n,this.changed=!1,this.data=e,this.type.type=ln.ALL,this}_ensureHSL(){const e=this.data,{h:n,s:r,l:i}=e;n===void 0&&(e.h=we.channel.rgb2hsl(e,"h")),r===void 0&&(e.s=we.channel.rgb2hsl(e,"s")),i===void 0&&(e.l=we.channel.rgb2hsl(e,"l"))}_ensureRGB(){const e=this.data,{r:n,g:r,b:i}=e;n===void 0&&(e.r=we.channel.hsl2rgb(e,"r")),r===void 0&&(e.g=we.channel.hsl2rgb(e,"g")),i===void 0&&(e.b=we.channel.hsl2rgb(e,"b"))}get r(){const e=this.data,n=e.r;return!this.type.is(ln.HSL)&&n!==void 0?n:(this._ensureHSL(),we.channel.hsl2rgb(e,"r"))}get g(){const e=this.data,n=e.g;return!this.type.is(ln.HSL)&&n!==void 0?n:(this._ensureHSL(),we.channel.hsl2rgb(e,"g"))}get b(){const e=this.data,n=e.b;return!this.type.is(ln.HSL)&&n!==void 0?n:(this._ensureHSL(),we.channel.hsl2rgb(e,"b"))}get h(){const e=this.data,n=e.h;return!this.type.is(ln.RGB)&&n!==void 0?n:(this._ensureRGB(),we.channel.rgb2hsl(e,"h"))}get s(){const e=this.data,n=e.s;return!this.type.is(ln.RGB)&&n!==void 0?n:(this._ensureRGB(),we.channel.rgb2hsl(e,"s"))}get l(){const e=this.data,n=e.l;return!this.type.is(ln.RGB)&&n!==void 0?n:(this._ensureRGB(),we.channel.rgb2hsl(e,"l"))}get a(){return this.data.a}set r(e){this.type.set(ln.RGB),this.changed=!0,this.data.r=e}set g(e){this.type.set(ln.RGB),this.changed=!0,this.data.g=e}set b(e){this.type.set(ln.RGB),this.changed=!0,this.data.b=e}set h(e){this.type.set(ln.HSL),this.changed=!0,this.data.h=e}set s(e){this.type.set(ln.HSL),this.changed=!0,this.data.s=e}set l(e){this.type.set(ln.HSL),this.changed=!0,this.data.l=e}set a(e){this.changed=!0,this.data.a=e}}const od=new mL({r:0,g:0,b:0,a:0},"transparent"),ka={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:t=>{if(t.charCodeAt(0)!==35)return;const e=t.match(ka.re);if(!e)return;const n=e[1],r=parseInt(n,16),i=n.length,s=i%4===0,a=i>4,o=a?1:17,u=a?8:4,l=s?0:-1,c=a?255:15;return od.set({r:(r>>u*(l+3)&c)*o,g:(r>>u*(l+2)&c)*o,b:(r>>u*(l+1)&c)*o,a:s?(r&c)*o/255:1},t)},stringify:t=>{const{r:e,g:n,b:r,a:i}=t;return i<1?`#${Mi[Math.round(e)]}${Mi[Math.round(n)]}${Mi[Math.round(r)]}${Mi[Math.round(i*255)]}`:`#${Mi[Math.round(e)]}${Mi[Math.round(n)]}${Mi[Math.round(r)]}`}},xs={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:t=>{const e=t.match(xs.hueRe);if(e){const[,n,r]=e;switch(r){case"grad":return we.channel.clamp.h(parseFloat(n)*.9);case"rad":return we.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return we.channel.clamp.h(parseFloat(n)*360)}}return we.channel.clamp.h(parseFloat(t))},parse:t=>{const e=t.charCodeAt(0);if(e!==104&&e!==72)return;const n=t.match(xs.re);if(!n)return;const[,r,i,s,a,o]=n;return od.set({h:xs._hue2deg(r),s:we.channel.clamp.s(parseFloat(i)),l:we.channel.clamp.l(parseFloat(s)),a:a?we.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},t)},stringify:t=>{const{h:e,s:n,l:r,a:i}=t;return i<1?`hsla(${we.lang.round(e)}, ${we.lang.round(n)}%, ${we.lang.round(r)}%, ${i})`:`hsl(${we.lang.round(e)}, ${we.lang.round(n)}%, ${we.lang.round(r)}%)`}},Ru={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:t=>{t=t.toLowerCase();const e=Ru.colors[t];if(e)return ka.parse(e)},stringify:t=>{const e=ka.stringify(t);for(const n in Ru.colors)if(Ru.colors[n]===e)return n}},Go={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:t=>{const e=t.charCodeAt(0);if(e!==114&&e!==82)return;const n=t.match(Go.re);if(!n)return;const[,r,i,s,a,o,u,l,c]=n;return od.set({r:we.channel.clamp.r(i?parseFloat(r)*2.55:parseFloat(r)),g:we.channel.clamp.g(a?parseFloat(s)*2.55:parseFloat(s)),b:we.channel.clamp.b(u?parseFloat(o)*2.55:parseFloat(o)),a:l?we.channel.clamp.a(c?parseFloat(l)/100:parseFloat(l)):1},t)},stringify:t=>{const{r:e,g:n,b:r,a:i}=t;return i<1?`rgba(${we.lang.round(e)}, ${we.lang.round(n)}, ${we.lang.round(r)}, ${we.lang.round(i)})`:`rgb(${we.lang.round(e)}, ${we.lang.round(n)}, ${we.lang.round(r)})`}},Ar={format:{keyword:Ru,hex:ka,rgb:Go,rgba:Go,hsl:xs,hsla:xs},parse:t=>{if(typeof t!="string")return t;const e=ka.parse(t)||Go.parse(t)||xs.parse(t)||Ru.parse(t);if(e)return e;throw new Error(`Unsupported color format: "${t}"`)},stringify:t=>!t.changed&&t.color?t.color:t.type.is(ln.HSL)||t.data.r===void 0?xs.stringify(t):t.a<1||!Number.isInteger(t.r)||!Number.isInteger(t.g)||!Number.isInteger(t.b)?Go.stringify(t):ka.stringify(t)},Q_=(t,e)=>{const n=Ar.parse(t);for(const r in e)n[r]=we.channel.clamp[r](e[r]);return Ar.stringify(n)},yL=(t,e,n=0,r=1)=>{if(typeof t!="number")return Q_(t,{a:e});const i=od.set({r:we.channel.clamp.r(t),g:we.channel.clamp.g(e),b:we.channel.clamp.b(n),a:we.channel.clamp.a(r)});return Ar.stringify(i)},Oq=(t,e)=>we.lang.round(Ar.parse(t)[e]),vL=t=>{const{r:e,g:n,b:r}=Ar.parse(t),i=.2126*we.channel.toLinear(e)+.7152*we.channel.toLinear(n)+.0722*we.channel.toLinear(r);return we.lang.round(i)},bL=t=>vL(t)>=.5,Iq=t=>!bL(t),eC=(t,e,n)=>{const r=Ar.parse(t),i=r[e],s=we.channel.clamp[e](i+n);return i!==s&&(r[e]=s),Ar.stringify(r)},Lq=(t,e)=>eC(t,"l",e),Pq=(t,e)=>eC(t,"l",-e),$q=(t,e)=>{const n=Ar.parse(t),r={};for(const i in e)e[i]&&(r[i]=n[i]+e[i]);return Q_(t,r)},xL=(t,e,n=50)=>{const{r,g:i,b:s,a}=Ar.parse(t),{r:o,g:u,b:l,a:c}=Ar.parse(e),h=n/100,d=h*2-1,f=a-c,g=((d*f===-1?d:(d+f)/(1+d*f))+1)/2,m=1-g,y=r*g+o*m,b=i*g+u*m,v=s*g+l*m,E=a*h+c*(1-h);return yL(y,b,v,E)},Bq=(t,e=100)=>{const n=Ar.parse(t);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,xL(n,t,e)};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:tC,setPrototypeOf:rb,isFrozen:EL,getPrototypeOf:DL,getOwnPropertyDescriptor:wL}=Object;let{freeze:xn,seal:lr,create:tg}=Object,{apply:ng,construct:rg}=typeof Reflect<"u"&&Reflect;xn||(xn=function(e){return e});lr||(lr=function(e){return e});ng||(ng=function(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return e.apply(n,i)});rg||(rg=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new e(...r)});const Zl=En(Array.prototype.forEach),_L=En(Array.prototype.lastIndexOf),ib=En(Array.prototype.pop),ho=En(Array.prototype.push),CL=En(Array.prototype.splice),zc=En(String.prototype.toLowerCase),mp=En(String.prototype.toString),yp=En(String.prototype.match),fo=En(String.prototype.replace),AL=En(String.prototype.indexOf),TL=En(String.prototype.trim),dr=En(Object.prototype.hasOwnProperty),yn=En(RegExp.prototype.test),po=kL(TypeError);function En(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ng(t,e,r)}}function kL(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rg(t,n)}}function Ne(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zc;rb&&rb(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=n(i);s!==i&&(EL(e)||(e[r]=s),i=s)}t[i]=!0}return t}function SL(t){for(let e=0;e<t.length;e++)dr(t,e)||(t[e]=null);return t}function hi(t){const e=tg(null);for(const[n,r]of tC(t))dr(t,n)&&(Array.isArray(r)?e[n]=SL(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=hi(r):e[n]=r);return e}function go(t,e){for(;t!==null;){const r=wL(t,e);if(r){if(r.get)return En(r.get);if(typeof r.value=="function")return En(r.value)}t=DL(t)}function n(){return null}return n}const sb=xn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),vp=xn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),bp=xn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),NL=xn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),xp=xn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),FL=xn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ab=xn(["#text"]),ob=xn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ep=xn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ub=xn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ql=xn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),RL=lr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ML=lr(/<%[\w\W]*|[\w\W]*%>/gm),OL=lr(/\$\{[\w\W]*/gm),IL=lr(/^data-[\-\w.\u00B7-\uFFFF]+$/),LL=lr(/^aria-[\-\w]+$/),nC=lr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),PL=lr(/^(?:\w+script|data):/i),$L=lr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),rC=lr(/^html$/i),BL=lr(/^[a-z][.\w]*(-[.\w]+)+$/i);var lb=Object.freeze({__proto__:null,ARIA_ATTR:LL,ATTR_WHITESPACE:$L,CUSTOM_ELEMENT:BL,DATA_ATTR:IL,DOCTYPE_NAME:rC,ERB_EXPR:ML,IS_ALLOWED_URI:nC,IS_SCRIPT_OR_DATA:PL,MUSTACHE_EXPR:RL,TMPLIT_EXPR:OL});const mo={element:1,text:3,progressingInstruction:7,comment:8,document:9},UL=function(){return typeof window>"u"?null:window},GL=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},cb=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function iC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:UL();const e=le=>iC(le);if(e.version="3.3.0",e.removed=[],!t||!t.document||t.document.nodeType!==mo.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:o,Element:u,NodeFilter:l,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,p=u.prototype,g=go(p,"cloneNode"),m=go(p,"remove"),y=go(p,"nextSibling"),b=go(p,"childNodes"),v=go(p,"parentNode");if(typeof a=="function"){const le=n.createElement("template");le.content&&le.content.ownerDocument&&(n=le.content.ownerDocument)}let E,w="";const{implementation:N,createNodeIterator:D,createDocumentFragment:k,getElementsByTagName:F}=n,{importNode:M}=r;let S=cb();e.isSupported=typeof tC=="function"&&typeof v=="function"&&N&&N.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:R,ERB_EXPR:I,TMPLIT_EXPR:x,DATA_ATTR:_,ARIA_ATTR:C,IS_SCRIPT_OR_DATA:A,ATTR_WHITESPACE:T,CUSTOM_ELEMENT:O}=lb;let{IS_ALLOWED_URI:L}=lb,P=null;const Y=Ne({},[...sb,...vp,...bp,...xp,...ab]);let W=null;const X=Ne({},[...ob,...Ep,...ub,...Ql]);let V=Object.seal(tg(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),q=null,Z=null;const J=Object.seal(tg(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let B=!0,H=!0,j=!1,G=!0,re=!1,K=!0,_e=!1,ve=!1,dt=!1,ut=!1,Me=!1,rn=!1,In=!0,Ti=!1;const Wt="user-content-";let Fr=!0,At=!1,sn={},Ln=null;const ki=Ne({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let gn=null;const nr=Ne({},["audio","video","img","source","image","track"]);let mn=null;const Q=Ne({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ie="http://www.w3.org/1998/Math/MathML",he="http://www.w3.org/2000/svg",fe="http://www.w3.org/1999/xhtml";let ue=fe,Ce=!1,je=null;const Ge=Ne({},[ie,he,fe],mp);let ge=Ne({},["mi","mo","mn","ms","mtext"]),oe=Ne({},["annotation-xml"]);const $e=Ne({},["title","style","font","a","script"]);let ze=null;const Ie=["application/xhtml+xml","text/html"],Tt="text/html";let ce=null,de=null;const We=n.createElement("form"),be=function($){return $ instanceof RegExp||$ instanceof Function},me=function(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(de&&de===$)){if((!$||typeof $!="object")&&($={}),$=hi($),ze=Ie.indexOf($.PARSER_MEDIA_TYPE)===-1?Tt:$.PARSER_MEDIA_TYPE,ce=ze==="application/xhtml+xml"?mp:zc,P=dr($,"ALLOWED_TAGS")?Ne({},$.ALLOWED_TAGS,ce):Y,W=dr($,"ALLOWED_ATTR")?Ne({},$.ALLOWED_ATTR,ce):X,je=dr($,"ALLOWED_NAMESPACES")?Ne({},$.ALLOWED_NAMESPACES,mp):Ge,mn=dr($,"ADD_URI_SAFE_ATTR")?Ne(hi(Q),$.ADD_URI_SAFE_ATTR,ce):Q,gn=dr($,"ADD_DATA_URI_TAGS")?Ne(hi(nr),$.ADD_DATA_URI_TAGS,ce):nr,Ln=dr($,"FORBID_CONTENTS")?Ne({},$.FORBID_CONTENTS,ce):ki,q=dr($,"FORBID_TAGS")?Ne({},$.FORBID_TAGS,ce):hi({}),Z=dr($,"FORBID_ATTR")?Ne({},$.FORBID_ATTR,ce):hi({}),sn=dr($,"USE_PROFILES")?$.USE_PROFILES:!1,B=$.ALLOW_ARIA_ATTR!==!1,H=$.ALLOW_DATA_ATTR!==!1,j=$.ALLOW_UNKNOWN_PROTOCOLS||!1,G=$.ALLOW_SELF_CLOSE_IN_ATTR!==!1,re=$.SAFE_FOR_TEMPLATES||!1,K=$.SAFE_FOR_XML!==!1,_e=$.WHOLE_DOCUMENT||!1,ut=$.RETURN_DOM||!1,Me=$.RETURN_DOM_FRAGMENT||!1,rn=$.RETURN_TRUSTED_TYPE||!1,dt=$.FORCE_BODY||!1,In=$.SANITIZE_DOM!==!1,Ti=$.SANITIZE_NAMED_PROPS||!1,Fr=$.KEEP_CONTENT!==!1,At=$.IN_PLACE||!1,L=$.ALLOWED_URI_REGEXP||nC,ue=$.NAMESPACE||fe,ge=$.MATHML_TEXT_INTEGRATION_POINTS||ge,oe=$.HTML_INTEGRATION_POINTS||oe,V=$.CUSTOM_ELEMENT_HANDLING||{},$.CUSTOM_ELEMENT_HANDLING&&be($.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=$.CUSTOM_ELEMENT_HANDLING.tagNameCheck),$.CUSTOM_ELEMENT_HANDLING&&be($.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=$.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),$.CUSTOM_ELEMENT_HANDLING&&typeof $.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(V.allowCustomizedBuiltInElements=$.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),re&&(H=!1),Me&&(ut=!0),sn&&(P=Ne({},ab),W=[],sn.html===!0&&(Ne(P,sb),Ne(W,ob)),sn.svg===!0&&(Ne(P,vp),Ne(W,Ep),Ne(W,Ql)),sn.svgFilters===!0&&(Ne(P,bp),Ne(W,Ep),Ne(W,Ql)),sn.mathMl===!0&&(Ne(P,xp),Ne(W,ub),Ne(W,Ql))),$.ADD_TAGS&&(typeof $.ADD_TAGS=="function"?J.tagCheck=$.ADD_TAGS:(P===Y&&(P=hi(P)),Ne(P,$.ADD_TAGS,ce))),$.ADD_ATTR&&(typeof $.ADD_ATTR=="function"?J.attributeCheck=$.ADD_ATTR:(W===X&&(W=hi(W)),Ne(W,$.ADD_ATTR,ce))),$.ADD_URI_SAFE_ATTR&&Ne(mn,$.ADD_URI_SAFE_ATTR,ce),$.FORBID_CONTENTS&&(Ln===ki&&(Ln=hi(Ln)),Ne(Ln,$.FORBID_CONTENTS,ce)),Fr&&(P["#text"]=!0),_e&&Ne(P,["html","head","body"]),P.table&&(Ne(P,["tbody"]),delete q.tbody),$.TRUSTED_TYPES_POLICY){if(typeof $.TRUSTED_TYPES_POLICY.createHTML!="function")throw po('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof $.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw po('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=$.TRUSTED_TYPES_POLICY,w=E.createHTML("")}else E===void 0&&(E=GL(f,i)),E!==null&&typeof w=="string"&&(w=E.createHTML(""));xn&&xn($),de=$}},kt=Ne({},[...vp,...bp,...NL]),ke=Ne({},[...xp,...FL]),Fe=function($){let ee=v($);(!ee||!ee.tagName)&&(ee={namespaceURI:ue,tagName:"template"});const ae=zc($.tagName),Ze=zc(ee.tagName);return je[$.namespaceURI]?$.namespaceURI===he?ee.namespaceURI===fe?ae==="svg":ee.namespaceURI===ie?ae==="svg"&&(Ze==="annotation-xml"||ge[Ze]):!!kt[ae]:$.namespaceURI===ie?ee.namespaceURI===fe?ae==="math":ee.namespaceURI===he?ae==="math"&&oe[Ze]:!!ke[ae]:$.namespaceURI===fe?ee.namespaceURI===he&&!oe[Ze]||ee.namespaceURI===ie&&!ge[Ze]?!1:!ke[ae]&&($e[ae]||!kt[ae]):!!(ze==="application/xhtml+xml"&&je[$.namespaceURI]):!1},lt=function($){ho(e.removed,{element:$});try{v($).removeChild($)}catch{m($)}},tt=function($,ee){try{ho(e.removed,{attribute:ee.getAttributeNode($),from:ee})}catch{ho(e.removed,{attribute:null,from:ee})}if(ee.removeAttribute($),$==="is")if(ut||Me)try{lt(ee)}catch{}else try{ee.setAttribute($,"")}catch{}},an=function($){let ee=null,ae=null;if(dt)$="<remove></remove>"+$;else{const pt=yp($,/^[\r\n\t ]+/);ae=pt&&pt[0]}ze==="application/xhtml+xml"&&ue===fe&&($='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+$+"</body></html>");const Ze=E?E.createHTML($):$;if(ue===fe)try{ee=new d().parseFromString(Ze,ze)}catch{}if(!ee||!ee.documentElement){ee=N.createDocument(ue,"template",null);try{ee.documentElement.innerHTML=Ce?w:Ze}catch{}}const bt=ee.body||ee.documentElement;return $&&ae&&bt.insertBefore(n.createTextNode(ae),bt.childNodes[0]||null),ue===fe?F.call(ee,_e?"html":"body")[0]:_e?ee.documentElement:bt},at=function($){return D.call($.ownerDocument||$,$,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},Cn=function($){return $ instanceof h&&(typeof $.nodeName!="string"||typeof $.textContent!="string"||typeof $.removeChild!="function"||!($.attributes instanceof c)||typeof $.removeAttribute!="function"||typeof $.setAttribute!="function"||typeof $.namespaceURI!="string"||typeof $.insertBefore!="function"||typeof $.hasChildNodes!="function")},ii=function($){return typeof o=="function"&&$ instanceof o};function Pn(le,$,ee){Zl(le,ae=>{ae.call(e,$,ee,de)})}const Rr=function($){let ee=null;if(Pn(S.beforeSanitizeElements,$,null),Cn($))return lt($),!0;const ae=ce($.nodeName);if(Pn(S.uponSanitizeElement,$,{tagName:ae,allowedTags:P}),K&&$.hasChildNodes()&&!ii($.firstElementChild)&&yn(/<[/\w!]/g,$.innerHTML)&&yn(/<[/\w!]/g,$.textContent)||$.nodeType===mo.progressingInstruction||K&&$.nodeType===mo.comment&&yn(/<[/\w]/g,$.data))return lt($),!0;if(!(J.tagCheck instanceof Function&&J.tagCheck(ae))&&(!P[ae]||q[ae])){if(!q[ae]&&ai(ae)&&(V.tagNameCheck instanceof RegExp&&yn(V.tagNameCheck,ae)||V.tagNameCheck instanceof Function&&V.tagNameCheck(ae)))return!1;if(Fr&&!Ln[ae]){const Ze=v($)||$.parentNode,bt=b($)||$.childNodes;if(bt&&Ze){const pt=bt.length;for(let Ot=pt-1;Ot>=0;--Ot){const rr=g(bt[Ot],!0);rr.__removalCount=($.__removalCount||0)+1,Ze.insertBefore(rr,y($))}}}return lt($),!0}return $ instanceof u&&!Fe($)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&yn(/<\/no(script|embed|frames)/i,$.innerHTML)?(lt($),!0):(re&&$.nodeType===mo.text&&(ee=$.textContent,Zl([R,I,x],Ze=>{ee=fo(ee,Ze," ")}),$.textContent!==ee&&(ho(e.removed,{element:$.cloneNode()}),$.textContent=ee)),Pn(S.afterSanitizeElements,$,null),!1)},si=function($,ee,ae){if(In&&(ee==="id"||ee==="name")&&(ae in n||ae in We))return!1;if(!(H&&!Z[ee]&&yn(_,ee))){if(!(B&&yn(C,ee))){if(!(J.attributeCheck instanceof Function&&J.attributeCheck(ee,$))){if(!W[ee]||Z[ee]){if(!(ai($)&&(V.tagNameCheck instanceof RegExp&&yn(V.tagNameCheck,$)||V.tagNameCheck instanceof Function&&V.tagNameCheck($))&&(V.attributeNameCheck instanceof RegExp&&yn(V.attributeNameCheck,ee)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(ee,$))||ee==="is"&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&yn(V.tagNameCheck,ae)||V.tagNameCheck instanceof Function&&V.tagNameCheck(ae))))return!1}else if(!mn[ee]){if(!yn(L,fo(ae,T,""))){if(!((ee==="src"||ee==="xlink:href"||ee==="href")&&$!=="script"&&AL(ae,"data:")===0&&gn[$])){if(!(j&&!yn(A,fo(ae,T,"")))){if(ae)return!1}}}}}}}return!0},ai=function($){return $!=="annotation-xml"&&yp($,O)},Mr=function($){Pn(S.beforeSanitizeAttributes,$,null);const{attributes:ee}=$;if(!ee||Cn($))return;const ae={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W,forceKeepAttr:void 0};let Ze=ee.length;for(;Ze--;){const bt=ee[Ze],{name:pt,namespaceURI:Ot,value:rr}=bt,oi=ce(pt),is=rr;let xt=pt==="value"?is:TL(is);if(ae.attrName=oi,ae.attrValue=xt,ae.keepAttr=!0,ae.forceKeepAttr=void 0,Pn(S.uponSanitizeAttribute,$,ae),xt=ae.attrValue,Ti&&(oi==="id"||oi==="name")&&(tt(pt,$),xt=Wt+xt),K&&yn(/((--!?|])>)|<\/(style|title|textarea)/i,xt)){tt(pt,$);continue}if(oi==="attributename"&&yp(xt,"href")){tt(pt,$);continue}if(ae.forceKeepAttr)continue;if(!ae.keepAttr){tt(pt,$);continue}if(!G&&yn(/\/>/i,xt)){tt(pt,$);continue}re&&Zl([R,I,x],Te=>{xt=fo(xt,Te," ")});const Et=ce($.nodeName);if(!si(Et,oi,xt)){tt(pt,$);continue}if(E&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Ot)switch(f.getAttributeType(Et,oi)){case"TrustedHTML":{xt=E.createHTML(xt);break}case"TrustedScriptURL":{xt=E.createScriptURL(xt);break}}if(xt!==is)try{Ot?$.setAttributeNS(Ot,pt,xt):$.setAttribute(pt,xt),Cn($)?lt($):ib(e.removed)}catch{tt(pt,$)}}Pn(S.afterSanitizeAttributes,$,null)},Zs=function le($){let ee=null;const ae=at($);for(Pn(S.beforeSanitizeShadowDOM,$,null);ee=ae.nextNode();)Pn(S.uponSanitizeShadowNode,ee,null),Rr(ee),Mr(ee),ee.content instanceof s&&le(ee.content);Pn(S.afterSanitizeShadowDOM,$,null)};return e.sanitize=function(le){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee=null,ae=null,Ze=null,bt=null;if(Ce=!le,Ce&&(le="<!-->"),typeof le!="string"&&!ii(le))if(typeof le.toString=="function"){if(le=le.toString(),typeof le!="string")throw po("dirty is not a string, aborting")}else throw po("toString is not a function");if(!e.isSupported)return le;if(ve||me($),e.removed=[],typeof le=="string"&&(At=!1),At){if(le.nodeName){const rr=ce(le.nodeName);if(!P[rr]||q[rr])throw po("root node is forbidden and cannot be sanitized in-place")}}else if(le instanceof o)ee=an("<!---->"),ae=ee.ownerDocument.importNode(le,!0),ae.nodeType===mo.element&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?ee=ae:ee.appendChild(ae);else{if(!ut&&!re&&!_e&&le.indexOf("<")===-1)return E&&rn?E.createHTML(le):le;if(ee=an(le),!ee)return ut?null:rn?w:""}ee&&dt&&lt(ee.firstChild);const pt=at(At?le:ee);for(;Ze=pt.nextNode();)Rr(Ze),Mr(Ze),Ze.content instanceof s&&Zs(Ze.content);if(At)return le;if(ut){if(Me)for(bt=k.call(ee.ownerDocument);ee.firstChild;)bt.appendChild(ee.firstChild);else bt=ee;return(W.shadowroot||W.shadowrootmode)&&(bt=M.call(r,bt,!0)),bt}let Ot=_e?ee.outerHTML:ee.innerHTML;return _e&&P["!doctype"]&&ee.ownerDocument&&ee.ownerDocument.doctype&&ee.ownerDocument.doctype.name&&yn(rC,ee.ownerDocument.doctype.name)&&(Ot="<!DOCTYPE "+ee.ownerDocument.doctype.name+`>
`+Ot),re&&Zl([R,I,x],rr=>{Ot=fo(Ot,rr," ")}),E&&rn?E.createHTML(Ot):Ot},e.setConfig=function(){let le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};me(le),ve=!0},e.clearConfig=function(){de=null,ve=!1},e.isValidAttribute=function(le,$,ee){de||me({});const ae=ce(le),Ze=ce($);return si(ae,Ze,ee)},e.addHook=function(le,$){typeof $=="function"&&ho(S[le],$)},e.removeHook=function(le,$){if($!==void 0){const ee=_L(S[le],$);return ee===-1?void 0:CL(S[le],ee,1)[0]}return ib(S[le])},e.removeHooks=function(le){S[le]=[]},e.removeAllHooks=function(){S=cb()},e}var Uq=iC();function Wc(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function zL(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function p1(t){let e,n,r;t.length!==2?(e=Wc,n=(o,u)=>Wc(t(o),u),r=(o,u)=>t(o)-u):(e=t===Wc||t===zL?t:WL,n=t,r=t);function i(o,u,l=0,c=o.length){if(l<c){if(e(u,u)!==0)return c;do{const h=l+c>>>1;n(o[h],u)<0?l=h+1:c=h}while(l<c)}return l}function s(o,u,l=0,c=o.length){if(l<c){if(e(u,u)!==0)return c;do{const h=l+c>>>1;n(o[h],u)<=0?l=h+1:c=h}while(l<c)}return l}function a(o,u,l=0,c=o.length){const h=i(o,u,l,c-1);return h>l&&r(o[h-1],u)>-r(o[h],u)?h-1:h}return{left:i,center:a,right:s}}function WL(){return 0}function HL(t){return t===null?NaN:+t}const YL=p1(Wc),VL=YL.right;p1(HL).center;class hb extends Map{constructor(e,n=jL){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(fb(this,e))}has(e){return super.has(fb(this,e))}set(e,n){return super.set(qL(this,e),n)}delete(e){return super.delete(XL(this,e))}}function fb({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function qL({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function XL({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function jL(t){return t!==null&&typeof t=="object"?t.valueOf():t}const KL=Math.sqrt(50),JL=Math.sqrt(10),ZL=Math.sqrt(2);function Ph(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=KL?10:s>=JL?5:s>=ZL?2:1;let o,u,l;return i<0?(l=Math.pow(10,-i)/a,o=Math.round(t*l),u=Math.round(e*l),o/l<t&&++o,u/l>e&&--u,l=-l):(l=Math.pow(10,i)*a,o=Math.round(t/l),u=Math.round(e/l),o*l<t&&++o,u*l>e&&--u),u<o&&.5<=n&&n<2?Ph(t,e,n*2):[o,u,l]}function QL(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,a]=r?Ph(e,t,n):Ph(t,e,n);if(!(s>=i))return[];const o=s-i+1,u=new Array(o);if(r)if(a<0)for(let l=0;l<o;++l)u[l]=(s-l)/-a;else for(let l=0;l<o;++l)u[l]=(s-l)*a;else if(a<0)for(let l=0;l<o;++l)u[l]=(i+l)/-a;else for(let l=0;l<o;++l)u[l]=(i+l)*a;return u}function ig(t,e,n){return e=+e,t=+t,n=+n,Ph(t,e,n)[2]}function sg(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?ig(e,t,n):ig(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Gq(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function zq(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function e6(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}function t6(t){return t}var Hc=1,Dp=2,ag=3,ec=4,db=1e-6;function n6(t){return"translate("+t+",0)"}function r6(t){return"translate(0,"+t+")"}function i6(t){return e=>+t(e)}function s6(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function a6(){return!this.__axis}function sC(t,e){var n=[],r=null,i=null,s=6,a=6,o=3,u=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=t===Hc||t===ec?-1:1,c=t===ec||t===Dp?"x":"y",h=t===Hc||t===ag?n6:r6;function d(f){var p=r??(e.ticks?e.ticks.apply(e,n):e.domain()),g=i??(e.tickFormat?e.tickFormat.apply(e,n):t6),m=Math.max(s,0)+o,y=e.range(),b=+y[0]+u,v=+y[y.length-1]+u,E=(e.bandwidth?s6:i6)(e.copy(),u),w=f.selection?f.selection():f,N=w.selectAll(".domain").data([null]),D=w.selectAll(".tick").data(p,e).order(),k=D.exit(),F=D.enter().append("g").attr("class","tick"),M=D.select("line"),S=D.select("text");N=N.merge(N.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),D=D.merge(F),M=M.merge(F.append("line").attr("stroke","currentColor").attr(c+"2",l*s)),S=S.merge(F.append("text").attr("fill","currentColor").attr(c,l*m).attr("dy",t===Hc?"0em":t===ag?"0.71em":"0.32em")),f!==w&&(N=N.transition(f),D=D.transition(f),M=M.transition(f),S=S.transition(f),k=k.transition(f).attr("opacity",db).attr("transform",function(R){return isFinite(R=E(R))?h(R+u):this.getAttribute("transform")}),F.attr("opacity",db).attr("transform",function(R){var I=this.parentNode.__axis;return h((I&&isFinite(I=I(R))?I:E(R))+u)})),k.remove(),N.attr("d",t===ec||t===Dp?a?"M"+l*a+","+b+"H"+u+"V"+v+"H"+l*a:"M"+u+","+b+"V"+v:a?"M"+b+","+l*a+"V"+u+"H"+v+"V"+l*a:"M"+b+","+u+"H"+v),D.attr("opacity",1).attr("transform",function(R){return h(E(R)+u)}),M.attr(c+"2",l*s),S.attr(c,l*m).text(g),w.filter(a6).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Dp?"start":t===ec?"end":"middle"),w.each(function(){this.__axis=E})}return d.scale=function(f){return arguments.length?(e=f,d):e},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(f){return arguments.length?(n=f==null?[]:Array.from(f),d):n.slice()},d.tickValues=function(f){return arguments.length?(r=f==null?null:Array.from(f),d):r&&r.slice()},d.tickFormat=function(f){return arguments.length?(i=f,d):i},d.tickSize=function(f){return arguments.length?(s=a=+f,d):s},d.tickSizeInner=function(f){return arguments.length?(s=+f,d):s},d.tickSizeOuter=function(f){return arguments.length?(a=+f,d):a},d.tickPadding=function(f){return arguments.length?(o=+f,d):o},d.offset=function(f){return arguments.length?(u=+f,d):u},d}function Wq(t){return sC(Hc,t)}function Hq(t){return sC(ag,t)}var o6={value:()=>{}};function aC(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Yc(n)}function Yc(t){this._=t}function u6(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Yc.prototype=aC.prototype={constructor:Yc,on:function(t,e){var n=this._,r=u6(t+"",n),i,s=-1,a=r.length;if(arguments.length<2){for(;++s<a;)if((i=(t=r[s]).type)&&(i=l6(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(i=(t=r[s]).type)n[i]=pb(n[i],t.name,e);else if(e==null)for(i in n)n[i]=pb(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Yc(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function l6(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function pb(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=o6,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var og="http://www.w3.org/1999/xhtml";const gb={svg:"http://www.w3.org/2000/svg",xhtml:og,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ud(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),gb.hasOwnProperty(e)?{space:gb[e],local:t}:t}function c6(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===og&&e.documentElement.namespaceURI===og?e.createElement(t):e.createElementNS(n,t)}}function h6(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function oC(t){var e=ud(t);return(e.local?h6:c6)(e)}function f6(){}function g1(t){return t==null?f6:function(){return this.querySelector(t)}}function d6(t){typeof t!="function"&&(t=g1(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],a=s.length,o=r[i]=new Array(a),u,l,c=0;c<a;++c)(u=s[c])&&(l=t.call(u,u.__data__,c,s))&&("__data__"in u&&(l.__data__=u.__data__),o[c]=l);return new Qn(r,this._parents)}function p6(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function g6(){return[]}function uC(t){return t==null?g6:function(){return this.querySelectorAll(t)}}function m6(t){return function(){return p6(t.apply(this,arguments))}}function y6(t){typeof t=="function"?t=m6(t):t=uC(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var a=e[s],o=a.length,u,l=0;l<o;++l)(u=a[l])&&(r.push(t.call(u,u.__data__,l,a)),i.push(u));return new Qn(r,i)}function lC(t){return function(){return this.matches(t)}}function cC(t){return function(e){return e.matches(t)}}var v6=Array.prototype.find;function b6(t){return function(){return v6.call(this.children,t)}}function x6(){return this.firstElementChild}function E6(t){return this.select(t==null?x6:b6(typeof t=="function"?t:cC(t)))}var D6=Array.prototype.filter;function w6(){return Array.from(this.children)}function _6(t){return function(){return D6.call(this.children,t)}}function C6(t){return this.selectAll(t==null?w6:_6(typeof t=="function"?t:cC(t)))}function A6(t){typeof t!="function"&&(t=lC(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],a=s.length,o=r[i]=[],u,l=0;l<a;++l)(u=s[l])&&t.call(u,u.__data__,l,s)&&o.push(u);return new Qn(r,this._parents)}function hC(t){return new Array(t.length)}function T6(){return new Qn(this._enter||this._groups.map(hC),this._parents)}function $h(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}$h.prototype={constructor:$h,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function k6(t){return function(){return t}}function S6(t,e,n,r,i,s){for(var a=0,o,u=e.length,l=s.length;a<l;++a)(o=e[a])?(o.__data__=s[a],r[a]=o):n[a]=new $h(t,s[a]);for(;a<u;++a)(o=e[a])&&(i[a]=o)}function N6(t,e,n,r,i,s,a){var o,u,l=new Map,c=e.length,h=s.length,d=new Array(c),f;for(o=0;o<c;++o)(u=e[o])&&(d[o]=f=a.call(u,u.__data__,o,e)+"",l.has(f)?i[o]=u:l.set(f,u));for(o=0;o<h;++o)f=a.call(t,s[o],o,s)+"",(u=l.get(f))?(r[o]=u,u.__data__=s[o],l.delete(f)):n[o]=new $h(t,s[o]);for(o=0;o<c;++o)(u=e[o])&&l.get(d[o])===u&&(i[o]=u)}function F6(t){return t.__data__}function R6(t,e){if(!arguments.length)return Array.from(this,F6);var n=e?N6:S6,r=this._parents,i=this._groups;typeof t!="function"&&(t=k6(t));for(var s=i.length,a=new Array(s),o=new Array(s),u=new Array(s),l=0;l<s;++l){var c=r[l],h=i[l],d=h.length,f=M6(t.call(c,c&&c.__data__,l,r)),p=f.length,g=o[l]=new Array(p),m=a[l]=new Array(p),y=u[l]=new Array(d);n(c,h,g,m,y,f,e);for(var b=0,v=0,E,w;b<p;++b)if(E=g[b]){for(b>=v&&(v=b+1);!(w=m[v])&&++v<p;);E._next=w||null}}return a=new Qn(a,r),a._enter=o,a._exit=u,a}function M6(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function O6(){return new Qn(this._exit||this._groups.map(hC),this._parents)}function I6(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function L6(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,a=Math.min(i,s),o=new Array(i),u=0;u<a;++u)for(var l=n[u],c=r[u],h=l.length,d=o[u]=new Array(h),f,p=0;p<h;++p)(f=l[p]||c[p])&&(d[p]=f);for(;u<i;++u)o[u]=n[u];return new Qn(o,this._parents)}function P6(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],a;--i>=0;)(a=r[i])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function $6(t){t||(t=B6);function e(h,d){return h&&d?t(h.__data__,d.__data__):!h-!d}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var a=n[s],o=a.length,u=i[s]=new Array(o),l,c=0;c<o;++c)(l=a[c])&&(u[c]=l);u.sort(e)}return new Qn(i,this._parents).order()}function B6(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function U6(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function G6(){return Array.from(this)}function z6(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var a=r[i];if(a)return a}return null}function W6(){let t=0;for(const e of this)++t;return t}function H6(){return!this.node()}function Y6(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,a=i.length,o;s<a;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function V6(t){return function(){this.removeAttribute(t)}}function q6(t){return function(){this.removeAttributeNS(t.space,t.local)}}function X6(t,e){return function(){this.setAttribute(t,e)}}function j6(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function K6(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function J6(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Z6(t,e){var n=ud(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?q6:V6:typeof e=="function"?n.local?J6:K6:n.local?j6:X6)(n,e))}function fC(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Q6(t){return function(){this.style.removeProperty(t)}}function eP(t,e,n){return function(){this.style.setProperty(t,e,n)}}function tP(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function nP(t,e,n){return arguments.length>1?this.each((e==null?Q6:typeof e=="function"?tP:eP)(t,e,n??"")):za(this.node(),t)}function za(t,e){return t.style.getPropertyValue(e)||fC(t).getComputedStyle(t,null).getPropertyValue(e)}function rP(t){return function(){delete this[t]}}function iP(t,e){return function(){this[t]=e}}function sP(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function aP(t,e){return arguments.length>1?this.each((e==null?rP:typeof e=="function"?sP:iP)(t,e)):this.node()[t]}function dC(t){return t.trim().split(/^|\s+/)}function m1(t){return t.classList||new pC(t)}function pC(t){this._node=t,this._names=dC(t.getAttribute("class")||"")}pC.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function gC(t,e){for(var n=m1(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function mC(t,e){for(var n=m1(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function oP(t){return function(){gC(this,t)}}function uP(t){return function(){mC(this,t)}}function lP(t,e){return function(){(e.apply(this,arguments)?gC:mC)(this,t)}}function cP(t,e){var n=dC(t+"");if(arguments.length<2){for(var r=m1(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?lP:e?oP:uP)(n,e))}function hP(){this.textContent=""}function fP(t){return function(){this.textContent=t}}function dP(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function pP(t){return arguments.length?this.each(t==null?hP:(typeof t=="function"?dP:fP)(t)):this.node().textContent}function gP(){this.innerHTML=""}function mP(t){return function(){this.innerHTML=t}}function yP(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function vP(t){return arguments.length?this.each(t==null?gP:(typeof t=="function"?yP:mP)(t)):this.node().innerHTML}function bP(){this.nextSibling&&this.parentNode.appendChild(this)}function xP(){return this.each(bP)}function EP(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function DP(){return this.each(EP)}function wP(t){var e=typeof t=="function"?t:oC(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function _P(){return null}function CP(t,e){var n=typeof t=="function"?t:oC(t),r=e==null?_P:typeof e=="function"?e:g1(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function AP(){var t=this.parentNode;t&&t.removeChild(this)}function TP(){return this.each(AP)}function kP(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function SP(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function NP(t){return this.select(t?SP:kP)}function FP(t){return arguments.length?this.property("__data__",t):this.node().__data__}function RP(t){return function(e){t.call(this,e,this.__data__)}}function MP(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function OP(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function IP(t,e,n){return function(){var r=this.__on,i,s=RP(e);if(r){for(var a=0,o=r.length;a<o;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function LP(t,e,n){var r=MP(t+""),i,s=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var u=0,l=o.length,c;u<l;++u)for(i=0,c=o[u];i<s;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(o=e?IP:OP,i=0;i<s;++i)this.each(o(r[i],e,n));return this}function yC(t,e,n){var r=fC(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function PP(t,e){return function(){return yC(this,t,e)}}function $P(t,e){return function(){return yC(this,t,e.apply(this,arguments))}}function BP(t,e){return this.each((typeof e=="function"?$P:PP)(t,e))}function*UP(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,a;i<s;++i)(a=r[i])&&(yield a)}var vC=[null];function Qn(t,e){this._groups=t,this._parents=e}function xl(){return new Qn([[document.documentElement]],vC)}function GP(){return this}Qn.prototype=xl.prototype={constructor:Qn,select:d6,selectAll:y6,selectChild:E6,selectChildren:C6,filter:A6,data:R6,enter:T6,exit:O6,join:I6,merge:L6,selection:GP,order:P6,sort:$6,call:U6,nodes:G6,node:z6,size:W6,empty:H6,each:Y6,attr:Z6,style:nP,property:aP,classed:cP,text:pP,html:vP,raise:xP,lower:DP,append:wP,insert:CP,remove:TP,clone:NP,datum:FP,on:LP,dispatch:BP,[Symbol.iterator]:UP};function Yq(t){return typeof t=="string"?new Qn([[document.querySelector(t)]],[document.documentElement]):new Qn([[t]],vC)}function El(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ld(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ys(){}var Ju=.7,Bh=1/Ju,Sa="\\s*([+-]?\\d+)\\s*",Zu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zP=/^#([0-9a-f]{3,8})$/,WP=new RegExp(`^rgb\\(${Sa},${Sa},${Sa}\\)$`),HP=new RegExp(`^rgb\\(${qr},${qr},${qr}\\)$`),YP=new RegExp(`^rgba\\(${Sa},${Sa},${Sa},${Zu}\\)$`),VP=new RegExp(`^rgba\\(${qr},${qr},${qr},${Zu}\\)$`),qP=new RegExp(`^hsl\\(${Zu},${qr},${qr}\\)$`),XP=new RegExp(`^hsla\\(${Zu},${qr},${qr},${Zu}\\)$`),mb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};El(Ys,Ms,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:yb,formatHex:yb,formatHex8:jP,formatHsl:KP,formatRgb:vb,toString:vb});function yb(){return this.rgb().formatHex()}function jP(){return this.rgb().formatHex8()}function KP(){return xC(this).formatHsl()}function vb(){return this.rgb().formatRgb()}function Ms(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=zP.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?bb(e):n===3?new fn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?tc(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?tc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=WP.exec(t))?new fn(e[1],e[2],e[3],1):(e=HP.exec(t))?new fn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=YP.exec(t))?tc(e[1],e[2],e[3],e[4]):(e=VP.exec(t))?tc(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=qP.exec(t))?Db(e[1],e[2]/100,e[3]/100,1):(e=XP.exec(t))?Db(e[1],e[2]/100,e[3]/100,e[4]):mb.hasOwnProperty(t)?bb(mb[t]):t==="transparent"?new fn(NaN,NaN,NaN,0):null}function bb(t){return new fn(t>>16&255,t>>8&255,t&255,1)}function tc(t,e,n,r){return r<=0&&(t=e=n=NaN),new fn(t,e,n,r)}function bC(t){return t instanceof Ys||(t=Ms(t)),t?(t=t.rgb(),new fn(t.r,t.g,t.b,t.opacity)):new fn}function ug(t,e,n,r){return arguments.length===1?bC(t):new fn(t,e,n,r??1)}function fn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}El(fn,ug,ld(Ys,{brighter(t){return t=t==null?Bh:Math.pow(Bh,t),new fn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Ju:Math.pow(Ju,t),new fn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new fn(Ns(this.r),Ns(this.g),Ns(this.b),Uh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xb,formatHex:xb,formatHex8:JP,formatRgb:Eb,toString:Eb}));function xb(){return`#${Es(this.r)}${Es(this.g)}${Es(this.b)}`}function JP(){return`#${Es(this.r)}${Es(this.g)}${Es(this.b)}${Es((isNaN(this.opacity)?1:this.opacity)*255)}`}function Eb(){const t=Uh(this.opacity);return`${t===1?"rgb(":"rgba("}${Ns(this.r)}, ${Ns(this.g)}, ${Ns(this.b)}${t===1?")":`, ${t})`}`}function Uh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ns(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Es(t){return t=Ns(t),(t<16?"0":"")+t.toString(16)}function Db(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new br(t,e,n,r)}function xC(t){if(t instanceof br)return new br(t.h,t.s,t.l,t.opacity);if(t instanceof Ys||(t=Ms(t)),!t)return new br;if(t instanceof br)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),a=NaN,o=s-i,u=(s+i)/2;return o?(e===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-e)/o+2:a=(e-n)/o+4,o/=u<.5?s+i:2-s-i,a*=60):o=u>0&&u<1?0:a,new br(a,o,u,t.opacity)}function ZP(t,e,n,r){return arguments.length===1?xC(t):new br(t,e,n,r??1)}function br(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}El(br,ZP,ld(Ys,{brighter(t){return t=t==null?Bh:Math.pow(Bh,t),new br(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ju:Math.pow(Ju,t),new br(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new fn(wp(t>=240?t-240:t+120,i,r),wp(t,i,r),wp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new br(wb(this.h),nc(this.s),nc(this.l),Uh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Uh(this.opacity);return`${t===1?"hsl(":"hsla("}${wb(this.h)}, ${nc(this.s)*100}%, ${nc(this.l)*100}%${t===1?")":`, ${t})`}`}}));function wb(t){return t=(t||0)%360,t<0?t+360:t}function nc(t){return Math.max(0,Math.min(1,t||0))}function wp(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const QP=Math.PI/180,e8=180/Math.PI,Gh=18,EC=.96422,DC=1,wC=.82521,_C=4/29,Na=6/29,CC=3*Na*Na,t8=Na*Na*Na;function AC(t){if(t instanceof Xr)return new Xr(t.l,t.a,t.b,t.opacity);if(t instanceof mi)return TC(t);t instanceof fn||(t=bC(t));var e=Tp(t.r),n=Tp(t.g),r=Tp(t.b),i=_p((.2225045*e+.7168786*n+.0606169*r)/DC),s,a;return e===n&&n===r?s=a=i:(s=_p((.4360747*e+.3850649*n+.1430804*r)/EC),a=_p((.0139322*e+.0971045*n+.7141733*r)/wC)),new Xr(116*i-16,500*(s-i),200*(i-a),t.opacity)}function n8(t,e,n,r){return arguments.length===1?AC(t):new Xr(t,e,n,r??1)}function Xr(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}El(Xr,n8,ld(Ys,{brighter(t){return new Xr(this.l+Gh*(t??1),this.a,this.b,this.opacity)},darker(t){return new Xr(this.l-Gh*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=EC*Cp(e),t=DC*Cp(t),n=wC*Cp(n),new fn(Ap(3.1338561*e-1.6168667*t-.4906146*n),Ap(-.9787684*e+1.9161415*t+.033454*n),Ap(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function _p(t){return t>t8?Math.pow(t,1/3):t/CC+_C}function Cp(t){return t>Na?t*t*t:CC*(t-_C)}function Ap(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Tp(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function r8(t){if(t instanceof mi)return new mi(t.h,t.c,t.l,t.opacity);if(t instanceof Xr||(t=AC(t)),t.a===0&&t.b===0)return new mi(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*e8;return new mi(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function lg(t,e,n,r){return arguments.length===1?r8(t):new mi(t,e,n,r??1)}function mi(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function TC(t){if(isNaN(t.h))return new Xr(t.l,0,0,t.opacity);var e=t.h*QP;return new Xr(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}El(mi,lg,ld(Ys,{brighter(t){return new mi(this.h,this.c,this.l+Gh*(t??1),this.opacity)},darker(t){return new mi(this.h,this.c,this.l-Gh*(t??1),this.opacity)},rgb(){return TC(this).rgb()}}));const cd=t=>()=>t;function kC(t,e){return function(n){return t+n*e}}function i8(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function s8(t,e){var n=e-t;return n?kC(t,n>180||n<-180?n-360*Math.round(n/360):n):cd(isNaN(t)?e:t)}function a8(t){return(t=+t)==1?Mu:function(e,n){return n-e?i8(e,n,t):cd(isNaN(e)?n:e)}}function Mu(t,e){var n=e-t;return n?kC(t,n):cd(isNaN(t)?e:t)}const zh=function t(e){var n=a8(e);function r(i,s){var a=n((i=ug(i)).r,(s=ug(s)).r),o=n(i.g,s.g),u=n(i.b,s.b),l=Mu(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=t,r}(1);function o8(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function u8(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function l8(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=y1(t[a],e[a]);for(;a<n;++a)s[a]=e[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function c8(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function mr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function h8(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=y1(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var cg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,kp=new RegExp(cg.source,"g");function f8(t){return function(){return t}}function d8(t){return function(e){return t(e)+""}}function SC(t,e){var n=cg.lastIndex=kp.lastIndex=0,r,i,s,a=-1,o=[],u=[];for(t=t+"",e=e+"";(r=cg.exec(t))&&(i=kp.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,u.push({i:a,x:mr(r,i)})),n=kp.lastIndex;return n<e.length&&(s=e.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?u[0]?d8(u[0].x):f8(e):(e=u.length,function(l){for(var c=0,h;c<e;++c)o[(h=u[c]).i]=h.x(l);return o.join("")})}function y1(t,e){var n=typeof e,r;return e==null||n==="boolean"?cd(e):(n==="number"?mr:n==="string"?(r=Ms(e))?(e=r,zh):SC:e instanceof Ms?zh:e instanceof Date?c8:u8(e)?o8:Array.isArray(e)?l8:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?h8:mr)(t,e)}function p8(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var _b=180/Math.PI,hg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function NC(t,e,n,r,i,s){var a,o,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,u/=o),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*_b,skewX:Math.atan(u)*_b,scaleX:a,scaleY:o}}var rc;function g8(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?hg:NC(e.a,e.b,e.c,e.d,e.e,e.f)}function m8(t){return t==null||(rc||(rc=document.createElementNS("http://www.w3.org/2000/svg","g")),rc.setAttribute("transform",t),!(t=rc.transform.baseVal.consolidate()))?hg:(t=t.matrix,NC(t.a,t.b,t.c,t.d,t.e,t.f))}function FC(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,c,h,d,f,p){if(l!==h||c!==d){var g=f.push("translate(",null,e,null,n);p.push({i:g-4,x:mr(l,h)},{i:g-2,x:mr(c,d)})}else(h||d)&&f.push("translate("+h+e+d+n)}function a(l,c,h,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:h.push(i(h)+"rotate(",null,r)-2,x:mr(l,c)})):c&&h.push(i(h)+"rotate("+c+r)}function o(l,c,h,d){l!==c?d.push({i:h.push(i(h)+"skewX(",null,r)-2,x:mr(l,c)}):c&&h.push(i(h)+"skewX("+c+r)}function u(l,c,h,d,f,p){if(l!==h||c!==d){var g=f.push(i(f)+"scale(",null,",",null,")");p.push({i:g-4,x:mr(l,h)},{i:g-2,x:mr(c,d)})}else(h!==1||d!==1)&&f.push(i(f)+"scale("+h+","+d+")")}return function(l,c){var h=[],d=[];return l=t(l),c=t(c),s(l.translateX,l.translateY,c.translateX,c.translateY,h,d),a(l.rotate,c.rotate,h,d),o(l.skewX,c.skewX,h,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,h,d),l=c=null,function(f){for(var p=-1,g=d.length,m;++p<g;)h[(m=d[p]).i]=m.x(f);return h.join("")}}}var y8=FC(g8,"px, ","px)","deg)"),v8=FC(m8,", ",")",")");function b8(t){return function(e,n){var r=t((e=lg(e)).h,(n=lg(n)).h),i=Mu(e.c,n.c),s=Mu(e.l,n.l),a=Mu(e.opacity,n.opacity);return function(o){return e.h=r(o),e.c=i(o),e.l=s(o),e.opacity=a(o),e+""}}}const Vq=b8(s8);var Wa=0,zo=0,yo=0,RC=1e3,Wh,Wo,Hh=0,Os=0,hd=0,Qu=typeof performance=="object"&&performance.now?performance:Date,MC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function v1(){return Os||(MC(x8),Os=Qu.now()+hd)}function x8(){Os=0}function Yh(){this._call=this._time=this._next=null}Yh.prototype=OC.prototype={constructor:Yh,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?v1():+n)+(e==null?0:+e),!this._next&&Wo!==this&&(Wo?Wo._next=this:Wh=this,Wo=this),this._call=t,this._time=n,fg()},stop:function(){this._call&&(this._call=null,this._time=1/0,fg())}};function OC(t,e,n){var r=new Yh;return r.restart(t,e,n),r}function E8(){v1(),++Wa;for(var t=Wh,e;t;)(e=Os-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Wa}function Cb(){Os=(Hh=Qu.now())+hd,Wa=zo=0;try{E8()}finally{Wa=0,w8(),Os=0}}function D8(){var t=Qu.now(),e=t-Hh;e>RC&&(hd-=e,Hh=t)}function w8(){for(var t,e=Wh,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Wh=n);Wo=t,fg(r)}function fg(t){if(!Wa){zo&&(zo=clearTimeout(zo));var e=t-Os;e>24?(t<1/0&&(zo=setTimeout(Cb,t-Qu.now()-hd)),yo&&(yo=clearInterval(yo))):(yo||(Hh=Qu.now(),yo=setInterval(D8,RC)),Wa=1,MC(Cb))}}function Ab(t,e,n){var r=new Yh;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var _8=aC("start","end","cancel","interrupt"),C8=[],IC=0,Tb=1,dg=2,Vc=3,kb=4,pg=5,qc=6;function fd(t,e,n,r,i,s){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;A8(t,n,{name:e,index:r,group:i,on:_8,tween:C8,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:IC})}function b1(t,e){var n=Nr(t,e);if(n.state>IC)throw new Error("too late; already scheduled");return n}function ti(t,e){var n=Nr(t,e);if(n.state>Vc)throw new Error("too late; already running");return n}function Nr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function A8(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=OC(s,0,n.time);function s(l){n.state=Tb,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var c,h,d,f;if(n.state!==Tb)return u();for(c in r)if(f=r[c],f.name===n.name){if(f.state===Vc)return Ab(a);f.state===kb?(f.state=qc,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete r[c]):+c<e&&(f.state=qc,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete r[c])}if(Ab(function(){n.state===Vc&&(n.state=kb,n.timer.restart(o,n.delay,n.time),o(l))}),n.state=dg,n.on.call("start",t,t.__data__,n.index,n.group),n.state===dg){for(n.state=Vc,i=new Array(d=n.tween.length),c=0,h=-1;c<d;++c)(f=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=f);i.length=h+1}}function o(l){for(var c=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(u),n.state=pg,1),h=-1,d=i.length;++h<d;)i[h].call(t,c);n.state===pg&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=qc,n.timer.stop(),delete r[e];for(var l in r)return;delete t.__transition}}function T8(t,e){var n=t.__transition,r,i,s=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){s=!1;continue}i=r.state>dg&&r.state<pg,r.state=qc,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}s&&delete t.__transition}}function k8(t){return this.each(function(){T8(this,t)})}function S8(t,e){var n,r;return function(){var i=ti(this,t),s=i.tween;if(s!==n){r=n=s;for(var a=0,o=r.length;a<o;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function N8(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=ti(this,t),a=s.tween;if(a!==r){i=(r=a).slice();for(var o={name:e,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===e){i[u]=o;break}u===l&&i.push(o)}s.tween=i}}function F8(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Nr(this.node(),n).tween,i=0,s=r.length,a;i<s;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?S8:N8)(n,t,e))}function x1(t,e,n){var r=t._id;return t.each(function(){var i=ti(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Nr(i,r).value[e]}}function LC(t,e){var n;return(typeof e=="number"?mr:e instanceof Ms?zh:(n=Ms(e))?(e=n,zh):SC)(t,e)}function R8(t){return function(){this.removeAttribute(t)}}function M8(t){return function(){this.removeAttributeNS(t.space,t.local)}}function O8(t,e,n){var r,i=n+"",s;return function(){var a=this.getAttribute(t);return a===i?null:a===r?s:s=e(r=a,n)}}function I8(t,e,n){var r,i=n+"",s;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?s:s=e(r=a,n)}}function L8(t,e,n){var r,i,s;return function(){var a,o=n(this),u;return o==null?void this.removeAttribute(t):(a=this.getAttribute(t),u=o+"",a===u?null:a===r&&u===i?s:(i=u,s=e(r=a,o)))}}function P8(t,e,n){var r,i,s;return function(){var a,o=n(this),u;return o==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),u=o+"",a===u?null:a===r&&u===i?s:(i=u,s=e(r=a,o)))}}function $8(t,e){var n=ud(t),r=n==="transform"?v8:LC;return this.attrTween(t,typeof e=="function"?(n.local?P8:L8)(n,r,x1(this,"attr."+t,e)):e==null?(n.local?M8:R8)(n):(n.local?I8:O8)(n,r,e))}function B8(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function U8(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function G8(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&U8(t,s)),n}return i._value=e,i}function z8(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&B8(t,s)),n}return i._value=e,i}function W8(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=ud(t);return this.tween(n,(r.local?G8:z8)(r,e))}function H8(t,e){return function(){b1(this,t).delay=+e.apply(this,arguments)}}function Y8(t,e){return e=+e,function(){b1(this,t).delay=e}}function V8(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?H8:Y8)(e,t)):Nr(this.node(),e).delay}function q8(t,e){return function(){ti(this,t).duration=+e.apply(this,arguments)}}function X8(t,e){return e=+e,function(){ti(this,t).duration=e}}function j8(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?q8:X8)(e,t)):Nr(this.node(),e).duration}function K8(t,e){if(typeof e!="function")throw new Error;return function(){ti(this,t).ease=e}}function J8(t){var e=this._id;return arguments.length?this.each(K8(e,t)):Nr(this.node(),e).ease}function Z8(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ti(this,t).ease=n}}function Q8(t){if(typeof t!="function")throw new Error;return this.each(Z8(this._id,t))}function e4(t){typeof t!="function"&&(t=lC(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],a=s.length,o=r[i]=[],u,l=0;l<a;++l)(u=s[l])&&t.call(u,u.__data__,l,s)&&o.push(u);return new wi(r,this._parents,this._name,this._id)}function t4(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),a=new Array(r),o=0;o<s;++o)for(var u=e[o],l=n[o],c=u.length,h=a[o]=new Array(c),d,f=0;f<c;++f)(d=u[f]||l[f])&&(h[f]=d);for(;o<r;++o)a[o]=e[o];return new wi(a,this._parents,this._name,this._id)}function n4(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function r4(t,e,n){var r,i,s=n4(e)?b1:ti;return function(){var a=s(this,t),o=a.on;o!==r&&(i=(r=o).copy()).on(e,n),a.on=i}}function i4(t,e){var n=this._id;return arguments.length<2?Nr(this.node(),n).on.on(t):this.each(r4(n,t,e))}function s4(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function a4(){return this.on("end.remove",s4(this._id))}function o4(t){var e=this._name,n=this._id;typeof t!="function"&&(t=g1(t));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var o=r[a],u=o.length,l=s[a]=new Array(u),c,h,d=0;d<u;++d)(c=o[d])&&(h=t.call(c,c.__data__,d,o))&&("__data__"in c&&(h.__data__=c.__data__),l[d]=h,fd(l[d],e,n,d,l,Nr(c,n)));return new wi(s,this._parents,e,n)}function u4(t){var e=this._name,n=this._id;typeof t!="function"&&(t=uC(t));for(var r=this._groups,i=r.length,s=[],a=[],o=0;o<i;++o)for(var u=r[o],l=u.length,c,h=0;h<l;++h)if(c=u[h]){for(var d=t.call(c,c.__data__,h,u),f,p=Nr(c,n),g=0,m=d.length;g<m;++g)(f=d[g])&&fd(f,e,n,g,d,p);s.push(d),a.push(c)}return new wi(s,a,e,n)}var l4=xl.prototype.constructor;function c4(){return new l4(this._groups,this._parents)}function h4(t,e){var n,r,i;return function(){var s=za(this,t),a=(this.style.removeProperty(t),za(this,t));return s===a?null:s===n&&a===r?i:i=e(n=s,r=a)}}function PC(t){return function(){this.style.removeProperty(t)}}function f4(t,e,n){var r,i=n+"",s;return function(){var a=za(this,t);return a===i?null:a===r?s:s=e(r=a,n)}}function d4(t,e,n){var r,i,s;return function(){var a=za(this,t),o=n(this),u=o+"";return o==null&&(u=o=(this.style.removeProperty(t),za(this,t))),a===u?null:a===r&&u===i?s:(i=u,s=e(r=a,o))}}function p4(t,e){var n,r,i,s="style."+e,a="end."+s,o;return function(){var u=ti(this,t),l=u.on,c=u.value[s]==null?o||(o=PC(e)):void 0;(l!==n||i!==c)&&(r=(n=l).copy()).on(a,i=c),u.on=r}}function g4(t,e,n){var r=(t+="")=="transform"?y8:LC;return e==null?this.styleTween(t,h4(t,r)).on("end.style."+t,PC(t)):typeof e=="function"?this.styleTween(t,d4(t,r,x1(this,"style."+t,e))).each(p4(this._id,t)):this.styleTween(t,f4(t,r,e),n).on("end.style."+t,null)}function m4(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function y4(t,e,n){var r,i;function s(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&m4(t,a,n)),r}return s._value=e,s}function v4(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,y4(t,e,n??""))}function b4(t){return function(){this.textContent=t}}function x4(t){return function(){var e=t(this);this.textContent=e??""}}function E4(t){return this.tween("text",typeof t=="function"?x4(x1(this,"text",t)):b4(t==null?"":t+""))}function D4(t){return function(e){this.textContent=t.call(this,e)}}function w4(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&D4(i)),e}return r._value=t,r}function _4(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,w4(t))}function C4(){for(var t=this._name,e=this._id,n=$C(),r=this._groups,i=r.length,s=0;s<i;++s)for(var a=r[s],o=a.length,u,l=0;l<o;++l)if(u=a[l]){var c=Nr(u,e);fd(u,t,n,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new wi(r,this._parents,t,n)}function A4(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,a){var o={value:a},u={value:function(){--i===0&&s()}};n.each(function(){var l=ti(this,r),c=l.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(u)),l.on=e}),i===0&&s()})}var T4=0;function wi(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function $C(){return++T4}var li=xl.prototype;wi.prototype={constructor:wi,select:o4,selectAll:u4,selectChild:li.selectChild,selectChildren:li.selectChildren,filter:e4,merge:t4,selection:c4,transition:C4,call:li.call,nodes:li.nodes,node:li.node,size:li.size,empty:li.empty,each:li.each,on:i4,attr:$8,attrTween:W8,style:g4,styleTween:v4,text:E4,textTween:_4,remove:a4,tween:F8,delay:V8,duration:j8,ease:J8,easeVarying:Q8,end:A4,[Symbol.iterator]:li[Symbol.iterator]};function k4(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var S4={time:null,delay:0,duration:250,ease:k4};function N4(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function F4(t){var e,n;t instanceof wi?(e=t._id,t=t._name):(e=$C(),(n=S4).time=v1(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var a=r[s],o=a.length,u,l=0;l<o;++l)(u=a[l])&&fd(u,t,e,l,a,n||N4(u,e));return new wi(r,this._parents,t,e)}xl.prototype.interrupt=k8;xl.prototype.transition=F4;const gg=Math.PI,mg=2*gg,hs=1e-6,R4=mg-hs;function BC(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function M4(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return BC;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let O4=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?BC:M4(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,u=r-e,l=i-n,c=a-e,h=o-n,d=c*c+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(d>hs)if(!(Math.abs(h*u-l*c)>hs)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let f=r-a,p=i-o,g=u*u+l*l,m=f*f+p*p,y=Math.sqrt(g),b=Math.sqrt(d),v=s*Math.tan((gg-Math.acos((g+d-m)/(2*y*b)))/2),E=v/b,w=v/y;Math.abs(E-1)>hs&&this._append`L${e+E*c},${n+E*h}`,this._append`A${s},${s},0,0,${+(h*f>c*p)},${this._x1=e+w*u},${this._y1=n+w*l}`}}arc(e,n,r,i,s,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),u=r*Math.sin(i),l=e+o,c=n+u,h=1^a,d=a?i-s:s-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>hs||Math.abs(this._y1-c)>hs)&&this._append`L${l},${c}`,r&&(d<0&&(d=d%mg+mg),d>R4?this._append`A${r},${r},0,1,${h},${e-o},${n-u}A${r},${r},0,1,${h},${this._x1=l},${this._y1=c}`:d>hs&&this._append`A${r},${r},0,${+(d>=gg)},${h},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function I4(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Vh(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Ha(t){return t=Vh(Math.abs(t)),t?t[1]:NaN}function L4(t,e){return function(n,r){for(var i=n.length,s=[],a=0,o=t[0],u=0;i>0&&o>0&&(u+o+1>r&&(o=Math.max(1,r-u)),s.push(n.substring(i-=o,i+o)),!((u+=o+1)>r));)o=t[a=(a+1)%t.length];return s.reverse().join(e)}}function P4(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var $4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qh(t){if(!(e=$4.exec(t)))throw new Error("invalid format: "+t);var e;return new E1({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}qh.prototype=E1.prototype;function E1(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}E1.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function B4(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var UC;function U4(t,e){var n=Vh(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(UC=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+Vh(t,Math.max(0,e+s-1))[0]}function Sb(t,e){var n=Vh(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Nb={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:I4,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Sb(t*100,e),r:Sb,s:U4,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Fb(t){return t}var Rb=Array.prototype.map,Mb=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function G4(t){var e=t.grouping===void 0||t.thousands===void 0?Fb:L4(Rb.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Fb:P4(Rb.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function l(h){h=qh(h);var d=h.fill,f=h.align,p=h.sign,g=h.symbol,m=h.zero,y=h.width,b=h.comma,v=h.precision,E=h.trim,w=h.type;w==="n"?(b=!0,w="g"):Nb[w]||(v===void 0&&(v=12),E=!0,w="g"),(m||d==="0"&&f==="=")&&(m=!0,d="0",f="=");var N=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",D=g==="$"?r:/[%p]/.test(w)?a:"",k=Nb[w],F=/[defgprs%]/.test(w);v=v===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function M(S){var R=N,I=D,x,_,C;if(w==="c")I=k(S)+I,S="";else{S=+S;var A=S<0||1/S<0;if(S=isNaN(S)?u:k(Math.abs(S),v),E&&(S=B4(S)),A&&+S==0&&p!=="+"&&(A=!1),R=(A?p==="("?p:o:p==="-"||p==="("?"":p)+R,I=(w==="s"?Mb[8+UC/3]:"")+I+(A&&p==="("?")":""),F){for(x=-1,_=S.length;++x<_;)if(C=S.charCodeAt(x),48>C||C>57){I=(C===46?i+S.slice(x+1):S.slice(x))+I,S=S.slice(0,x);break}}}b&&!m&&(S=e(S,1/0));var T=R.length+S.length+I.length,O=T<y?new Array(y-T+1).join(d):"";switch(b&&m&&(S=e(O+S,O.length?y-I.length:1/0),O=""),f){case"<":S=R+S+I+O;break;case"=":S=R+O+S+I;break;case"^":S=O.slice(0,T=O.length>>1)+R+S+I+O.slice(T);break;default:S=O+R+S+I;break}return s(S)}return M.toString=function(){return h+""},M}function c(h,d){var f=l((h=qh(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(Ha(d)/3)))*3,g=Math.pow(10,-p),m=Mb[8+p/3];return function(y){return f(g*y)+m}}return{format:l,formatPrefix:c}}var ic,GC,zC;z4({thousands:",",grouping:[3],currency:["$",""]});function z4(t){return ic=G4(t),GC=ic.format,zC=ic.formatPrefix,ic}function W4(t){return Math.max(0,-Ha(Math.abs(t)))}function H4(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ha(e)/3)))*3-Ha(Math.abs(t)))}function Y4(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ha(e)-Ha(t))+1}function V4(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function q4(){return this.eachAfter(V4)}function X4(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function j4(t,e){for(var n=this,r=[n],i,s,a=-1;n=r.pop();)if(t.call(e,n,++a,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function K4(t,e){for(var n=this,r=[n],i=[],s,a,o,u=-1;n=r.pop();)if(i.push(n),s=n.children)for(a=0,o=s.length;a<o;++a)r.push(s[a]);for(;n=i.pop();)t.call(e,n,++u,this);return this}function J4(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function Z4(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function Q4(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function e5(t){for(var e=this,n=t5(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function t5(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function n5(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function r5(){return Array.from(this)}function i5(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function s5(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*a5(){var t=this,e,n=[t],r,i,s;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);while(n.length)}function WC(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=l5)):e===void 0&&(e=u5);for(var n=new Xh(t),r,i=[n],s,a,o,u;r=i.pop();)if((a=e(r.data))&&(u=(a=Array.from(a)).length))for(r.children=a,o=u-1;o>=0;--o)i.push(s=a[o]=new Xh(a[o])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(h5)}function o5(){return WC(this).eachBefore(c5)}function u5(t){return t.children}function l5(t){return Array.isArray(t)?t[1]:null}function c5(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function h5(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Xh(t){this.data=t,this.depth=this.height=0,this.parent=null}Xh.prototype=WC.prototype={constructor:Xh,count:q4,each:X4,eachAfter:K4,eachBefore:j4,find:J4,sum:Z4,sort:Q4,path:e5,ancestors:n5,descendants:r5,leaves:i5,links:s5,copy:o5,[Symbol.iterator]:a5};function f5(t){if(typeof t!="function")throw new Error;return t}function vo(){return 0}function bo(t){return function(){return t}}function d5(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function p5(t,e,n,r,i){for(var s=t.children,a,o=-1,u=s.length,l=t.value&&(r-e)/t.value;++o<u;)a=s[o],a.y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*l}function g5(t,e,n,r,i){for(var s=t.children,a,o=-1,u=s.length,l=t.value&&(i-n)/t.value;++o<u;)a=s[o],a.x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*l}var m5=(1+Math.sqrt(5))/2;function y5(t,e,n,r,i,s){for(var a=[],o=e.children,u,l,c=0,h=0,d=o.length,f,p,g=e.value,m,y,b,v,E,w,N;c<d;){f=i-n,p=s-r;do m=o[h++].value;while(!m&&h<d);for(y=b=m,w=Math.max(p/f,f/p)/(g*t),N=m*m*w,E=Math.max(b/N,N/y);h<d;++h){if(m+=l=o[h].value,l<y&&(y=l),l>b&&(b=l),N=m*m*w,v=Math.max(b/N,N/y),v>E){m-=l;break}E=v}a.push(u={value:m,dice:f<p,children:o.slice(c,h)}),u.dice?p5(u,n,r,i,g?r+=p*m/g:s):g5(u,n,r,g?n+=f*m/g:i,s),g-=m,c=h}return a}const v5=function t(e){function n(r,i,s,a,o){y5(e,r,i,s,a,o)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(m5);function Xq(){var t=v5,e=!1,n=1,r=1,i=[0],s=vo,a=vo,o=vo,u=vo,l=vo;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(h),i=[0],e&&d.eachBefore(d5),d}function h(d){var f=i[d.depth],p=d.x0+f,g=d.y0+f,m=d.x1-f,y=d.y1-f;m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=y,d.children&&(f=i[d.depth+1]=s(d)/2,p+=l(d)-f,g+=a(d)-f,m-=o(d)-f,y-=u(d)-f,m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),t(d,p,g,m,y))}return c.round=function(d){return arguments.length?(e=!!d,c):e},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(t=f5(d),c):t},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:bo(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:bo(+d),c):a},c.paddingRight=function(d){return arguments.length?(o=typeof d=="function"?d:bo(+d),c):o},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:bo(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:bo(+d),c):l},c}function dd(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const Ob=Symbol("implicit");function HC(){var t=new hb,e=[],n=[],r=Ob;function i(s){let a=t.get(s);if(a===void 0){if(r!==Ob)return r;t.set(s,a=e.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new hb;for(const a of s)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return HC(e,n).unknown(r)},dd.apply(i,arguments),i}function b5(){var t=HC().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,s,a,o=!1,u=0,l=0,c=.5;delete t.unknown;function h(){var d=e().length,f=i<r,p=f?i:r,g=f?r:i;s=(g-p)/Math.max(1,d-u+l*2),o&&(s=Math.floor(s)),p+=(g-p-s*(d-u))*c,a=s*(1-u),o&&(p=Math.round(p),a=Math.round(a));var m=e6(d).map(function(y){return p+s*y});return n(f?m.reverse():m)}return t.domain=function(d){return arguments.length?(e(d),h()):e()},t.range=function(d){return arguments.length?([r,i]=d,r=+r,i=+i,h()):[r,i]},t.rangeRound=function(d){return[r,i]=d,r=+r,i=+i,o=!0,h()},t.bandwidth=function(){return a},t.step=function(){return s},t.round=function(d){return arguments.length?(o=!!d,h()):o},t.padding=function(d){return arguments.length?(u=Math.min(1,l=+d),h()):u},t.paddingInner=function(d){return arguments.length?(u=Math.min(1,d),h()):u},t.paddingOuter=function(d){return arguments.length?(l=+d,h()):l},t.align=function(d){return arguments.length?(c=Math.max(0,Math.min(1,d)),h()):c},t.copy=function(){return b5(e(),[r,i]).round(o).paddingInner(u).paddingOuter(l).align(c)},dd.apply(h(),arguments)}function x5(t){return function(){return t}}function E5(t){return+t}var Ib=[0,1];function ga(t){return t}function yg(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:x5(isNaN(e)?NaN:.5)}function D5(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function w5(t,e,n){var r=t[0],i=t[1],s=e[0],a=e[1];return i<r?(r=yg(i,r),s=n(a,s)):(r=yg(r,i),s=n(s,a)),function(o){return s(r(o))}}function _5(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=yg(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(o){var u=VL(t,o,1,r)-1;return s[u](i[u](o))}}function YC(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function C5(){var t=Ib,e=Ib,n=y1,r,i,s,a=ga,o,u,l;function c(){var d=Math.min(t.length,e.length);return a!==ga&&(a=D5(t[0],t[d-1])),o=d>2?_5:w5,u=l=null,h}function h(d){return d==null||isNaN(d=+d)?s:(u||(u=o(t.map(r),e,n)))(r(a(d)))}return h.invert=function(d){return a(i((l||(l=o(e,t.map(r),mr)))(d)))},h.domain=function(d){return arguments.length?(t=Array.from(d,E5),c()):t.slice()},h.range=function(d){return arguments.length?(e=Array.from(d),c()):e.slice()},h.rangeRound=function(d){return e=Array.from(d),n=p8,c()},h.clamp=function(d){return arguments.length?(a=d?!0:ga,c()):a!==ga},h.interpolate=function(d){return arguments.length?(n=d,c()):n},h.unknown=function(d){return arguments.length?(s=d,h):s},function(d,f){return r=d,i=f,c()}}function VC(){return C5()(ga,ga)}function A5(t,e,n,r){var i=sg(t,e,n),s;switch(r=qh(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=H4(i,a))&&(r.precision=s),zC(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Y4(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=W4(i))&&(r.precision=s-(r.type==="%")*2);break}}return GC(r)}function T5(t){var e=t.domain;return t.ticks=function(n){var r=e();return QL(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return A5(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,a=r[i],o=r[s],u,l,c=10;for(o<a&&(l=a,a=o,o=l,l=i,i=s,s=l);c-- >0;){if(l=ig(a,o,n),l===u)return r[i]=a,r[s]=o,e(r);if(l>0)a=Math.floor(a/l)*l,o=Math.ceil(o/l)*l;else if(l<0)a=Math.ceil(a*l)/l,o=Math.floor(o*l)/l;else break;u=l}return t},t}function k5(){var t=VC();return t.copy=function(){return YC(t,k5())},dd.apply(t,arguments),T5(t)}function S5(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),t[n]=e.floor(i),t[r]=e.ceil(s),t}const Sp=new Date,Np=new Date;function Mt(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(e(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const u=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return u;let l;do u.push(l=new Date(+s)),e(s,o),t(s);while(l<s&&s<a);return u},i.filter=s=>Mt(a=>{if(a>=a)for(;t(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;e(a,-1),!s(a););else for(;--o>=0;)for(;e(a,1),!s(a););}),n&&(i.count=(s,a)=>(Sp.setTime(+s),Np.setTime(+a),t(Sp),t(Np),Math.floor(n(Sp,Np))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const jh=Mt(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);jh.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Mt(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):jh);jh.range;const yi=1e3,or=yi*60,vi=or*60,_i=vi*24,D1=_i*7,Lb=_i*30,Fp=_i*365,ma=Mt(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*yi)},(t,e)=>(e-t)/yi,t=>t.getUTCSeconds());ma.range;const w1=Mt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*yi)},(t,e)=>{t.setTime(+t+e*or)},(t,e)=>(e-t)/or,t=>t.getMinutes());w1.range;const N5=Mt(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*or)},(t,e)=>(e-t)/or,t=>t.getUTCMinutes());N5.range;const _1=Mt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*yi-t.getMinutes()*or)},(t,e)=>{t.setTime(+t+e*vi)},(t,e)=>(e-t)/vi,t=>t.getHours());_1.range;const F5=Mt(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*vi)},(t,e)=>(e-t)/vi,t=>t.getUTCHours());F5.range;const Dl=Mt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*or)/_i,t=>t.getDate()-1);Dl.range;const C1=Mt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/_i,t=>t.getUTCDate()-1);C1.range;const R5=Mt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/_i,t=>Math.floor(t/_i));R5.range;function Vs(t){return Mt(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*or)/D1)}const pd=Vs(0),Kh=Vs(1),M5=Vs(2),O5=Vs(3),Ya=Vs(4),I5=Vs(5),L5=Vs(6);pd.range;Kh.range;M5.range;O5.range;Ya.range;I5.range;L5.range;function qs(t){return Mt(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/D1)}const qC=qs(0),Jh=qs(1),P5=qs(2),$5=qs(3),Va=qs(4),B5=qs(5),U5=qs(6);qC.range;Jh.range;P5.range;$5.range;Va.range;B5.range;U5.range;const A1=Mt(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());A1.range;const G5=Mt(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());G5.range;const Ci=Mt(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Ci.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mt(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Ci.range;const Is=Mt(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Is.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mt(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Is.range;function z5(t,e,n,r,i,s){const a=[[ma,1,yi],[ma,5,5*yi],[ma,15,15*yi],[ma,30,30*yi],[s,1,or],[s,5,5*or],[s,15,15*or],[s,30,30*or],[i,1,vi],[i,3,3*vi],[i,6,6*vi],[i,12,12*vi],[r,1,_i],[r,2,2*_i],[n,1,D1],[e,1,Lb],[e,3,3*Lb],[t,1,Fp]];function o(l,c,h){const d=c<l;d&&([l,c]=[c,l]);const f=h&&typeof h.range=="function"?h:u(l,c,h),p=f?f.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,h){const d=Math.abs(c-l)/h,f=p1(([,,m])=>m).right(a,d);if(f===a.length)return t.every(sg(l/Fp,c/Fp,h));if(f===0)return jh.every(Math.max(sg(l,c,h),1));const[p,g]=a[d/a[f-1][2]<a[f][2]/d?f-1:f];return p.every(g)}return[o,u]}const[W5,H5]=z5(Ci,A1,pd,Dl,_1,w1);function Rp(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Mp(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function xo(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Y5(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,a=t.shortDays,o=t.months,u=t.shortMonths,l=Eo(i),c=Do(i),h=Eo(s),d=Do(s),f=Eo(a),p=Do(a),g=Eo(o),m=Do(o),y=Eo(u),b=Do(u),v={a:A,A:T,b:O,B:L,c:null,d:zb,e:zb,f:p9,g:_9,G:A9,H:h9,I:f9,j:d9,L:XC,m:g9,M:m9,p:P,q:Y,Q:Yb,s:Vb,S:y9,u:v9,U:b9,V:x9,w:E9,W:D9,x:null,X:null,y:w9,Y:C9,Z:T9,"%":Hb},E={a:W,A:X,b:V,B:q,c:null,d:Wb,e:Wb,f:F9,g:G9,G:W9,H:k9,I:S9,j:N9,L:KC,m:R9,M:M9,p:Z,q:J,Q:Yb,s:Vb,S:O9,u:I9,U:L9,V:P9,w:$9,W:B9,x:null,X:null,y:U9,Y:z9,Z:H9,"%":Hb},w={a:M,A:S,b:R,B:I,c:x,d:Ub,e:Ub,f:o9,g:Bb,G:$b,H:Gb,I:Gb,j:r9,L:a9,m:n9,M:i9,p:F,q:t9,Q:l9,s:c9,S:s9,u:K5,U:J5,V:Z5,w:j5,W:Q5,x:_,X:C,y:Bb,Y:$b,Z:e9,"%":u9};v.x=N(n,v),v.X=N(r,v),v.c=N(e,v),E.x=N(n,E),E.X=N(r,E),E.c=N(e,E);function N(B,H){return function(j){var G=[],re=-1,K=0,_e=B.length,ve,dt,ut;for(j instanceof Date||(j=new Date(+j));++re<_e;)B.charCodeAt(re)===37&&(G.push(B.slice(K,re)),(dt=Pb[ve=B.charAt(++re)])!=null?ve=B.charAt(++re):dt=ve==="e"?" ":"0",(ut=H[ve])&&(ve=ut(j,dt)),G.push(ve),K=re+1);return G.push(B.slice(K,re)),G.join("")}}function D(B,H){return function(j){var G=xo(1900,void 0,1),re=k(G,B,j+="",0),K,_e;if(re!=j.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(H&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(K=Mp(xo(G.y,0,1)),_e=K.getUTCDay(),K=_e>4||_e===0?Jh.ceil(K):Jh(K),K=C1.offset(K,(G.V-1)*7),G.y=K.getUTCFullYear(),G.m=K.getUTCMonth(),G.d=K.getUTCDate()+(G.w+6)%7):(K=Rp(xo(G.y,0,1)),_e=K.getDay(),K=_e>4||_e===0?Kh.ceil(K):Kh(K),K=Dl.offset(K,(G.V-1)*7),G.y=K.getFullYear(),G.m=K.getMonth(),G.d=K.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),_e="Z"in G?Mp(xo(G.y,0,1)).getUTCDay():Rp(xo(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(_e+5)%7:G.w+G.U*7-(_e+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,Mp(G)):Rp(G)}}function k(B,H,j,G){for(var re=0,K=H.length,_e=j.length,ve,dt;re<K;){if(G>=_e)return-1;if(ve=H.charCodeAt(re++),ve===37){if(ve=H.charAt(re++),dt=w[ve in Pb?H.charAt(re++):ve],!dt||(G=dt(B,j,G))<0)return-1}else if(ve!=j.charCodeAt(G++))return-1}return G}function F(B,H,j){var G=l.exec(H.slice(j));return G?(B.p=c.get(G[0].toLowerCase()),j+G[0].length):-1}function M(B,H,j){var G=f.exec(H.slice(j));return G?(B.w=p.get(G[0].toLowerCase()),j+G[0].length):-1}function S(B,H,j){var G=h.exec(H.slice(j));return G?(B.w=d.get(G[0].toLowerCase()),j+G[0].length):-1}function R(B,H,j){var G=y.exec(H.slice(j));return G?(B.m=b.get(G[0].toLowerCase()),j+G[0].length):-1}function I(B,H,j){var G=g.exec(H.slice(j));return G?(B.m=m.get(G[0].toLowerCase()),j+G[0].length):-1}function x(B,H,j){return k(B,e,H,j)}function _(B,H,j){return k(B,n,H,j)}function C(B,H,j){return k(B,r,H,j)}function A(B){return a[B.getDay()]}function T(B){return s[B.getDay()]}function O(B){return u[B.getMonth()]}function L(B){return o[B.getMonth()]}function P(B){return i[+(B.getHours()>=12)]}function Y(B){return 1+~~(B.getMonth()/3)}function W(B){return a[B.getUTCDay()]}function X(B){return s[B.getUTCDay()]}function V(B){return u[B.getUTCMonth()]}function q(B){return o[B.getUTCMonth()]}function Z(B){return i[+(B.getUTCHours()>=12)]}function J(B){return 1+~~(B.getUTCMonth()/3)}return{format:function(B){var H=N(B+="",v);return H.toString=function(){return B},H},parse:function(B){var H=D(B+="",!1);return H.toString=function(){return B},H},utcFormat:function(B){var H=N(B+="",E);return H.toString=function(){return B},H},utcParse:function(B){var H=D(B+="",!0);return H.toString=function(){return B},H}}}var Pb={"-":"",_:" ",0:"0"},zt=/^\s*\d+/,V5=/^%/,q5=/[\\^$*+?|[\]().{}]/g;function Be(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function X5(t){return t.replace(q5,"\\$&")}function Eo(t){return new RegExp("^(?:"+t.map(X5).join("|")+")","i")}function Do(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function j5(t,e,n){var r=zt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function K5(t,e,n){var r=zt.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function J5(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Z5(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Q5(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function $b(t,e,n){var r=zt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Bb(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function e9(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function t9(t,e,n){var r=zt.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function n9(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Ub(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function r9(t,e,n){var r=zt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Gb(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function i9(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function s9(t,e,n){var r=zt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function a9(t,e,n){var r=zt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function o9(t,e,n){var r=zt.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function u9(t,e,n){var r=V5.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function l9(t,e,n){var r=zt.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function c9(t,e,n){var r=zt.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function zb(t,e){return Be(t.getDate(),e,2)}function h9(t,e){return Be(t.getHours(),e,2)}function f9(t,e){return Be(t.getHours()%12||12,e,2)}function d9(t,e){return Be(1+Dl.count(Ci(t),t),e,3)}function XC(t,e){return Be(t.getMilliseconds(),e,3)}function p9(t,e){return XC(t,e)+"000"}function g9(t,e){return Be(t.getMonth()+1,e,2)}function m9(t,e){return Be(t.getMinutes(),e,2)}function y9(t,e){return Be(t.getSeconds(),e,2)}function v9(t){var e=t.getDay();return e===0?7:e}function b9(t,e){return Be(pd.count(Ci(t)-1,t),e,2)}function jC(t){var e=t.getDay();return e>=4||e===0?Ya(t):Ya.ceil(t)}function x9(t,e){return t=jC(t),Be(Ya.count(Ci(t),t)+(Ci(t).getDay()===4),e,2)}function E9(t){return t.getDay()}function D9(t,e){return Be(Kh.count(Ci(t)-1,t),e,2)}function w9(t,e){return Be(t.getFullYear()%100,e,2)}function _9(t,e){return t=jC(t),Be(t.getFullYear()%100,e,2)}function C9(t,e){return Be(t.getFullYear()%1e4,e,4)}function A9(t,e){var n=t.getDay();return t=n>=4||n===0?Ya(t):Ya.ceil(t),Be(t.getFullYear()%1e4,e,4)}function T9(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Be(e/60|0,"0",2)+Be(e%60,"0",2)}function Wb(t,e){return Be(t.getUTCDate(),e,2)}function k9(t,e){return Be(t.getUTCHours(),e,2)}function S9(t,e){return Be(t.getUTCHours()%12||12,e,2)}function N9(t,e){return Be(1+C1.count(Is(t),t),e,3)}function KC(t,e){return Be(t.getUTCMilliseconds(),e,3)}function F9(t,e){return KC(t,e)+"000"}function R9(t,e){return Be(t.getUTCMonth()+1,e,2)}function M9(t,e){return Be(t.getUTCMinutes(),e,2)}function O9(t,e){return Be(t.getUTCSeconds(),e,2)}function I9(t){var e=t.getUTCDay();return e===0?7:e}function L9(t,e){return Be(qC.count(Is(t)-1,t),e,2)}function JC(t){var e=t.getUTCDay();return e>=4||e===0?Va(t):Va.ceil(t)}function P9(t,e){return t=JC(t),Be(Va.count(Is(t),t)+(Is(t).getUTCDay()===4),e,2)}function $9(t){return t.getUTCDay()}function B9(t,e){return Be(Jh.count(Is(t)-1,t),e,2)}function U9(t,e){return Be(t.getUTCFullYear()%100,e,2)}function G9(t,e){return t=JC(t),Be(t.getUTCFullYear()%100,e,2)}function z9(t,e){return Be(t.getUTCFullYear()%1e4,e,4)}function W9(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Va(t):Va.ceil(t),Be(t.getUTCFullYear()%1e4,e,4)}function H9(){return"+0000"}function Hb(){return"%"}function Yb(t){return+t}function Vb(t){return Math.floor(+t/1e3)}var aa,ZC;Y9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Y9(t){return aa=Y5(t),ZC=aa.format,aa.parse,aa.utcFormat,aa.utcParse,aa}function V9(t){return new Date(t)}function q9(t){return t instanceof Date?+t:+new Date(+t)}function QC(t,e,n,r,i,s,a,o,u,l){var c=VC(),h=c.invert,d=c.domain,f=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),b=l("%b %d"),v=l("%B"),E=l("%Y");function w(N){return(u(N)<N?f:o(N)<N?p:a(N)<N?g:s(N)<N?m:r(N)<N?i(N)<N?y:b:n(N)<N?v:E)(N)}return c.invert=function(N){return new Date(h(N))},c.domain=function(N){return arguments.length?d(Array.from(N,q9)):d().map(V9)},c.ticks=function(N){var D=d();return t(D[0],D[D.length-1],N??10)},c.tickFormat=function(N,D){return D==null?w:l(D)},c.nice=function(N){var D=d();return(!N||typeof N.range!="function")&&(N=e(D[0],D[D.length-1],N??10)),N?d(S5(D,N)):c},c.copy=function(){return YC(c,QC(t,e,n,r,i,s,a,o,u,l))},c}function jq(){return dd.apply(QC(W5,H5,Ci,A1,pd,Dl,_1,w1,ma,ZC).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function X9(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const Kq=X9("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function vt(t){return function(){return t}}const qb=Math.abs,on=Math.atan2,as=Math.cos,j9=Math.max,Op=Math.min,Lr=Math.sin,ya=Math.sqrt,cn=1e-12,el=Math.PI,Zh=el/2,Xc=2*el;function K9(t){return t>1?0:t<-1?el:Math.acos(t)}function Xb(t){return t>=1?Zh:t<=-1?-Zh:Math.asin(t)}function eA(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new O4(e)}function J9(t){return t.innerRadius}function Z9(t){return t.outerRadius}function Q9(t){return t.startAngle}function e7(t){return t.endAngle}function t7(t){return t&&t.padAngle}function n7(t,e,n,r,i,s,a,o){var u=n-t,l=r-e,c=a-i,h=o-s,d=h*u-c*l;if(!(d*d<cn))return d=(c*(e-s)-h*(t-i))/d,[t+d*u,e+d*l]}function sc(t,e,n,r,i,s,a){var o=t-n,u=e-r,l=(a?s:-s)/ya(o*o+u*u),c=l*u,h=-l*o,d=t+c,f=e+h,p=n+c,g=r+h,m=(d+p)/2,y=(f+g)/2,b=p-d,v=g-f,E=b*b+v*v,w=i-s,N=d*g-p*f,D=(v<0?-1:1)*ya(j9(0,w*w*E-N*N)),k=(N*v-b*D)/E,F=(-N*b-v*D)/E,M=(N*v+b*D)/E,S=(-N*b+v*D)/E,R=k-m,I=F-y,x=M-m,_=S-y;return R*R+I*I>x*x+_*_&&(k=M,F=S),{cx:k,cy:F,x01:-c,y01:-h,x11:k*(i/w-1),y11:F*(i/w-1)}}function Jq(){var t=J9,e=Z9,n=vt(0),r=null,i=Q9,s=e7,a=t7,o=null,u=eA(l);function l(){var c,h,d=+t.apply(this,arguments),f=+e.apply(this,arguments),p=i.apply(this,arguments)-Zh,g=s.apply(this,arguments)-Zh,m=qb(g-p),y=g>p;if(o||(o=c=u()),f<d&&(h=f,f=d,d=h),!(f>cn))o.moveTo(0,0);else if(m>Xc-cn)o.moveTo(f*as(p),f*Lr(p)),o.arc(0,0,f,p,g,!y),d>cn&&(o.moveTo(d*as(g),d*Lr(g)),o.arc(0,0,d,g,p,y));else{var b=p,v=g,E=p,w=g,N=m,D=m,k=a.apply(this,arguments)/2,F=k>cn&&(r?+r.apply(this,arguments):ya(d*d+f*f)),M=Op(qb(f-d)/2,+n.apply(this,arguments)),S=M,R=M,I,x;if(F>cn){var _=Xb(F/d*Lr(k)),C=Xb(F/f*Lr(k));(N-=_*2)>cn?(_*=y?1:-1,E+=_,w-=_):(N=0,E=w=(p+g)/2),(D-=C*2)>cn?(C*=y?1:-1,b+=C,v-=C):(D=0,b=v=(p+g)/2)}var A=f*as(b),T=f*Lr(b),O=d*as(w),L=d*Lr(w);if(M>cn){var P=f*as(v),Y=f*Lr(v),W=d*as(E),X=d*Lr(E),V;if(m<el)if(V=n7(A,T,W,X,P,Y,O,L)){var q=A-V[0],Z=T-V[1],J=P-V[0],B=Y-V[1],H=1/Lr(K9((q*J+Z*B)/(ya(q*q+Z*Z)*ya(J*J+B*B)))/2),j=ya(V[0]*V[0]+V[1]*V[1]);S=Op(M,(d-j)/(H-1)),R=Op(M,(f-j)/(H+1))}else S=R=0}D>cn?R>cn?(I=sc(W,X,A,T,f,R,y),x=sc(P,Y,O,L,f,R,y),o.moveTo(I.cx+I.x01,I.cy+I.y01),R<M?o.arc(I.cx,I.cy,R,on(I.y01,I.x01),on(x.y01,x.x01),!y):(o.arc(I.cx,I.cy,R,on(I.y01,I.x01),on(I.y11,I.x11),!y),o.arc(0,0,f,on(I.cy+I.y11,I.cx+I.x11),on(x.cy+x.y11,x.cx+x.x11),!y),o.arc(x.cx,x.cy,R,on(x.y11,x.x11),on(x.y01,x.x01),!y))):(o.moveTo(A,T),o.arc(0,0,f,b,v,!y)):o.moveTo(A,T),!(d>cn)||!(N>cn)?o.lineTo(O,L):S>cn?(I=sc(O,L,P,Y,d,-S,y),x=sc(A,T,W,X,d,-S,y),o.lineTo(I.cx+I.x01,I.cy+I.y01),S<M?o.arc(I.cx,I.cy,S,on(I.y01,I.x01),on(x.y01,x.x01),!y):(o.arc(I.cx,I.cy,S,on(I.y01,I.x01),on(I.y11,I.x11),!y),o.arc(0,0,d,on(I.cy+I.y11,I.cx+I.x11),on(x.cy+x.y11,x.cx+x.x11),y),o.arc(x.cx,x.cy,S,on(x.y11,x.x11),on(x.y01,x.x01),!y))):o.arc(0,0,d,w,E,y)}if(o.closePath(),c)return o=null,c+""||null}return l.centroid=function(){var c=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,h=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-el/2;return[as(h)*c,Lr(h)*c]},l.innerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:vt(+c),l):t},l.outerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:vt(+c),l):e},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:vt(+c),l):n},l.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:vt(+c),l):r},l.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:vt(+c),l):i},l.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:vt(+c),l):s},l.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:vt(+c),l):a},l.context=function(c){return arguments.length?(o=c??null,l):o},l}function tA(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function nA(t){this._context=t}nA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function r7(t){return new nA(t)}function i7(t){return t[0]}function s7(t){return t[1]}function Zq(t,e){var n=vt(!0),r=null,i=r7,s=null,a=eA(o);t=typeof t=="function"?t:t===void 0?i7:vt(t),e=typeof e=="function"?e:e===void 0?s7:vt(e);function o(u){var l,c=(u=tA(u)).length,h,d=!1,f;for(r==null&&(s=i(f=a())),l=0;l<=c;++l)!(l<c&&n(h=u[l],l,u))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+t(h,l,u),+e(h,l,u));if(f)return s=null,f+""||null}return o.x=function(u){return arguments.length?(t=typeof u=="function"?u:vt(+u),o):t},o.y=function(u){return arguments.length?(e=typeof u=="function"?u:vt(+u),o):e},o.defined=function(u){return arguments.length?(n=typeof u=="function"?u:vt(!!u),o):n},o.curve=function(u){return arguments.length?(i=u,r!=null&&(s=i(r)),o):i},o.context=function(u){return arguments.length?(u==null?r=s=null:s=i(r=u),o):r},o}function a7(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function o7(t){return t}function Qq(){var t=o7,e=a7,n=null,r=vt(0),i=vt(Xc),s=vt(0);function a(o){var u,l=(o=tA(o)).length,c,h,d=0,f=new Array(l),p=new Array(l),g=+r.apply(this,arguments),m=Math.min(Xc,Math.max(-Xc,i.apply(this,arguments)-g)),y,b=Math.min(Math.abs(m)/l,s.apply(this,arguments)),v=b*(m<0?-1:1),E;for(u=0;u<l;++u)(E=p[f[u]=u]=+t(o[u],u,o))>0&&(d+=E);for(e!=null?f.sort(function(w,N){return e(p[w],p[N])}):n!=null&&f.sort(function(w,N){return n(o[w],o[N])}),u=0,h=d?(m-l*v)/d:0;u<l;++u,g=y)c=f[u],E=p[c],y=g+(E>0?E*h:0)+v,p[c]={data:o[c],index:u,value:E,startAngle:g,endAngle:y,padAngle:b};return p}return a.value=function(o){return arguments.length?(t=typeof o=="function"?o:vt(+o),a):t},a.sortValues=function(o){return arguments.length?(e=o,n=null,a):e},a.sort=function(o){return arguments.length?(n=o,e=null,a):n},a.startAngle=function(o){return arguments.length?(r=typeof o=="function"?o:vt(+o),a):r},a.endAngle=function(o){return arguments.length?(i=typeof o=="function"?o:vt(+o),a):i},a.padAngle=function(o){return arguments.length?(s=typeof o=="function"?o:vt(+o),a):s},a}class rA{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function eX(t){return new rA(t,!0)}function tX(t){return new rA(t,!1)}function Vi(){}function Qh(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function gd(t){this._context=t}gd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Qh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Qh(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function nX(t){return new gd(t)}function iA(t){this._context=t}iA.prototype={areaStart:Vi,areaEnd:Vi,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Qh(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function rX(t){return new iA(t)}function sA(t){this._context=t}sA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Qh(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function iX(t){return new sA(t)}function aA(t,e){this._basis=new gd(t),this._beta=e}aA.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r=t[0],i=e[0],s=t[n]-r,a=e[n]-i,o=-1,u;++o<=n;)u=o/n,this._basis.point(this._beta*t[o]+(1-this._beta)*(r+u*s),this._beta*e[o]+(1-this._beta)*(i+u*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const sX=function t(e){function n(r){return e===1?new gd(r):new aA(r,e)}return n.beta=function(r){return t(+r)},n}(.85);function ef(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function T1(t,e){this._context=t,this._k=(1-e)/6}T1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ef(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:ef(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const aX=function t(e){function n(r){return new T1(r,e)}return n.tension=function(r){return t(+r)},n}(0);function k1(t,e){this._context=t,this._k=(1-e)/6}k1.prototype={areaStart:Vi,areaEnd:Vi,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:ef(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const oX=function t(e){function n(r){return new k1(r,e)}return n.tension=function(r){return t(+r)},n}(0);function S1(t,e){this._context=t,this._k=(1-e)/6}S1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ef(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const uX=function t(e){function n(r){return new S1(r,e)}return n.tension=function(r){return t(+r)},n}(0);function N1(t,e,n){var r=t._x1,i=t._y1,s=t._x2,a=t._y2;if(t._l01_a>cn){var o=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*o-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*o-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>cn){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*l+t._x1*t._l23_2a-e*t._l12_2a)/c,a=(a*l+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,s,a,t._x2,t._y2)}function oA(t,e){this._context=t,this._alpha=e}oA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:N1(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const lX=function t(e){function n(r){return e?new oA(r,e):new T1(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function uA(t,e){this._context=t,this._alpha=e}uA.prototype={areaStart:Vi,areaEnd:Vi,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:N1(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cX=function t(e){function n(r){return e?new uA(r,e):new k1(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function lA(t,e){this._context=t,this._alpha=e}lA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:N1(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const hX=function t(e){function n(r){return e?new lA(r,e):new S1(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function cA(t){this._context=t}cA.prototype={areaStart:Vi,areaEnd:Vi,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function fX(t){return new cA(t)}function jb(t){return t<0?-1:1}function Kb(t,e,n){var r=t._x1-t._x0,i=e-t._x1,s=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(jb(s)+jb(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function Jb(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Ip(t,e,n){var r=t._x0,i=t._y0,s=t._x1,a=t._y1,o=(s-r)/3;t._context.bezierCurveTo(r+o,i+o*e,s-o,a-o*n,s,a)}function tf(t){this._context=t}tf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ip(this,this._t0,Jb(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Ip(this,Jb(this,n=Kb(this,t,e)),n);break;default:Ip(this,this._t0,n=Kb(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function hA(t){this._context=new fA(t)}(hA.prototype=Object.create(tf.prototype)).point=function(t,e){tf.prototype.point.call(this,e,t)};function fA(t){this._context=t}fA.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,s){this._context.bezierCurveTo(e,t,r,n,s,i)}};function dX(t){return new tf(t)}function pX(t){return new hA(t)}function dA(t){this._context=t}dA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=Zb(t),i=Zb(e),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],t[a],e[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Zb(t){var e,n=t.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=t[0]+2*t[1],e=1;e<n-1;++e)i[e]=1,s[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=i[e]/s[e-1],s[e]-=r,a[e]-=r*a[e-1];for(i[n-1]=a[n-1]/s[n-1],e=n-2;e>=0;--e)i[e]=(a[e]-i[e+1])/s[e];for(s[n-1]=(t[n]+i[n-1])/2,e=0;e<n-1;++e)s[e]=2*t[e+1]-i[e+1];return[i,s]}function gX(t){return new dA(t)}function md(t,e){this._context=t,this._t=e}md.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function mX(t){return new md(t,.5)}function yX(t){return new md(t,0)}function vX(t){return new md(t,1)}function Ho(t,e,n){this.k=t,this.x=e,this.y=n}Ho.prototype={constructor:Ho,scale:function(t){return t===1?this:new Ho(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Ho(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ho.prototype;var wo={},Nt={},Qb;function u7(){return Qb||(Qb=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.BLANK_URL=Nt.relativeFirstCharacters=Nt.whitespaceEscapeCharsRegex=Nt.urlSchemeRegex=Nt.ctrlCharactersRegex=Nt.htmlCtrlEntityRegex=Nt.htmlEntitiesRegex=Nt.invalidProtocolRegex=void 0,Nt.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,Nt.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,Nt.htmlCtrlEntityRegex=/&(newline|tab);/gi,Nt.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Nt.urlSchemeRegex=/^.+(:|&colon;)/gim,Nt.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,Nt.relativeFirstCharacters=[".","/"],Nt.BLANK_URL="about:blank"),Nt}var ex;function l7(){if(ex)return wo;ex=1,Object.defineProperty(wo,"__esModule",{value:!0}),wo.sanitizeUrl=void 0;var t=u7();function e(a){return t.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(t.ctrlCharactersRegex,"");return o.replace(t.htmlEntitiesRegex,function(u,l){return String.fromCharCode(l)})}function r(a){return URL.canParse(a)}function i(a){try{return decodeURIComponent(a)}catch{return a}}function s(a){if(!a)return t.BLANK_URL;var o,u=i(a.trim());do u=n(u).replace(t.htmlCtrlEntityRegex,"").replace(t.ctrlCharactersRegex,"").replace(t.whitespaceEscapeCharsRegex,"").trim(),u=i(u),o=u.match(t.ctrlCharactersRegex)||u.match(t.htmlEntitiesRegex)||u.match(t.htmlCtrlEntityRegex)||u.match(t.whitespaceEscapeCharsRegex);while(o&&o.length>0);var l=u;if(!l)return t.BLANK_URL;if(e(l))return l;var c=l.trimStart(),h=c.match(t.urlSchemeRegex);if(!h)return l;var d=h[0].toLowerCase().trim();if(t.invalidProtocolRegex.test(d))return t.BLANK_URL;var f=c.replace(/\\/g,"/");if(d==="mailto:"||d.includes("://"))return f;if(d==="http:"||d==="https:"){if(!r(f))return t.BLANK_URL;var p=new URL(f);return p.protocol=p.protocol.toLowerCase(),p.hostname=p.hostname.toLowerCase(),p.toString()}return f}return wo.sanitizeUrl=s,wo}var bX=l7();const c7=Object.freeze({left:0,top:0,width:16,height:16}),nf=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),pA=Object.freeze({...c7,...nf}),h7=Object.freeze({...pA,body:"",hidden:!1}),f7=Object.freeze({width:null,height:null}),d7=Object.freeze({...f7,...nf}),xX=(t,e,n,r="")=>{const i=t.split(":");if(t.slice(0,1)==="@"){if(i.length<2||i.length>3)return null;r=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){const o=i.pop(),u=i.pop(),l={provider:i.length>0?i[0]:r,prefix:u,name:o};return Lp(l)?l:null}const s=i[0],a=s.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return Lp(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:s};return Lp(o,n)?o:null}return null},Lp=(t,e)=>t?!!((e&&t.prefix===""||t.prefix)&&t.name):!1;function p7(t,e){const n={};!t.hFlip!=!e.hFlip&&(n.hFlip=!0),!t.vFlip!=!e.vFlip&&(n.vFlip=!0);const r=((t.rotate||0)+(e.rotate||0))%4;return r&&(n.rotate=r),n}function tx(t,e){const n=p7(t,e);for(const r in h7)r in nf?r in t&&!(r in n)&&(n[r]=nf[r]):r in e?n[r]=e[r]:r in t&&(n[r]=t[r]);return n}function g7(t,e){const n=t.icons,r=t.aliases||Object.create(null),i=Object.create(null);function s(a){if(n[a])return i[a]=[];if(!(a in i)){i[a]=null;const o=r[a]&&r[a].parent,u=o&&s(o);u&&(i[a]=[o].concat(u))}return i[a]}return(e||Object.keys(n).concat(Object.keys(r))).forEach(s),i}function nx(t,e,n){const r=t.icons,i=t.aliases||Object.create(null);let s={};function a(o){s=tx(r[o]||i[o],s)}return a(e),n.forEach(a),tx(t,s)}function EX(t,e){if(t.icons[e])return nx(t,e,[]);const n=g7(t,[e])[e];return n?nx(t,e,n):null}const m7=/(-?[0-9.]*[0-9]+[0-9.]*)/g,y7=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function rx(t,e,n){if(e===1)return t;if(n=n||100,typeof t=="number")return Math.ceil(t*e*n)/n;if(typeof t!="string")return t;const r=t.split(m7);if(r===null||!r.length)return t;const i=[];let s=r.shift(),a=y7.test(s);for(;;){if(a){const o=parseFloat(s);isNaN(o)?i.push(s):i.push(Math.ceil(o*e*n)/n)}else i.push(s);if(s=r.shift(),s===void 0)return i.join("");a=!a}}function v7(t,e="defs"){let n="";const r=t.indexOf("<"+e);for(;r>=0;){const i=t.indexOf(">",r),s=t.indexOf("</"+e);if(i===-1||s===-1)break;const a=t.indexOf(">",s);if(a===-1)break;n+=t.slice(i+1,s).trim(),t=t.slice(0,r).trim()+t.slice(a+1)}return{defs:n,content:t}}function b7(t,e){return t?"<defs>"+t+"</defs>"+e:e}function x7(t,e,n){const r=v7(t);return b7(r.defs,e+r.content+n)}const E7=t=>t==="unset"||t==="undefined"||t==="none";function DX(t,e){const n={...pA,...t},r={...d7,...e},i={left:n.left,top:n.top,width:n.width,height:n.height};let s=n.body;[n,r].forEach(g=>{const m=[],y=g.hFlip,b=g.vFlip;let v=g.rotate;y?b?v+=2:(m.push("translate("+(i.width+i.left).toString()+" "+(0-i.top).toString()+")"),m.push("scale(-1 1)"),i.top=i.left=0):b&&(m.push("translate("+(0-i.left).toString()+" "+(i.height+i.top).toString()+")"),m.push("scale(1 -1)"),i.top=i.left=0);let E;switch(v<0&&(v-=Math.floor(v/4)*4),v=v%4,v){case 1:E=i.height/2+i.top,m.unshift("rotate(90 "+E.toString()+" "+E.toString()+")");break;case 2:m.unshift("rotate(180 "+(i.width/2+i.left).toString()+" "+(i.height/2+i.top).toString()+")");break;case 3:E=i.width/2+i.left,m.unshift("rotate(-90 "+E.toString()+" "+E.toString()+")");break}v%2===1&&(i.left!==i.top&&(E=i.left,i.left=i.top,i.top=E),i.width!==i.height&&(E=i.width,i.width=i.height,i.height=E)),m.length&&(s=x7(s,'<g transform="'+m.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,u=i.width,l=i.height;let c,h;a===null?(h=o===null?"1em":o==="auto"?l:o,c=rx(h,u/l)):(c=a==="auto"?u:a,h=o===null?rx(c,l/u):o==="auto"?l:o);const d={},f=(g,m)=>{E7(m)||(d[g]=m.toString())};f("width",c),f("height",h);const p=[i.left,i.top,u,l];return d.viewBox=p.join(" "),{attributes:d,viewBox:p,body:s}}const D7=/\sid="(\S+)"/g,w7="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let _7=0;function wX(t,e=w7){const n=[];let r;for(;r=D7.exec(t);)n.push(r[1]);if(!n.length)return t;const i="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(s=>{const a=typeof e=="function"?e(s):e+(_7++).toString(),o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t=t.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+i+"$3")}),t=t.replace(new RegExp(i,"g"),""),t}function _X(t,e){let n=t.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in e)n+=" "+r+'="'+e[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+t+"</svg>"}function F1(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Xs=F1();function gA(t){Xs=t}var Ou={exec:()=>null};function Ue(t,e=""){let n=typeof t=="string"?t:t.source,r={replace:(i,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(bn.caret,"$1"),n=n.replace(i,a),r},getRegex:()=>new RegExp(n,e)};return r}var bn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},C7=/^(?:[ \t]*(?:\n|$))+/,A7=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,T7=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,wl=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,k7=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,R1=/(?:[*+-]|\d{1,9}[.)])/,mA=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,yA=Ue(mA).replace(/bull/g,R1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),S7=Ue(mA).replace(/bull/g,R1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),M1=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,N7=/^[^\n]+/,O1=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,F7=Ue(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",O1).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),R7=Ue(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,R1).getRegex(),yd="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",I1=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,M7=Ue("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",I1).replace("tag",yd).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),vA=Ue(M1).replace("hr",wl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yd).getRegex(),O7=Ue(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",vA).getRegex(),L1={blockquote:O7,code:A7,def:F7,fences:T7,heading:k7,hr:wl,html:M7,lheading:yA,list:R7,newline:C7,paragraph:vA,table:Ou,text:N7},ix=Ue("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",wl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yd).getRegex(),I7={...L1,lheading:S7,table:ix,paragraph:Ue(M1).replace("hr",wl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ix).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yd).getRegex()},L7={...L1,html:Ue(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",I1).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ou,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ue(M1).replace("hr",wl).replace("heading",` *#{1,6} *[^
]`).replace("lheading",yA).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},P7=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,$7=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,bA=/^( {2,}|\\)\n(?!\s*$)/,B7=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,vd=/[\p{P}\p{S}]/u,P1=/[\s\p{P}\p{S}]/u,xA=/[^\s\p{P}\p{S}]/u,U7=Ue(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,P1).getRegex(),EA=/(?!~)[\p{P}\p{S}]/u,G7=/(?!~)[\s\p{P}\p{S}]/u,z7=/(?:[^\s\p{P}\p{S}]|~)/u,W7=Ue(/link|code|html/,"g").replace("link",new RegExp("\\[(?:[^\\[\\]`]|(?<!`)(?<a>`+)[^`]+\\k<a>(?!`))*?\\]\\((?:\\\\[\\s\\S]|[^\\\\\\(\\)]|\\((?:\\\\[\\s\\S]|[^\\\\\\(\\)])*\\))*\\)")).replace("code",new RegExp("(?<!`)(?<b>`+)[^`]+\\k<b>(?!`)")).replace("html",/<(?! )[^<>]*?>/).getRegex(),DA=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,H7=Ue(DA,"u").replace(/punct/g,vd).getRegex(),Y7=Ue(DA,"u").replace(/punct/g,EA).getRegex(),wA="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",V7=Ue(wA,"gu").replace(/notPunctSpace/g,xA).replace(/punctSpace/g,P1).replace(/punct/g,vd).getRegex(),q7=Ue(wA,"gu").replace(/notPunctSpace/g,z7).replace(/punctSpace/g,G7).replace(/punct/g,EA).getRegex(),X7=Ue("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,xA).replace(/punctSpace/g,P1).replace(/punct/g,vd).getRegex(),j7=Ue(/\\(punct)/,"gu").replace(/punct/g,vd).getRegex(),K7=Ue(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),J7=Ue(I1).replace("(?:-->|$)","-->").getRegex(),Z7=Ue("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",J7).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),rf=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Q7=Ue(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",rf).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),_A=Ue(/^!?\[(label)\]\[(ref)\]/).replace("label",rf).replace("ref",O1).getRegex(),CA=Ue(/^!?\[(ref)\](?:\[\])?/).replace("ref",O1).getRegex(),e$=Ue("reflink|nolink(?!\\()","g").replace("reflink",_A).replace("nolink",CA).getRegex(),sx=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,$1={_backpedal:Ou,anyPunctuation:j7,autolink:K7,blockSkip:W7,br:bA,code:$7,del:Ou,emStrongLDelim:H7,emStrongRDelimAst:V7,emStrongRDelimUnd:X7,escape:P7,link:Q7,nolink:CA,punctuation:U7,reflink:_A,reflinkSearch:e$,tag:Z7,text:B7,url:Ou},t$={...$1,link:Ue(/^!?\[(label)\]\((.*?)\)/).replace("label",rf).getRegex(),reflink:Ue(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",rf).getRegex()},vg={...$1,emStrongRDelimAst:q7,emStrongLDelim:Y7,url:Ue(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",sx).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Ue(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",sx).getRegex()},n$={...vg,br:Ue(bA).replace("{2,}","*").getRegex(),text:Ue(vg.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ac={normal:L1,gfm:I7,pedantic:L7},_o={normal:$1,gfm:vg,breaks:n$,pedantic:t$},r$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ax=t=>r$[t];function Pr(t,e){if(e){if(bn.escapeTest.test(t))return t.replace(bn.escapeReplace,ax)}else if(bn.escapeTestNoEncode.test(t))return t.replace(bn.escapeReplaceNoEncode,ax);return t}function ox(t){try{t=encodeURI(t).replace(bn.percentDecode,"%")}catch{return null}return t}function ux(t,e){var s;let n=t.replace(bn.findPipe,(a,o,u)=>{let l=!1,c=o;for(;--c>=0&&u[c]==="\\";)l=!l;return l?"|":" |"}),r=n.split(bn.splitPipe),i=0;if(r[0].trim()||r.shift(),r.length>0&&!((s=r.at(-1))!=null&&s.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(bn.slashPipe,"|");return r}function Co(t,e,n){let r=t.length;if(r===0)return"";let i=0;for(;i<r&&t.charAt(r-i-1)===e;)i++;return t.slice(0,r-i)}function i$(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return n>0?-2:-1}function lx(t,e,n,r,i){let s=e.href,a=e.title||null,o=t[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;let u={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,u}function s$(t,e,n){let r=t.match(n.other.indentCodeCompensation);if(r===null)return e;let i=r[1];return e.split(`
`).map(s=>{let a=s.match(n.other.beginningSpace);if(a===null)return s;let[o]=a;return o.length>=i.length?s.slice(i.length):s}).join(`
`)}var sf=class{constructor(e){Oe(this,"options");Oe(this,"rules");Oe(this,"lexer");this.options=e||Xs}space(e){let n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){let n=this.rules.block.code.exec(e);if(n){let r=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Co(r,`
`)}}}fences(e){let n=this.rules.block.fences.exec(e);if(n){let r=n[0],i=s$(r,n[3]||"",this.rules);return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:i}}}heading(e){let n=this.rules.block.heading.exec(e);if(n){let r=n[2].trim();if(this.rules.other.endingHash.test(r)){let i=Co(r,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(r=i.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){let n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:Co(n[0],`
`)}}blockquote(e){let n=this.rules.block.blockquote.exec(e);if(n){let r=Co(n[0],`
`).split(`
`),i="",s="",a=[];for(;r.length>0;){let o=!1,u=[],l;for(l=0;l<r.length;l++)if(this.rules.other.blockquoteStart.test(r[l]))u.push(r[l]),o=!0;else if(!o)u.push(r[l]);else break;r=r.slice(l);let c=u.join(`
`),h=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${c}`:c,s=s?`${s}
${h}`:h;let d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,a,!0),this.lexer.state.top=d,r.length===0)break;let f=a.at(-1);if((f==null?void 0:f.type)==="code")break;if((f==null?void 0:f.type)==="blockquote"){let p=f,g=p.raw+`
`+r.join(`
`),m=this.blockquote(g);a[a.length-1]=m,i=i.substring(0,i.length-p.raw.length)+m.raw,s=s.substring(0,s.length-p.text.length)+m.text;break}else if((f==null?void 0:f.type)==="list"){let p=f,g=p.raw+`
`+r.join(`
`),m=this.list(g);a[a.length-1]=m,i=i.substring(0,i.length-f.raw.length)+m.raw,s=s.substring(0,s.length-p.raw.length)+m.raw,r=g.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:a,text:s}}}list(e){let n=this.rules.block.list.exec(e);if(n){let r=n[1].trim(),i=r.length>1,s={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");let a=this.rules.other.listItemRegex(r),o=!1;for(;e;){let l=!1,c="",h="";if(!(n=a.exec(e))||this.rules.block.hr.test(e))break;c=n[0],e=e.substring(c.length);let d=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,b=>" ".repeat(3*b.length)),f=e.split(`
`,1)[0],p=!d.trim(),g=0;if(this.options.pedantic?(g=2,h=d.trimStart()):p?g=n[1].length+1:(g=n[2].search(this.rules.other.nonSpaceChar),g=g>4?1:g,h=d.slice(g),g+=n[1].length),p&&this.rules.other.blankLine.test(f)&&(c+=f+`
`,e=e.substring(f.length+1),l=!0),!l){let b=this.rules.other.nextBulletRegex(g),v=this.rules.other.hrRegex(g),E=this.rules.other.fencesBeginRegex(g),w=this.rules.other.headingBeginRegex(g),N=this.rules.other.htmlBeginRegex(g);for(;e;){let D=e.split(`
`,1)[0],k;if(f=D,this.options.pedantic?(f=f.replace(this.rules.other.listReplaceNesting,"  "),k=f):k=f.replace(this.rules.other.tabCharGlobal,"    "),E.test(f)||w.test(f)||N.test(f)||b.test(f)||v.test(f))break;if(k.search(this.rules.other.nonSpaceChar)>=g||!f.trim())h+=`
`+k.slice(g);else{if(p||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(d)||w.test(d)||v.test(d))break;h+=`
`+f}!p&&!f.trim()&&(p=!0),c+=D+`
`,e=e.substring(D.length+1),d=k.slice(g)}}s.loose||(o?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(o=!0));let m=null,y;this.options.gfm&&(m=this.rules.other.listIsTask.exec(h),m&&(y=m[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!m,checked:y,loose:!1,text:h,tokens:[]}),s.raw+=c}let u=s.items.at(-1);if(u)u.raw=u.raw.trimEnd(),u.text=u.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){let c=s.items[l].tokens.filter(d=>d.type==="space"),h=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=h}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){let n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(e){let n=this.rules.block.def.exec(e);if(n){let r=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:i,title:s}}}table(e){var o;let n=this.rules.block.table.exec(e);if(!n||!this.rules.other.tableDelimiter.test(n[2]))return;let r=ux(n[1]),i=n[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(o=n[3])!=null&&o.trim()?n[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:n[0],header:[],align:[],rows:[]};if(r.length===i.length){for(let u of i)this.rules.other.tableAlignRight.test(u)?a.align.push("right"):this.rules.other.tableAlignCenter.test(u)?a.align.push("center"):this.rules.other.tableAlignLeft.test(u)?a.align.push("left"):a.align.push(null);for(let u=0;u<r.length;u++)a.header.push({text:r[u],tokens:this.lexer.inline(r[u]),header:!0,align:a.align[u]});for(let u of s)a.rows.push(ux(u,a.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:a.align[c]})));return a}}lheading(e){let n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){let n=this.rules.block.paragraph.exec(e);if(n){let r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(e){let n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){let n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(e){let n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){let n=this.rules.inline.link.exec(e);if(n){let r=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let a=Co(r.slice(0,-1),"\\");if((r.length-a.length)%2===0)return}else{let a=i$(n[2],"()");if(a===-2)return;if(a>-1){let o=(n[0].indexOf("!")===0?5:4)+n[1].length+a;n[2]=n[2].substring(0,a),n[0]=n[0].substring(0,o).trim(),n[3]=""}}let i=n[2],s="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(i);a&&(i=a[1],s=a[3])}else s=n[3]?n[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?i=i.slice(1):i=i.slice(1,-1)),lx(n,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(e,n){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let i=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=n[i.toLowerCase()];if(!s){let a=r[0].charAt(0);return{type:"text",raw:a,text:a}}return lx(r,s,r[0],this.lexer,this.rules)}}emStrong(e,n,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!(!i||i[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(i[1]||i[2])||!r||this.rules.inline.punctuation.exec(r))){let s=[...i[0]].length-1,a,o,u=s,l=0,c=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,n=n.slice(-1*e.length+s);(i=c.exec(n))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(o=[...a].length,i[3]||i[4]){u+=o;continue}else if((i[5]||i[6])&&s%3&&!((s+o)%3)){l+=o;continue}if(u-=o,u>0)continue;o=Math.min(o,o+u+l);let h=[...i[0]][0].length,d=e.slice(0,s+i.index+h+o);if(Math.min(s,o)%2){let p=d.slice(1,-1);return{type:"em",raw:d,text:p,tokens:this.lexer.inlineTokens(p)}}let f=d.slice(2,-2);return{type:"strong",raw:d,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(e){let n=this.rules.inline.code.exec(e);if(n){let r=n[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(r),s=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return i&&s&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:n[0],text:r}}}br(e){let n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){let n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){let n=this.rules.inline.autolink.exec(e);if(n){let r,i;return n[2]==="@"?(r=n[1],i="mailto:"+r):(r=n[1],i=r),{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var r;let n;if(n=this.rules.inline.url.exec(e)){let i,s;if(n[2]==="@")i=n[0],s="mailto:"+i;else{let a;do a=n[0],n[0]=((r=this.rules.inline._backpedal.exec(n[0]))==null?void 0:r[0])??"";while(a!==n[0]);i=n[0],n[1]==="www."?s="http://"+n[0]:s=n[0]}return{type:"link",raw:n[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){let n=this.rules.inline.text.exec(e);if(n){let r=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:r}}}},yr=class bg{constructor(e){Oe(this,"tokens");Oe(this,"options");Oe(this,"state");Oe(this,"tokenizer");Oe(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Xs,this.options.tokenizer=this.options.tokenizer||new sf,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:bn,block:ac.normal,inline:_o.normal};this.options.pedantic?(n.block=ac.pedantic,n.inline=_o.pedantic):this.options.gfm&&(n.block=ac.gfm,this.options.breaks?n.inline=_o.breaks:n.inline=_o.gfm),this.tokenizer.rules=n}static get rules(){return{block:ac,inline:_o}}static lex(e,n){return new bg(n).lex(e)}static lexInline(e,n){return new bg(n).inlineTokens(e)}lex(e){e=e.replace(bn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){var i,s,a;for(this.options.pedantic&&(e=e.replace(bn.tabCharGlobal,"    ").replace(bn.spaceLine,""));e;){let o;if((s=(i=this.options.extensions)==null?void 0:i.block)!=null&&s.some(l=>(o=l.call({lexer:this},e,n))?(e=e.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);let l=n.at(-1);o.raw.length===1&&l!==void 0?l.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);let l=n.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+o.raw,l.text+=`
`+o.text,this.inlineQueue.at(-1).src=l.text):n.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);let l=n.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+o.raw,l.text+=`
`+o.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title},n.push(o));continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),n.push(o);continue}let u=e;if((a=this.options.extensions)!=null&&a.startBlock){let l=1/0,c=e.slice(1),h;this.options.extensions.startBlock.forEach(d=>{h=d.call({lexer:this},c),typeof h=="number"&&h>=0&&(l=Math.min(l,h))}),l<1/0&&l>=0&&(u=e.substring(0,l+1))}if(this.state.top&&(o=this.tokenizer.paragraph(u))){let l=n.at(-1);r&&(l==null?void 0:l.type)==="paragraph"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+o.raw,l.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(o),r=u.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);let l=n.at(-1);(l==null?void 0:l.type)==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+o.raw,l.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(o);continue}if(e){let l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var o,u,l,c,h;let r=e,i=null;if(this.tokens.links){let d=Object.keys(this.tokens.links);if(d.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)d.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=((u=(o=this.options.hooks)==null?void 0:o.emStrongMask)==null?void 0:u.call({lexer:this},r))??r;let s=!1,a="";for(;e;){s||(a=""),s=!1;let d;if((c=(l=this.options.extensions)==null?void 0:l.inline)!=null&&c.some(p=>(d=p.call({lexer:this},e,n))?(e=e.substring(d.raw.length),n.push(d),!0):!1))continue;if(d=this.tokenizer.escape(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.tag(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.link(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(d.raw.length);let p=n.at(-1);d.type==="text"&&(p==null?void 0:p.type)==="text"?(p.raw+=d.raw,p.text+=d.text):n.push(d);continue}if(d=this.tokenizer.emStrong(e,r,a)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.codespan(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.br(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.del(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.autolink(e)){e=e.substring(d.raw.length),n.push(d);continue}if(!this.state.inLink&&(d=this.tokenizer.url(e))){e=e.substring(d.raw.length),n.push(d);continue}let f=e;if((h=this.options.extensions)!=null&&h.startInline){let p=1/0,g=e.slice(1),m;this.options.extensions.startInline.forEach(y=>{m=y.call({lexer:this},g),typeof m=="number"&&m>=0&&(p=Math.min(p,m))}),p<1/0&&p>=0&&(f=e.substring(0,p+1))}if(d=this.tokenizer.inlineText(f)){e=e.substring(d.raw.length),d.raw.slice(-1)!=="_"&&(a=d.raw.slice(-1)),s=!0;let p=n.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=d.raw,p.text+=d.text):n.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return n}},af=class{constructor(e){Oe(this,"options");Oe(this,"parser");this.options=e||Xs}space(e){return""}code({text:e,lang:n,escaped:r}){var a;let i=(a=(n||"").match(bn.notSpaceStart))==null?void 0:a[0],s=e.replace(bn.endingNewline,"")+`
`;return i?'<pre><code class="language-'+Pr(i)+'">'+(r?s:Pr(s,!0))+`</code></pre>
`:"<pre><code>"+(r?s:Pr(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:n}){return`<h${n}>${this.parser.parseInline(e)}</h${n}>
`}hr(e){return`<hr>
`}list(e){let n=e.ordered,r=e.start,i="";for(let o=0;o<e.items.length;o++){let u=e.items[o];i+=this.listitem(u)}let s=n?"ol":"ul",a=n&&r!==1?' start="'+r+'"':"";return"<"+s+a+`>
`+i+"</"+s+`>
`}listitem(e){var r;let n="";if(e.task){let i=this.checkbox({checked:!!e.checked});e.loose?((r=e.tokens[0])==null?void 0:r.type)==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+Pr(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):n+=i+" "}return n+=this.parser.parse(e.tokens,!!e.loose),`<li>${n}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let n="",r="";for(let s=0;s<e.header.length;s++)r+=this.tablecell(e.header[s]);n+=this.tablerow({text:r});let i="";for(let s=0;s<e.rows.length;s++){let a=e.rows[s];r="";for(let o=0;o<a.length;o++)r+=this.tablecell(a[o]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let n=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+n+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Pr(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:n,tokens:r}){let i=this.parser.parseInline(r),s=ox(e);if(s===null)return i;e=s;let a='<a href="'+e+'"';return n&&(a+=' title="'+Pr(n)+'"'),a+=">"+i+"</a>",a}image({href:e,title:n,text:r,tokens:i}){i&&(r=this.parser.parseInline(i,this.parser.textRenderer));let s=ox(e);if(s===null)return Pr(r);e=s;let a=`<img src="${e}" alt="${r}"`;return n&&(a+=` title="${Pr(n)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Pr(e.text)}},B1=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},vr=class xg{constructor(e){Oe(this,"options");Oe(this,"renderer");Oe(this,"textRenderer");this.options=e||Xs,this.options.renderer=this.options.renderer||new af,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new B1}static parse(e,n){return new xg(n).parse(e)}static parseInline(e,n){return new xg(n).parseInline(e)}parse(e,n=!0){var i,s;let r="";for(let a=0;a<e.length;a++){let o=e[a];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[o.type]){let l=o,c=this.options.extensions.renderers[l.type].call({parser:this},l);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(l.type)){r+=c||"";continue}}let u=o;switch(u.type){case"space":{r+=this.renderer.space(u);continue}case"hr":{r+=this.renderer.hr(u);continue}case"heading":{r+=this.renderer.heading(u);continue}case"code":{r+=this.renderer.code(u);continue}case"table":{r+=this.renderer.table(u);continue}case"blockquote":{r+=this.renderer.blockquote(u);continue}case"list":{r+=this.renderer.list(u);continue}case"html":{r+=this.renderer.html(u);continue}case"def":{r+=this.renderer.def(u);continue}case"paragraph":{r+=this.renderer.paragraph(u);continue}case"text":{let l=u,c=this.renderer.text(l);for(;a+1<e.length&&e[a+1].type==="text";)l=e[++a],c+=`
`+this.renderer.text(l);n?r+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):r+=c;continue}default:{let l='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return r}parseInline(e,n=this.renderer){var i,s;let r="";for(let a=0;a<e.length;a++){let o=e[a];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[o.type]){let l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=l||"";continue}}let u=o;switch(u.type){case"escape":{r+=n.text(u);break}case"html":{r+=n.html(u);break}case"link":{r+=n.link(u);break}case"image":{r+=n.image(u);break}case"strong":{r+=n.strong(u);break}case"em":{r+=n.em(u);break}case"codespan":{r+=n.codespan(u);break}case"br":{r+=n.br(u);break}case"del":{r+=n.del(u);break}case"text":{r+=n.text(u);break}default:{let l='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return r}},Tc,Yo=(Tc=class{constructor(e){Oe(this,"options");Oe(this,"block");this.options=e||Xs}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?yr.lex:yr.lexInline}provideParser(){return this.block?vr.parse:vr.parseInline}},Oe(Tc,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Oe(Tc,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Tc),a$=class{constructor(...e){Oe(this,"defaults",F1());Oe(this,"options",this.setOptions);Oe(this,"parse",this.parseMarkdown(!0));Oe(this,"parseInline",this.parseMarkdown(!1));Oe(this,"Parser",vr);Oe(this,"Renderer",af);Oe(this,"TextRenderer",B1);Oe(this,"Lexer",yr);Oe(this,"Tokenizer",sf);Oe(this,"Hooks",Yo);this.use(...e)}walkTokens(e,n){var i,s;let r=[];for(let a of e)switch(r=r.concat(n.call(this,a)),a.type){case"table":{let o=a;for(let u of o.header)r=r.concat(this.walkTokens(u.tokens,n));for(let u of o.rows)for(let l of u)r=r.concat(this.walkTokens(l.tokens,n));break}case"list":{let o=a;r=r.concat(this.walkTokens(o.items,n));break}default:{let o=a;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[o.type]?this.defaults.extensions.childTokens[o.type].forEach(u=>{let l=o[u].flat(1/0);r=r.concat(this.walkTokens(l,n))}):o.tokens&&(r=r.concat(this.walkTokens(o.tokens,n)))}}return r}use(...e){let n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{let i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let a=n.renderers[s.name];a?n.renderers[s.name]=function(...o){let u=s.renderer.apply(this,o);return u===!1&&(u=a.apply(this,o)),u}:n.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=n[s.level];a?a.unshift(s.tokenizer):n[s.level]=[s.tokenizer],s.start&&(s.level==="block"?n.startBlock?n.startBlock.push(s.start):n.startBlock=[s.start]:s.level==="inline"&&(n.startInline?n.startInline.push(s.start):n.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(n.childTokens[s.name]=s.childTokens)}),i.extensions=n),r.renderer){let s=this.defaults.renderer||new af(this.defaults);for(let a in r.renderer){if(!(a in s))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let o=a,u=r.renderer[o],l=s[o];s[o]=(...c)=>{let h=u.apply(s,c);return h===!1&&(h=l.apply(s,c)),h||""}}i.renderer=s}if(r.tokenizer){let s=this.defaults.tokenizer||new sf(this.defaults);for(let a in r.tokenizer){if(!(a in s))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let o=a,u=r.tokenizer[o],l=s[o];s[o]=(...c)=>{let h=u.apply(s,c);return h===!1&&(h=l.apply(s,c)),h}}i.tokenizer=s}if(r.hooks){let s=this.defaults.hooks||new Yo;for(let a in r.hooks){if(!(a in s))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let o=a,u=r.hooks[o],l=s[o];Yo.passThroughHooks.has(a)?s[o]=c=>{if(this.defaults.async&&Yo.passThroughHooksRespectAsync.has(a))return(async()=>{let d=await u.call(s,c);return l.call(s,d)})();let h=u.call(s,c);return l.call(s,h)}:s[o]=(...c)=>{if(this.defaults.async)return(async()=>{let d=await u.apply(s,c);return d===!1&&(d=await l.apply(s,c)),d})();let h=u.apply(s,c);return h===!1&&(h=l.apply(s,c)),h}}i.hooks=s}if(r.walkTokens){let s=this.defaults.walkTokens,a=r.walkTokens;i.walkTokens=function(o){let u=[];return u.push(a.call(this,o)),s&&(u=u.concat(s.call(this,o))),u}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return yr.lex(e,n??this.defaults)}parser(e,n){return vr.parse(e,n??this.defaults)}parseMarkdown(e){return(n,r)=>{let i={...r},s={...this.defaults,...i},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&i.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let o=s.hooks?await s.hooks.preprocess(n):n,u=await(s.hooks?await s.hooks.provideLexer():e?yr.lex:yr.lexInline)(o,s),l=s.hooks?await s.hooks.processAllTokens(u):u;s.walkTokens&&await Promise.all(this.walkTokens(l,s.walkTokens));let c=await(s.hooks?await s.hooks.provideParser():e?vr.parse:vr.parseInline)(l,s);return s.hooks?await s.hooks.postprocess(c):c})().catch(a);try{s.hooks&&(n=s.hooks.preprocess(n));let o=(s.hooks?s.hooks.provideLexer():e?yr.lex:yr.lexInline)(n,s);s.hooks&&(o=s.hooks.processAllTokens(o)),s.walkTokens&&this.walkTokens(o,s.walkTokens);let u=(s.hooks?s.hooks.provideParser():e?vr.parse:vr.parseInline)(o,s);return s.hooks&&(u=s.hooks.postprocess(u)),u}catch(o){return a(o)}}}onError(e,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let i="<p>An error occurred:</p><pre>"+Pr(r.message+"",!0)+"</pre>";return n?Promise.resolve(i):i}if(n)return Promise.reject(r);throw r}}},Ls=new a$;function Je(t,e){return Ls.parse(t,e)}Je.options=Je.setOptions=function(t){return Ls.setOptions(t),Je.defaults=Ls.defaults,gA(Je.defaults),Je};Je.getDefaults=F1;Je.defaults=Xs;Je.use=function(...t){return Ls.use(...t),Je.defaults=Ls.defaults,gA(Je.defaults),Je};Je.walkTokens=function(t,e){return Ls.walkTokens(t,e)};Je.parseInline=Ls.parseInline;Je.Parser=vr;Je.parser=vr.parse;Je.Renderer=af;Je.TextRenderer=B1;Je.Lexer=yr;Je.lexer=yr.lex;Je.Tokenizer=sf;Je.Hooks=Yo;Je.parse=Je;Je.options;Je.setOptions;Je.use;Je.walkTokens;Je.parseInline;vr.parse;yr.lex;function NX(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Array.from(typeof t=="string"?[t]:t);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var i=r.reduce(function(o,u){var l=u.match(/\n([\t ]+|(?!\s).)/g);return l?o.concat(l.map(function(c){var h,d;return(d=(h=c.match(/[\t ]/g))===null||h===void 0?void 0:h.length)!==null&&d!==void 0?d:0})):o},[]);if(i.length){var s=new RegExp(`
[	 ]{`+Math.min.apply(Math,i)+"}","g");r=r.map(function(o){return o.replace(s,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return e.forEach(function(o,u){var l=a.match(/(?:^|\n)( *)$/),c=l?l[1]:"",h=o;typeof o=="string"&&o.includes(`
`)&&(h=String(o).split(`
`).map(function(d,f){return f===0?d:""+c+d}).join(`
`)),a+=h+r[u+1]}),a}function Pp(t,e,n){if(t&&t.length){const[r,i]=e,s=Math.PI/180*n,a=Math.cos(s),o=Math.sin(s);for(const u of t){const[l,c]=u;u[0]=(l-r)*a-(c-i)*o+r,u[1]=(l-r)*o+(c-i)*a+i}}}function o$(t,e){return t[0]===e[0]&&t[1]===e[1]}function u$(t,e,n,r=1){const i=n,s=Math.max(e,.1),a=t[0]&&t[0][0]&&typeof t[0][0]=="number"?[t]:t,o=[0,0];if(i)for(const l of a)Pp(l,o,i);const u=function(l,c,h){const d=[];for(const b of l){const v=[...b];o$(v[0],v[v.length-1])||v.push([v[0][0],v[0][1]]),v.length>2&&d.push(v)}const f=[];c=Math.max(c,.1);const p=[];for(const b of d)for(let v=0;v<b.length-1;v++){const E=b[v],w=b[v+1];if(E[1]!==w[1]){const N=Math.min(E[1],w[1]);p.push({ymin:N,ymax:Math.max(E[1],w[1]),x:N===E[1]?E[0]:w[0],islope:(w[0]-E[0])/(w[1]-E[1])})}}if(p.sort((b,v)=>b.ymin<v.ymin?-1:b.ymin>v.ymin?1:b.x<v.x?-1:b.x>v.x?1:b.ymax===v.ymax?0:(b.ymax-v.ymax)/Math.abs(b.ymax-v.ymax)),!p.length)return f;let g=[],m=p[0].ymin,y=0;for(;g.length||p.length;){if(p.length){let b=-1;for(let v=0;v<p.length&&!(p[v].ymin>m);v++)b=v;p.splice(0,b+1).forEach(v=>{g.push({s:m,edge:v})})}if(g=g.filter(b=>!(b.edge.ymax<=m)),g.sort((b,v)=>b.edge.x===v.edge.x?0:(b.edge.x-v.edge.x)/Math.abs(b.edge.x-v.edge.x)),(h!==1||y%c==0)&&g.length>1)for(let b=0;b<g.length;b+=2){const v=b+1;if(v>=g.length)break;const E=g[b].edge,w=g[v].edge;f.push([[Math.round(E.x),m],[Math.round(w.x),m]])}m+=h,g.forEach(b=>{b.edge.x=b.edge.x+h*b.edge.islope}),y++}return f}(a,s,r);if(i){for(const l of a)Pp(l,o,-i);(function(l,c,h){const d=[];l.forEach(f=>d.push(...f)),Pp(d,c,h)})(u,o,-i)}return u}function _l(t,e){var n;const r=e.hachureAngle+90;let i=e.hachureGap;i<0&&(i=4*e.strokeWidth),i=Math.round(Math.max(i,.1));let s=1;return e.roughness>=1&&(((n=e.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(s=i),u$(t,i,r,s||1)}class U1{constructor(e){this.helper=e}fillPolygons(e,n){return this._fillPolygons(e,n)}_fillPolygons(e,n){const r=_l(e,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(e,n){const r=[];for(const i of e)r.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],n));return r}}function bd(t){const e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}class l$ extends U1{fillPolygons(e,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const i=_l(e,Object.assign({},n,{hachureGap:r})),s=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(s),u=.5*r*Math.sin(s);for(const[l,c]of i)bd([l,c])&&a.push([[l[0]-o,l[1]+u],[...c]],[[l[0]+o,l[1]-u],[...c]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class c$ extends U1{fillPolygons(e,n){const r=this._fillPolygons(e,n),i=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),s=this._fillPolygons(e,i);return r.ops=r.ops.concat(s.ops),r}}class h${constructor(e){this.helper=e}fillPolygons(e,n){const r=_l(e,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(e,n){const r=[];let i=n.hachureGap;i<0&&(i=4*n.strokeWidth),i=Math.max(i,.1);let s=n.fillWeight;s<0&&(s=n.strokeWidth/2);const a=i/4;for(const o of e){const u=bd(o),l=u/i,c=Math.ceil(l)-1,h=u-c*i,d=(o[0][0]+o[1][0])/2-i/4,f=Math.min(o[0][1],o[1][1]);for(let p=0;p<c;p++){const g=f+h+p*i,m=d-a+2*Math.random()*a,y=g-a+2*Math.random()*a,b=this.helper.ellipse(m,y,s,s,n);r.push(...b.ops)}}return{type:"fillSketch",ops:r}}}class f${constructor(e){this.helper=e}fillPolygons(e,n){const r=_l(e,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(e,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,i=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,s=[];return e.forEach(a=>{const o=bd(a),u=Math.floor(o/(r+i)),l=(o+i-u*(r+i))/2;let c=a[0],h=a[1];c[0]>h[0]&&(c=a[1],h=a[0]);const d=Math.atan((h[1]-c[1])/(h[0]-c[0]));for(let f=0;f<u;f++){const p=f*(r+i),g=p+r,m=[c[0]+p*Math.cos(d)+l*Math.cos(d),c[1]+p*Math.sin(d)+l*Math.sin(d)],y=[c[0]+g*Math.cos(d)+l*Math.cos(d),c[1]+g*Math.sin(d)+l*Math.sin(d)];s.push(...this.helper.doubleLineOps(m[0],m[1],y[0],y[1],n))}}),s}}class d${constructor(e){this.helper=e}fillPolygons(e,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,i=n.zigzagOffset<0?r:n.zigzagOffset,s=_l(e,n=Object.assign({},n,{hachureGap:r+i}));return{type:"fillSketch",ops:this.zigzagLines(s,i,n)}}zigzagLines(e,n,r){const i=[];return e.forEach(s=>{const a=bd(s),o=Math.round(a/(2*n));let u=s[0],l=s[1];u[0]>l[0]&&(u=s[1],l=s[0]);const c=Math.atan((l[1]-u[1])/(l[0]-u[0]));for(let h=0;h<o;h++){const d=2*h*n,f=2*(h+1)*n,p=Math.sqrt(2*Math.pow(n,2)),g=[u[0]+d*Math.cos(c),u[1]+d*Math.sin(c)],m=[u[0]+f*Math.cos(c),u[1]+f*Math.sin(c)],y=[g[0]+p*Math.cos(c+Math.PI/4),g[1]+p*Math.sin(c+Math.PI/4)];i.push(...this.helper.doubleLineOps(g[0],g[1],y[0],y[1],r),...this.helper.doubleLineOps(y[0],y[1],m[0],m[1],r))}}),i}}const Tn={};class p${constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const g$=0,$p=1,cx=2,oc={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Bp(t,e){return t.type===e}function G1(t){const e=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:g$,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:$p,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:cx,text:""},o}(t);let r="BOD",i=0,s=n[i];for(;!Bp(s,cx);){let a=0;const o=[];if(r==="BOD"){if(s.text!=="M"&&s.text!=="m")return G1("M0,0"+t);i++,a=oc[s.text],r=s.text}else Bp(s,$p)?a=oc[r]:(i++,a=oc[s.text],r=s.text);if(!(i+a<n.length))throw new Error("Path data ended short");for(let u=i;u<i+a;u++){const l=n[u];if(!Bp(l,$p))throw new Error("Param not a number: "+r+","+l.text);o[o.length]=+l.text}if(typeof oc[r]!="number")throw new Error("Bad segment: "+r);{const u={key:r,data:o};e.push(u),i+=a,s=n[i],r==="M"&&(r="L"),r==="m"&&(r="l")}}return e}function AA(t){let e=0,n=0,r=0,i=0;const s=[];for(const{key:a,data:o}of t)switch(a){case"M":s.push({key:"M",data:[...o]}),[e,n]=o,[r,i]=o;break;case"m":e+=o[0],n+=o[1],s.push({key:"M",data:[e,n]}),r=e,i=n;break;case"L":s.push({key:"L",data:[...o]}),[e,n]=o;break;case"l":e+=o[0],n+=o[1],s.push({key:"L",data:[e,n]});break;case"C":s.push({key:"C",data:[...o]}),e=o[4],n=o[5];break;case"c":{const u=o.map((l,c)=>c%2?l+n:l+e);s.push({key:"C",data:u}),e=u[4],n=u[5];break}case"Q":s.push({key:"Q",data:[...o]}),e=o[2],n=o[3];break;case"q":{const u=o.map((l,c)=>c%2?l+n:l+e);s.push({key:"Q",data:u}),e=u[2],n=u[3];break}case"A":s.push({key:"A",data:[...o]}),e=o[5],n=o[6];break;case"a":e+=o[5],n+=o[6],s.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],e,n]});break;case"H":s.push({key:"H",data:[...o]}),e=o[0];break;case"h":e+=o[0],s.push({key:"H",data:[e]});break;case"V":s.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],s.push({key:"V",data:[n]});break;case"S":s.push({key:"S",data:[...o]}),e=o[2],n=o[3];break;case"s":{const u=o.map((l,c)=>c%2?l+n:l+e);s.push({key:"S",data:u}),e=u[2],n=u[3];break}case"T":s.push({key:"T",data:[...o]}),e=o[0],n=o[1];break;case"t":e+=o[0],n+=o[1],s.push({key:"T",data:[e,n]});break;case"Z":case"z":s.push({key:"Z",data:[]}),e=r,n=i}return s}function TA(t){const e=[];let n="",r=0,i=0,s=0,a=0,o=0,u=0;for(const{key:l,data:c}of t){switch(l){case"M":e.push({key:"M",data:[...c]}),[r,i]=c,[s,a]=c;break;case"C":e.push({key:"C",data:[...c]}),r=c[4],i=c[5],o=c[2],u=c[3];break;case"L":e.push({key:"L",data:[...c]}),[r,i]=c;break;case"H":r=c[0],e.push({key:"L",data:[r,i]});break;case"V":i=c[0],e.push({key:"L",data:[r,i]});break;case"S":{let h=0,d=0;n==="C"||n==="S"?(h=r+(r-o),d=i+(i-u)):(h=r,d=i),e.push({key:"C",data:[h,d,...c]}),o=c[0],u=c[1],r=c[2],i=c[3];break}case"T":{const[h,d]=c;let f=0,p=0;n==="Q"||n==="T"?(f=r+(r-o),p=i+(i-u)):(f=r,p=i);const g=r+2*(f-r)/3,m=i+2*(p-i)/3,y=h+2*(f-h)/3,b=d+2*(p-d)/3;e.push({key:"C",data:[g,m,y,b,h,d]}),o=f,u=p,r=h,i=d;break}case"Q":{const[h,d,f,p]=c,g=r+2*(h-r)/3,m=i+2*(d-i)/3,y=f+2*(h-f)/3,b=p+2*(d-p)/3;e.push({key:"C",data:[g,m,y,b,f,p]}),o=h,u=d,r=f,i=p;break}case"A":{const h=Math.abs(c[0]),d=Math.abs(c[1]),f=c[2],p=c[3],g=c[4],m=c[5],y=c[6];h===0||d===0?(e.push({key:"C",data:[r,i,m,y,m,y]}),r=m,i=y):(r!==m||i!==y)&&(kA(r,i,m,y,h,d,f,p,g).forEach(function(b){e.push({key:"C",data:b})}),r=m,i=y);break}case"Z":e.push({key:"Z",data:[]}),r=s,i=a}n=l}return e}function Ao(t,e,n){return[t*Math.cos(n)-e*Math.sin(n),t*Math.sin(n)+e*Math.cos(n)]}function kA(t,e,n,r,i,s,a,o,u,l){const c=(h=a,Math.PI*h/180);var h;let d=[],f=0,p=0,g=0,m=0;if(l)[f,p,g,m]=l;else{[t,e]=Ao(t,e,-c),[n,r]=Ao(n,r,-c);const I=(t-n)/2,x=(e-r)/2;let _=I*I/(i*i)+x*x/(s*s);_>1&&(_=Math.sqrt(_),i*=_,s*=_);const C=i*i,A=s*s,T=C*A-C*x*x-A*I*I,O=C*x*x+A*I*I,L=(o===u?-1:1)*Math.sqrt(Math.abs(T/O));g=L*i*x/s+(t+n)/2,m=L*-s*I/i+(e+r)/2,f=Math.asin(parseFloat(((e-m)/s).toFixed(9))),p=Math.asin(parseFloat(((r-m)/s).toFixed(9))),t<g&&(f=Math.PI-f),n<g&&(p=Math.PI-p),f<0&&(f=2*Math.PI+f),p<0&&(p=2*Math.PI+p),u&&f>p&&(f-=2*Math.PI),!u&&p>f&&(p-=2*Math.PI)}let y=p-f;if(Math.abs(y)>120*Math.PI/180){const I=p,x=n,_=r;p=u&&p>f?f+120*Math.PI/180*1:f+120*Math.PI/180*-1,d=kA(n=g+i*Math.cos(p),r=m+s*Math.sin(p),x,_,i,s,a,0,u,[p,I,g,m])}y=p-f;const b=Math.cos(f),v=Math.sin(f),E=Math.cos(p),w=Math.sin(p),N=Math.tan(y/4),D=4/3*i*N,k=4/3*s*N,F=[t,e],M=[t+D*v,e-k*b],S=[n+D*w,r-k*E],R=[n,r];if(M[0]=2*F[0]-M[0],M[1]=2*F[1]-M[1],l)return[M,S,R].concat(d);{d=[M,S,R].concat(d);const I=[];for(let x=0;x<d.length;x+=3){const _=Ao(d[x][0],d[x][1],c),C=Ao(d[x+1][0],d[x+1][1],c),A=Ao(d[x+2][0],d[x+2][1],c);I.push([_[0],_[1],C[0],C[1],A[0],A[1]])}return I}}const m$={randOffset:function(t,e){return Ee(t,e)},randOffsetWithRange:function(t,e,n){return of(t,e,n)},ellipse:function(t,e,n,r,i){const s=NA(n,r,i);return Eg(t,e,i,s).opset},doubleLineOps:function(t,e,n,r,i){return qi(t,e,n,r,i,!0)}};function SA(t,e,n,r,i){return{type:"path",ops:qi(t,e,n,r,i)}}function jc(t,e,n){const r=(t||[]).length;if(r>2){const i=[];for(let s=0;s<r-1;s++)i.push(...qi(t[s][0],t[s][1],t[s+1][0],t[s+1][1],n));return e&&i.push(...qi(t[r-1][0],t[r-1][1],t[0][0],t[0][1],n)),{type:"path",ops:i}}return r===2?SA(t[0][0],t[0][1],t[1][0],t[1][1],n):{type:"path",ops:[]}}function y$(t,e,n,r,i){return function(s,a){return jc(s,!0,a)}([[t,e],[t+n,e],[t+n,e+r],[t,e+r]],i)}function hx(t,e){if(t.length){const n=typeof t[0][0]=="number"?[t]:t,r=uc(n[0],1*(1+.2*e.roughness),e),i=e.disableMultiStroke?[]:uc(n[0],1.5*(1+.22*e.roughness),px(e));for(let s=1;s<n.length;s++){const a=n[s];if(a.length){const o=uc(a,1*(1+.2*e.roughness),e),u=e.disableMultiStroke?[]:uc(a,1.5*(1+.22*e.roughness),px(e));for(const l of o)l.op!=="move"&&r.push(l);for(const l of u)l.op!=="move"&&i.push(l)}}return{type:"path",ops:r.concat(i)}}return{type:"path",ops:[]}}function NA(t,e,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),i=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),s=2*Math.PI/i;let a=Math.abs(t/2),o=Math.abs(e/2);const u=1-n.curveFitting;return a+=Ee(a*u,n),o+=Ee(o*u,n),{increment:s,rx:a,ry:o}}function Eg(t,e,n,r){const[i,s]=gx(r.increment,t,e,r.rx,r.ry,1,r.increment*of(.1,of(.4,1,n),n),n);let a=uf(i,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=gx(r.increment,t,e,r.rx,r.ry,1.5,0,n),u=uf(o,null,n);a=a.concat(u)}return{estimatedPoints:s,opset:{type:"path",ops:a}}}function fx(t,e,n,r,i,s,a,o,u){const l=t,c=e;let h=Math.abs(n/2),d=Math.abs(r/2);h+=Ee(.01*h,u),d+=Ee(.01*d,u);let f=i,p=s;for(;f<0;)f+=2*Math.PI,p+=2*Math.PI;p-f>2*Math.PI&&(f=0,p=2*Math.PI);const g=2*Math.PI/u.curveStepCount,m=Math.min(g/2,(p-f)/2),y=mx(m,l,c,h,d,f,p,1,u);if(!u.disableMultiStroke){const b=mx(m,l,c,h,d,f,p,1.5,u);y.push(...b)}return a&&(o?y.push(...qi(l,c,l+h*Math.cos(f),c+d*Math.sin(f),u),...qi(l,c,l+h*Math.cos(p),c+d*Math.sin(p),u)):y.push({op:"lineTo",data:[l,c]},{op:"lineTo",data:[l+h*Math.cos(f),c+d*Math.sin(f)]})),{type:"path",ops:y}}function dx(t,e){const n=TA(AA(G1(t))),r=[];let i=[0,0],s=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":s=[o[0],o[1]],i=[o[0],o[1]];break;case"L":r.push(...qi(s[0],s[1],o[0],o[1],e)),s=[o[0],o[1]];break;case"C":{const[u,l,c,h,d,f]=o;r.push(...v$(u,l,c,h,d,f,s,e)),s=[d,f];break}case"Z":r.push(...qi(s[0],s[1],i[0],i[1],e)),s=[i[0],i[1]]}return{type:"path",ops:r}}function Up(t,e){const n=[];for(const r of t)if(r.length){const i=e.maxRandomnessOffset||0,s=r.length;if(s>2){n.push({op:"move",data:[r[0][0]+Ee(i,e),r[0][1]+Ee(i,e)]});for(let a=1;a<s;a++)n.push({op:"lineTo",data:[r[a][0]+Ee(i,e),r[a][1]+Ee(i,e)]})}}return{type:"fillPath",ops:n}}function oa(t,e){return function(n,r){let i=n.fillStyle||"hachure";if(!Tn[i])switch(i){case"zigzag":Tn[i]||(Tn[i]=new l$(r));break;case"cross-hatch":Tn[i]||(Tn[i]=new c$(r));break;case"dots":Tn[i]||(Tn[i]=new h$(r));break;case"dashed":Tn[i]||(Tn[i]=new f$(r));break;case"zigzag-line":Tn[i]||(Tn[i]=new d$(r));break;default:i="hachure",Tn[i]||(Tn[i]=new U1(r))}return Tn[i]}(e,m$).fillPolygons(t,e)}function px(t){const e=Object.assign({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}function FA(t){return t.randomizer||(t.randomizer=new p$(t.seed||0)),t.randomizer.next()}function of(t,e,n,r=1){return n.roughness*r*(FA(n)*(e-t)+t)}function Ee(t,e,n=1){return of(-t,t,e,n)}function qi(t,e,n,r,i,s=!1){const a=s?i.disableMultiStrokeFill:i.disableMultiStroke,o=Dg(t,e,n,r,i,!0,!1);if(a)return o;const u=Dg(t,e,n,r,i,!0,!0);return o.concat(u)}function Dg(t,e,n,r,i,s,a){const o=Math.pow(t-n,2)+Math.pow(e-r,2),u=Math.sqrt(o);let l=1;l=u<200?1:u>500?.4:-.0016668*u+1.233334;let c=i.maxRandomnessOffset||0;c*c*100>o&&(c=u/10);const h=c/2,d=.2+.2*FA(i);let f=i.bowing*i.maxRandomnessOffset*(r-e)/200,p=i.bowing*i.maxRandomnessOffset*(t-n)/200;f=Ee(f,i,l),p=Ee(p,i,l);const g=[],m=()=>Ee(h,i,l),y=()=>Ee(c,i,l),b=i.preserveVertices;return a?g.push({op:"move",data:[t+(b?0:m()),e+(b?0:m())]}):g.push({op:"move",data:[t+(b?0:Ee(c,i,l)),e+(b?0:Ee(c,i,l))]}),a?g.push({op:"bcurveTo",data:[f+t+(n-t)*d+m(),p+e+(r-e)*d+m(),f+t+2*(n-t)*d+m(),p+e+2*(r-e)*d+m(),n+(b?0:m()),r+(b?0:m())]}):g.push({op:"bcurveTo",data:[f+t+(n-t)*d+y(),p+e+(r-e)*d+y(),f+t+2*(n-t)*d+y(),p+e+2*(r-e)*d+y(),n+(b?0:y()),r+(b?0:y())]}),g}function uc(t,e,n){if(!t.length)return[];const r=[];r.push([t[0][0]+Ee(e,n),t[0][1]+Ee(e,n)]),r.push([t[0][0]+Ee(e,n),t[0][1]+Ee(e,n)]);for(let i=1;i<t.length;i++)r.push([t[i][0]+Ee(e,n),t[i][1]+Ee(e,n)]),i===t.length-1&&r.push([t[i][0]+Ee(e,n),t[i][1]+Ee(e,n)]);return uf(r,null,n)}function uf(t,e,n){const r=t.length,i=[];if(r>3){const s=[],a=1-n.curveTightness;i.push({op:"move",data:[t[1][0],t[1][1]]});for(let o=1;o+2<r;o++){const u=t[o];s[0]=[u[0],u[1]],s[1]=[u[0]+(a*t[o+1][0]-a*t[o-1][0])/6,u[1]+(a*t[o+1][1]-a*t[o-1][1])/6],s[2]=[t[o+1][0]+(a*t[o][0]-a*t[o+2][0])/6,t[o+1][1]+(a*t[o][1]-a*t[o+2][1])/6],s[3]=[t[o+1][0],t[o+1][1]],i.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}}else r===3?(i.push({op:"move",data:[t[1][0],t[1][1]]}),i.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):r===2&&i.push(...Dg(t[0][0],t[0][1],t[1][0],t[1][1],n,!0,!0));return i}function gx(t,e,n,r,i,s,a,o){const u=[],l=[];if(o.roughness===0){t/=4,l.push([e+r*Math.cos(-t),n+i*Math.sin(-t)]);for(let c=0;c<=2*Math.PI;c+=t){const h=[e+r*Math.cos(c),n+i*Math.sin(c)];u.push(h),l.push(h)}l.push([e+r*Math.cos(0),n+i*Math.sin(0)]),l.push([e+r*Math.cos(t),n+i*Math.sin(t)])}else{const c=Ee(.5,o)-Math.PI/2;l.push([Ee(s,o)+e+.9*r*Math.cos(c-t),Ee(s,o)+n+.9*i*Math.sin(c-t)]);const h=2*Math.PI+c-.01;for(let d=c;d<h;d+=t){const f=[Ee(s,o)+e+r*Math.cos(d),Ee(s,o)+n+i*Math.sin(d)];u.push(f),l.push(f)}l.push([Ee(s,o)+e+r*Math.cos(c+2*Math.PI+.5*a),Ee(s,o)+n+i*Math.sin(c+2*Math.PI+.5*a)]),l.push([Ee(s,o)+e+.98*r*Math.cos(c+a),Ee(s,o)+n+.98*i*Math.sin(c+a)]),l.push([Ee(s,o)+e+.9*r*Math.cos(c+.5*a),Ee(s,o)+n+.9*i*Math.sin(c+.5*a)])}return[l,u]}function mx(t,e,n,r,i,s,a,o,u){const l=s+Ee(.1,u),c=[];c.push([Ee(o,u)+e+.9*r*Math.cos(l-t),Ee(o,u)+n+.9*i*Math.sin(l-t)]);for(let h=l;h<=a;h+=t)c.push([Ee(o,u)+e+r*Math.cos(h),Ee(o,u)+n+i*Math.sin(h)]);return c.push([e+r*Math.cos(a),n+i*Math.sin(a)]),c.push([e+r*Math.cos(a),n+i*Math.sin(a)]),uf(c,null,u)}function v$(t,e,n,r,i,s,a,o){const u=[],l=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let c=[0,0];const h=o.disableMultiStroke?1:2,d=o.preserveVertices;for(let f=0;f<h;f++)f===0?u.push({op:"move",data:[a[0],a[1]]}):u.push({op:"move",data:[a[0]+(d?0:Ee(l[0],o)),a[1]+(d?0:Ee(l[0],o))]}),c=d?[i,s]:[i+Ee(l[f],o),s+Ee(l[f],o)],u.push({op:"bcurveTo",data:[t+Ee(l[f],o),e+Ee(l[f],o),n+Ee(l[f],o),r+Ee(l[f],o),c[0],c[1]]});return u}function To(t){return[...t]}function yx(t,e=0){const n=t.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(To(t[0]),To(t[1]),To(t[2]),To(t[2]));else{const i=[];i.push(t[0],t[0]);for(let o=1;o<t.length;o++)i.push(t[o]),o===t.length-1&&i.push(t[o]);const s=[],a=1-e;r.push(To(i[0]));for(let o=1;o+2<i.length;o++){const u=i[o];s[0]=[u[0],u[1]],s[1]=[u[0]+(a*i[o+1][0]-a*i[o-1][0])/6,u[1]+(a*i[o+1][1]-a*i[o-1][1])/6],s[2]=[i[o+1][0]+(a*i[o][0]-a*i[o+2][0])/6,i[o+1][1]+(a*i[o][1]-a*i[o+2][1])/6],s[3]=[i[o+1][0],i[o+1][1]],r.push(s[1],s[2],s[3])}}return r}function Kc(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function b$(t,e,n){const r=Kc(e,n);if(r===0)return Kc(t,e);let i=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/r;return i=Math.max(0,Math.min(1,i)),Kc(t,fs(e,n,i))}function fs(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function wg(t,e,n,r){const i=r||[];if(function(o,u){const l=o[u+0],c=o[u+1],h=o[u+2],d=o[u+3];let f=3*c[0]-2*l[0]-d[0];f*=f;let p=3*c[1]-2*l[1]-d[1];p*=p;let g=3*h[0]-2*d[0]-l[0];g*=g;let m=3*h[1]-2*d[1]-l[1];return m*=m,f<g&&(f=g),p<m&&(p=m),f+p}(t,e)<n){const o=t[e+0];i.length?(s=i[i.length-1],a=o,Math.sqrt(Kc(s,a))>1&&i.push(o)):i.push(o),i.push(t[e+3])}else{const u=t[e+0],l=t[e+1],c=t[e+2],h=t[e+3],d=fs(u,l,.5),f=fs(l,c,.5),p=fs(c,h,.5),g=fs(d,f,.5),m=fs(f,p,.5),y=fs(g,m,.5);wg([u,d,g,y],0,n,i),wg([y,m,p,h],0,n,i)}var s,a;return i}function x$(t,e){return lf(t,0,t.length,e)}function lf(t,e,n,r,i){const s=i||[],a=t[e],o=t[n-1];let u=0,l=1;for(let c=e+1;c<n-1;++c){const h=b$(t[c],a,o);h>u&&(u=h,l=c)}return Math.sqrt(u)>r?(lf(t,e,l+1,r,s),lf(t,l,n,r,s)):(s.length||s.push(a),s.push(o)),s}function Gp(t,e=.15,n){const r=[],i=(t.length-1)/3;for(let s=0;s<i;s++)wg(t,3*s,e,r);return n&&n>0?lf(r,0,r.length,n):r}const Bn="none";class cf{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,n,r){return{shape:e,sets:n||[],options:r||this.defaultOptions}}line(e,n,r,i,s){const a=this._o(s);return this._d("line",[SA(e,n,r,i,a)],a)}rectangle(e,n,r,i,s){const a=this._o(s),o=[],u=y$(e,n,r,i,a);if(a.fill){const l=[[e,n],[e+r,n],[e+r,n+i],[e,n+i]];a.fillStyle==="solid"?o.push(Up([l],a)):o.push(oa([l],a))}return a.stroke!==Bn&&o.push(u),this._d("rectangle",o,a)}ellipse(e,n,r,i,s){const a=this._o(s),o=[],u=NA(r,i,a),l=Eg(e,n,a,u);if(a.fill)if(a.fillStyle==="solid"){const c=Eg(e,n,a,u).opset;c.type="fillPath",o.push(c)}else o.push(oa([l.estimatedPoints],a));return a.stroke!==Bn&&o.push(l.opset),this._d("ellipse",o,a)}circle(e,n,r,i){const s=this.ellipse(e,n,r,r,i);return s.shape="circle",s}linearPath(e,n){const r=this._o(n);return this._d("linearPath",[jc(e,!1,r)],r)}arc(e,n,r,i,s,a,o=!1,u){const l=this._o(u),c=[],h=fx(e,n,r,i,s,a,o,!0,l);if(o&&l.fill)if(l.fillStyle==="solid"){const d=Object.assign({},l);d.disableMultiStroke=!0;const f=fx(e,n,r,i,s,a,!0,!1,d);f.type="fillPath",c.push(f)}else c.push(function(d,f,p,g,m,y,b){const v=d,E=f;let w=Math.abs(p/2),N=Math.abs(g/2);w+=Ee(.01*w,b),N+=Ee(.01*N,b);let D=m,k=y;for(;D<0;)D+=2*Math.PI,k+=2*Math.PI;k-D>2*Math.PI&&(D=0,k=2*Math.PI);const F=(k-D)/b.curveStepCount,M=[];for(let S=D;S<=k;S+=F)M.push([v+w*Math.cos(S),E+N*Math.sin(S)]);return M.push([v+w*Math.cos(k),E+N*Math.sin(k)]),M.push([v,E]),oa([M],b)}(e,n,r,i,s,a,l));return l.stroke!==Bn&&c.push(h),this._d("arc",c,l)}curve(e,n){const r=this._o(n),i=[],s=hx(e,r);if(r.fill&&r.fill!==Bn)if(r.fillStyle==="solid"){const a=hx(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=e;if(o.length){const u=typeof o[0][0]=="number"?[o]:o;for(const l of u)l.length<3?a.push(...l):l.length===3?a.push(...Gp(yx([l[0],l[0],l[1],l[2]]),10,(1+r.roughness)/2)):a.push(...Gp(yx(l),10,(1+r.roughness)/2))}a.length&&i.push(oa([a],r))}return r.stroke!==Bn&&i.push(s),this._d("curve",i,r)}polygon(e,n){const r=this._o(n),i=[],s=jc(e,!0,r);return r.fill&&(r.fillStyle==="solid"?i.push(Up([e],r)):i.push(oa([e],r))),r.stroke!==Bn&&i.push(s),this._d("polygon",i,r)}path(e,n){const r=this._o(n),i=[];if(!e)return this._d("path",i,r);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const s=r.fill&&r.fill!=="transparent"&&r.fill!==Bn,a=r.stroke!==Bn,o=!!(r.simplification&&r.simplification<1),u=function(c,h,d){const f=TA(AA(G1(c))),p=[];let g=[],m=[0,0],y=[];const b=()=>{y.length>=4&&g.push(...Gp(y,h)),y=[]},v=()=>{b(),g.length&&(p.push(g),g=[])};for(const{key:w,data:N}of f)switch(w){case"M":v(),m=[N[0],N[1]],g.push(m);break;case"L":b(),g.push([N[0],N[1]]);break;case"C":if(!y.length){const D=g.length?g[g.length-1]:m;y.push([D[0],D[1]])}y.push([N[0],N[1]]),y.push([N[2],N[3]]),y.push([N[4],N[5]]);break;case"Z":b(),g.push([m[0],m[1]])}if(v(),!d)return p;const E=[];for(const w of p){const N=x$(w,d);N.length&&E.push(N)}return E}(e,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),l=dx(e,r);if(s)if(r.fillStyle==="solid")if(u.length===1){const c=dx(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(c.ops)})}else i.push(Up(u,r));else i.push(oa(u,r));return a&&(o?u.forEach(c=>{i.push(jc(c,!1,r))}):i.push(l)),this._d("path",i,r)}opsToPath(e,n){let r="";for(const i of e.ops){const s=typeof n=="number"&&n>=0?i.data.map(a=>+a.toFixed(n)):i.data;switch(i.op){case"move":r+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":r+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":r+=`L${s[0]} ${s[1]} `}}return r.trim()}toPaths(e){const n=e.sets||[],r=e.options||this.defaultOptions,i=[];for(const s of n){let a=null;switch(s.type){case"path":a={d:this.opsToPath(s),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:Bn};break;case"fillPath":a={d:this.opsToPath(s),stroke:Bn,strokeWidth:0,fill:r.fill||Bn};break;case"fillSketch":a=this.fillSketch(s,r)}a&&i.push(a)}return i}fillSketch(e,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(e),stroke:n.fill||Bn,strokeWidth:r,fill:Bn}}_mergedShape(e){return e.filter((n,r)=>r===0||n.op!=="move")}}class E${constructor(e,n){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new cf(n)}draw(e){const n=e.sets||[],r=e.options||this.getDefaultOptions(),i=this.ctx,s=e.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":i.save(),i.strokeStyle=r.stroke==="none"?"transparent":r.stroke,i.lineWidth=r.strokeWidth,r.strokeLineDash&&i.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(i.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(i,a,s),i.restore();break;case"fillPath":{i.save(),i.fillStyle=r.fill||"";const o=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(i,a,s,o),i.restore();break}case"fillSketch":this.fillSketch(i,a,r)}}fillSketch(e,n,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2),e.save(),r.fillLineDash&&e.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(e.lineDashOffset=r.fillLineDashOffset),e.strokeStyle=r.fill||"",e.lineWidth=i,this._drawToContext(e,n,r.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,n,r,i="nonzero"){e.beginPath();for(const s of n.ops){const a=typeof r=="number"&&r>=0?s.data.map(o=>+o.toFixed(r)):s.data;switch(s.op){case"move":e.moveTo(a[0],a[1]);break;case"bcurveTo":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":e.lineTo(a[0],a[1])}}n.type==="fillPath"?e.fill(i):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,n,r,i,s){const a=this.gen.line(e,n,r,i,s);return this.draw(a),a}rectangle(e,n,r,i,s){const a=this.gen.rectangle(e,n,r,i,s);return this.draw(a),a}ellipse(e,n,r,i,s){const a=this.gen.ellipse(e,n,r,i,s);return this.draw(a),a}circle(e,n,r,i){const s=this.gen.circle(e,n,r,i);return this.draw(s),s}linearPath(e,n){const r=this.gen.linearPath(e,n);return this.draw(r),r}polygon(e,n){const r=this.gen.polygon(e,n);return this.draw(r),r}arc(e,n,r,i,s,a,o=!1,u){const l=this.gen.arc(e,n,r,i,s,a,o,u);return this.draw(l),l}curve(e,n){const r=this.gen.curve(e,n);return this.draw(r),r}path(e,n){const r=this.gen.path(e,n);return this.draw(r),r}}const lc="http://www.w3.org/2000/svg";class D${constructor(e,n){this.svg=e,this.gen=new cf(n)}draw(e){const n=e.sets||[],r=e.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,s=i.createElementNS(lc,"g"),a=e.options.fixedDecimalPlaceDigits;for(const o of n){let u=null;switch(o.type){case"path":u=i.createElementNS(lc,"path"),u.setAttribute("d",this.opsToPath(o,a)),u.setAttribute("stroke",r.stroke),u.setAttribute("stroke-width",r.strokeWidth+""),u.setAttribute("fill","none"),r.strokeLineDash&&u.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&u.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":u=i.createElementNS(lc,"path"),u.setAttribute("d",this.opsToPath(o,a)),u.setAttribute("stroke","none"),u.setAttribute("stroke-width","0"),u.setAttribute("fill",r.fill||""),e.shape!=="curve"&&e.shape!=="polygon"||u.setAttribute("fill-rule","evenodd");break;case"fillSketch":u=this.fillSketch(i,o,r)}u&&s.appendChild(u)}return s}fillSketch(e,n,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2);const s=e.createElementNS(lc,"path");return s.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),s.setAttribute("stroke",r.fill||""),s.setAttribute("stroke-width",i+""),s.setAttribute("fill","none"),r.fillLineDash&&s.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&s.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),s}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,n){return this.gen.opsToPath(e,n)}line(e,n,r,i,s){const a=this.gen.line(e,n,r,i,s);return this.draw(a)}rectangle(e,n,r,i,s){const a=this.gen.rectangle(e,n,r,i,s);return this.draw(a)}ellipse(e,n,r,i,s){const a=this.gen.ellipse(e,n,r,i,s);return this.draw(a)}circle(e,n,r,i){const s=this.gen.circle(e,n,r,i);return this.draw(s)}linearPath(e,n){const r=this.gen.linearPath(e,n);return this.draw(r)}polygon(e,n){const r=this.gen.polygon(e,n);return this.draw(r)}arc(e,n,r,i,s,a,o=!1,u){const l=this.gen.arc(e,n,r,i,s,a,o,u);return this.draw(l)}curve(e,n){const r=this.gen.curve(e,n);return this.draw(r)}path(e,n){const r=this.gen.path(e,n);return this.draw(r)}}var FX={canvas:(t,e)=>new E$(t,e),svg:(t,e)=>new D$(t,e),generator:t=>new cf(t),newSeed:()=>cf.newSeed()},RA="comm",MA="rule",OA="decl",w$="@import",_$="@namespace",C$="@keyframes",A$="@layer",IA=Math.abs,z1=String.fromCharCode;function LA(t){return t.trim()}function Jc(t,e,n){return t.replace(e,n)}function T$(t,e,n){return t.indexOf(e,n)}function Fa(t,e){return t.charCodeAt(e)|0}function qa(t,e,n){return t.slice(e,n)}function Ur(t){return t.length}function k$(t){return t.length}function cc(t,e){return e.push(t),t}var xd=1,Xa=1,PA=0,cr=0,wt=0,ro="";function W1(t,e,n,r,i,s,a,o){return{value:t,root:e,parent:n,type:r,props:i,children:s,line:xd,column:Xa,length:a,return:"",siblings:o}}function S$(){return wt}function N$(){return wt=cr>0?Fa(ro,--cr):0,Xa--,wt===10&&(Xa=1,xd--),wt}function wr(){return wt=cr<PA?Fa(ro,cr++):0,Xa++,wt===10&&(Xa=1,xd++),wt}function zi(){return Fa(ro,cr)}function Zc(){return cr}function Ed(t,e){return qa(ro,t,e)}function tl(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function F$(t){return xd=Xa=1,PA=Ur(ro=t),cr=0,[]}function R$(t){return ro="",t}function zp(t){return LA(Ed(cr-1,_g(t===91?t+2:t===40?t+1:t)))}function M$(t){for(;(wt=zi())&&wt<33;)wr();return tl(t)>2||tl(wt)>3?"":" "}function O$(t,e){for(;--e&&wr()&&!(wt<48||wt>102||wt>57&&wt<65||wt>70&&wt<97););return Ed(t,Zc()+(e<6&&zi()==32&&wr()==32))}function _g(t){for(;wr();)switch(wt){case t:return cr;case 34:case 39:t!==34&&t!==39&&_g(wt);break;case 40:t===41&&_g(t);break;case 92:wr();break}return cr}function I$(t,e){for(;wr()&&t+wt!==57;)if(t+wt===84&&zi()===47)break;return"/*"+Ed(e,cr-1)+"*"+z1(t===47?t:wr())}function L$(t){for(;!tl(zi());)wr();return Ed(t,cr)}function RX(t){return R$(Qc("",null,null,null,[""],t=F$(t),0,[0],t))}function Qc(t,e,n,r,i,s,a,o,u){for(var l=0,c=0,h=a,d=0,f=0,p=0,g=1,m=1,y=1,b=0,v="",E=i,w=s,N=r,D=v;m;)switch(p=b,b=wr()){case 40:if(p!=108&&Fa(D,h-1)==58){T$(D+=Jc(zp(b),"&","&\f"),"&\f",IA(l?o[l-1]:0))!=-1&&(y=-1);break}case 34:case 39:case 91:D+=zp(b);break;case 9:case 10:case 13:case 32:D+=M$(p);break;case 92:D+=O$(Zc()-1,7);continue;case 47:switch(zi()){case 42:case 47:cc(P$(I$(wr(),Zc()),e,n,u),u),(tl(p||1)==5||tl(zi()||1)==5)&&Ur(D)&&qa(D,-1,void 0)!==" "&&(D+=" ");break;default:D+="/"}break;case 123*g:o[l++]=Ur(D)*y;case 125*g:case 59:case 0:switch(b){case 0:case 125:m=0;case 59+c:y==-1&&(D=Jc(D,/\f/g,"")),f>0&&(Ur(D)-h||g===0&&p===47)&&cc(f>32?bx(D+";",r,n,h-1,u):bx(Jc(D," ","")+";",r,n,h-2,u),u);break;case 59:D+=";";default:if(cc(N=vx(D,e,n,l,c,i,o,v,E=[],w=[],h,s),s),b===123)if(c===0)Qc(D,e,N,N,E,s,h,o,w);else{switch(d){case 99:if(Fa(D,3)===110)break;case 108:if(Fa(D,2)===97)break;default:c=0;case 100:case 109:case 115:}c?Qc(t,N,N,r&&cc(vx(t,N,N,0,0,i,o,v,i,E=[],h,w),w),i,w,h,o,r?E:w):Qc(D,N,N,N,[""],w,0,o,w)}}l=c=f=0,g=y=1,v=D="",h=a;break;case 58:h=1+Ur(D),f=p;default:if(g<1){if(b==123)--g;else if(b==125&&g++==0&&N$()==125)continue}switch(D+=z1(b),b*g){case 38:y=c>0?1:(D+="\f",-1);break;case 44:o[l++]=(Ur(D)-1)*y,y=1;break;case 64:zi()===45&&(D+=zp(wr())),d=zi(),c=h=Ur(v=D+=L$(Zc())),b++;break;case 45:p===45&&Ur(D)==2&&(g=0)}}return s}function vx(t,e,n,r,i,s,a,o,u,l,c,h){for(var d=i-1,f=i===0?s:[""],p=k$(f),g=0,m=0,y=0;g<r;++g)for(var b=0,v=qa(t,d+1,d=IA(m=a[g])),E=t;b<p;++b)(E=LA(m>0?f[b]+" "+v:Jc(v,/&\f/g,f[b])))&&(u[y++]=E);return W1(t,e,n,i===0?MA:o,u,l,c,h)}function P$(t,e,n,r){return W1(t,e,n,RA,z1(S$()),qa(t,2,-2),0,r)}function bx(t,e,n,r,i){return W1(t,e,n,OA,qa(t,0,r),qa(t,r+1,-1),r,i)}function xx(t,e){for(var n="",r=0;r<t.length;r++)n+=e(t[r],r,t,e)||"";return n}function MX(t,e,n,r){switch(t.type){case A$:if(t.children.length)break;case w$:case _$:case OA:return t.return=t.return||t.value;case RA:return"";case C$:return t.return=t.value+"{"+xx(t.children,r)+"}";case MA:if(!Ur(t.value=t.props.join(",")))return""}return Ur(n=xx(t.children,r))?t.return=t.value+"{"+n+"}":""}var $$="\0",us="\0",Ex="";class ni{constructor(e={}){this._isDirected=Object.prototype.hasOwnProperty.call(e,"directed")?e.directed:!0,this._isMultigraph=Object.prototype.hasOwnProperty.call(e,"multigraph")?e.multigraph:!1,this._isCompound=Object.prototype.hasOwnProperty.call(e,"compound")?e.compound:!1,this._label=void 0,this._defaultNodeLabelFn=Fo(void 0),this._defaultEdgeLabelFn=Fo(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[us]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return xi(e)||(e=Fo(e)),this._defaultNodeLabelFn=e,this}nodeCount(){return this._nodeCount}nodes(){return gr(this._nodes)}sources(){var e=this;return yt(this.nodes(),function(n){return Xe(e._in[n])})}sinks(){var e=this;return yt(this.nodes(),function(n){return Xe(e._out[n])})}setNodes(e,n){var r=arguments,i=this;return U(e,function(s){r.length>1?i.setNode(s,n):i.setNode(s)}),this}setNode(e,n){return Object.prototype.hasOwnProperty.call(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=n),this):(this._nodes[e]=arguments.length>1?n:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=us,this._children[e]={},this._children[us][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return Object.prototype.hasOwnProperty.call(this._nodes,e)}removeNode(e){if(Object.prototype.hasOwnProperty.call(this._nodes,e)){var n=r=>this.removeEdge(this._edgeObjs[r]);delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],U(this.children(e),r=>{this.setParent(r)}),delete this._children[e]),U(gr(this._in[e]),n),delete this._in[e],delete this._preds[e],U(gr(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Ye(n))n=us;else{n+="";for(var r=n;!Ye(r);r=this.parent(r))if(r===e)throw new Error("Setting "+n+" as parent of "+e+" would create a cycle");this.setNode(n)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=n,this._children[n][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var n=this._parent[e];if(n!==us)return n}}children(e){if(Ye(e)&&(e=us),this._isCompound){var n=this._children[e];if(n)return gr(n)}else{if(e===us)return this.nodes();if(this.hasNode(e))return[]}}predecessors(e){var n=this._preds[e];if(n)return gr(n)}successors(e){var n=this._sucs[e];if(n)return gr(n)}neighbors(e){var n=this.predecessors(e);if(n)return Mk(n,this.successors(e))}isLeaf(e){var n;return this.isDirected()?n=this.successors(e):n=this.neighbors(e),n.length===0}filterNodes(e){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var r=this;U(this._nodes,function(a,o){e(o)&&n.setNode(o,a)}),U(this._edgeObjs,function(a){n.hasNode(a.v)&&n.hasNode(a.w)&&n.setEdge(a,r.edge(a))});var i={};function s(a){var o=r.parent(a);return o===void 0||n.hasNode(o)?(i[a]=o,o):o in i?i[o]:s(o)}return this._isCompound&&U(n.nodes(),function(a){n.setParent(a,s(a))}),n}setDefaultEdgeLabel(e){return xi(e)||(e=Fo(e)),this._defaultEdgeLabelFn=e,this}edgeCount(){return this._edgeCount}edges(){return Qe(this._edgeObjs)}setPath(e,n){var r=this,i=arguments;return Ct(e,function(s,a){return i.length>1?r.setEdge(s,a,n):r.setEdge(s,a),a}),this}setEdge(){var e,n,r,i,s=!1,a=arguments[0];typeof a=="object"&&a!==null&&"v"in a?(e=a.v,n=a.w,r=a.name,arguments.length===2&&(i=arguments[1],s=!0)):(e=a,n=arguments[1],r=arguments[3],arguments.length>2&&(i=arguments[2],s=!0)),e=""+e,n=""+n,Ye(r)||(r=""+r);var o=Vo(this._isDirected,e,n,r);if(Object.prototype.hasOwnProperty.call(this._edgeLabels,o))return s&&(this._edgeLabels[o]=i),this;if(!Ye(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(n),this._edgeLabels[o]=s?i:this._defaultEdgeLabelFn(e,n,r);var u=B$(this._isDirected,e,n,r);return e=u.v,n=u.w,Object.freeze(u),this._edgeObjs[o]=u,Dx(this._preds[n],e),Dx(this._sucs[e],n),this._in[n][o]=u,this._out[e][o]=u,this._edgeCount++,this}edge(e,n,r){var i=arguments.length===1?Wp(this._isDirected,arguments[0]):Vo(this._isDirected,e,n,r);return this._edgeLabels[i]}hasEdge(e,n,r){var i=arguments.length===1?Wp(this._isDirected,arguments[0]):Vo(this._isDirected,e,n,r);return Object.prototype.hasOwnProperty.call(this._edgeLabels,i)}removeEdge(e,n,r){var i=arguments.length===1?Wp(this._isDirected,arguments[0]):Vo(this._isDirected,e,n,r),s=this._edgeObjs[i];return s&&(e=s.v,n=s.w,delete this._edgeLabels[i],delete this._edgeObjs[i],wx(this._preds[n],e),wx(this._sucs[e],n),delete this._in[n][i],delete this._out[e][i],this._edgeCount--),this}inEdges(e,n){var r=this._in[e];if(r){var i=Qe(r);return n?yt(i,function(s){return s.v===n}):i}}outEdges(e,n){var r=this._out[e];if(r){var i=Qe(r);return n?yt(i,function(s){return s.w===n}):i}}nodeEdges(e,n){var r=this.inEdges(e,n);if(r)return r.concat(this.outEdges(e,n))}}ni.prototype._nodeCount=0;ni.prototype._edgeCount=0;function Dx(t,e){t[e]?t[e]++:t[e]=1}function wx(t,e){--t[e]||delete t[e]}function Vo(t,e,n,r){var i=""+e,s=""+n;if(!t&&i>s){var a=i;i=s,s=a}return i+Ex+s+Ex+(Ye(r)?$$:r)}function B$(t,e,n,r){var i=""+e,s=""+n;if(!t&&i>s){var a=i;i=s,s=a}var o={v:i,w:s};return r&&(o.name=r),o}function Wp(t,e){return Vo(t,e.v,e.w,e.name)}class U${constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,n=e._prev;if(n!==e)return _x(n),n}enqueue(e){var n=this._sentinel;e._prev&&e._next&&_x(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n}toString(){for(var e=[],n=this._sentinel,r=n._prev;r!==n;)e.push(JSON.stringify(r,G$)),r=r._prev;return"["+e.join(", ")+"]"}}function _x(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function G$(t,e){if(t!=="_next"&&t!=="_prev")return e}var z$=Fo(1);function W$(t,e){if(t.nodeCount()<=1)return[];var n=Y$(t,e||z$),r=H$(n.graph,n.buckets,n.zeroIdx);return Qt(ne(r,function(i){return t.outEdges(i.v,i.w)}))}function H$(t,e,n){for(var r=[],i=e[e.length-1],s=e[0],a;t.nodeCount();){for(;a=s.dequeue();)Hp(t,e,n,a);for(;a=i.dequeue();)Hp(t,e,n,a);if(t.nodeCount()){for(var o=e.length-2;o>0;--o)if(a=e[o].dequeue(),a){r=r.concat(Hp(t,e,n,a,!0));break}}}return r}function Hp(t,e,n,r,i){var s=i?[]:void 0;return U(t.inEdges(r.v),function(a){var o=t.edge(a),u=t.node(a.v);i&&s.push({v:a.v,w:a.w}),u.out-=o,Cg(e,n,u)}),U(t.outEdges(r.v),function(a){var o=t.edge(a),u=a.w,l=t.node(u);l.in-=o,Cg(e,n,l)}),t.removeNode(r.v),s}function Y$(t,e){var n=new ni,r=0,i=0;U(t.nodes(),function(o){n.setNode(o,{v:o,in:0,out:0})}),U(t.edges(),function(o){var u=n.edge(o.v,o.w)||0,l=e(o),c=u+l;n.setEdge(o.v,o.w,c),i=Math.max(i,n.node(o.v).out+=l),r=Math.max(r,n.node(o.w).in+=l)});var s=Oa(i+r+3).map(function(){return new U$}),a=r+1;return U(n.nodes(),function(o){Cg(s,a,n.node(o))}),{graph:n,buckets:s,zeroIdx:a}}function Cg(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}function V$(t){var e=t.graph().acyclicer==="greedy"?W$(t,n(t)):q$(t);U(e,function(r){var i=t.edge(r);t.removeEdge(r),i.forwardName=r.name,i.reversed=!0,t.setEdge(r.w,r.v,i,hm("rev"))});function n(r){return function(i){return r.edge(i).weight}}}function q$(t){var e=[],n={},r={};function i(s){Object.prototype.hasOwnProperty.call(r,s)||(r[s]=!0,n[s]=!0,U(t.outEdges(s),function(a){Object.prototype.hasOwnProperty.call(n,a.w)?e.push(a):i(a.w)}),delete n[s])}return U(t.nodes(),i),e}function X$(t){U(t.edges(),function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var r=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,r)}})}function io(t,e,n,r){var i;do i=hm(r);while(t.hasNode(i));return n.dummy=e,t.setNode(i,n),i}function j$(t){var e=new ni().setGraph(t.graph());return U(t.nodes(),function(n){e.setNode(n,t.node(n))}),U(t.edges(),function(n){var r=e.edge(n.v,n.w)||{weight:0,minlen:1},i=t.edge(n);e.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),e}function $A(t){var e=new ni({multigraph:t.isMultigraph()}).setGraph(t.graph());return U(t.nodes(),function(n){t.children(n).length||e.setNode(n,t.node(n))}),U(t.edges(),function(n){e.setEdge(n,t.edge(n))}),e}function Cx(t,e){var n=t.x,r=t.y,i=e.x-n,s=e.y-r,a=t.width/2,o=t.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var u,l;return Math.abs(s)*a>Math.abs(i)*o?(s<0&&(o=-o),u=o*i/s,l=o):(i<0&&(a=-a),u=a,l=a*s/i),{x:n+u,y:r+l}}function Dd(t){var e=ne(Oa(BA(t)+1),function(){return[]});return U(t.nodes(),function(n){var r=t.node(n),i=r.rank;Ye(i)||(e[i][r.order]=n)}),e}function K$(t){var e=Ia(ne(t.nodes(),function(n){return t.node(n).rank}));U(t.nodes(),function(n){var r=t.node(n);ye(r,"rank")&&(r.rank-=e)})}function J$(t){var e=Ia(ne(t.nodes(),function(s){return t.node(s).rank})),n=[];U(t.nodes(),function(s){var a=t.node(s).rank-e;n[a]||(n[a]=[]),n[a].push(s)});var r=0,i=t.graph().nodeRankFactor;U(n,function(s,a){Ye(s)&&a%i!==0?--r:r&&U(s,function(o){t.node(o).rank+=r})})}function Ax(t,e,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),io(t,"border",i,e)}function BA(t){return Fs(ne(t.nodes(),function(e){var n=t.node(e).rank;if(!Ye(n))return n}))}function Z$(t,e){var n={lhs:[],rhs:[]};return U(t,function(r){e(r)?n.lhs.push(r):n.rhs.push(r)}),n}function Q$(t,e){return e()}function eB(t){function e(n){var r=t.children(n),i=t.node(n);if(r.length&&U(r,e),Object.prototype.hasOwnProperty.call(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var s=i.minRank,a=i.maxRank+1;s<a;++s)Tx(t,"borderLeft","_bl",n,i,s),Tx(t,"borderRight","_br",n,i,s)}}U(t.children(),e)}function Tx(t,e,n,r,i,s){var a={width:0,height:0,rank:s,borderType:e},o=i[e][s-1],u=io(t,"border",a,n);i[e][s]=u,t.setParent(u,r),o&&t.setEdge(o,u,{weight:1})}function tB(t){var e=t.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&UA(t)}function nB(t){var e=t.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&rB(t),(e==="lr"||e==="rl")&&(iB(t),UA(t))}function UA(t){U(t.nodes(),function(e){kx(t.node(e))}),U(t.edges(),function(e){kx(t.edge(e))})}function kx(t){var e=t.width;t.width=t.height,t.height=e}function rB(t){U(t.nodes(),function(e){Yp(t.node(e))}),U(t.edges(),function(e){var n=t.edge(e);U(n.points,Yp),Object.prototype.hasOwnProperty.call(n,"y")&&Yp(n)})}function Yp(t){t.y=-t.y}function iB(t){U(t.nodes(),function(e){Vp(t.node(e))}),U(t.edges(),function(e){var n=t.edge(e);U(n.points,Vp),Object.prototype.hasOwnProperty.call(n,"x")&&Vp(n)})}function Vp(t){var e=t.x;t.x=t.y,t.y=e}function sB(t){t.graph().dummyChains=[],U(t.edges(),function(e){aB(t,e)})}function aB(t,e){var n=e.v,r=t.node(n).rank,i=e.w,s=t.node(i).rank,a=e.name,o=t.edge(e),u=o.labelRank;if(s!==r+1){t.removeEdge(e);var l=void 0,c,h;for(h=0,++r;r<s;++h,++r)o.points=[],l={width:0,height:0,edgeLabel:o,edgeObj:e,rank:r},c=io(t,"edge",l,"_d"),r===u&&(l.width=o.width,l.height=o.height,l.dummy="edge-label",l.labelpos=o.labelpos),t.setEdge(n,c,{weight:o.weight},a),h===0&&t.graph().dummyChains.push(c),n=c;t.setEdge(n,i,{weight:o.weight},a)}}function oB(t){U(t.graph().dummyChains,function(e){var n=t.node(e),r=n.edgeLabel,i;for(t.setEdge(n.edgeObj,r);n.dummy;)i=t.successors(e)[0],t.removeNode(e),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),e=i,n=t.node(e)})}function H1(t){var e={};function n(r){var i=t.node(r);if(Object.prototype.hasOwnProperty.call(e,r))return i.rank;e[r]=!0;var s=Ia(ne(t.outEdges(r),function(a){return n(a.w)-t.edge(a).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),i.rank=s}U(t.sources(),n)}function nl(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}function GA(t){var e=new ni({directed:!1}),n=t.nodes()[0],r=t.nodeCount();e.setNode(n,{});for(var i,s;uB(e,t)<r;)i=lB(e,t),s=e.hasNode(i.v)?nl(t,i):-nl(t,i),cB(e,t,s);return e}function uB(t,e){function n(r){U(e.nodeEdges(r),function(i){var s=i.v,a=r===s?i.w:s;!t.hasNode(a)&&!nl(e,i)&&(t.setNode(a,{}),t.setEdge(r,a,{}),n(a))})}return U(t.nodes(),n),t.nodeCount()}function lB(t,e){return fm(e.edges(),function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return nl(e,n)})}function cB(t,e,n){U(t.nodes(),function(r){e.node(r).rank+=n})}function hB(){}hB.prototype=new Error;function zA(t,e,n){qn(e)||(e=[e]);var r=(t.isDirected()?t.successors:t.neighbors).bind(t),i=[],s={};return U(e,function(a){if(!t.hasNode(a))throw new Error("Graph does not have node: "+a);WA(t,a,n==="post",s,r,i)}),i}function WA(t,e,n,r,i,s){Object.prototype.hasOwnProperty.call(r,e)||(r[e]=!0,n||s.push(e),U(i(e),function(a){WA(t,a,n,r,i,s)}),n&&s.push(e))}function fB(t,e){return zA(t,e,"post")}function dB(t,e){return zA(t,e,"pre")}js.initLowLimValues=V1;js.initCutValues=Y1;js.calcCutValue=HA;js.leaveEdge=VA;js.enterEdge=qA;js.exchangeEdges=XA;function js(t){t=j$(t),H1(t);var e=GA(t);V1(e),Y1(e,t);for(var n,r;n=VA(e);)r=qA(e,t,n),XA(e,t,n,r)}function Y1(t,e){var n=fB(t,t.nodes());n=n.slice(0,n.length-1),U(n,function(r){pB(t,e,r)})}function pB(t,e,n){var r=t.node(n),i=r.parent;t.edge(n,i).cutvalue=HA(t,e,n)}function HA(t,e,n){var r=t.node(n),i=r.parent,s=!0,a=e.edge(n,i),o=0;return a||(s=!1,a=e.edge(i,n)),o=a.weight,U(e.nodeEdges(n),function(u){var l=u.v===n,c=l?u.w:u.v;if(c!==i){var h=l===s,d=e.edge(u).weight;if(o+=h?d:-d,mB(t,n,c)){var f=t.edge(n,c).cutvalue;o+=h?-f:f}}}),o}function V1(t,e){arguments.length<2&&(e=t.nodes()[0]),YA(t,{},1,e)}function YA(t,e,n,r,i){var s=n,a=t.node(r);return e[r]=!0,U(t.neighbors(r),function(o){Object.prototype.hasOwnProperty.call(e,o)||(n=YA(t,e,n,o,r))}),a.low=s,a.lim=n++,i?a.parent=i:delete a.parent,n}function VA(t){return Ei(t.edges(),function(e){return t.edge(e).cutvalue<0})}function qA(t,e,n){var r=n.v,i=n.w;e.hasEdge(r,i)||(r=n.w,i=n.v);var s=t.node(r),a=t.node(i),o=s,u=!1;s.lim>a.lim&&(o=a,u=!0);var l=yt(e.edges(),function(c){return u===Sx(t,t.node(c.v),o)&&u!==Sx(t,t.node(c.w),o)});return fm(l,function(c){return nl(e,c)})}function XA(t,e,n,r){var i=n.v,s=n.w;t.removeEdge(i,s),t.setEdge(r.v,r.w,{}),V1(t),Y1(t,e),gB(t,e)}function gB(t,e){var n=Ei(t.nodes(),function(i){return!e.node(i).parent}),r=dB(t,n);r=r.slice(1),U(r,function(i){var s=t.node(i).parent,a=e.edge(i,s),o=!1;a||(a=e.edge(s,i),o=!0),e.node(i).rank=e.node(s).rank+(o?a.minlen:-a.minlen)})}function mB(t,e,n){return t.hasEdge(e,n)}function Sx(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}function yB(t){switch(t.graph().ranker){case"network-simplex":Nx(t);break;case"tight-tree":bB(t);break;case"longest-path":vB(t);break;default:Nx(t)}}var vB=H1;function bB(t){H1(t),GA(t)}function Nx(t){js(t)}function xB(t){var e=io(t,"root",{},"_root"),n=EB(t),r=Fs(Qe(n))-1,i=2*r+1;t.graph().nestingRoot=e,U(t.edges(),function(a){t.edge(a).minlen*=i});var s=DB(t)+1;U(t.children(),function(a){jA(t,e,i,s,r,n,a)}),t.graph().nodeRankFactor=i}function jA(t,e,n,r,i,s,a){var o=t.children(a);if(!o.length){a!==e&&t.setEdge(e,a,{weight:0,minlen:n});return}var u=Ax(t,"_bt"),l=Ax(t,"_bb"),c=t.node(a);t.setParent(u,a),c.borderTop=u,t.setParent(l,a),c.borderBottom=l,U(o,function(h){jA(t,e,n,r,i,s,h);var d=t.node(h),f=d.borderTop?d.borderTop:h,p=d.borderBottom?d.borderBottom:h,g=d.borderTop?r:2*r,m=f!==p?1:i-s[a]+1;t.setEdge(u,f,{weight:g,minlen:m,nestingEdge:!0}),t.setEdge(p,l,{weight:g,minlen:m,nestingEdge:!0})}),t.parent(a)||t.setEdge(e,u,{weight:0,minlen:i+s[a]})}function EB(t){var e={};function n(r,i){var s=t.children(r);s&&s.length&&U(s,function(a){n(a,i+1)}),e[r]=i}return U(t.children(),function(r){n(r,1)}),e}function DB(t){return Ct(t.edges(),function(e,n){return e+t.edge(n).weight},0)}function wB(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,U(t.edges(),function(n){var r=t.edge(n);r.nestingEdge&&t.removeEdge(n)})}function _B(t,e,n){var r={},i;U(n,function(s){for(var a=t.parent(s),o,u;a;){if(o=t.parent(a),o?(u=r[o],r[o]=a):(u=i,i=a),u&&u!==a){e.setEdge(u,a);return}a=o}})}function CB(t,e,n){var r=AB(t),i=new ni({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(s){return t.node(s)});return U(t.nodes(),function(s){var a=t.node(s),o=t.parent(s);(a.rank===e||a.minRank<=e&&e<=a.maxRank)&&(i.setNode(s),i.setParent(s,o||r),U(t[n](s),function(u){var l=u.v===s?u.w:u.v,c=i.edge(l,s),h=Ye(c)?0:c.weight;i.setEdge(l,s,{weight:t.edge(u).weight+h})}),Object.prototype.hasOwnProperty.call(a,"minRank")&&i.setNode(s,{borderLeft:a.borderLeft[e],borderRight:a.borderRight[e]}))}),i}function AB(t){for(var e;t.hasNode(e=hm("_root")););return e}function TB(t,e){for(var n=0,r=1;r<e.length;++r)n+=kB(t,e[r-1],e[r]);return n}function kB(t,e,n){for(var r=Ok(n,ne(n,function(l,c){return c})),i=Qt(ne(e,function(l){return al(ne(t.outEdges(l),function(c){return{pos:r[c.w],weight:t.edge(c).weight}}),"pos")})),s=1;s<n.length;)s<<=1;var a=2*s-1;s-=1;var o=ne(new Array(a),function(){return 0}),u=0;return U(i.forEach(function(l){var c=l.pos+s;o[c]+=l.weight;for(var h=0;c>0;)c%2&&(h+=o[c+1]),c=c-1>>1,o[c]+=l.weight;u+=l.weight*h})),u}function SB(t){var e={},n=yt(t.nodes(),function(o){return!t.children(o).length}),r=Fs(ne(n,function(o){return t.node(o).rank})),i=ne(Oa(r+1),function(){return[]});function s(o){if(!ye(e,o)){e[o]=!0;var u=t.node(o);i[u.rank].push(o),U(t.successors(o),s)}}var a=al(n,function(o){return t.node(o).rank});return U(a,s),i}function NB(t,e){return ne(e,function(n){var r=t.inEdges(n);if(r.length){var i=Ct(r,function(s,a){var o=t.edge(a),u=t.node(a.v);return{sum:s.sum+o.weight*u.order,weight:s.weight+o.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:n}})}function FB(t,e){var n={};U(t,function(i,s){var a=n[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:s};Ye(i.barycenter)||(a.barycenter=i.barycenter,a.weight=i.weight)}),U(e.edges(),function(i){var s=n[i.v],a=n[i.w];!Ye(s)&&!Ye(a)&&(a.indegree++,s.out.push(n[i.w]))});var r=yt(n,function(i){return!i.indegree});return RB(r)}function RB(t){var e=[];function n(s){return function(a){a.merged||(Ye(a.barycenter)||Ye(s.barycenter)||a.barycenter>=s.barycenter)&&MB(s,a)}}function r(s){return function(a){a.in.push(s),--a.indegree===0&&t.push(a)}}for(;t.length;){var i=t.pop();e.push(i),U(i.in.reverse(),n(i)),U(i.out,r(i))}return ne(yt(e,function(s){return!s.merged}),function(s){return gh(s,["vs","i","barycenter","weight"])})}function MB(t,e){var n=0,r=0;t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.vs=e.vs.concat(t.vs),t.barycenter=n/r,t.weight=r,t.i=Math.min(e.i,t.i),e.merged=!0}function OB(t,e){var n=Z$(t,function(c){return Object.prototype.hasOwnProperty.call(c,"barycenter")}),r=n.lhs,i=al(n.rhs,function(c){return-c.i}),s=[],a=0,o=0,u=0;r.sort(IB(!!e)),u=Fx(s,i,u),U(r,function(c){u+=c.vs.length,s.push(c.vs),a+=c.barycenter*c.weight,o+=c.weight,u=Fx(s,i,u)});var l={vs:Qt(s)};return o&&(l.barycenter=a/o,l.weight=o),l}function Fx(t,e,n){for(var r;e.length&&(r=jr(e)).i<=n;)e.pop(),t.push(r.vs),n++;return n}function IB(t){return function(e,n){return e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:t?n.i-e.i:e.i-n.i}}function KA(t,e,n,r){var i=t.children(e),s=t.node(e),a=s?s.borderLeft:void 0,o=s?s.borderRight:void 0,u={};a&&(i=yt(i,function(p){return p!==a&&p!==o}));var l=NB(t,i);U(l,function(p){if(t.children(p.v).length){var g=KA(t,p.v,n,r);u[p.v]=g,Object.prototype.hasOwnProperty.call(g,"barycenter")&&PB(p,g)}});var c=FB(l,n);LB(c,u);var h=OB(c,r);if(a&&(h.vs=Qt([a,h.vs,o]),t.predecessors(a).length)){var d=t.node(t.predecessors(a)[0]),f=t.node(t.predecessors(o)[0]);Object.prototype.hasOwnProperty.call(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+d.order+f.order)/(h.weight+2),h.weight+=2}return h}function LB(t,e){U(t,function(n){n.vs=Qt(n.vs.map(function(r){return e[r]?e[r].vs:r}))})}function PB(t,e){Ye(t.barycenter)?(t.barycenter=e.barycenter,t.weight=e.weight):(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight)}function $B(t){var e=BA(t),n=Rx(t,Oa(1,e+1),"inEdges"),r=Rx(t,Oa(e-1,-1,-1),"outEdges"),i=SB(t);Mx(t,i);for(var s=Number.POSITIVE_INFINITY,a,o=0,u=0;u<4;++o,++u){BB(o%2?n:r,o%4>=2),i=Dd(t);var l=TB(t,i);l<s&&(u=0,a=Ik(i),s=l)}Mx(t,a)}function Rx(t,e,n){return ne(e,function(r){return CB(t,r,n)})}function BB(t,e){var n=new ni;U(t,function(r){var i=r.graph().root,s=KA(r,i,n,e);U(s.vs,function(a,o){r.node(a).order=o}),_B(r,n,s.vs)})}function Mx(t,e){U(e,function(n){U(n,function(r,i){t.node(r).order=i})})}function UB(t){var e=zB(t);U(t.graph().dummyChains,function(n){for(var r=t.node(n),i=r.edgeObj,s=GB(t,e,i.v,i.w),a=s.path,o=s.lca,u=0,l=a[u],c=!0;n!==i.w;){if(r=t.node(n),c){for(;(l=a[u])!==o&&t.node(l).maxRank<r.rank;)u++;l===o&&(c=!1)}if(!c){for(;u<a.length-1&&t.node(l=a[u+1]).minRank<=r.rank;)u++;l=a[u]}t.setParent(n,l),n=t.successors(n)[0]}})}function GB(t,e,n,r){var i=[],s=[],a=Math.min(e[n].low,e[r].low),o=Math.max(e[n].lim,e[r].lim),u,l;u=n;do u=t.parent(u),i.push(u);while(u&&(e[u].low>a||o>e[u].lim));for(l=u,u=r;(u=t.parent(u))!==l;)s.push(u);return{path:i.concat(s.reverse()),lca:l}}function zB(t){var e={},n=0;function r(i){var s=n;U(t.children(i),r),e[i]={low:s,lim:n++}}return U(t.children(),r),e}function WB(t,e){var n={};function r(i,s){var a=0,o=0,u=i.length,l=jr(s);return U(s,function(c,h){var d=YB(t,c),f=d?t.node(d).order:u;(d||c===l)&&(U(s.slice(o,h+1),function(p){U(t.predecessors(p),function(g){var m=t.node(g),y=m.order;(y<a||f<y)&&!(m.dummy&&t.node(p).dummy)&&JA(n,g,p)})}),o=h+1,a=f)}),s}return Ct(e,r),n}function HB(t,e){var n={};function r(s,a,o,u,l){var c;U(Oa(a,o),function(h){c=s[h],t.node(c).dummy&&U(t.predecessors(c),function(d){var f=t.node(d);f.dummy&&(f.order<u||f.order>l)&&JA(n,d,c)})})}function i(s,a){var o=-1,u,l=0;return U(a,function(c,h){if(t.node(c).dummy==="border"){var d=t.predecessors(c);d.length&&(u=t.node(d[0]).order,r(a,l,h,o,u),l=h,o=u)}r(a,l,a.length,u,s.length)}),a}return Ct(e,i),n}function YB(t,e){if(t.node(e).dummy)return Ei(t.predecessors(e),function(n){return t.node(n).dummy})}function JA(t,e,n){if(e>n){var r=e;e=n,n=r}var i=t[e];i||(t[e]=i={}),i[n]=!0}function VB(t,e,n){if(e>n){var r=e;e=n,n=r}return!!t[e]&&Object.prototype.hasOwnProperty.call(t[e],n)}function qB(t,e,n,r){var i={},s={},a={};return U(e,function(o){U(o,function(u,l){i[u]=u,s[u]=u,a[u]=l})}),U(e,function(o){var u=-1;U(o,function(l){var c=r(l);if(c.length){c=al(c,function(g){return a[g]});for(var h=(c.length-1)/2,d=Math.floor(h),f=Math.ceil(h);d<=f;++d){var p=c[d];s[l]===l&&u<a[p]&&!VB(n,l,p)&&(s[p]=l,s[l]=i[l]=i[p],u=a[p])}}})}),{root:i,align:s}}function XB(t,e,n,r,i){var s={},a=jB(t,e,n,i),o=i?"borderLeft":"borderRight";function u(h,d){for(var f=a.nodes(),p=f.pop(),g={};p;)g[p]?h(p):(g[p]=!0,f.push(p),f=f.concat(d(p))),p=f.pop()}function l(h){s[h]=a.inEdges(h).reduce(function(d,f){return Math.max(d,s[f.v]+a.edge(f))},0)}function c(h){var d=a.outEdges(h).reduce(function(p,g){return Math.min(p,s[g.w]-a.edge(g))},Number.POSITIVE_INFINITY),f=t.node(h);d!==Number.POSITIVE_INFINITY&&f.borderType!==o&&(s[h]=Math.max(s[h],d))}return u(l,a.predecessors.bind(a)),u(c,a.successors.bind(a)),U(r,function(h){s[h]=s[n[h]]}),s}function jB(t,e,n,r){var i=new ni,s=t.graph(),a=eU(s.nodesep,s.edgesep,r);return U(e,function(o){var u;U(o,function(l){var c=n[l];if(i.setNode(c),u){var h=n[u],d=i.edge(h,c);i.setEdge(h,c,Math.max(a(t,l,u),d||0))}u=l})}),i}function KB(t,e){return fm(Qe(e),function(n){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return Lk(n,function(s,a){var o=tU(t,a)/2;r=Math.max(s+o,r),i=Math.min(s-o,i)}),r-i})}function JB(t,e){var n=Qe(e),r=Ia(n),i=Fs(n);U(["u","d"],function(s){U(["l","r"],function(a){var o=s+a,u=t[o],l;if(u!==e){var c=Qe(u);l=a==="l"?r-Ia(c):i-Fs(c),l&&(t[o]=If(u,function(h){return h+l}))}})})}function ZB(t,e){return If(t.ul,function(n,r){if(e)return t[e.toLowerCase()][r];var i=al(ne(t,r));return(i[1]+i[2])/2})}function QB(t){var e=Dd(t),n=m0(WB(t,e),HB(t,e)),r={},i;U(["u","d"],function(a){i=a==="u"?e:Qe(e).reverse(),U(["l","r"],function(o){o==="r"&&(i=ne(i,function(h){return Qe(h).reverse()}));var u=(a==="u"?t.predecessors:t.successors).bind(t),l=qB(t,i,n,u),c=XB(t,i,l.root,l.align,o==="r");o==="r"&&(c=If(c,function(h){return-h})),r[a+o]=c})});var s=KB(t,r);return JB(r,s),ZB(r,t.graph().align)}function eU(t,e,n){return function(r,i,s){var a=r.node(i),o=r.node(s),u=0,l;if(u+=a.width/2,Object.prototype.hasOwnProperty.call(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=-a.width/2;break;case"r":l=a.width/2;break}if(l&&(u+=n?l:-l),l=0,u+=(a.dummy?e:t)/2,u+=(o.dummy?e:t)/2,u+=o.width/2,Object.prototype.hasOwnProperty.call(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":l=o.width/2;break;case"r":l=-o.width/2;break}return l&&(u+=n?l:-l),l=0,u}}function tU(t,e){return t.node(e).width}function nU(t){t=$A(t),rU(t),Pk(QB(t),function(e,n){t.node(n).x=e})}function rU(t){var e=Dd(t),n=t.graph().ranksep,r=0;U(e,function(i){var s=Fs(ne(i,function(a){return t.node(a).height}));U(i,function(a){t.node(a).y=r+s/2}),r+=s+n})}function OX(t,e){var n=Q$;n("layout",()=>{var r=n("  buildLayoutGraph",()=>pU(t));n("  runLayout",()=>iU(r,n)),n("  updateInputGraph",()=>sU(t,r))})}function iU(t,e){e("    makeSpaceForEdgeLabels",()=>gU(t)),e("    removeSelfEdges",()=>_U(t)),e("    acyclic",()=>V$(t)),e("    nestingGraph.run",()=>xB(t)),e("    rank",()=>yB($A(t))),e("    injectEdgeLabelProxies",()=>mU(t)),e("    removeEmptyRanks",()=>J$(t)),e("    nestingGraph.cleanup",()=>wB(t)),e("    normalizeRanks",()=>K$(t)),e("    assignRankMinMax",()=>yU(t)),e("    removeEdgeLabelProxies",()=>vU(t)),e("    normalize.run",()=>sB(t)),e("    parentDummyChains",()=>UB(t)),e("    addBorderSegments",()=>eB(t)),e("    order",()=>$B(t)),e("    insertSelfEdges",()=>CU(t)),e("    adjustCoordinateSystem",()=>tB(t)),e("    position",()=>nU(t)),e("    positionSelfEdges",()=>AU(t)),e("    removeBorderNodes",()=>wU(t)),e("    normalize.undo",()=>oB(t)),e("    fixupEdgeLabelCoords",()=>EU(t)),e("    undoCoordinateSystem",()=>nB(t)),e("    translateGraph",()=>bU(t)),e("    assignNodeIntersects",()=>xU(t)),e("    reversePoints",()=>DU(t)),e("    acyclic.undo",()=>X$(t))}function sU(t,e){U(t.nodes(),function(n){var r=t.node(n),i=e.node(n);r&&(r.x=i.x,r.y=i.y,e.children(n).length&&(r.width=i.width,r.height=i.height))}),U(t.edges(),function(n){var r=t.edge(n),i=e.edge(n);r.points=i.points,Object.prototype.hasOwnProperty.call(i,"x")&&(r.x=i.x,r.y=i.y)}),t.graph().width=e.graph().width,t.graph().height=e.graph().height}var aU=["nodesep","edgesep","ranksep","marginx","marginy"],oU={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},uU=["acyclicer","ranker","rankdir","align"],lU=["width","height"],cU={width:0,height:0},hU=["minlen","weight","width","height","labeloffset"],fU={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},dU=["labelpos"];function pU(t){var e=new ni({multigraph:!0,compound:!0}),n=Xp(t.graph());return e.setGraph(m0({},oU,qp(n,aU),gh(n,uU))),U(t.nodes(),function(r){var i=Xp(t.node(r));e.setNode(r,Lf(qp(i,lU),cU)),e.setParent(r,t.parent(r))}),U(t.edges(),function(r){var i=Xp(t.edge(r));e.setEdge(r,m0({},fU,qp(i,hU),gh(i,dU)))}),e}function gU(t){var e=t.graph();e.ranksep/=2,U(t.edges(),function(n){var r=t.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function mU(t){U(t.edges(),function(e){var n=t.edge(e);if(n.width&&n.height){var r=t.node(e.v),i=t.node(e.w),s={rank:(i.rank-r.rank)/2+r.rank,e};io(t,"edge-proxy",s,"_ep")}})}function yU(t){var e=0;U(t.nodes(),function(n){var r=t.node(n);r.borderTop&&(r.minRank=t.node(r.borderTop).rank,r.maxRank=t.node(r.borderBottom).rank,e=Fs(e,r.maxRank))}),t.graph().maxRank=e}function vU(t){U(t.nodes(),function(e){var n=t.node(e);n.dummy==="edge-proxy"&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))})}function bU(t){var e=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,s=t.graph(),a=s.marginx||0,o=s.marginy||0;function u(l){var c=l.x,h=l.y,d=l.width,f=l.height;e=Math.min(e,c-d/2),n=Math.max(n,c+d/2),r=Math.min(r,h-f/2),i=Math.max(i,h+f/2)}U(t.nodes(),function(l){u(t.node(l))}),U(t.edges(),function(l){var c=t.edge(l);Object.prototype.hasOwnProperty.call(c,"x")&&u(c)}),e-=a,r-=o,U(t.nodes(),function(l){var c=t.node(l);c.x-=e,c.y-=r}),U(t.edges(),function(l){var c=t.edge(l);U(c.points,function(h){h.x-=e,h.y-=r}),Object.prototype.hasOwnProperty.call(c,"x")&&(c.x-=e),Object.prototype.hasOwnProperty.call(c,"y")&&(c.y-=r)}),s.width=n-e+a,s.height=i-r+o}function xU(t){U(t.edges(),function(e){var n=t.edge(e),r=t.node(e.v),i=t.node(e.w),s,a;n.points?(s=n.points[0],a=n.points[n.points.length-1]):(n.points=[],s=i,a=r),n.points.unshift(Cx(r,s)),n.points.push(Cx(i,a))})}function EU(t){U(t.edges(),function(e){var n=t.edge(e);if(Object.prototype.hasOwnProperty.call(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function DU(t){U(t.edges(),function(e){var n=t.edge(e);n.reversed&&n.points.reverse()})}function wU(t){U(t.nodes(),function(e){if(t.children(e).length){var n=t.node(e),r=t.node(n.borderTop),i=t.node(n.borderBottom),s=t.node(jr(n.borderLeft)),a=t.node(jr(n.borderRight));n.width=Math.abs(a.x-s.x),n.height=Math.abs(i.y-r.y),n.x=s.x+n.width/2,n.y=r.y+n.height/2}}),U(t.nodes(),function(e){t.node(e).dummy==="border"&&t.removeNode(e)})}function _U(t){U(t.edges(),function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e,label:t.edge(e)}),t.removeEdge(e)}})}function CU(t){var e=Dd(t);U(e,function(n){var r=0;U(n,function(i,s){var a=t.node(i);a.order=s+r,U(a.selfEdges,function(o){io(t,"selfedge",{width:o.label.width,height:o.label.height,rank:a.rank,order:s+ ++r,e:o.e,label:o.label},"_se")}),delete a.selfEdges})})}function AU(t){U(t.nodes(),function(e){var n=t.node(e);if(n.dummy==="selfedge"){var r=t.node(n.e.v),i=r.x+r.width/2,s=r.y,a=n.x-i,o=r.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:i+2*a/3,y:s-o},{x:i+5*a/6,y:s-o},{x:i+a,y:s},{x:i+5*a/6,y:s+o},{x:i+2*a/3,y:s+o}],n.label.x=n.x,n.label.y=n.y}})}function qp(t,e){return If(gh(t,e),Number)}function Xp(t){var e={};return U(t,function(n,r){e[r.toLowerCase()]=n}),e}function IX(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:TU(t),edges:kU(t)};return Ye(t.graph())||(e.value=Ut(t.graph())),e}function TU(t){return ne(t.nodes(),function(e){var n=t.node(e),r=t.parent(e),i={v:e};return Ye(n)||(i.value=n),Ye(r)||(i.parent=r),i})}function kU(t){return ne(t.edges(),function(e){var n=t.edge(e),r={v:e.v,w:e.w};return Ye(e.name)||(r.name=e.name),Ye(n)||(r.value=n),r})}var eh={exports:{}},th={exports:{}},SU=th.exports,Ox;function NU(){return Ox||(Ox=1,function(t,e){(function(r,i){t.exports=i()})(SU,function(){return function(n){var r={};function i(s){if(r[s])return r[s].exports;var a=r[s]={i:s,l:!1,exports:{}};return n[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=n,i.c=r,i.i=function(s){return s},i.d=function(s,a,o){i.o(s,a)||Object.defineProperty(s,a,{configurable:!1,enumerable:!0,get:o})},i.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(a,"a",a),a},i.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},i.p="",i(i.s=26)}([function(n,r,i){function s(){}s.QUALITY=1,s.DEFAULT_CREATE_BENDS_AS_NEEDED=!1,s.DEFAULT_INCREMENTAL=!1,s.DEFAULT_ANIMATION_ON_LAYOUT=!0,s.DEFAULT_ANIMATION_DURING_LAYOUT=!1,s.DEFAULT_ANIMATION_PERIOD=50,s.DEFAULT_UNIFORM_LEAF_NODE_SIZES=!1,s.DEFAULT_GRAPH_MARGIN=15,s.NODE_DIMENSIONS_INCLUDE_LABELS=!1,s.SIMPLE_NODE_SIZE=40,s.SIMPLE_NODE_HALF_SIZE=s.SIMPLE_NODE_SIZE/2,s.EMPTY_COMPOUND_NODE_SIZE=40,s.MIN_EDGE_LENGTH=1,s.WORLD_BOUNDARY=1e6,s.INITIAL_WORLD_BOUNDARY=s.WORLD_BOUNDARY/1e3,s.WORLD_CENTER_X=1200,s.WORLD_CENTER_Y=900,n.exports=s},function(n,r,i){var s=i(2),a=i(8),o=i(9);function u(c,h,d){s.call(this,d),this.isOverlapingSourceAndTarget=!1,this.vGraphObject=d,this.bendpoints=[],this.source=c,this.target=h}u.prototype=Object.create(s.prototype);for(var l in s)u[l]=s[l];u.prototype.getSource=function(){return this.source},u.prototype.getTarget=function(){return this.target},u.prototype.isInterGraph=function(){return this.isInterGraph},u.prototype.getLength=function(){return this.length},u.prototype.isOverlapingSourceAndTarget=function(){return this.isOverlapingSourceAndTarget},u.prototype.getBendpoints=function(){return this.bendpoints},u.prototype.getLca=function(){return this.lca},u.prototype.getSourceInLca=function(){return this.sourceInLca},u.prototype.getTargetInLca=function(){return this.targetInLca},u.prototype.getOtherEnd=function(c){if(this.source===c)return this.target;if(this.target===c)return this.source;throw"Node is not incident with this edge"},u.prototype.getOtherEndInGraph=function(c,h){for(var d=this.getOtherEnd(c),f=h.getGraphManager().getRoot();;){if(d.getOwner()==h)return d;if(d.getOwner()==f)break;d=d.getOwner().getParent()}return null},u.prototype.updateLength=function(){var c=new Array(4);this.isOverlapingSourceAndTarget=a.getIntersection(this.target.getRect(),this.source.getRect(),c),this.isOverlapingSourceAndTarget||(this.lengthX=c[0]-c[2],this.lengthY=c[1]-c[3],Math.abs(this.lengthX)<1&&(this.lengthX=o.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=o.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY))},u.prototype.updateLengthSimple=function(){this.lengthX=this.target.getCenterX()-this.source.getCenterX(),this.lengthY=this.target.getCenterY()-this.source.getCenterY(),Math.abs(this.lengthX)<1&&(this.lengthX=o.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=o.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY)},n.exports=u},function(n,r,i){function s(a){this.vGraphObject=a}n.exports=s},function(n,r,i){var s=i(2),a=i(10),o=i(13),u=i(0),l=i(16),c=i(4);function h(f,p,g,m){g==null&&m==null&&(m=p),s.call(this,m),f.graphManager!=null&&(f=f.graphManager),this.estimatedSize=a.MIN_VALUE,this.inclusionTreeDepth=a.MAX_VALUE,this.vGraphObject=m,this.edges=[],this.graphManager=f,g!=null&&p!=null?this.rect=new o(p.x,p.y,g.width,g.height):this.rect=new o}h.prototype=Object.create(s.prototype);for(var d in s)h[d]=s[d];h.prototype.getEdges=function(){return this.edges},h.prototype.getChild=function(){return this.child},h.prototype.getOwner=function(){return this.owner},h.prototype.getWidth=function(){return this.rect.width},h.prototype.setWidth=function(f){this.rect.width=f},h.prototype.getHeight=function(){return this.rect.height},h.prototype.setHeight=function(f){this.rect.height=f},h.prototype.getCenterX=function(){return this.rect.x+this.rect.width/2},h.prototype.getCenterY=function(){return this.rect.y+this.rect.height/2},h.prototype.getCenter=function(){return new c(this.rect.x+this.rect.width/2,this.rect.y+this.rect.height/2)},h.prototype.getLocation=function(){return new c(this.rect.x,this.rect.y)},h.prototype.getRect=function(){return this.rect},h.prototype.getDiagonal=function(){return Math.sqrt(this.rect.width*this.rect.width+this.rect.height*this.rect.height)},h.prototype.getHalfTheDiagonal=function(){return Math.sqrt(this.rect.height*this.rect.height+this.rect.width*this.rect.width)/2},h.prototype.setRect=function(f,p){this.rect.x=f.x,this.rect.y=f.y,this.rect.width=p.width,this.rect.height=p.height},h.prototype.setCenter=function(f,p){this.rect.x=f-this.rect.width/2,this.rect.y=p-this.rect.height/2},h.prototype.setLocation=function(f,p){this.rect.x=f,this.rect.y=p},h.prototype.moveBy=function(f,p){this.rect.x+=f,this.rect.y+=p},h.prototype.getEdgeListToNode=function(f){var p=[],g=this;return g.edges.forEach(function(m){if(m.target==f){if(m.source!=g)throw"Incorrect edge source!";p.push(m)}}),p},h.prototype.getEdgesBetween=function(f){var p=[],g=this;return g.edges.forEach(function(m){if(!(m.source==g||m.target==g))throw"Incorrect edge source and/or target";(m.target==f||m.source==f)&&p.push(m)}),p},h.prototype.getNeighborsList=function(){var f=new Set,p=this;return p.edges.forEach(function(g){if(g.source==p)f.add(g.target);else{if(g.target!=p)throw"Incorrect incidency!";f.add(g.source)}}),f},h.prototype.withChildren=function(){var f=new Set,p,g;if(f.add(this),this.child!=null)for(var m=this.child.getNodes(),y=0;y<m.length;y++)p=m[y],g=p.withChildren(),g.forEach(function(b){f.add(b)});return f},h.prototype.getNoOfChildren=function(){var f=0,p;if(this.child==null)f=1;else for(var g=this.child.getNodes(),m=0;m<g.length;m++)p=g[m],f+=p.getNoOfChildren();return f==0&&(f=1),f},h.prototype.getEstimatedSize=function(){if(this.estimatedSize==a.MIN_VALUE)throw"assert failed";return this.estimatedSize},h.prototype.calcEstimatedSize=function(){return this.child==null?this.estimatedSize=(this.rect.width+this.rect.height)/2:(this.estimatedSize=this.child.calcEstimatedSize(),this.rect.width=this.estimatedSize,this.rect.height=this.estimatedSize,this.estimatedSize)},h.prototype.scatter=function(){var f,p,g=-u.INITIAL_WORLD_BOUNDARY,m=u.INITIAL_WORLD_BOUNDARY;f=u.WORLD_CENTER_X+l.nextDouble()*(m-g)+g;var y=-u.INITIAL_WORLD_BOUNDARY,b=u.INITIAL_WORLD_BOUNDARY;p=u.WORLD_CENTER_Y+l.nextDouble()*(b-y)+y,this.rect.x=f,this.rect.y=p},h.prototype.updateBounds=function(){if(this.getChild()==null)throw"assert failed";if(this.getChild().getNodes().length!=0){var f=this.getChild();if(f.updateBounds(!0),this.rect.x=f.getLeft(),this.rect.y=f.getTop(),this.setWidth(f.getRight()-f.getLeft()),this.setHeight(f.getBottom()-f.getTop()),u.NODE_DIMENSIONS_INCLUDE_LABELS){var p=f.getRight()-f.getLeft(),g=f.getBottom()-f.getTop();this.labelWidth>p&&(this.rect.x-=(this.labelWidth-p)/2,this.setWidth(this.labelWidth)),this.labelHeight>g&&(this.labelPos=="center"?this.rect.y-=(this.labelHeight-g)/2:this.labelPos=="top"&&(this.rect.y-=this.labelHeight-g),this.setHeight(this.labelHeight))}}},h.prototype.getInclusionTreeDepth=function(){if(this.inclusionTreeDepth==a.MAX_VALUE)throw"assert failed";return this.inclusionTreeDepth},h.prototype.transform=function(f){var p=this.rect.x;p>u.WORLD_BOUNDARY?p=u.WORLD_BOUNDARY:p<-u.WORLD_BOUNDARY&&(p=-u.WORLD_BOUNDARY);var g=this.rect.y;g>u.WORLD_BOUNDARY?g=u.WORLD_BOUNDARY:g<-u.WORLD_BOUNDARY&&(g=-u.WORLD_BOUNDARY);var m=new c(p,g),y=f.inverseTransformPoint(m);this.setLocation(y.x,y.y)},h.prototype.getLeft=function(){return this.rect.x},h.prototype.getRight=function(){return this.rect.x+this.rect.width},h.prototype.getTop=function(){return this.rect.y},h.prototype.getBottom=function(){return this.rect.y+this.rect.height},h.prototype.getParent=function(){return this.owner==null?null:this.owner.getParent()},n.exports=h},function(n,r,i){function s(a,o){a==null&&o==null?(this.x=0,this.y=0):(this.x=a,this.y=o)}s.prototype.getX=function(){return this.x},s.prototype.getY=function(){return this.y},s.prototype.setX=function(a){this.x=a},s.prototype.setY=function(a){this.y=a},s.prototype.getDifference=function(a){return new DimensionD(this.x-a.x,this.y-a.y)},s.prototype.getCopy=function(){return new s(this.x,this.y)},s.prototype.translate=function(a){return this.x+=a.width,this.y+=a.height,this},n.exports=s},function(n,r,i){var s=i(2),a=i(10),o=i(0),u=i(6),l=i(3),c=i(1),h=i(13),d=i(12),f=i(11);function p(m,y,b){s.call(this,b),this.estimatedSize=a.MIN_VALUE,this.margin=o.DEFAULT_GRAPH_MARGIN,this.edges=[],this.nodes=[],this.isConnected=!1,this.parent=m,y!=null&&y instanceof u?this.graphManager=y:y!=null&&y instanceof Layout&&(this.graphManager=y.graphManager)}p.prototype=Object.create(s.prototype);for(var g in s)p[g]=s[g];p.prototype.getNodes=function(){return this.nodes},p.prototype.getEdges=function(){return this.edges},p.prototype.getGraphManager=function(){return this.graphManager},p.prototype.getParent=function(){return this.parent},p.prototype.getLeft=function(){return this.left},p.prototype.getRight=function(){return this.right},p.prototype.getTop=function(){return this.top},p.prototype.getBottom=function(){return this.bottom},p.prototype.isConnected=function(){return this.isConnected},p.prototype.add=function(m,y,b){if(y==null&&b==null){var v=m;if(this.graphManager==null)throw"Graph has no graph mgr!";if(this.getNodes().indexOf(v)>-1)throw"Node already in graph!";return v.owner=this,this.getNodes().push(v),v}else{var E=m;if(!(this.getNodes().indexOf(y)>-1&&this.getNodes().indexOf(b)>-1))throw"Source or target not in graph!";if(!(y.owner==b.owner&&y.owner==this))throw"Both owners must be this graph!";return y.owner!=b.owner?null:(E.source=y,E.target=b,E.isInterGraph=!1,this.getEdges().push(E),y.edges.push(E),b!=y&&b.edges.push(E),E)}},p.prototype.remove=function(m){var y=m;if(m instanceof l){if(y==null)throw"Node is null!";if(!(y.owner!=null&&y.owner==this))throw"Owner graph is invalid!";if(this.graphManager==null)throw"Owner graph manager is invalid!";for(var b=y.edges.slice(),v,E=b.length,w=0;w<E;w++)v=b[w],v.isInterGraph?this.graphManager.remove(v):v.source.owner.remove(v);var N=this.nodes.indexOf(y);if(N==-1)throw"Node not in owner node list!";this.nodes.splice(N,1)}else if(m instanceof c){var v=m;if(v==null)throw"Edge is null!";if(!(v.source!=null&&v.target!=null))throw"Source and/or target is null!";if(!(v.source.owner!=null&&v.target.owner!=null&&v.source.owner==this&&v.target.owner==this))throw"Source and/or target owner is invalid!";var D=v.source.edges.indexOf(v),k=v.target.edges.indexOf(v);if(!(D>-1&&k>-1))throw"Source and/or target doesn't know this edge!";v.source.edges.splice(D,1),v.target!=v.source&&v.target.edges.splice(k,1);var N=v.source.owner.getEdges().indexOf(v);if(N==-1)throw"Not in owner's edge list!";v.source.owner.getEdges().splice(N,1)}},p.prototype.updateLeftTop=function(){for(var m=a.MAX_VALUE,y=a.MAX_VALUE,b,v,E,w=this.getNodes(),N=w.length,D=0;D<N;D++){var k=w[D];b=k.getTop(),v=k.getLeft(),m>b&&(m=b),y>v&&(y=v)}return m==a.MAX_VALUE?null:(w[0].getParent().paddingLeft!=null?E=w[0].getParent().paddingLeft:E=this.margin,this.left=y-E,this.top=m-E,new d(this.left,this.top))},p.prototype.updateBounds=function(m){for(var y=a.MAX_VALUE,b=-a.MAX_VALUE,v=a.MAX_VALUE,E=-a.MAX_VALUE,w,N,D,k,F,M=this.nodes,S=M.length,R=0;R<S;R++){var I=M[R];m&&I.child!=null&&I.updateBounds(),w=I.getLeft(),N=I.getRight(),D=I.getTop(),k=I.getBottom(),y>w&&(y=w),b<N&&(b=N),v>D&&(v=D),E<k&&(E=k)}var x=new h(y,v,b-y,E-v);y==a.MAX_VALUE&&(this.left=this.parent.getLeft(),this.right=this.parent.getRight(),this.top=this.parent.getTop(),this.bottom=this.parent.getBottom()),M[0].getParent().paddingLeft!=null?F=M[0].getParent().paddingLeft:F=this.margin,this.left=x.x-F,this.right=x.x+x.width+F,this.top=x.y-F,this.bottom=x.y+x.height+F},p.calculateBounds=function(m){for(var y=a.MAX_VALUE,b=-a.MAX_VALUE,v=a.MAX_VALUE,E=-a.MAX_VALUE,w,N,D,k,F=m.length,M=0;M<F;M++){var S=m[M];w=S.getLeft(),N=S.getRight(),D=S.getTop(),k=S.getBottom(),y>w&&(y=w),b<N&&(b=N),v>D&&(v=D),E<k&&(E=k)}var R=new h(y,v,b-y,E-v);return R},p.prototype.getInclusionTreeDepth=function(){return this==this.graphManager.getRoot()?1:this.parent.getInclusionTreeDepth()},p.prototype.getEstimatedSize=function(){if(this.estimatedSize==a.MIN_VALUE)throw"assert failed";return this.estimatedSize},p.prototype.calcEstimatedSize=function(){for(var m=0,y=this.nodes,b=y.length,v=0;v<b;v++){var E=y[v];m+=E.calcEstimatedSize()}return m==0?this.estimatedSize=o.EMPTY_COMPOUND_NODE_SIZE:this.estimatedSize=m/Math.sqrt(this.nodes.length),this.estimatedSize},p.prototype.updateConnected=function(){var m=this;if(this.nodes.length==0){this.isConnected=!0;return}var y=new f,b=new Set,v=this.nodes[0],E,w,N=v.withChildren();for(N.forEach(function(R){y.push(R),b.add(R)});y.length!==0;){v=y.shift(),E=v.getEdges();for(var D=E.length,k=0;k<D;k++){var F=E[k];if(w=F.getOtherEndInGraph(v,this),w!=null&&!b.has(w)){var M=w.withChildren();M.forEach(function(R){y.push(R),b.add(R)})}}}if(this.isConnected=!1,b.size>=this.nodes.length){var S=0;b.forEach(function(R){R.owner==m&&S++}),S==this.nodes.length&&(this.isConnected=!0)}},n.exports=p},function(n,r,i){var s,a=i(1);function o(u){s=i(5),this.layout=u,this.graphs=[],this.edges=[]}o.prototype.addRoot=function(){var u=this.layout.newGraph(),l=this.layout.newNode(null),c=this.add(u,l);return this.setRootGraph(c),this.rootGraph},o.prototype.add=function(u,l,c,h,d){if(c==null&&h==null&&d==null){if(u==null)throw"Graph is null!";if(l==null)throw"Parent node is null!";if(this.graphs.indexOf(u)>-1)throw"Graph already in this graph mgr!";if(this.graphs.push(u),u.parent!=null)throw"Already has a parent!";if(l.child!=null)throw"Already has a child!";return u.parent=l,l.child=u,u}else{d=c,h=l,c=u;var f=h.getOwner(),p=d.getOwner();if(!(f!=null&&f.getGraphManager()==this))throw"Source not in this graph mgr!";if(!(p!=null&&p.getGraphManager()==this))throw"Target not in this graph mgr!";if(f==p)return c.isInterGraph=!1,f.add(c,h,d);if(c.isInterGraph=!0,c.source=h,c.target=d,this.edges.indexOf(c)>-1)throw"Edge already in inter-graph edge list!";if(this.edges.push(c),!(c.source!=null&&c.target!=null))throw"Edge source and/or target is null!";if(!(c.source.edges.indexOf(c)==-1&&c.target.edges.indexOf(c)==-1))throw"Edge already in source and/or target incidency list!";return c.source.edges.push(c),c.target.edges.push(c),c}},o.prototype.remove=function(u){if(u instanceof s){var l=u;if(l.getGraphManager()!=this)throw"Graph not in this graph mgr";if(!(l==this.rootGraph||l.parent!=null&&l.parent.graphManager==this))throw"Invalid parent node!";var c=[];c=c.concat(l.getEdges());for(var h,d=c.length,f=0;f<d;f++)h=c[f],l.remove(h);var p=[];p=p.concat(l.getNodes());var g;d=p.length;for(var f=0;f<d;f++)g=p[f],l.remove(g);l==this.rootGraph&&this.setRootGraph(null);var m=this.graphs.indexOf(l);this.graphs.splice(m,1),l.parent=null}else if(u instanceof a){if(h=u,h==null)throw"Edge is null!";if(!h.isInterGraph)throw"Not an inter-graph edge!";if(!(h.source!=null&&h.target!=null))throw"Source and/or target is null!";if(!(h.source.edges.indexOf(h)!=-1&&h.target.edges.indexOf(h)!=-1))throw"Source and/or target doesn't know this edge!";var m=h.source.edges.indexOf(h);if(h.source.edges.splice(m,1),m=h.target.edges.indexOf(h),h.target.edges.splice(m,1),!(h.source.owner!=null&&h.source.owner.getGraphManager()!=null))throw"Edge owner graph or owner graph manager is null!";if(h.source.owner.getGraphManager().edges.indexOf(h)==-1)throw"Not in owner graph manager's edge list!";var m=h.source.owner.getGraphManager().edges.indexOf(h);h.source.owner.getGraphManager().edges.splice(m,1)}},o.prototype.updateBounds=function(){this.rootGraph.updateBounds(!0)},o.prototype.getGraphs=function(){return this.graphs},o.prototype.getAllNodes=function(){if(this.allNodes==null){for(var u=[],l=this.getGraphs(),c=l.length,h=0;h<c;h++)u=u.concat(l[h].getNodes());this.allNodes=u}return this.allNodes},o.prototype.resetAllNodes=function(){this.allNodes=null},o.prototype.resetAllEdges=function(){this.allEdges=null},o.prototype.resetAllNodesToApplyGravitation=function(){this.allNodesToApplyGravitation=null},o.prototype.getAllEdges=function(){if(this.allEdges==null){var u=[],l=this.getGraphs();l.length;for(var c=0;c<l.length;c++)u=u.concat(l[c].getEdges());u=u.concat(this.edges),this.allEdges=u}return this.allEdges},o.prototype.getAllNodesToApplyGravitation=function(){return this.allNodesToApplyGravitation},o.prototype.setAllNodesToApplyGravitation=function(u){if(this.allNodesToApplyGravitation!=null)throw"assert failed";this.allNodesToApplyGravitation=u},o.prototype.getRoot=function(){return this.rootGraph},o.prototype.setRootGraph=function(u){if(u.getGraphManager()!=this)throw"Root not in this graph mgr!";this.rootGraph=u,u.parent==null&&(u.parent=this.layout.newNode("Root node"))},o.prototype.getLayout=function(){return this.layout},o.prototype.isOneAncestorOfOther=function(u,l){if(!(u!=null&&l!=null))throw"assert failed";if(u==l)return!0;var c=u.getOwner(),h;do{if(h=c.getParent(),h==null)break;if(h==l)return!0;if(c=h.getOwner(),c==null)break}while(!0);c=l.getOwner();do{if(h=c.getParent(),h==null)break;if(h==u)return!0;if(c=h.getOwner(),c==null)break}while(!0);return!1},o.prototype.calcLowestCommonAncestors=function(){for(var u,l,c,h,d,f=this.getAllEdges(),p=f.length,g=0;g<p;g++){if(u=f[g],l=u.source,c=u.target,u.lca=null,u.sourceInLca=l,u.targetInLca=c,l==c){u.lca=l.getOwner();continue}for(h=l.getOwner();u.lca==null;){for(u.targetInLca=c,d=c.getOwner();u.lca==null;){if(d==h){u.lca=d;break}if(d==this.rootGraph)break;if(u.lca!=null)throw"assert failed";u.targetInLca=d.getParent(),d=u.targetInLca.getOwner()}if(h==this.rootGraph)break;u.lca==null&&(u.sourceInLca=h.getParent(),h=u.sourceInLca.getOwner())}if(u.lca==null)throw"assert failed"}},o.prototype.calcLowestCommonAncestor=function(u,l){if(u==l)return u.getOwner();var c=u.getOwner();do{if(c==null)break;var h=l.getOwner();do{if(h==null)break;if(h==c)return h;h=h.getParent().getOwner()}while(!0);c=c.getParent().getOwner()}while(!0);return c},o.prototype.calcInclusionTreeDepths=function(u,l){u==null&&l==null&&(u=this.rootGraph,l=1);for(var c,h=u.getNodes(),d=h.length,f=0;f<d;f++)c=h[f],c.inclusionTreeDepth=l,c.child!=null&&this.calcInclusionTreeDepths(c.child,l+1)},o.prototype.includesInvalidEdge=function(){for(var u,l=this.edges.length,c=0;c<l;c++)if(u=this.edges[c],this.isOneAncestorOfOther(u.source,u.target))return!0;return!1},n.exports=o},function(n,r,i){var s=i(0);function a(){}for(var o in s)a[o]=s[o];a.MAX_ITERATIONS=2500,a.DEFAULT_EDGE_LENGTH=50,a.DEFAULT_SPRING_STRENGTH=.45,a.DEFAULT_REPULSION_STRENGTH=4500,a.DEFAULT_GRAVITY_STRENGTH=.4,a.DEFAULT_COMPOUND_GRAVITY_STRENGTH=1,a.DEFAULT_GRAVITY_RANGE_FACTOR=3.8,a.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=1.5,a.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION=!0,a.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION=!0,a.DEFAULT_COOLING_FACTOR_INCREMENTAL=.3,a.COOLING_ADAPTATION_FACTOR=.33,a.ADAPTATION_LOWER_NODE_LIMIT=1e3,a.ADAPTATION_UPPER_NODE_LIMIT=5e3,a.MAX_NODE_DISPLACEMENT_INCREMENTAL=100,a.MAX_NODE_DISPLACEMENT=a.MAX_NODE_DISPLACEMENT_INCREMENTAL*3,a.MIN_REPULSION_DIST=a.DEFAULT_EDGE_LENGTH/10,a.CONVERGENCE_CHECK_PERIOD=100,a.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=.1,a.MIN_EDGE_LENGTH=1,a.GRID_CALCULATION_CHECK_PERIOD=10,n.exports=a},function(n,r,i){var s=i(12);function a(){}a.calcSeparationAmount=function(o,u,l,c){if(!o.intersects(u))throw"assert failed";var h=new Array(2);this.decideDirectionsForOverlappingNodes(o,u,h),l[0]=Math.min(o.getRight(),u.getRight())-Math.max(o.x,u.x),l[1]=Math.min(o.getBottom(),u.getBottom())-Math.max(o.y,u.y),o.getX()<=u.getX()&&o.getRight()>=u.getRight()?l[0]+=Math.min(u.getX()-o.getX(),o.getRight()-u.getRight()):u.getX()<=o.getX()&&u.getRight()>=o.getRight()&&(l[0]+=Math.min(o.getX()-u.getX(),u.getRight()-o.getRight())),o.getY()<=u.getY()&&o.getBottom()>=u.getBottom()?l[1]+=Math.min(u.getY()-o.getY(),o.getBottom()-u.getBottom()):u.getY()<=o.getY()&&u.getBottom()>=o.getBottom()&&(l[1]+=Math.min(o.getY()-u.getY(),u.getBottom()-o.getBottom()));var d=Math.abs((u.getCenterY()-o.getCenterY())/(u.getCenterX()-o.getCenterX()));u.getCenterY()===o.getCenterY()&&u.getCenterX()===o.getCenterX()&&(d=1);var f=d*l[0],p=l[1]/d;l[0]<p?p=l[0]:f=l[1],l[0]=-1*h[0]*(p/2+c),l[1]=-1*h[1]*(f/2+c)},a.decideDirectionsForOverlappingNodes=function(o,u,l){o.getCenterX()<u.getCenterX()?l[0]=-1:l[0]=1,o.getCenterY()<u.getCenterY()?l[1]=-1:l[1]=1},a.getIntersection2=function(o,u,l){var c=o.getCenterX(),h=o.getCenterY(),d=u.getCenterX(),f=u.getCenterY();if(o.intersects(u))return l[0]=c,l[1]=h,l[2]=d,l[3]=f,!0;var p=o.getX(),g=o.getY(),m=o.getRight(),y=o.getX(),b=o.getBottom(),v=o.getRight(),E=o.getWidthHalf(),w=o.getHeightHalf(),N=u.getX(),D=u.getY(),k=u.getRight(),F=u.getX(),M=u.getBottom(),S=u.getRight(),R=u.getWidthHalf(),I=u.getHeightHalf(),x=!1,_=!1;if(c===d){if(h>f)return l[0]=c,l[1]=g,l[2]=d,l[3]=M,!1;if(h<f)return l[0]=c,l[1]=b,l[2]=d,l[3]=D,!1}else if(h===f){if(c>d)return l[0]=p,l[1]=h,l[2]=k,l[3]=f,!1;if(c<d)return l[0]=m,l[1]=h,l[2]=N,l[3]=f,!1}else{var C=o.height/o.width,A=u.height/u.width,T=(f-h)/(d-c),O=void 0,L=void 0,P=void 0,Y=void 0,W=void 0,X=void 0;if(-C===T?c>d?(l[0]=y,l[1]=b,x=!0):(l[0]=m,l[1]=g,x=!0):C===T&&(c>d?(l[0]=p,l[1]=g,x=!0):(l[0]=v,l[1]=b,x=!0)),-A===T?d>c?(l[2]=F,l[3]=M,_=!0):(l[2]=k,l[3]=D,_=!0):A===T&&(d>c?(l[2]=N,l[3]=D,_=!0):(l[2]=S,l[3]=M,_=!0)),x&&_)return!1;if(c>d?h>f?(O=this.getCardinalDirection(C,T,4),L=this.getCardinalDirection(A,T,2)):(O=this.getCardinalDirection(-C,T,3),L=this.getCardinalDirection(-A,T,1)):h>f?(O=this.getCardinalDirection(-C,T,1),L=this.getCardinalDirection(-A,T,3)):(O=this.getCardinalDirection(C,T,2),L=this.getCardinalDirection(A,T,4)),!x)switch(O){case 1:Y=g,P=c+-w/T,l[0]=P,l[1]=Y;break;case 2:P=v,Y=h+E*T,l[0]=P,l[1]=Y;break;case 3:Y=b,P=c+w/T,l[0]=P,l[1]=Y;break;case 4:P=y,Y=h+-E*T,l[0]=P,l[1]=Y;break}if(!_)switch(L){case 1:X=D,W=d+-I/T,l[2]=W,l[3]=X;break;case 2:W=S,X=f+R*T,l[2]=W,l[3]=X;break;case 3:X=M,W=d+I/T,l[2]=W,l[3]=X;break;case 4:W=F,X=f+-R*T,l[2]=W,l[3]=X;break}}return!1},a.getCardinalDirection=function(o,u,l){return o>u?l:1+l%4},a.getIntersection=function(o,u,l,c){if(c==null)return this.getIntersection2(o,u,l);var h=o.x,d=o.y,f=u.x,p=u.y,g=l.x,m=l.y,y=c.x,b=c.y,v=void 0,E=void 0,w=void 0,N=void 0,D=void 0,k=void 0,F=void 0,M=void 0,S=void 0;return w=p-d,D=h-f,F=f*d-h*p,N=b-m,k=g-y,M=y*m-g*b,S=w*k-N*D,S===0?null:(v=(D*M-k*F)/S,E=(N*F-w*M)/S,new s(v,E))},a.angleOfVector=function(o,u,l,c){var h=void 0;return o!==l?(h=Math.atan((c-u)/(l-o)),l<o?h+=Math.PI:c<u&&(h+=this.TWO_PI)):c<u?h=this.ONE_AND_HALF_PI:h=this.HALF_PI,h},a.doIntersect=function(o,u,l,c){var h=o.x,d=o.y,f=u.x,p=u.y,g=l.x,m=l.y,y=c.x,b=c.y,v=(f-h)*(b-m)-(y-g)*(p-d);if(v===0)return!1;var E=((b-m)*(y-h)+(g-y)*(b-d))/v,w=((d-p)*(y-h)+(f-h)*(b-d))/v;return 0<E&&E<1&&0<w&&w<1},a.HALF_PI=.5*Math.PI,a.ONE_AND_HALF_PI=1.5*Math.PI,a.TWO_PI=2*Math.PI,a.THREE_PI=3*Math.PI,n.exports=a},function(n,r,i){function s(){}s.sign=function(a){return a>0?1:a<0?-1:0},s.floor=function(a){return a<0?Math.ceil(a):Math.floor(a)},s.ceil=function(a){return a<0?Math.floor(a):Math.ceil(a)},n.exports=s},function(n,r,i){function s(){}s.MAX_VALUE=2147483647,s.MIN_VALUE=-2147483648,n.exports=s},function(n,r,i){var s=function(){function h(d,f){for(var p=0;p<f.length;p++){var g=f[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}}return function(d,f,p){return f&&h(d.prototype,f),p&&h(d,p),d}}();function a(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}var o=function(d){return{value:d,next:null,prev:null}},u=function(d,f,p,g){return d!==null?d.next=f:g.head=f,p!==null?p.prev=f:g.tail=f,f.prev=d,f.next=p,g.length++,f},l=function(d,f){var p=d.prev,g=d.next;return p!==null?p.next=g:f.head=g,g!==null?g.prev=p:f.tail=p,d.prev=d.next=null,f.length--,d},c=function(){function h(d){var f=this;a(this,h),this.length=0,this.head=null,this.tail=null,d!=null&&d.forEach(function(p){return f.push(p)})}return s(h,[{key:"size",value:function(){return this.length}},{key:"insertBefore",value:function(f,p){return u(p.prev,o(f),p,this)}},{key:"insertAfter",value:function(f,p){return u(p,o(f),p.next,this)}},{key:"insertNodeBefore",value:function(f,p){return u(p.prev,f,p,this)}},{key:"insertNodeAfter",value:function(f,p){return u(p,f,p.next,this)}},{key:"push",value:function(f){return u(this.tail,o(f),null,this)}},{key:"unshift",value:function(f){return u(null,o(f),this.head,this)}},{key:"remove",value:function(f){return l(f,this)}},{key:"pop",value:function(){return l(this.tail,this).value}},{key:"popNode",value:function(){return l(this.tail,this)}},{key:"shift",value:function(){return l(this.head,this).value}},{key:"shiftNode",value:function(){return l(this.head,this)}},{key:"get_object_at",value:function(f){if(f<=this.length()){for(var p=1,g=this.head;p<f;)g=g.next,p++;return g.value}}},{key:"set_object_at",value:function(f,p){if(f<=this.length()){for(var g=1,m=this.head;g<f;)m=m.next,g++;m.value=p}}}]),h}();n.exports=c},function(n,r,i){function s(a,o,u){this.x=null,this.y=null,a==null&&o==null&&u==null?(this.x=0,this.y=0):typeof a=="number"&&typeof o=="number"&&u==null?(this.x=a,this.y=o):a.constructor.name=="Point"&&o==null&&u==null&&(u=a,this.x=u.x,this.y=u.y)}s.prototype.getX=function(){return this.x},s.prototype.getY=function(){return this.y},s.prototype.getLocation=function(){return new s(this.x,this.y)},s.prototype.setLocation=function(a,o,u){a.constructor.name=="Point"&&o==null&&u==null?(u=a,this.setLocation(u.x,u.y)):typeof a=="number"&&typeof o=="number"&&u==null&&(parseInt(a)==a&&parseInt(o)==o?this.move(a,o):(this.x=Math.floor(a+.5),this.y=Math.floor(o+.5)))},s.prototype.move=function(a,o){this.x=a,this.y=o},s.prototype.translate=function(a,o){this.x+=a,this.y+=o},s.prototype.equals=function(a){if(a.constructor.name=="Point"){var o=a;return this.x==o.x&&this.y==o.y}return this==a},s.prototype.toString=function(){return new s().constructor.name+"[x="+this.x+",y="+this.y+"]"},n.exports=s},function(n,r,i){function s(a,o,u,l){this.x=0,this.y=0,this.width=0,this.height=0,a!=null&&o!=null&&u!=null&&l!=null&&(this.x=a,this.y=o,this.width=u,this.height=l)}s.prototype.getX=function(){return this.x},s.prototype.setX=function(a){this.x=a},s.prototype.getY=function(){return this.y},s.prototype.setY=function(a){this.y=a},s.prototype.getWidth=function(){return this.width},s.prototype.setWidth=function(a){this.width=a},s.prototype.getHeight=function(){return this.height},s.prototype.setHeight=function(a){this.height=a},s.prototype.getRight=function(){return this.x+this.width},s.prototype.getBottom=function(){return this.y+this.height},s.prototype.intersects=function(a){return!(this.getRight()<a.x||this.getBottom()<a.y||a.getRight()<this.x||a.getBottom()<this.y)},s.prototype.getCenterX=function(){return this.x+this.width/2},s.prototype.getMinX=function(){return this.getX()},s.prototype.getMaxX=function(){return this.getX()+this.width},s.prototype.getCenterY=function(){return this.y+this.height/2},s.prototype.getMinY=function(){return this.getY()},s.prototype.getMaxY=function(){return this.getY()+this.height},s.prototype.getWidthHalf=function(){return this.width/2},s.prototype.getHeightHalf=function(){return this.height/2},n.exports=s},function(n,r,i){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};function a(){}a.lastID=0,a.createID=function(o){return a.isPrimitive(o)?o:(o.uniqueID!=null||(o.uniqueID=a.getString(),a.lastID++),o.uniqueID)},a.getString=function(o){return o==null&&(o=a.lastID),"Object#"+o},a.isPrimitive=function(o){var u=typeof o>"u"?"undefined":s(o);return o==null||u!="object"&&u!="function"},n.exports=a},function(n,r,i){function s(g){if(Array.isArray(g)){for(var m=0,y=Array(g.length);m<g.length;m++)y[m]=g[m];return y}else return Array.from(g)}var a=i(0),o=i(6),u=i(3),l=i(1),c=i(5),h=i(4),d=i(17),f=i(27);function p(g){f.call(this),this.layoutQuality=a.QUALITY,this.createBendsAsNeeded=a.DEFAULT_CREATE_BENDS_AS_NEEDED,this.incremental=a.DEFAULT_INCREMENTAL,this.animationOnLayout=a.DEFAULT_ANIMATION_ON_LAYOUT,this.animationDuringLayout=a.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=a.DEFAULT_ANIMATION_PERIOD,this.uniformLeafNodeSizes=a.DEFAULT_UNIFORM_LEAF_NODE_SIZES,this.edgeToDummyNodes=new Map,this.graphManager=new o(this),this.isLayoutFinished=!1,this.isSubLayout=!1,this.isRemoteUse=!1,g!=null&&(this.isRemoteUse=g)}p.RANDOM_SEED=1,p.prototype=Object.create(f.prototype),p.prototype.getGraphManager=function(){return this.graphManager},p.prototype.getAllNodes=function(){return this.graphManager.getAllNodes()},p.prototype.getAllEdges=function(){return this.graphManager.getAllEdges()},p.prototype.getAllNodesToApplyGravitation=function(){return this.graphManager.getAllNodesToApplyGravitation()},p.prototype.newGraphManager=function(){var g=new o(this);return this.graphManager=g,g},p.prototype.newGraph=function(g){return new c(null,this.graphManager,g)},p.prototype.newNode=function(g){return new u(this.graphManager,g)},p.prototype.newEdge=function(g){return new l(null,null,g)},p.prototype.checkLayoutSuccess=function(){return this.graphManager.getRoot()==null||this.graphManager.getRoot().getNodes().length==0||this.graphManager.includesInvalidEdge()},p.prototype.runLayout=function(){this.isLayoutFinished=!1,this.tilingPreLayout&&this.tilingPreLayout(),this.initParameters();var g;return this.checkLayoutSuccess()?g=!1:g=this.layout(),a.ANIMATE==="during"?!1:(g&&(this.isSubLayout||this.doPostLayout()),this.tilingPostLayout&&this.tilingPostLayout(),this.isLayoutFinished=!0,g)},p.prototype.doPostLayout=function(){this.incremental||this.transform(),this.update()},p.prototype.update2=function(){if(this.createBendsAsNeeded&&(this.createBendpointsFromDummyNodes(),this.graphManager.resetAllEdges()),!this.isRemoteUse){for(var g=this.graphManager.getAllEdges(),m=0;m<g.length;m++)g[m];for(var y=this.graphManager.getRoot().getNodes(),m=0;m<y.length;m++)y[m];this.update(this.graphManager.getRoot())}},p.prototype.update=function(g){if(g==null)this.update2();else if(g instanceof u){var m=g;if(m.getChild()!=null)for(var y=m.getChild().getNodes(),b=0;b<y.length;b++)update(y[b]);if(m.vGraphObject!=null){var v=m.vGraphObject;v.update(m)}}else if(g instanceof l){var E=g;if(E.vGraphObject!=null){var w=E.vGraphObject;w.update(E)}}else if(g instanceof c){var N=g;if(N.vGraphObject!=null){var D=N.vGraphObject;D.update(N)}}},p.prototype.initParameters=function(){this.isSubLayout||(this.layoutQuality=a.QUALITY,this.animationDuringLayout=a.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=a.DEFAULT_ANIMATION_PERIOD,this.animationOnLayout=a.DEFAULT_ANIMATION_ON_LAYOUT,this.incremental=a.DEFAULT_INCREMENTAL,this.createBendsAsNeeded=a.DEFAULT_CREATE_BENDS_AS_NEEDED,this.uniformLeafNodeSizes=a.DEFAULT_UNIFORM_LEAF_NODE_SIZES),this.animationDuringLayout&&(this.animationOnLayout=!1)},p.prototype.transform=function(g){if(g==null)this.transform(new h(0,0));else{var m=new d,y=this.graphManager.getRoot().updateLeftTop();if(y!=null){m.setWorldOrgX(g.x),m.setWorldOrgY(g.y),m.setDeviceOrgX(y.x),m.setDeviceOrgY(y.y);for(var b=this.getAllNodes(),v,E=0;E<b.length;E++)v=b[E],v.transform(m)}}},p.prototype.positionNodesRandomly=function(g){if(g==null)this.positionNodesRandomly(this.getGraphManager().getRoot()),this.getGraphManager().getRoot().updateBounds(!0);else for(var m,y,b=g.getNodes(),v=0;v<b.length;v++)m=b[v],y=m.getChild(),y==null||y.getNodes().length==0?m.scatter():(this.positionNodesRandomly(y),m.updateBounds())},p.prototype.getFlatForest=function(){for(var g=[],m=!0,y=this.graphManager.getRoot().getNodes(),b=!0,v=0;v<y.length;v++)y[v].getChild()!=null&&(b=!1);if(!b)return g;var E=new Set,w=[],N=new Map,D=[];for(D=D.concat(y);D.length>0&&m;){for(w.push(D[0]);w.length>0&&m;){var k=w[0];w.splice(0,1),E.add(k);for(var F=k.getEdges(),v=0;v<F.length;v++){var M=F[v].getOtherEnd(k);if(N.get(k)!=M)if(!E.has(M))w.push(M),N.set(M,k);else{m=!1;break}}}if(!m)g=[];else{var S=[].concat(s(E));g.push(S);for(var v=0;v<S.length;v++){var R=S[v],I=D.indexOf(R);I>-1&&D.splice(I,1)}E=new Set,N=new Map}}return g},p.prototype.createDummyNodesForBendpoints=function(g){for(var m=[],y=g.source,b=this.graphManager.calcLowestCommonAncestor(g.source,g.target),v=0;v<g.bendpoints.length;v++){var E=this.newNode(null);E.setRect(new Point(0,0),new Dimension(1,1)),b.add(E);var w=this.newEdge(null);this.graphManager.add(w,y,E),m.add(E),y=E}var w=this.newEdge(null);return this.graphManager.add(w,y,g.target),this.edgeToDummyNodes.set(g,m),g.isInterGraph()?this.graphManager.remove(g):b.remove(g),m},p.prototype.createBendpointsFromDummyNodes=function(){var g=[];g=g.concat(this.graphManager.getAllEdges()),g=[].concat(s(this.edgeToDummyNodes.keys())).concat(g);for(var m=0;m<g.length;m++){var y=g[m];if(y.bendpoints.length>0){for(var b=this.edgeToDummyNodes.get(y),v=0;v<b.length;v++){var E=b[v],w=new h(E.getCenterX(),E.getCenterY()),N=y.bendpoints.get(v);N.x=w.x,N.y=w.y,E.getOwner().remove(E)}this.graphManager.add(y,y.source,y.target)}}},p.transform=function(g,m,y,b){if(y!=null&&b!=null){var v=m;if(g<=50){var E=m/y;v-=(m-E)/50*(50-g)}else{var w=m*b;v+=(w-m)/50*(g-50)}return v}else{var N,D;return g<=50?(N=9*m/500,D=m/10):(N=9*m/50,D=-8*m),N*g+D}},p.findCenterOfTree=function(g){var m=[];m=m.concat(g);var y=[],b=new Map,v=!1,E=null;(m.length==1||m.length==2)&&(v=!0,E=m[0]);for(var w=0;w<m.length;w++){var N=m[w],D=N.getNeighborsList().size;b.set(N,N.getNeighborsList().size),D==1&&y.push(N)}var k=[];for(k=k.concat(y);!v;){var F=[];F=F.concat(k),k=[];for(var w=0;w<m.length;w++){var N=m[w],M=m.indexOf(N);M>=0&&m.splice(M,1);var S=N.getNeighborsList();S.forEach(function(x){if(y.indexOf(x)<0){var _=b.get(x),C=_-1;C==1&&k.push(x),b.set(x,C)}})}y=y.concat(k),(m.length==1||m.length==2)&&(v=!0,E=m[0])}return E},p.prototype.setGraphManager=function(g){this.graphManager=g},n.exports=p},function(n,r,i){function s(){}s.seed=1,s.x=0,s.nextDouble=function(){return s.x=Math.sin(s.seed++)*1e4,s.x-Math.floor(s.x)},n.exports=s},function(n,r,i){var s=i(4);function a(o,u){this.lworldOrgX=0,this.lworldOrgY=0,this.ldeviceOrgX=0,this.ldeviceOrgY=0,this.lworldExtX=1,this.lworldExtY=1,this.ldeviceExtX=1,this.ldeviceExtY=1}a.prototype.getWorldOrgX=function(){return this.lworldOrgX},a.prototype.setWorldOrgX=function(o){this.lworldOrgX=o},a.prototype.getWorldOrgY=function(){return this.lworldOrgY},a.prototype.setWorldOrgY=function(o){this.lworldOrgY=o},a.prototype.getWorldExtX=function(){return this.lworldExtX},a.prototype.setWorldExtX=function(o){this.lworldExtX=o},a.prototype.getWorldExtY=function(){return this.lworldExtY},a.prototype.setWorldExtY=function(o){this.lworldExtY=o},a.prototype.getDeviceOrgX=function(){return this.ldeviceOrgX},a.prototype.setDeviceOrgX=function(o){this.ldeviceOrgX=o},a.prototype.getDeviceOrgY=function(){return this.ldeviceOrgY},a.prototype.setDeviceOrgY=function(o){this.ldeviceOrgY=o},a.prototype.getDeviceExtX=function(){return this.ldeviceExtX},a.prototype.setDeviceExtX=function(o){this.ldeviceExtX=o},a.prototype.getDeviceExtY=function(){return this.ldeviceExtY},a.prototype.setDeviceExtY=function(o){this.ldeviceExtY=o},a.prototype.transformX=function(o){var u=0,l=this.lworldExtX;return l!=0&&(u=this.ldeviceOrgX+(o-this.lworldOrgX)*this.ldeviceExtX/l),u},a.prototype.transformY=function(o){var u=0,l=this.lworldExtY;return l!=0&&(u=this.ldeviceOrgY+(o-this.lworldOrgY)*this.ldeviceExtY/l),u},a.prototype.inverseTransformX=function(o){var u=0,l=this.ldeviceExtX;return l!=0&&(u=this.lworldOrgX+(o-this.ldeviceOrgX)*this.lworldExtX/l),u},a.prototype.inverseTransformY=function(o){var u=0,l=this.ldeviceExtY;return l!=0&&(u=this.lworldOrgY+(o-this.ldeviceOrgY)*this.lworldExtY/l),u},a.prototype.inverseTransformPoint=function(o){var u=new s(this.inverseTransformX(o.x),this.inverseTransformY(o.y));return u},n.exports=a},function(n,r,i){function s(f){if(Array.isArray(f)){for(var p=0,g=Array(f.length);p<f.length;p++)g[p]=f[p];return g}else return Array.from(f)}var a=i(15),o=i(7),u=i(0),l=i(8),c=i(9);function h(){a.call(this),this.useSmartIdealEdgeLengthCalculation=o.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.idealEdgeLength=o.DEFAULT_EDGE_LENGTH,this.springConstant=o.DEFAULT_SPRING_STRENGTH,this.repulsionConstant=o.DEFAULT_REPULSION_STRENGTH,this.gravityConstant=o.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=o.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=o.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=o.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.displacementThresholdPerNode=3*o.DEFAULT_EDGE_LENGTH/100,this.coolingFactor=o.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.initialCoolingFactor=o.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.totalDisplacement=0,this.oldTotalDisplacement=0,this.maxIterations=o.MAX_ITERATIONS}h.prototype=Object.create(a.prototype);for(var d in a)h[d]=a[d];h.prototype.initParameters=function(){a.prototype.initParameters.call(this,arguments),this.totalIterations=0,this.notAnimatedIterations=0,this.useFRGridVariant=o.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION,this.grid=[]},h.prototype.calcIdealEdgeLengths=function(){for(var f,p,g,m,y,b,v=this.getGraphManager().getAllEdges(),E=0;E<v.length;E++)f=v[E],f.idealLength=this.idealEdgeLength,f.isInterGraph&&(g=f.getSource(),m=f.getTarget(),y=f.getSourceInLca().getEstimatedSize(),b=f.getTargetInLca().getEstimatedSize(),this.useSmartIdealEdgeLengthCalculation&&(f.idealLength+=y+b-2*u.SIMPLE_NODE_SIZE),p=f.getLca().getInclusionTreeDepth(),f.idealLength+=o.DEFAULT_EDGE_LENGTH*o.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR*(g.getInclusionTreeDepth()+m.getInclusionTreeDepth()-2*p))},h.prototype.initSpringEmbedder=function(){var f=this.getAllNodes().length;this.incremental?(f>o.ADAPTATION_LOWER_NODE_LIMIT&&(this.coolingFactor=Math.max(this.coolingFactor*o.COOLING_ADAPTATION_FACTOR,this.coolingFactor-(f-o.ADAPTATION_LOWER_NODE_LIMIT)/(o.ADAPTATION_UPPER_NODE_LIMIT-o.ADAPTATION_LOWER_NODE_LIMIT)*this.coolingFactor*(1-o.COOLING_ADAPTATION_FACTOR))),this.maxNodeDisplacement=o.MAX_NODE_DISPLACEMENT_INCREMENTAL):(f>o.ADAPTATION_LOWER_NODE_LIMIT?this.coolingFactor=Math.max(o.COOLING_ADAPTATION_FACTOR,1-(f-o.ADAPTATION_LOWER_NODE_LIMIT)/(o.ADAPTATION_UPPER_NODE_LIMIT-o.ADAPTATION_LOWER_NODE_LIMIT)*(1-o.COOLING_ADAPTATION_FACTOR)):this.coolingFactor=1,this.initialCoolingFactor=this.coolingFactor,this.maxNodeDisplacement=o.MAX_NODE_DISPLACEMENT),this.maxIterations=Math.max(this.getAllNodes().length*5,this.maxIterations),this.totalDisplacementThreshold=this.displacementThresholdPerNode*this.getAllNodes().length,this.repulsionRange=this.calcRepulsionRange()},h.prototype.calcSpringForces=function(){for(var f=this.getAllEdges(),p,g=0;g<f.length;g++)p=f[g],this.calcSpringForce(p,p.idealLength)},h.prototype.calcRepulsionForces=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g,m,y,b,v=this.getAllNodes(),E;if(this.useFRGridVariant)for(this.totalIterations%o.GRID_CALCULATION_CHECK_PERIOD==1&&f&&this.updateGrid(),E=new Set,g=0;g<v.length;g++)y=v[g],this.calculateRepulsionForceOfANode(y,E,f,p),E.add(y);else for(g=0;g<v.length;g++)for(y=v[g],m=g+1;m<v.length;m++)b=v[m],y.getOwner()==b.getOwner()&&this.calcRepulsionForce(y,b)},h.prototype.calcGravitationalForces=function(){for(var f,p=this.getAllNodesToApplyGravitation(),g=0;g<p.length;g++)f=p[g],this.calcGravitationalForce(f)},h.prototype.moveNodes=function(){for(var f=this.getAllNodes(),p,g=0;g<f.length;g++)p=f[g],p.move()},h.prototype.calcSpringForce=function(f,p){var g=f.getSource(),m=f.getTarget(),y,b,v,E;if(this.uniformLeafNodeSizes&&g.getChild()==null&&m.getChild()==null)f.updateLengthSimple();else if(f.updateLength(),f.isOverlapingSourceAndTarget)return;y=f.getLength(),y!=0&&(b=this.springConstant*(y-p),v=b*(f.lengthX/y),E=b*(f.lengthY/y),g.springForceX+=v,g.springForceY+=E,m.springForceX-=v,m.springForceY-=E)},h.prototype.calcRepulsionForce=function(f,p){var g=f.getRect(),m=p.getRect(),y=new Array(2),b=new Array(4),v,E,w,N,D,k,F;if(g.intersects(m)){l.calcSeparationAmount(g,m,y,o.DEFAULT_EDGE_LENGTH/2),k=2*y[0],F=2*y[1];var M=f.noOfChildren*p.noOfChildren/(f.noOfChildren+p.noOfChildren);f.repulsionForceX-=M*k,f.repulsionForceY-=M*F,p.repulsionForceX+=M*k,p.repulsionForceY+=M*F}else this.uniformLeafNodeSizes&&f.getChild()==null&&p.getChild()==null?(v=m.getCenterX()-g.getCenterX(),E=m.getCenterY()-g.getCenterY()):(l.getIntersection(g,m,b),v=b[2]-b[0],E=b[3]-b[1]),Math.abs(v)<o.MIN_REPULSION_DIST&&(v=c.sign(v)*o.MIN_REPULSION_DIST),Math.abs(E)<o.MIN_REPULSION_DIST&&(E=c.sign(E)*o.MIN_REPULSION_DIST),w=v*v+E*E,N=Math.sqrt(w),D=this.repulsionConstant*f.noOfChildren*p.noOfChildren/w,k=D*v/N,F=D*E/N,f.repulsionForceX-=k,f.repulsionForceY-=F,p.repulsionForceX+=k,p.repulsionForceY+=F},h.prototype.calcGravitationalForce=function(f){var p,g,m,y,b,v,E,w;p=f.getOwner(),g=(p.getRight()+p.getLeft())/2,m=(p.getTop()+p.getBottom())/2,y=f.getCenterX()-g,b=f.getCenterY()-m,v=Math.abs(y)+f.getWidth()/2,E=Math.abs(b)+f.getHeight()/2,f.getOwner()==this.graphManager.getRoot()?(w=p.getEstimatedSize()*this.gravityRangeFactor,(v>w||E>w)&&(f.gravitationForceX=-this.gravityConstant*y,f.gravitationForceY=-this.gravityConstant*b)):(w=p.getEstimatedSize()*this.compoundGravityRangeFactor,(v>w||E>w)&&(f.gravitationForceX=-this.gravityConstant*y*this.compoundGravityConstant,f.gravitationForceY=-this.gravityConstant*b*this.compoundGravityConstant))},h.prototype.isConverged=function(){var f,p=!1;return this.totalIterations>this.maxIterations/3&&(p=Math.abs(this.totalDisplacement-this.oldTotalDisplacement)<2),f=this.totalDisplacement<this.totalDisplacementThreshold,this.oldTotalDisplacement=this.totalDisplacement,f||p},h.prototype.animate=function(){this.animationDuringLayout&&!this.isSubLayout&&(this.notAnimatedIterations==this.animationPeriod?(this.update(),this.notAnimatedIterations=0):this.notAnimatedIterations++)},h.prototype.calcNoOfChildrenForAllNodes=function(){for(var f,p=this.graphManager.getAllNodes(),g=0;g<p.length;g++)f=p[g],f.noOfChildren=f.getNoOfChildren()},h.prototype.calcGrid=function(f){var p=0,g=0;p=parseInt(Math.ceil((f.getRight()-f.getLeft())/this.repulsionRange)),g=parseInt(Math.ceil((f.getBottom()-f.getTop())/this.repulsionRange));for(var m=new Array(p),y=0;y<p;y++)m[y]=new Array(g);for(var y=0;y<p;y++)for(var b=0;b<g;b++)m[y][b]=new Array;return m},h.prototype.addNodeToGrid=function(f,p,g){var m=0,y=0,b=0,v=0;m=parseInt(Math.floor((f.getRect().x-p)/this.repulsionRange)),y=parseInt(Math.floor((f.getRect().width+f.getRect().x-p)/this.repulsionRange)),b=parseInt(Math.floor((f.getRect().y-g)/this.repulsionRange)),v=parseInt(Math.floor((f.getRect().height+f.getRect().y-g)/this.repulsionRange));for(var E=m;E<=y;E++)for(var w=b;w<=v;w++)this.grid[E][w].push(f),f.setGridCoordinates(m,y,b,v)},h.prototype.updateGrid=function(){var f,p,g=this.getAllNodes();for(this.grid=this.calcGrid(this.graphManager.getRoot()),f=0;f<g.length;f++)p=g[f],this.addNodeToGrid(p,this.graphManager.getRoot().getLeft(),this.graphManager.getRoot().getTop())},h.prototype.calculateRepulsionForceOfANode=function(f,p,g,m){if(this.totalIterations%o.GRID_CALCULATION_CHECK_PERIOD==1&&g||m){var y=new Set;f.surrounding=new Array;for(var b,v=this.grid,E=f.startX-1;E<f.finishX+2;E++)for(var w=f.startY-1;w<f.finishY+2;w++)if(!(E<0||w<0||E>=v.length||w>=v[0].length)){for(var N=0;N<v[E][w].length;N++)if(b=v[E][w][N],!(f.getOwner()!=b.getOwner()||f==b)&&!p.has(b)&&!y.has(b)){var D=Math.abs(f.getCenterX()-b.getCenterX())-(f.getWidth()/2+b.getWidth()/2),k=Math.abs(f.getCenterY()-b.getCenterY())-(f.getHeight()/2+b.getHeight()/2);D<=this.repulsionRange&&k<=this.repulsionRange&&y.add(b)}}f.surrounding=[].concat(s(y))}for(E=0;E<f.surrounding.length;E++)this.calcRepulsionForce(f,f.surrounding[E])},h.prototype.calcRepulsionRange=function(){return 0},n.exports=h},function(n,r,i){var s=i(1),a=i(7);function o(l,c,h){s.call(this,l,c,h),this.idealLength=a.DEFAULT_EDGE_LENGTH}o.prototype=Object.create(s.prototype);for(var u in s)o[u]=s[u];n.exports=o},function(n,r,i){var s=i(3);function a(u,l,c,h){s.call(this,u,l,c,h),this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0,this.startX=0,this.finishX=0,this.startY=0,this.finishY=0,this.surrounding=[]}a.prototype=Object.create(s.prototype);for(var o in s)a[o]=s[o];a.prototype.setGridCoordinates=function(u,l,c,h){this.startX=u,this.finishX=l,this.startY=c,this.finishY=h},n.exports=a},function(n,r,i){function s(a,o){this.width=0,this.height=0,a!==null&&o!==null&&(this.height=o,this.width=a)}s.prototype.getWidth=function(){return this.width},s.prototype.setWidth=function(a){this.width=a},s.prototype.getHeight=function(){return this.height},s.prototype.setHeight=function(a){this.height=a},n.exports=s},function(n,r,i){var s=i(14);function a(){this.map={},this.keys=[]}a.prototype.put=function(o,u){var l=s.createID(o);this.contains(l)||(this.map[l]=u,this.keys.push(o))},a.prototype.contains=function(o){return s.createID(o),this.map[o]!=null},a.prototype.get=function(o){var u=s.createID(o);return this.map[u]},a.prototype.keySet=function(){return this.keys},n.exports=a},function(n,r,i){var s=i(14);function a(){this.set={}}a.prototype.add=function(o){var u=s.createID(o);this.contains(u)||(this.set[u]=o)},a.prototype.remove=function(o){delete this.set[s.createID(o)]},a.prototype.clear=function(){this.set={}},a.prototype.contains=function(o){return this.set[s.createID(o)]==o},a.prototype.isEmpty=function(){return this.size()===0},a.prototype.size=function(){return Object.keys(this.set).length},a.prototype.addAllTo=function(o){for(var u=Object.keys(this.set),l=u.length,c=0;c<l;c++)o.push(this.set[u[c]])},a.prototype.size=function(){return Object.keys(this.set).length},a.prototype.addAll=function(o){for(var u=o.length,l=0;l<u;l++){var c=o[l];this.add(c)}},n.exports=a},function(n,r,i){var s=function(){function l(c,h){for(var d=0;d<h.length;d++){var f=h[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(c,f.key,f)}}return function(c,h,d){return h&&l(c.prototype,h),d&&l(c,d),c}}();function a(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var o=i(11),u=function(){function l(c,h){a(this,l),(h!==null||h!==void 0)&&(this.compareFunction=this._defaultCompareFunction);var d=void 0;c instanceof o?d=c.size():d=c.length,this._quicksort(c,0,d-1)}return s(l,[{key:"_quicksort",value:function(h,d,f){if(d<f){var p=this._partition(h,d,f);this._quicksort(h,d,p),this._quicksort(h,p+1,f)}}},{key:"_partition",value:function(h,d,f){for(var p=this._get(h,d),g=d,m=f;;){for(;this.compareFunction(p,this._get(h,m));)m--;for(;this.compareFunction(this._get(h,g),p);)g++;if(g<m)this._swap(h,g,m),g++,m--;else return m}}},{key:"_get",value:function(h,d){return h instanceof o?h.get_object_at(d):h[d]}},{key:"_set",value:function(h,d,f){h instanceof o?h.set_object_at(d,f):h[d]=f}},{key:"_swap",value:function(h,d,f){var p=this._get(h,d);this._set(h,d,this._get(h,f)),this._set(h,f,p)}},{key:"_defaultCompareFunction",value:function(h,d){return d>h}}]),l}();n.exports=u},function(n,r,i){var s=function(){function u(l,c){for(var h=0;h<c.length;h++){var d=c[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(l,d.key,d)}}return function(l,c,h){return c&&u(l.prototype,c),h&&u(l,h),l}}();function a(u,l){if(!(u instanceof l))throw new TypeError("Cannot call a class as a function")}var o=function(){function u(l,c){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;a(this,u),this.sequence1=l,this.sequence2=c,this.match_score=h,this.mismatch_penalty=d,this.gap_penalty=f,this.iMax=l.length+1,this.jMax=c.length+1,this.grid=new Array(this.iMax);for(var p=0;p<this.iMax;p++){this.grid[p]=new Array(this.jMax);for(var g=0;g<this.jMax;g++)this.grid[p][g]=0}this.tracebackGrid=new Array(this.iMax);for(var m=0;m<this.iMax;m++){this.tracebackGrid[m]=new Array(this.jMax);for(var y=0;y<this.jMax;y++)this.tracebackGrid[m][y]=[null,null,null]}this.alignments=[],this.score=-1,this.computeGrids()}return s(u,[{key:"getScore",value:function(){return this.score}},{key:"getAlignments",value:function(){return this.alignments}},{key:"computeGrids",value:function(){for(var c=1;c<this.jMax;c++)this.grid[0][c]=this.grid[0][c-1]+this.gap_penalty,this.tracebackGrid[0][c]=[!1,!1,!0];for(var h=1;h<this.iMax;h++)this.grid[h][0]=this.grid[h-1][0]+this.gap_penalty,this.tracebackGrid[h][0]=[!1,!0,!1];for(var d=1;d<this.iMax;d++)for(var f=1;f<this.jMax;f++){var p=void 0;this.sequence1[d-1]===this.sequence2[f-1]?p=this.grid[d-1][f-1]+this.match_score:p=this.grid[d-1][f-1]+this.mismatch_penalty;var g=this.grid[d-1][f]+this.gap_penalty,m=this.grid[d][f-1]+this.gap_penalty,y=[p,g,m],b=this.arrayAllMaxIndexes(y);this.grid[d][f]=y[b[0]],this.tracebackGrid[d][f]=[b.includes(0),b.includes(1),b.includes(2)]}this.score=this.grid[this.iMax-1][this.jMax-1]}},{key:"alignmentTraceback",value:function(){var c=[];for(c.push({pos:[this.sequence1.length,this.sequence2.length],seq1:"",seq2:""});c[0];){var h=c[0],d=this.tracebackGrid[h.pos[0]][h.pos[1]];d[0]&&c.push({pos:[h.pos[0]-1,h.pos[1]-1],seq1:this.sequence1[h.pos[0]-1]+h.seq1,seq2:this.sequence2[h.pos[1]-1]+h.seq2}),d[1]&&c.push({pos:[h.pos[0]-1,h.pos[1]],seq1:this.sequence1[h.pos[0]-1]+h.seq1,seq2:"-"+h.seq2}),d[2]&&c.push({pos:[h.pos[0],h.pos[1]-1],seq1:"-"+h.seq1,seq2:this.sequence2[h.pos[1]-1]+h.seq2}),h.pos[0]===0&&h.pos[1]===0&&this.alignments.push({sequence1:h.seq1,sequence2:h.seq2}),c.shift()}return this.alignments}},{key:"getAllIndexes",value:function(c,h){for(var d=[],f=-1;(f=c.indexOf(h,f+1))!==-1;)d.push(f);return d}},{key:"arrayAllMaxIndexes",value:function(c){return this.getAllIndexes(c,Math.max.apply(null,c))}}]),u}();n.exports=o},function(n,r,i){var s=function(){};s.FDLayout=i(18),s.FDLayoutConstants=i(7),s.FDLayoutEdge=i(19),s.FDLayoutNode=i(20),s.DimensionD=i(21),s.HashMap=i(22),s.HashSet=i(23),s.IGeometry=i(8),s.IMath=i(9),s.Integer=i(10),s.Point=i(12),s.PointD=i(4),s.RandomSeed=i(16),s.RectangleD=i(13),s.Transform=i(17),s.UniqueIDGeneretor=i(14),s.Quicksort=i(24),s.LinkedList=i(11),s.LGraphObject=i(2),s.LGraph=i(5),s.LEdge=i(1),s.LGraphManager=i(6),s.LNode=i(3),s.Layout=i(15),s.LayoutConstants=i(0),s.NeedlemanWunsch=i(25),n.exports=s},function(n,r,i){function s(){this.listeners=[]}var a=s.prototype;a.addListener=function(o,u){this.listeners.push({event:o,callback:u})},a.removeListener=function(o,u){for(var l=this.listeners.length;l>=0;l--){var c=this.listeners[l];c.event===o&&c.callback===u&&this.listeners.splice(l,1)}},a.emit=function(o,u){for(var l=0;l<this.listeners.length;l++){var c=this.listeners[l];o===c.event&&c.callback(u)}},n.exports=s}])})}(th)),th.exports}var FU=eh.exports,Ix;function LX(){return Ix||(Ix=1,function(t,e){(function(r,i){t.exports=i(NU())})(FU,function(n){return function(r){var i={};function s(a){if(i[a])return i[a].exports;var o=i[a]={i:a,l:!1,exports:{}};return r[a].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=r,s.c=i,s.i=function(a){return a},s.d=function(a,o,u){s.o(a,o)||Object.defineProperty(a,o,{configurable:!1,enumerable:!0,get:u})},s.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(o,"a",o),o},s.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},s.p="",s(s.s=7)}([function(r,i){r.exports=n},function(r,i,s){var a=s(0).FDLayoutConstants;function o(){}for(var u in a)o[u]=a[u];o.DEFAULT_USE_MULTI_LEVEL_SCALING=!1,o.DEFAULT_RADIAL_SEPARATION=a.DEFAULT_EDGE_LENGTH,o.DEFAULT_COMPONENT_SEPERATION=60,o.TILE=!0,o.TILING_PADDING_VERTICAL=10,o.TILING_PADDING_HORIZONTAL=10,o.TREE_REDUCTION_ON_INCREMENTAL=!1,r.exports=o},function(r,i,s){var a=s(0).FDLayoutEdge;function o(l,c,h){a.call(this,l,c,h)}o.prototype=Object.create(a.prototype);for(var u in a)o[u]=a[u];r.exports=o},function(r,i,s){var a=s(0).LGraph;function o(l,c,h){a.call(this,l,c,h)}o.prototype=Object.create(a.prototype);for(var u in a)o[u]=a[u];r.exports=o},function(r,i,s){var a=s(0).LGraphManager;function o(l){a.call(this,l)}o.prototype=Object.create(a.prototype);for(var u in a)o[u]=a[u];r.exports=o},function(r,i,s){var a=s(0).FDLayoutNode,o=s(0).IMath;function u(c,h,d,f){a.call(this,c,h,d,f)}u.prototype=Object.create(a.prototype);for(var l in a)u[l]=a[l];u.prototype.move=function(){var c=this.graphManager.getLayout();this.displacementX=c.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.noOfChildren,this.displacementY=c.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.noOfChildren,Math.abs(this.displacementX)>c.coolingFactor*c.maxNodeDisplacement&&(this.displacementX=c.coolingFactor*c.maxNodeDisplacement*o.sign(this.displacementX)),Math.abs(this.displacementY)>c.coolingFactor*c.maxNodeDisplacement&&(this.displacementY=c.coolingFactor*c.maxNodeDisplacement*o.sign(this.displacementY)),this.child==null?this.moveBy(this.displacementX,this.displacementY):this.child.getNodes().length==0?this.moveBy(this.displacementX,this.displacementY):this.propogateDisplacementToChildren(this.displacementX,this.displacementY),c.totalDisplacement+=Math.abs(this.displacementX)+Math.abs(this.displacementY),this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0},u.prototype.propogateDisplacementToChildren=function(c,h){for(var d=this.getChild().getNodes(),f,p=0;p<d.length;p++)f=d[p],f.getChild()==null?(f.moveBy(c,h),f.displacementX+=c,f.displacementY+=h):f.propogateDisplacementToChildren(c,h)},u.prototype.setPred1=function(c){this.pred1=c},u.prototype.getPred1=function(){return pred1},u.prototype.getPred2=function(){return pred2},u.prototype.setNext=function(c){this.next=c},u.prototype.getNext=function(){return next},u.prototype.setProcessed=function(c){this.processed=c},u.prototype.isProcessed=function(){return processed},r.exports=u},function(r,i,s){var a=s(0).FDLayout,o=s(4),u=s(3),l=s(5),c=s(2),h=s(1),d=s(0).FDLayoutConstants,f=s(0).LayoutConstants,p=s(0).Point,g=s(0).PointD,m=s(0).Layout,y=s(0).Integer,b=s(0).IGeometry,v=s(0).LGraph,E=s(0).Transform;function w(){a.call(this),this.toBeTiled={}}w.prototype=Object.create(a.prototype);for(var N in a)w[N]=a[N];w.prototype.newGraphManager=function(){var D=new o(this);return this.graphManager=D,D},w.prototype.newGraph=function(D){return new u(null,this.graphManager,D)},w.prototype.newNode=function(D){return new l(this.graphManager,D)},w.prototype.newEdge=function(D){return new c(null,null,D)},w.prototype.initParameters=function(){a.prototype.initParameters.call(this,arguments),this.isSubLayout||(h.DEFAULT_EDGE_LENGTH<10?this.idealEdgeLength=10:this.idealEdgeLength=h.DEFAULT_EDGE_LENGTH,this.useSmartIdealEdgeLengthCalculation=h.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.springConstant=d.DEFAULT_SPRING_STRENGTH,this.repulsionConstant=d.DEFAULT_REPULSION_STRENGTH,this.gravityConstant=d.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=d.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=d.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=d.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.prunedNodesAll=[],this.growTreeIterations=0,this.afterGrowthIterations=0,this.isTreeGrowing=!1,this.isGrowthFinished=!1,this.coolingCycle=0,this.maxCoolingCycle=this.maxIterations/d.CONVERGENCE_CHECK_PERIOD,this.finalTemperature=d.CONVERGENCE_CHECK_PERIOD/this.maxIterations,this.coolingAdjuster=1)},w.prototype.layout=function(){var D=f.DEFAULT_CREATE_BENDS_AS_NEEDED;return D&&(this.createBendpoints(),this.graphManager.resetAllEdges()),this.level=0,this.classicLayout()},w.prototype.classicLayout=function(){if(this.nodesWithGravity=this.calculateNodesToApplyGravitationTo(),this.graphManager.setAllNodesToApplyGravitation(this.nodesWithGravity),this.calcNoOfChildrenForAllNodes(),this.graphManager.calcLowestCommonAncestors(),this.graphManager.calcInclusionTreeDepths(),this.graphManager.getRoot().calcEstimatedSize(),this.calcIdealEdgeLengths(),this.incremental){if(h.TREE_REDUCTION_ON_INCREMENTAL){this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var k=new Set(this.getAllNodes()),F=this.nodesWithGravity.filter(function(R){return k.has(R)});this.graphManager.setAllNodesToApplyGravitation(F)}}else{var D=this.getFlatForest();if(D.length>0)this.positionNodesRadially(D);else{this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var k=new Set(this.getAllNodes()),F=this.nodesWithGravity.filter(function(M){return k.has(M)});this.graphManager.setAllNodesToApplyGravitation(F),this.positionNodesRandomly()}}return this.initSpringEmbedder(),this.runSpringEmbedder(),!0},w.prototype.tick=function(){if(this.totalIterations++,this.totalIterations===this.maxIterations&&!this.isTreeGrowing&&!this.isGrowthFinished)if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;if(this.totalIterations%d.CONVERGENCE_CHECK_PERIOD==0&&!this.isTreeGrowing&&!this.isGrowthFinished){if(this.isConverged())if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;this.coolingCycle++,this.layoutQuality==0?this.coolingAdjuster=this.coolingCycle:this.layoutQuality==1&&(this.coolingAdjuster=this.coolingCycle/3),this.coolingFactor=Math.max(this.initialCoolingFactor-Math.pow(this.coolingCycle,Math.log(100*(this.initialCoolingFactor-this.finalTemperature))/Math.log(this.maxCoolingCycle))/100*this.coolingAdjuster,this.finalTemperature),this.animationPeriod=Math.ceil(this.initialAnimationPeriod*Math.sqrt(this.coolingFactor))}if(this.isTreeGrowing){if(this.growTreeIterations%10==0)if(this.prunedNodesAll.length>0){this.graphManager.updateBounds(),this.updateGrid(),this.growTree(this.prunedNodesAll),this.graphManager.resetAllNodesToApplyGravitation();var D=new Set(this.getAllNodes()),k=this.nodesWithGravity.filter(function(S){return D.has(S)});this.graphManager.setAllNodesToApplyGravitation(k),this.graphManager.updateBounds(),this.updateGrid(),this.coolingFactor=d.DEFAULT_COOLING_FACTOR_INCREMENTAL}else this.isTreeGrowing=!1,this.isGrowthFinished=!0;this.growTreeIterations++}if(this.isGrowthFinished){if(this.isConverged())return!0;this.afterGrowthIterations%10==0&&(this.graphManager.updateBounds(),this.updateGrid()),this.coolingFactor=d.DEFAULT_COOLING_FACTOR_INCREMENTAL*((100-this.afterGrowthIterations)/100),this.afterGrowthIterations++}var F=!this.isTreeGrowing&&!this.isGrowthFinished,M=this.growTreeIterations%10==1&&this.isTreeGrowing||this.afterGrowthIterations%10==1&&this.isGrowthFinished;return this.totalDisplacement=0,this.graphManager.updateBounds(),this.calcSpringForces(),this.calcRepulsionForces(F,M),this.calcGravitationalForces(),this.moveNodes(),this.animate(),!1},w.prototype.getPositionsData=function(){for(var D=this.graphManager.getAllNodes(),k={},F=0;F<D.length;F++){var M=D[F].rect,S=D[F].id;k[S]={id:S,x:M.getCenterX(),y:M.getCenterY(),w:M.width,h:M.height}}return k},w.prototype.runSpringEmbedder=function(){this.initialAnimationPeriod=25,this.animationPeriod=this.initialAnimationPeriod;var D=!1;if(d.ANIMATE==="during")this.emit("layoutstarted");else{for(;!D;)D=this.tick();this.graphManager.updateBounds()}},w.prototype.calculateNodesToApplyGravitationTo=function(){var D=[],k,F=this.graphManager.getGraphs(),M=F.length,S;for(S=0;S<M;S++)k=F[S],k.updateConnected(),k.isConnected||(D=D.concat(k.getNodes()));return D},w.prototype.createBendpoints=function(){var D=[];D=D.concat(this.graphManager.getAllEdges());var k=new Set,F;for(F=0;F<D.length;F++){var M=D[F];if(!k.has(M)){var S=M.getSource(),R=M.getTarget();if(S==R)M.getBendpoints().push(new g),M.getBendpoints().push(new g),this.createDummyNodesForBendpoints(M),k.add(M);else{var I=[];if(I=I.concat(S.getEdgeListToNode(R)),I=I.concat(R.getEdgeListToNode(S)),!k.has(I[0])){if(I.length>1){var x;for(x=0;x<I.length;x++){var _=I[x];_.getBendpoints().push(new g),this.createDummyNodesForBendpoints(_)}}I.forEach(function(C){k.add(C)})}}}if(k.size==D.length)break}},w.prototype.positionNodesRadially=function(D){for(var k=new p(0,0),F=Math.ceil(Math.sqrt(D.length)),M=0,S=0,R=0,I=new g(0,0),x=0;x<D.length;x++){x%F==0&&(R=0,S=M,x!=0&&(S+=h.DEFAULT_COMPONENT_SEPERATION),M=0);var _=D[x],C=m.findCenterOfTree(_);k.x=R,k.y=S,I=w.radialLayout(_,C,k),I.y>M&&(M=Math.floor(I.y)),R=Math.floor(I.x+h.DEFAULT_COMPONENT_SEPERATION)}this.transform(new g(f.WORLD_CENTER_X-I.x/2,f.WORLD_CENTER_Y-I.y/2))},w.radialLayout=function(D,k,F){var M=Math.max(this.maxDiagonalInTree(D),h.DEFAULT_RADIAL_SEPARATION);w.branchRadialLayout(k,null,0,359,0,M);var S=v.calculateBounds(D),R=new E;R.setDeviceOrgX(S.getMinX()),R.setDeviceOrgY(S.getMinY()),R.setWorldOrgX(F.x),R.setWorldOrgY(F.y);for(var I=0;I<D.length;I++){var x=D[I];x.transform(R)}var _=new g(S.getMaxX(),S.getMaxY());return R.inverseTransformPoint(_)},w.branchRadialLayout=function(D,k,F,M,S,R){var I=(M-F+1)/2;I<0&&(I+=180);var x=(I+F)%360,_=x*b.TWO_PI/360,C=S*Math.cos(_),A=S*Math.sin(_);D.setCenter(C,A);var T=[];T=T.concat(D.getEdges());var O=T.length;k!=null&&O--;for(var L=0,P=T.length,Y,W=D.getEdgesBetween(k);W.length>1;){var X=W[0];W.splice(0,1);var V=T.indexOf(X);V>=0&&T.splice(V,1),P--,O--}k!=null?Y=(T.indexOf(W[0])+1)%P:Y=0;for(var q=Math.abs(M-F)/O,Z=Y;L!=O;Z=++Z%P){var J=T[Z].getOtherEnd(D);if(J!=k){var B=(F+L*q)%360,H=(B+q)%360;w.branchRadialLayout(J,D,B,H,S+R,R),L++}}},w.maxDiagonalInTree=function(D){for(var k=y.MIN_VALUE,F=0;F<D.length;F++){var M=D[F],S=M.getDiagonal();S>k&&(k=S)}return k},w.prototype.calcRepulsionRange=function(){return 2*(this.level+1)*this.idealEdgeLength},w.prototype.groupZeroDegreeMembers=function(){var D=this,k={};this.memberGroups={},this.idToDummyNode={};for(var F=[],M=this.graphManager.getAllNodes(),S=0;S<M.length;S++){var R=M[S],I=R.getParent();this.getNodeDegreeWithChildren(R)===0&&(I.id==null||!this.getToBeTiled(I))&&F.push(R)}for(var S=0;S<F.length;S++){var R=F[S],x=R.getParent().id;typeof k[x]>"u"&&(k[x]=[]),k[x]=k[x].concat(R)}Object.keys(k).forEach(function(_){if(k[_].length>1){var C="DummyCompound_"+_;D.memberGroups[C]=k[_];var A=k[_][0].getParent(),T=new l(D.graphManager);T.id=C,T.paddingLeft=A.paddingLeft||0,T.paddingRight=A.paddingRight||0,T.paddingBottom=A.paddingBottom||0,T.paddingTop=A.paddingTop||0,D.idToDummyNode[C]=T;var O=D.getGraphManager().add(D.newGraph(),T),L=A.getChild();L.add(T);for(var P=0;P<k[_].length;P++){var Y=k[_][P];L.remove(Y),O.add(Y)}}})},w.prototype.clearCompounds=function(){var D={},k={};this.performDFSOnCompounds();for(var F=0;F<this.compoundOrder.length;F++)k[this.compoundOrder[F].id]=this.compoundOrder[F],D[this.compoundOrder[F].id]=[].concat(this.compoundOrder[F].getChild().getNodes()),this.graphManager.remove(this.compoundOrder[F].getChild()),this.compoundOrder[F].child=null;this.graphManager.resetAllNodes(),this.tileCompoundMembers(D,k)},w.prototype.clearZeroDegreeMembers=function(){var D=this,k=this.tiledZeroDegreePack=[];Object.keys(this.memberGroups).forEach(function(F){var M=D.idToDummyNode[F];k[F]=D.tileNodes(D.memberGroups[F],M.paddingLeft+M.paddingRight),M.rect.width=k[F].width,M.rect.height=k[F].height})},w.prototype.repopulateCompounds=function(){for(var D=this.compoundOrder.length-1;D>=0;D--){var k=this.compoundOrder[D],F=k.id,M=k.paddingLeft,S=k.paddingTop;this.adjustLocations(this.tiledMemberPack[F],k.rect.x,k.rect.y,M,S)}},w.prototype.repopulateZeroDegreeMembers=function(){var D=this,k=this.tiledZeroDegreePack;Object.keys(k).forEach(function(F){var M=D.idToDummyNode[F],S=M.paddingLeft,R=M.paddingTop;D.adjustLocations(k[F],M.rect.x,M.rect.y,S,R)})},w.prototype.getToBeTiled=function(D){var k=D.id;if(this.toBeTiled[k]!=null)return this.toBeTiled[k];var F=D.getChild();if(F==null)return this.toBeTiled[k]=!1,!1;for(var M=F.getNodes(),S=0;S<M.length;S++){var R=M[S];if(this.getNodeDegree(R)>0)return this.toBeTiled[k]=!1,!1;if(R.getChild()==null){this.toBeTiled[R.id]=!1;continue}if(!this.getToBeTiled(R))return this.toBeTiled[k]=!1,!1}return this.toBeTiled[k]=!0,!0},w.prototype.getNodeDegree=function(D){D.id;for(var k=D.getEdges(),F=0,M=0;M<k.length;M++){var S=k[M];S.getSource().id!==S.getTarget().id&&(F=F+1)}return F},w.prototype.getNodeDegreeWithChildren=function(D){var k=this.getNodeDegree(D);if(D.getChild()==null)return k;for(var F=D.getChild().getNodes(),M=0;M<F.length;M++){var S=F[M];k+=this.getNodeDegreeWithChildren(S)}return k},w.prototype.performDFSOnCompounds=function(){this.compoundOrder=[],this.fillCompexOrderByDFS(this.graphManager.getRoot().getNodes())},w.prototype.fillCompexOrderByDFS=function(D){for(var k=0;k<D.length;k++){var F=D[k];F.getChild()!=null&&this.fillCompexOrderByDFS(F.getChild().getNodes()),this.getToBeTiled(F)&&this.compoundOrder.push(F)}},w.prototype.adjustLocations=function(D,k,F,M,S){k+=M,F+=S;for(var R=k,I=0;I<D.rows.length;I++){var x=D.rows[I];k=R;for(var _=0,C=0;C<x.length;C++){var A=x[C];A.rect.x=k,A.rect.y=F,k+=A.rect.width+D.horizontalPadding,A.rect.height>_&&(_=A.rect.height)}F+=_+D.verticalPadding}},w.prototype.tileCompoundMembers=function(D,k){var F=this;this.tiledMemberPack=[],Object.keys(D).forEach(function(M){var S=k[M];F.tiledMemberPack[M]=F.tileNodes(D[M],S.paddingLeft+S.paddingRight),S.rect.width=F.tiledMemberPack[M].width,S.rect.height=F.tiledMemberPack[M].height})},w.prototype.tileNodes=function(D,k){var F=h.TILING_PADDING_VERTICAL,M=h.TILING_PADDING_HORIZONTAL,S={rows:[],rowWidth:[],rowHeight:[],width:0,height:k,verticalPadding:F,horizontalPadding:M};D.sort(function(x,_){return x.rect.width*x.rect.height>_.rect.width*_.rect.height?-1:x.rect.width*x.rect.height<_.rect.width*_.rect.height?1:0});for(var R=0;R<D.length;R++){var I=D[R];S.rows.length==0?this.insertNodeToRow(S,I,0,k):this.canAddHorizontal(S,I.rect.width,I.rect.height)?this.insertNodeToRow(S,I,this.getShortestRowIndex(S),k):this.insertNodeToRow(S,I,S.rows.length,k),this.shiftToLastRow(S)}return S},w.prototype.insertNodeToRow=function(D,k,F,M){var S=M;if(F==D.rows.length){var R=[];D.rows.push(R),D.rowWidth.push(S),D.rowHeight.push(0)}var I=D.rowWidth[F]+k.rect.width;D.rows[F].length>0&&(I+=D.horizontalPadding),D.rowWidth[F]=I,D.width<I&&(D.width=I);var x=k.rect.height;F>0&&(x+=D.verticalPadding);var _=0;x>D.rowHeight[F]&&(_=D.rowHeight[F],D.rowHeight[F]=x,_=D.rowHeight[F]-_),D.height+=_,D.rows[F].push(k)},w.prototype.getShortestRowIndex=function(D){for(var k=-1,F=Number.MAX_VALUE,M=0;M<D.rows.length;M++)D.rowWidth[M]<F&&(k=M,F=D.rowWidth[M]);return k},w.prototype.getLongestRowIndex=function(D){for(var k=-1,F=Number.MIN_VALUE,M=0;M<D.rows.length;M++)D.rowWidth[M]>F&&(k=M,F=D.rowWidth[M]);return k},w.prototype.canAddHorizontal=function(D,k,F){var M=this.getShortestRowIndex(D);if(M<0)return!0;var S=D.rowWidth[M];if(S+D.horizontalPadding+k<=D.width)return!0;var R=0;D.rowHeight[M]<F&&M>0&&(R=F+D.verticalPadding-D.rowHeight[M]);var I;D.width-S>=k+D.horizontalPadding?I=(D.height+R)/(S+k+D.horizontalPadding):I=(D.height+R)/D.width,R=F+D.verticalPadding;var x;return D.width<k?x=(D.height+R)/k:x=(D.height+R)/D.width,x<1&&(x=1/x),I<1&&(I=1/I),I<x},w.prototype.shiftToLastRow=function(D){var k=this.getLongestRowIndex(D),F=D.rowWidth.length-1,M=D.rows[k],S=M[M.length-1],R=S.width+D.horizontalPadding;if(D.width-D.rowWidth[F]>R&&k!=F){M.splice(-1,1),D.rows[F].push(S),D.rowWidth[k]=D.rowWidth[k]-R,D.rowWidth[F]=D.rowWidth[F]+R,D.width=D.rowWidth[instance.getLongestRowIndex(D)];for(var I=Number.MIN_VALUE,x=0;x<M.length;x++)M[x].height>I&&(I=M[x].height);k>0&&(I+=D.verticalPadding);var _=D.rowHeight[k]+D.rowHeight[F];D.rowHeight[k]=I,D.rowHeight[F]<S.height+D.verticalPadding&&(D.rowHeight[F]=S.height+D.verticalPadding);var C=D.rowHeight[k]+D.rowHeight[F];D.height+=C-_,this.shiftToLastRow(D)}},w.prototype.tilingPreLayout=function(){h.TILE&&(this.groupZeroDegreeMembers(),this.clearCompounds(),this.clearZeroDegreeMembers())},w.prototype.tilingPostLayout=function(){h.TILE&&(this.repopulateZeroDegreeMembers(),this.repopulateCompounds())},w.prototype.reduceTrees=function(){for(var D=[],k=!0,F;k;){var M=this.graphManager.getAllNodes(),S=[];k=!1;for(var R=0;R<M.length;R++)F=M[R],F.getEdges().length==1&&!F.getEdges()[0].isInterGraph&&F.getChild()==null&&(S.push([F,F.getEdges()[0],F.getOwner()]),k=!0);if(k==!0){for(var I=[],x=0;x<S.length;x++)S[x][0].getEdges().length==1&&(I.push(S[x]),S[x][0].getOwner().remove(S[x][0]));D.push(I),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()}}this.prunedNodesAll=D},w.prototype.growTree=function(D){for(var k=D.length,F=D[k-1],M,S=0;S<F.length;S++)M=F[S],this.findPlaceforPrunedNode(M),M[2].add(M[0]),M[2].add(M[1],M[1].source,M[1].target);D.splice(D.length-1,1),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()},w.prototype.findPlaceforPrunedNode=function(D){var k,F,M=D[0];M==D[1].source?F=D[1].target:F=D[1].source;var S=F.startX,R=F.finishX,I=F.startY,x=F.finishY,_=0,C=0,A=0,T=0,O=[_,A,C,T];if(I>0)for(var L=S;L<=R;L++)O[0]+=this.grid[L][I-1].length+this.grid[L][I].length-1;if(R<this.grid.length-1)for(var L=I;L<=x;L++)O[1]+=this.grid[R+1][L].length+this.grid[R][L].length-1;if(x<this.grid[0].length-1)for(var L=S;L<=R;L++)O[2]+=this.grid[L][x+1].length+this.grid[L][x].length-1;if(S>0)for(var L=I;L<=x;L++)O[3]+=this.grid[S-1][L].length+this.grid[S][L].length-1;for(var P=y.MAX_VALUE,Y,W,X=0;X<O.length;X++)O[X]<P?(P=O[X],Y=1,W=X):O[X]==P&&Y++;if(Y==3&&P==0)O[0]==0&&O[1]==0&&O[2]==0?k=1:O[0]==0&&O[1]==0&&O[3]==0?k=0:O[0]==0&&O[2]==0&&O[3]==0?k=3:O[1]==0&&O[2]==0&&O[3]==0&&(k=2);else if(Y==2&&P==0){var V=Math.floor(Math.random()*2);O[0]==0&&O[1]==0?V==0?k=0:k=1:O[0]==0&&O[2]==0?V==0?k=0:k=2:O[0]==0&&O[3]==0?V==0?k=0:k=3:O[1]==0&&O[2]==0?V==0?k=1:k=2:O[1]==0&&O[3]==0?V==0?k=1:k=3:V==0?k=2:k=3}else if(Y==4&&P==0){var V=Math.floor(Math.random()*4);k=V}else k=W;k==0?M.setCenter(F.getCenterX(),F.getCenterY()-F.getHeight()/2-d.DEFAULT_EDGE_LENGTH-M.getHeight()/2):k==1?M.setCenter(F.getCenterX()+F.getWidth()/2+d.DEFAULT_EDGE_LENGTH+M.getWidth()/2,F.getCenterY()):k==2?M.setCenter(F.getCenterX(),F.getCenterY()+F.getHeight()/2+d.DEFAULT_EDGE_LENGTH+M.getHeight()/2):M.setCenter(F.getCenterX()-F.getWidth()/2-d.DEFAULT_EDGE_LENGTH-M.getWidth()/2,F.getCenterY())},r.exports=w},function(r,i,s){var a={};a.layoutBase=s(0),a.CoSEConstants=s(1),a.CoSEEdge=s(2),a.CoSEGraph=s(3),a.CoSEGraphManager=s(4),a.CoSELayout=s(6),a.CoSENode=s(5),r.exports=a}])})}(eh)),eh.exports}function dn(t){return typeof t=="object"&&t!==null&&typeof t.$type=="string"}function Vr(t){return typeof t=="object"&&t!==null&&typeof t.$refText=="string"}function RU(t){return typeof t=="object"&&t!==null&&typeof t.name=="string"&&typeof t.type=="string"&&typeof t.path=="string"}function nh(t){return typeof t=="object"&&t!==null&&dn(t.container)&&Vr(t.reference)&&typeof t.message=="string"}class MU{constructor(){this.subtypes={},this.allSubtypes={}}isInstance(e,n){return dn(e)&&this.isSubtype(e.$type,n)}isSubtype(e,n){if(e===n)return!0;let r=this.subtypes[e];r||(r=this.subtypes[e]={});const i=r[n];if(i!==void 0)return i;{const s=this.computeIsSubtype(e,n);return r[n]=s,s}}getAllSubTypes(e){const n=this.allSubtypes[e];if(n)return n;{const r=this.getAllTypes(),i=[];for(const s of r)this.isSubtype(s,e)&&i.push(s);return this.allSubtypes[e]=i,i}}}function rl(t){return typeof t=="object"&&t!==null&&Array.isArray(t.content)}function ZA(t){return typeof t=="object"&&t!==null&&typeof t.tokenType=="object"}function QA(t){return rl(t)&&typeof t.fullText=="string"}class jt{constructor(e,n){this.startFn=e,this.nextFn=n}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),[Symbol.iterator]:()=>e};return e}[Symbol.iterator](){return this.iterator()}isEmpty(){return!!this.iterator().next().done}count(){const e=this.iterator();let n=0,r=e.next();for(;!r.done;)n++,r=e.next();return n}toArray(){const e=[],n=this.iterator();let r;do r=n.next(),r.value!==void 0&&e.push(r.value);while(!r.done);return e}toSet(){return new Set(this)}toMap(e,n){const r=this.map(i=>[e?e(i):i,n?n(i):i]);return new Map(r)}toString(){return this.join()}concat(e){return new jt(()=>({first:this.startFn(),firstDone:!1,iterator:e[Symbol.iterator]()}),n=>{let r;if(!n.firstDone){do if(r=this.nextFn(n.first),!r.done)return r;while(!r.done);n.firstDone=!0}do if(r=n.iterator.next(),!r.done)return r;while(!r.done);return zn})}join(e=","){const n=this.iterator();let r="",i,s=!1;do i=n.next(),i.done||(s&&(r+=e),r+=OU(i.value)),s=!0;while(!i.done);return r}indexOf(e,n=0){const r=this.iterator();let i=0,s=r.next();for(;!s.done;){if(i>=n&&s.value===e)return i;s=r.next(),i++}return-1}every(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(!e(r.value))return!1;r=n.next()}return!0}some(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(e(r.value))return!0;r=n.next()}return!1}forEach(e){const n=this.iterator();let r=0,i=n.next();for(;!i.done;)e(i.value,r),i=n.next(),r++}map(e){return new jt(this.startFn,n=>{const{done:r,value:i}=this.nextFn(n);return r?zn:{done:!1,value:e(i)}})}filter(e){return new jt(this.startFn,n=>{let r;do if(r=this.nextFn(n),!r.done&&e(r.value))return r;while(!r.done);return zn})}nonNullable(){return this.filter(e=>e!=null)}reduce(e,n){const r=this.iterator();let i=n,s=r.next();for(;!s.done;)i===void 0?i=s.value:i=e(i,s.value),s=r.next();return i}reduceRight(e,n){return this.recursiveReduce(this.iterator(),e,n)}recursiveReduce(e,n,r){const i=e.next();if(i.done)return r;const s=this.recursiveReduce(e,n,r);return s===void 0?i.value:n(s,i.value)}find(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(e(r.value))return r.value;r=n.next()}}findIndex(e){const n=this.iterator();let r=0,i=n.next();for(;!i.done;){if(e(i.value))return r;i=n.next(),r++}return-1}includes(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(r.value===e)return!0;r=n.next()}return!1}flatMap(e){return new jt(()=>({this:this.startFn()}),n=>{do{if(n.iterator){const s=n.iterator.next();if(s.done)n.iterator=void 0;else return s}const{done:r,value:i}=this.nextFn(n.this);if(!r){const s=e(i);if(hf(s))n.iterator=s[Symbol.iterator]();else return{done:!1,value:s}}}while(n.iterator);return zn})}flat(e){if(e===void 0&&(e=1),e<=0)return this;const n=e>1?this.flat(e-1):this;return new jt(()=>({this:n.startFn()}),r=>{do{if(r.iterator){const a=r.iterator.next();if(a.done)r.iterator=void 0;else return a}const{done:i,value:s}=n.nextFn(r.this);if(!i)if(hf(s))r.iterator=s[Symbol.iterator]();else return{done:!1,value:s}}while(r.iterator);return zn})}head(){const n=this.iterator().next();if(!n.done)return n.value}tail(e=1){return new jt(()=>{const n=this.startFn();for(let r=0;r<e;r++)if(this.nextFn(n).done)return n;return n},this.nextFn)}limit(e){return new jt(()=>({size:0,state:this.startFn()}),n=>(n.size++,n.size>e?zn:this.nextFn(n.state)))}distinct(e){return new jt(()=>({set:new Set,internalState:this.startFn()}),n=>{let r;do if(r=this.nextFn(n.internalState),!r.done){const i=e?e(r.value):r.value;if(!n.set.has(i))return n.set.add(i),r}while(!r.done);return zn})}exclude(e,n){const r=new Set;for(const i of e){const s=n?n(i):i;r.add(s)}return this.filter(i=>{const s=n?n(i):i;return!r.has(s)})}}function OU(t){return typeof t=="string"?t:typeof t>"u"?"undefined":typeof t.toString=="function"?t.toString():Object.prototype.toString.call(t)}function hf(t){return!!t&&typeof t[Symbol.iterator]=="function"}const IU=new jt(()=>{},()=>zn),zn=Object.freeze({done:!0,value:void 0});function Zt(...t){if(t.length===1){const e=t[0];if(e instanceof jt)return e;if(hf(e))return new jt(()=>e[Symbol.iterator](),n=>n.next());if(typeof e.length=="number")return new jt(()=>({index:0}),n=>n.index<e.length?{done:!1,value:e[n.index++]}:zn)}return t.length>1?new jt(()=>({collIndex:0,arrIndex:0}),e=>{do{if(e.iterator){const n=e.iterator.next();if(!n.done)return n;e.iterator=void 0}if(e.array){if(e.arrIndex<e.array.length)return{done:!1,value:e.array[e.arrIndex++]};e.array=void 0,e.arrIndex=0}if(e.collIndex<t.length){const n=t[e.collIndex++];hf(n)?e.iterator=n[Symbol.iterator]():n&&typeof n.length=="number"&&(e.array=n)}}while(e.iterator||e.array||e.collIndex<t.length);return zn}):IU}class q1 extends jt{constructor(e,n,r){super(()=>({iterators:r!=null&&r.includeRoot?[[e][Symbol.iterator]()]:[n(e)[Symbol.iterator]()],pruned:!1}),i=>{for(i.pruned&&(i.iterators.pop(),i.pruned=!1);i.iterators.length>0;){const a=i.iterators[i.iterators.length-1].next();if(a.done)i.iterators.pop();else return i.iterators.push(n(a.value)[Symbol.iterator]()),a}return zn})}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),prune:()=>{e.state.pruned=!0},[Symbol.iterator]:()=>e};return e}}var Ag;(function(t){function e(s){return s.reduce((a,o)=>a+o,0)}t.sum=e;function n(s){return s.reduce((a,o)=>a*o,0)}t.product=n;function r(s){return s.reduce((a,o)=>Math.min(a,o))}t.min=r;function i(s){return s.reduce((a,o)=>Math.max(a,o))}t.max=i})(Ag||(Ag={}));function Tg(t){return new q1(t,e=>rl(e)?e.content:[],{includeRoot:!0})}function LU(t,e){for(;t.container;)if(t=t.container,t===e)return!0;return!1}function kg(t){return{start:{character:t.startColumn-1,line:t.startLine-1},end:{character:t.endColumn,line:t.endLine-1}}}function ff(t){if(!t)return;const{offset:e,end:n,range:r}=t;return{range:r,offset:e,end:n,length:n-e}}var di;(function(t){t[t.Before=0]="Before",t[t.After=1]="After",t[t.OverlapFront=2]="OverlapFront",t[t.OverlapBack=3]="OverlapBack",t[t.Inside=4]="Inside",t[t.Outside=5]="Outside"})(di||(di={}));function PU(t,e){if(t.end.line<e.start.line||t.end.line===e.start.line&&t.end.character<=e.start.character)return di.Before;if(t.start.line>e.end.line||t.start.line===e.end.line&&t.start.character>=e.end.character)return di.After;const n=t.start.line>e.start.line||t.start.line===e.start.line&&t.start.character>=e.start.character,r=t.end.line<e.end.line||t.end.line===e.end.line&&t.end.character<=e.end.character;return n&&r?di.Inside:n?di.OverlapBack:r?di.OverlapFront:di.Outside}function $U(t,e){return PU(t,e)>di.After}const BU=/^[\w\p{L}]$/u;function UU(t,e){if(t){const n=GU(t,!0);if(n&&Lx(n,e))return n;if(QA(t)){const r=t.content.findIndex(i=>!i.hidden);for(let i=r-1;i>=0;i--){const s=t.content[i];if(Lx(s,e))return s}}}}function Lx(t,e){return ZA(t)&&e.includes(t.tokenType.name)}function GU(t,e=!0){for(;t.container;){const n=t.container;let r=n.content.indexOf(t);for(;r>0;){r--;const i=n.content[r];if(e||!i.hidden)return i}t=n}}class eT extends Error{constructor(e,n){super(e?`${n} at ${e.range.start.line}:${e.range.start.character}`:n)}}function Cl(t){throw new Error("Error! The input value was not handled.")}const hc="AbstractRule",fc="AbstractType",jp="Condition",Px="TypeDefinition",Kp="ValueLiteral",qo="AbstractElement";function zU(t){return Ve.isInstance(t,qo)}const dc="ArrayLiteral",pc="ArrayType",Xo="BooleanLiteral";function WU(t){return Ve.isInstance(t,Xo)}const jo="Conjunction";function HU(t){return Ve.isInstance(t,jo)}const Ko="Disjunction";function YU(t){return Ve.isInstance(t,Ko)}const gc="Grammar",Jp="GrammarImport",Jo="InferredType";function tT(t){return Ve.isInstance(t,Jo)}const Zo="Interface";function nT(t){return Ve.isInstance(t,Zo)}const Zp="NamedArgument",Qo="Negation";function VU(t){return Ve.isInstance(t,Qo)}const mc="NumberLiteral",yc="Parameter",eu="ParameterReference";function qU(t){return Ve.isInstance(t,eu)}const tu="ParserRule";function hr(t){return Ve.isInstance(t,tu)}const vc="ReferenceType",rh="ReturnType";function XU(t){return Ve.isInstance(t,rh)}const nu="SimpleType";function jU(t){return Ve.isInstance(t,nu)}const bc="StringLiteral",da="TerminalRule";function Ks(t){return Ve.isInstance(t,da)}const ru="Type";function rT(t){return Ve.isInstance(t,ru)}const Qp="TypeAttribute",xc="UnionType",iu="Action";function wd(t){return Ve.isInstance(t,iu)}const su="Alternatives";function iT(t){return Ve.isInstance(t,su)}const au="Assignment";function Ps(t){return Ve.isInstance(t,au)}const ou="CharacterRange";function KU(t){return Ve.isInstance(t,ou)}const uu="CrossReference";function X1(t){return Ve.isInstance(t,uu)}const lu="EndOfFile";function JU(t){return Ve.isInstance(t,lu)}const cu="Group";function j1(t){return Ve.isInstance(t,cu)}const hu="Keyword";function $s(t){return Ve.isInstance(t,hu)}const fu="NegatedToken";function ZU(t){return Ve.isInstance(t,fu)}const du="RegexToken";function QU(t){return Ve.isInstance(t,du)}const pu="RuleCall";function Bs(t){return Ve.isInstance(t,pu)}const gu="TerminalAlternatives";function eG(t){return Ve.isInstance(t,gu)}const mu="TerminalGroup";function tG(t){return Ve.isInstance(t,mu)}const yu="TerminalRuleCall";function nG(t){return Ve.isInstance(t,yu)}const vu="UnorderedGroup";function sT(t){return Ve.isInstance(t,vu)}const bu="UntilToken";function rG(t){return Ve.isInstance(t,bu)}const xu="Wildcard";function iG(t){return Ve.isInstance(t,xu)}class aT extends MU{getAllTypes(){return[qo,hc,fc,iu,su,dc,pc,au,Xo,ou,jp,jo,uu,Ko,lu,gc,Jp,cu,Jo,Zo,hu,Zp,fu,Qo,mc,yc,eu,tu,vc,du,rh,pu,nu,bc,gu,mu,da,yu,ru,Qp,Px,xc,vu,bu,Kp,xu]}computeIsSubtype(e,n){switch(e){case iu:case su:case au:case ou:case uu:case lu:case cu:case hu:case fu:case du:case pu:case gu:case mu:case yu:case vu:case bu:case xu:return this.isSubtype(qo,n);case dc:case mc:case bc:return this.isSubtype(Kp,n);case pc:case vc:case nu:case xc:return this.isSubtype(Px,n);case Xo:return this.isSubtype(jp,n)||this.isSubtype(Kp,n);case jo:case Ko:case Qo:case eu:return this.isSubtype(jp,n);case Jo:case Zo:case ru:return this.isSubtype(fc,n);case tu:return this.isSubtype(hc,n)||this.isSubtype(fc,n);case da:return this.isSubtype(hc,n);default:return!1}}getReferenceType(e){const n=`${e.container.$type}:${e.property}`;switch(n){case"Action:type":case"CrossReference:type":case"Interface:superTypes":case"ParserRule:returnType":case"SimpleType:typeRef":return fc;case"Grammar:hiddenTokens":case"ParserRule:hiddenTokens":case"RuleCall:rule":return hc;case"Grammar:usedGrammars":return gc;case"NamedArgument:parameter":case"ParameterReference:parameter":return yc;case"TerminalRuleCall:rule":return da;default:throw new Error(`${n} is not a valid reference id.`)}}getTypeMetaData(e){switch(e){case qo:return{name:qo,properties:[{name:"cardinality"},{name:"lookahead"}]};case dc:return{name:dc,properties:[{name:"elements",defaultValue:[]}]};case pc:return{name:pc,properties:[{name:"elementType"}]};case Xo:return{name:Xo,properties:[{name:"true",defaultValue:!1}]};case jo:return{name:jo,properties:[{name:"left"},{name:"right"}]};case Ko:return{name:Ko,properties:[{name:"left"},{name:"right"}]};case gc:return{name:gc,properties:[{name:"definesHiddenTokens",defaultValue:!1},{name:"hiddenTokens",defaultValue:[]},{name:"imports",defaultValue:[]},{name:"interfaces",defaultValue:[]},{name:"isDeclared",defaultValue:!1},{name:"name"},{name:"rules",defaultValue:[]},{name:"types",defaultValue:[]},{name:"usedGrammars",defaultValue:[]}]};case Jp:return{name:Jp,properties:[{name:"path"}]};case Jo:return{name:Jo,properties:[{name:"name"}]};case Zo:return{name:Zo,properties:[{name:"attributes",defaultValue:[]},{name:"name"},{name:"superTypes",defaultValue:[]}]};case Zp:return{name:Zp,properties:[{name:"calledByName",defaultValue:!1},{name:"parameter"},{name:"value"}]};case Qo:return{name:Qo,properties:[{name:"value"}]};case mc:return{name:mc,properties:[{name:"value"}]};case yc:return{name:yc,properties:[{name:"name"}]};case eu:return{name:eu,properties:[{name:"parameter"}]};case tu:return{name:tu,properties:[{name:"dataType"},{name:"definesHiddenTokens",defaultValue:!1},{name:"definition"},{name:"entry",defaultValue:!1},{name:"fragment",defaultValue:!1},{name:"hiddenTokens",defaultValue:[]},{name:"inferredType"},{name:"name"},{name:"parameters",defaultValue:[]},{name:"returnType"},{name:"wildcard",defaultValue:!1}]};case vc:return{name:vc,properties:[{name:"referenceType"}]};case rh:return{name:rh,properties:[{name:"name"}]};case nu:return{name:nu,properties:[{name:"primitiveType"},{name:"stringType"},{name:"typeRef"}]};case bc:return{name:bc,properties:[{name:"value"}]};case da:return{name:da,properties:[{name:"definition"},{name:"fragment",defaultValue:!1},{name:"hidden",defaultValue:!1},{name:"name"},{name:"type"}]};case ru:return{name:ru,properties:[{name:"name"},{name:"type"}]};case Qp:return{name:Qp,properties:[{name:"defaultValue"},{name:"isOptional",defaultValue:!1},{name:"name"},{name:"type"}]};case xc:return{name:xc,properties:[{name:"types",defaultValue:[]}]};case iu:return{name:iu,properties:[{name:"cardinality"},{name:"feature"},{name:"inferredType"},{name:"lookahead"},{name:"operator"},{name:"type"}]};case su:return{name:su,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case au:return{name:au,properties:[{name:"cardinality"},{name:"feature"},{name:"lookahead"},{name:"operator"},{name:"terminal"}]};case ou:return{name:ou,properties:[{name:"cardinality"},{name:"left"},{name:"lookahead"},{name:"right"}]};case uu:return{name:uu,properties:[{name:"cardinality"},{name:"deprecatedSyntax",defaultValue:!1},{name:"lookahead"},{name:"terminal"},{name:"type"}]};case lu:return{name:lu,properties:[{name:"cardinality"},{name:"lookahead"}]};case cu:return{name:cu,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"guardCondition"},{name:"lookahead"}]};case hu:return{name:hu,properties:[{name:"cardinality"},{name:"lookahead"},{name:"value"}]};case fu:return{name:fu,properties:[{name:"cardinality"},{name:"lookahead"},{name:"terminal"}]};case du:return{name:du,properties:[{name:"cardinality"},{name:"lookahead"},{name:"regex"}]};case pu:return{name:pu,properties:[{name:"arguments",defaultValue:[]},{name:"cardinality"},{name:"lookahead"},{name:"rule"}]};case gu:return{name:gu,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case mu:return{name:mu,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case yu:return{name:yu,properties:[{name:"cardinality"},{name:"lookahead"},{name:"rule"}]};case vu:return{name:vu,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case bu:return{name:bu,properties:[{name:"cardinality"},{name:"lookahead"},{name:"terminal"}]};case xu:return{name:xu,properties:[{name:"cardinality"},{name:"lookahead"}]};default:return{name:e,properties:[]}}}}const Ve=new aT;function sG(t){for(const[e,n]of Object.entries(t))e.startsWith("$")||(Array.isArray(n)?n.forEach((r,i)=>{dn(r)&&(r.$container=t,r.$containerProperty=e,r.$containerIndex=i)}):dn(n)&&(n.$container=t,n.$containerProperty=e))}function _d(t,e){let n=t;for(;n;){if(e(n))return n;n=n.$container}}function Xi(t){const n=Sg(t).$document;if(!n)throw new Error("AST node has no document.");return n}function Sg(t){for(;t.$container;)t=t.$container;return t}function K1(t,e){if(!t)throw new Error("Node must be an AstNode.");const n=e==null?void 0:e.range;return new jt(()=>({keys:Object.keys(t),keyIndex:0,arrayIndex:0}),r=>{for(;r.keyIndex<r.keys.length;){const i=r.keys[r.keyIndex];if(!i.startsWith("$")){const s=t[i];if(dn(s)){if(r.keyIndex++,$x(s,n))return{done:!1,value:s}}else if(Array.isArray(s)){for(;r.arrayIndex<s.length;){const a=r.arrayIndex++,o=s[a];if(dn(o)&&$x(o,n))return{done:!1,value:o}}r.arrayIndex=0}}r.keyIndex++}return zn})}function Al(t,e){if(!t)throw new Error("Root node must be an AstNode.");return new q1(t,n=>K1(n,e))}function Ra(t,e){if(!t)throw new Error("Root node must be an AstNode.");return new q1(t,n=>K1(n,e),{includeRoot:!0})}function $x(t,e){var n;if(!e)return!0;const r=(n=t.$cstNode)===null||n===void 0?void 0:n.range;return r?$U(r,e):!1}function oT(t){return new jt(()=>({keys:Object.keys(t),keyIndex:0,arrayIndex:0}),e=>{for(;e.keyIndex<e.keys.length;){const n=e.keys[e.keyIndex];if(!n.startsWith("$")){const r=t[n];if(Vr(r))return e.keyIndex++,{done:!1,value:{reference:r,container:t,property:n}};if(Array.isArray(r)){for(;e.arrayIndex<r.length;){const i=e.arrayIndex++,s=r[i];if(Vr(s))return{done:!1,value:{reference:s,container:t,property:n,index:i}}}e.arrayIndex=0}}e.keyIndex++}return zn})}function aG(t,e){const n=t.getTypeMetaData(e.$type),r=e;for(const i of n.properties)i.defaultValue!==void 0&&r[i.name]===void 0&&(r[i.name]=uT(i.defaultValue))}function uT(t){return Array.isArray(t)?[...t.map(uT)]:t}function De(t){return t.charCodeAt(0)}function e0(t,e){Array.isArray(t)?t.forEach(function(n){e.push(n)}):e.push(t)}function ko(t,e){if(t[e]===!0)throw"duplicate flag "+e;t[e],t[e]=!0}function ua(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function oG(){throw Error("Internal Error - Should never get here!")}function Bx(t){return t.type==="Character"}const df=[];for(let t=De("0");t<=De("9");t++)df.push(t);const pf=[De("_")].concat(df);for(let t=De("a");t<=De("z");t++)pf.push(t);for(let t=De("A");t<=De("Z");t++)pf.push(t);const Ux=[De(" "),De("\f"),De(`
`),De("\r"),De("	"),De("\v"),De("	"),De(""),De(""),De(""),De(""),De(""),De(""),De(""),De(""),De(""),De(""),De(""),De(""),De(""),De("\u2028"),De("\u2029"),De(""),De(""),De(""),De("\uFEFF")],uG=/[0-9a-fA-F]/,Ec=/[0-9]/,lG=/[1-9]/;class lT{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":ko(r,"global");break;case"i":ko(r,"ignoreCase");break;case"m":ko(r,"multiLine");break;case"u":ko(r,"unicode");break;case"y":ko(r,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:n,loc:this.loc(0)}}disjunction(){const e=[],n=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(n)}}alternative(){const e=[],n=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}ua(n);const r=this.disjunction();return this.consumeChar(")"),{type:n,value:r,loc:this.loc(e)}}return oG()}quantifier(e=!1){let n;const r=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:i,atMost:s}):n={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(e===!0&&n===void 0)return;ua(n);break}if(!(e===!0&&n===void 0)&&ua(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(r),n}atom(){let e;const n=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),ua(e))return e.loc=this.loc(n),this.isQuantifier()&&(e.quantifier=this.quantifier()),e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[De(`
`),De("\r"),De("\u2028"),De("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,n=!1;switch(this.popChar()){case"d":e=df;break;case"D":e=df,n=!0;break;case"s":e=Ux;break;case"S":e=Ux,n=!0;break;case"w":e=pf;break;case"W":e=pf,n=!0;break}if(ua(e))return{type:"Set",value:e,complement:n}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=De("\f");break;case"n":e=De(`
`);break;case"r":e=De("\r");break;case"t":e=De("	");break;case"v":e=De("\v");break}if(ua(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:De("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:De(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:De(e)}}}characterClass(){const e=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const r=this.classAtom();if(r.type,Bx(r)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,Bx(i)){if(i.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:i.value})}else e0(r.value,e),e.push(De("-")),e0(i.value,e)}else e0(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:n,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:De("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const n=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:e,value:n};return e&&(r.idx=this.groupIdx),r}positiveInteger(){let e=this.popChar();if(lG.test(e)===!1)throw Error("Expecting a positive integer");for(;Ec.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(Ec.test(e)===!1)throw Error("Expecting an integer");for(;Ec.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:De(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return Ec.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let n="";for(let i=0;i<e;i++){const s=this.popChar();if(uG.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class Cd{visitChildren(e){for(const n in e){const r=e[n];e.hasOwnProperty(n)&&(r.type!==void 0?this.visit(r):Array.isArray(r)&&r.forEach(i=>{this.visit(i)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}const cG=/\r?\n/gm,hG=new lT;class fG extends Cd{constructor(){super(...arguments),this.isStarting=!0,this.endRegexpStack=[],this.multiline=!1}get endRegex(){return this.endRegexpStack.join("")}reset(e){this.multiline=!1,this.regex=e,this.startRegexp="",this.isStarting=!0,this.endRegexpStack=[]}visitGroup(e){e.quantifier&&(this.isStarting=!1,this.endRegexpStack=[])}visitCharacter(e){const n=String.fromCharCode(e.value);if(!this.multiline&&n===`
`&&(this.multiline=!0),e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{const r=Ad(n);this.endRegexpStack.push(r),this.isStarting&&(this.startRegexp+=r)}}visitSet(e){if(!this.multiline){const n=this.regex.substring(e.loc.begin,e.loc.end),r=new RegExp(n);this.multiline=!!`
`.match(r)}if(e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{const n=this.regex.substring(e.loc.begin,e.loc.end);this.endRegexpStack.push(n),this.isStarting&&(this.startRegexp+=n)}}visitChildren(e){e.type==="Group"&&e.quantifier||super.visitChildren(e)}}const t0=new fG;function dG(t){try{return typeof t=="string"&&(t=new RegExp(t)),t=t.toString(),t0.reset(t),t0.visit(hG.pattern(t)),t0.multiline}catch{return!1}}const pG=`\f
\r	\v \u2028\u2029\uFEFF`.split("");function Ng(t){const e=typeof t=="string"?new RegExp(t):t;return pG.some(n=>e.test(n))}function Ad(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function gG(t){return Array.prototype.map.call(t,e=>/\w/.test(e)?`[${e.toLowerCase()}${e.toUpperCase()}]`:Ad(e)).join("")}function mG(t,e){const n=yG(t),r=e.match(n);return!!r&&r[0].length>0}function yG(t){typeof t=="string"&&(t=new RegExp(t));const e=t,n=t.source;let r=0;function i(){let s="",a;function o(l){s+=n.substr(r,l),r+=l}function u(l){s+="(?:"+n.substr(r,l)+"|$)",r+=l}for(;r<n.length;)switch(n[r]){case"\\":switch(n[r+1]){case"c":u(3);break;case"x":u(4);break;case"u":e.unicode?n[r+2]==="{"?u(n.indexOf("}",r)-r+1):u(6):u(2);break;case"p":case"P":e.unicode?u(n.indexOf("}",r)-r+1):u(2);break;case"k":u(n.indexOf(">",r)-r+1);break;default:u(2);break}break;case"[":a=/\[(?:\\.|.)*?\]/g,a.lastIndex=r,a=a.exec(n)||[],u(a[0].length);break;case"|":case"^":case"$":case"*":case"+":case"?":o(1);break;case"{":a=/\{\d+,?\d*\}/g,a.lastIndex=r,a=a.exec(n),a?o(a[0].length):u(1);break;case"(":if(n[r+1]==="?")switch(n[r+2]){case":":s+="(?:",r+=3,s+=i()+"|$)";break;case"=":s+="(?=",r+=3,s+=i()+")";break;case"!":a=r,r+=3,i(),s+=n.substr(a,r-a);break;case"<":switch(n[r+3]){case"=":case"!":a=r,r+=4,i(),s+=n.substr(a,r-a);break;default:o(n.indexOf(">",r)-r+1),s+=i()+"|$)";break}break}else o(1),s+=i()+"|$)";break;case")":return++r,s;default:u(1);break}return s}return new RegExp(i(),t.flags)}function vG(t){return t.rules.find(e=>hr(e)&&e.entry)}function bG(t){return t.rules.filter(e=>Ks(e)&&e.hidden)}function cT(t,e){const n=new Set,r=vG(t);if(!r)return new Set(t.rules);const i=[r].concat(bG(t));for(const a of i)hT(a,n,e);const s=new Set;for(const a of t.rules)(n.has(a.name)||Ks(a)&&a.hidden)&&s.add(a);return s}function hT(t,e,n){e.add(t.name),Al(t).forEach(r=>{if(Bs(r)||n){const i=r.rule.ref;i&&!e.has(i.name)&&hT(i,e,n)}})}function xG(t){if(t.terminal)return t.terminal;if(t.type.ref){const e=dT(t.type.ref);return e==null?void 0:e.terminal}}function EG(t){return t.hidden&&!Ng(ey(t))}function DG(t,e){return!t||!e?[]:J1(t,e,t.astNode,!0)}function fT(t,e,n){if(!t||!e)return;const r=J1(t,e,t.astNode,!0);if(r.length!==0)return n!==void 0?n=Math.max(0,Math.min(n,r.length-1)):n=0,r[n]}function J1(t,e,n,r){if(!r){const i=_d(t.grammarSource,Ps);if(i&&i.feature===e)return[t]}return rl(t)&&t.astNode===n?t.content.flatMap(i=>J1(i,e,n,!1)):[]}function wG(t,e,n){if(!t)return;const r=_G(t,e,t==null?void 0:t.astNode);if(r.length!==0)return n!==void 0?n=Math.max(0,Math.min(n,r.length-1)):n=0,r[n]}function _G(t,e,n){if(t.astNode!==n)return[];if($s(t.grammarSource)&&t.grammarSource.value===e)return[t];const r=Tg(t).iterator();let i;const s=[];do if(i=r.next(),!i.done){const a=i.value;a.astNode===n?$s(a.grammarSource)&&a.grammarSource.value===e&&s.push(a):r.prune()}while(!i.done);return s}function CG(t){var e;const n=t.astNode;for(;n===((e=t.container)===null||e===void 0?void 0:e.astNode);){const r=_d(t.grammarSource,Ps);if(r)return r;t=t.container}}function dT(t){let e=t;return tT(e)&&(wd(e.$container)?e=e.$container.$container:hr(e.$container)?e=e.$container:Cl(e.$container)),pT(t,e,new Map)}function pT(t,e,n){var r;function i(s,a){let o;return _d(s,Ps)||(o=pT(a,a,n)),n.set(t,o),o}if(n.has(t))return n.get(t);n.set(t,void 0);for(const s of Al(e)){if(Ps(s)&&s.feature.toLowerCase()==="name")return n.set(t,s),s;if(Bs(s)&&hr(s.rule.ref))return i(s,s.rule.ref);if(jU(s)&&(!((r=s.typeRef)===null||r===void 0)&&r.ref))return i(s,s.typeRef.ref)}}function gT(t){return mT(t,new Set)}function mT(t,e){if(e.has(t))return!0;e.add(t);for(const n of Al(t))if(Bs(n)){if(!n.rule.ref||hr(n.rule.ref)&&!mT(n.rule.ref,e))return!1}else{if(Ps(n))return!1;if(wd(n))return!1}return!!t.definition}function Z1(t){if(t.inferredType)return t.inferredType.name;if(t.dataType)return t.dataType;if(t.returnType){const e=t.returnType.ref;if(e){if(hr(e))return e.name;if(nT(e)||rT(e))return e.name}}}function Q1(t){var e;if(hr(t))return gT(t)?t.name:(e=Z1(t))!==null&&e!==void 0?e:t.name;if(nT(t)||rT(t)||XU(t))return t.name;if(wd(t)){const n=AG(t);if(n)return n}else if(tT(t))return t.name;throw new Error("Cannot get name of Unknown Type")}function AG(t){var e;if(t.inferredType)return t.inferredType.name;if(!((e=t.type)===null||e===void 0)&&e.ref)return Q1(t.type.ref)}function TG(t){var e,n,r;return Ks(t)?(n=(e=t.type)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:"string":(r=Z1(t))!==null&&r!==void 0?r:t.name}function ey(t){const e={s:!1,i:!1,u:!1},n=so(t.definition,e),r=Object.entries(e).filter(([,i])=>i).map(([i])=>i).join("");return new RegExp(n,r)}const ty=/[\s\S]/.source;function so(t,e){if(eG(t))return kG(t);if(tG(t))return SG(t);if(KU(t))return RG(t);if(nG(t)){const n=t.rule.ref;if(!n)throw new Error("Missing rule reference.");return bi(so(n.definition),{cardinality:t.cardinality,lookahead:t.lookahead})}else{if(ZU(t))return FG(t);if(rG(t))return NG(t);if(QU(t)){const n=t.regex.lastIndexOf("/"),r=t.regex.substring(1,n),i=t.regex.substring(n+1);return e&&(e.i=i.includes("i"),e.s=i.includes("s"),e.u=i.includes("u")),bi(r,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}else{if(iG(t))return bi(ty,{cardinality:t.cardinality,lookahead:t.lookahead});throw new Error(`Invalid terminal element: ${t==null?void 0:t.$type}`)}}}function kG(t){return bi(t.elements.map(e=>so(e)).join("|"),{cardinality:t.cardinality,lookahead:t.lookahead})}function SG(t){return bi(t.elements.map(e=>so(e)).join(""),{cardinality:t.cardinality,lookahead:t.lookahead})}function NG(t){return bi(`${ty}*?${so(t.terminal)}`,{cardinality:t.cardinality,lookahead:t.lookahead})}function FG(t){return bi(`(?!${so(t.terminal)})${ty}*?`,{cardinality:t.cardinality,lookahead:t.lookahead})}function RG(t){return t.right?bi(`[${n0(t.left)}-${n0(t.right)}]`,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1}):bi(n0(t.left),{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}function n0(t){return Ad(t.value)}function bi(t,e){var n;return(e.wrap!==!1||e.lookahead)&&(t=`(${(n=e.lookahead)!==null&&n!==void 0?n:""}${t})`),e.cardinality?`${t}${e.cardinality}`:t}function MG(t){const e=[],n=t.Grammar;for(const r of n.rules)Ks(r)&&EG(r)&&dG(ey(r))&&e.push(r.name);return{multilineCommentRules:e,nameRegexp:BU}}function Fg(t){console&&console.error&&console.error(`Error: ${t}`)}function yT(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function vT(t){const e=new Date().getTime(),n=t();return{time:new Date().getTime()-e,value:n}}function bT(t){function e(){}e.prototype=t;const n=new e;function r(){return typeof n.bar}return r(),r(),t}function OG(t){return IG(t)?t.LABEL:t.name}function IG(t){return Kn(t.LABEL)&&t.LABEL!==""}class ri{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),U(this.definition,n=>{n.accept(e)})}}class Dn extends ri{constructor(e){super([]),this.idx=1,jn(this,Tr(e,n=>n!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class ao extends ri{constructor(e){super(e.definition),this.orgText="",jn(this,Tr(e,n=>n!==void 0))}}class Fn extends ri{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,jn(this,Tr(e,n=>n!==void 0))}}class tn extends ri{constructor(e){super(e.definition),this.idx=1,jn(this,Tr(e,n=>n!==void 0))}}class er extends ri{constructor(e){super(e.definition),this.idx=1,jn(this,Tr(e,n=>n!==void 0))}}class tr extends ri{constructor(e){super(e.definition),this.idx=1,jn(this,Tr(e,n=>n!==void 0))}}class gt extends ri{constructor(e){super(e.definition),this.idx=1,jn(this,Tr(e,n=>n!==void 0))}}class Mn extends ri{constructor(e){super(e.definition),this.idx=1,jn(this,Tr(e,n=>n!==void 0))}}class On extends ri{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,jn(this,Tr(e,n=>n!==void 0))}}class st{constructor(e){this.idx=1,jn(this,Tr(e,n=>n!==void 0))}accept(e){e.visit(this)}}function LG(t){return ne(t,ih)}function ih(t){function e(n){return ne(n,ih)}if(t instanceof Dn){const n={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return Kn(t.label)&&(n.label=t.label),n}else{if(t instanceof Fn)return{type:"Alternative",definition:e(t.definition)};if(t instanceof tn)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof er)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof tr)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:ih(new st({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Mn)return{type:"RepetitionWithSeparator",idx:t.idx,separator:ih(new st({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof gt)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof On)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof st){const n={type:"Terminal",name:t.terminalType.name,label:OG(t.terminalType),idx:t.idx};Kn(t.label)&&(n.terminalLabel=t.label);const r=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=Di(r)?r.source:r),n}else{if(t instanceof ao)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}class oo{visit(e){const n=e;switch(n.constructor){case Dn:return this.visitNonTerminal(n);case Fn:return this.visitAlternative(n);case tn:return this.visitOption(n);case er:return this.visitRepetitionMandatory(n);case tr:return this.visitRepetitionMandatoryWithSeparator(n);case Mn:return this.visitRepetitionWithSeparator(n);case gt:return this.visitRepetition(n);case On:return this.visitAlternation(n);case st:return this.visitTerminal(n);case ao:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function PG(t){return t instanceof Fn||t instanceof tn||t instanceof gt||t instanceof er||t instanceof tr||t instanceof Mn||t instanceof st||t instanceof ao}function gf(t,e=[]){return t instanceof tn||t instanceof gt||t instanceof Mn?!0:t instanceof On?HD(t.definition,r=>gf(r,e)):t instanceof Dn&&_n(e,t)?!1:t instanceof ri?(t instanceof Dn&&e.push(t),Dr(t.definition,r=>gf(r,e))):!1}function $G(t){return t instanceof On}function Gr(t){if(t instanceof Dn)return"SUBRULE";if(t instanceof tn)return"OPTION";if(t instanceof On)return"OR";if(t instanceof er)return"AT_LEAST_ONE";if(t instanceof tr)return"AT_LEAST_ONE_SEP";if(t instanceof Mn)return"MANY_SEP";if(t instanceof gt)return"MANY";if(t instanceof st)return"CONSUME";throw Error("non exhaustive match")}class Td{walk(e,n=[]){U(e.definition,(r,i)=>{const s=Vt(e.definition,i+1);if(r instanceof Dn)this.walkProdRef(r,s,n);else if(r instanceof st)this.walkTerminal(r,s,n);else if(r instanceof Fn)this.walkFlat(r,s,n);else if(r instanceof tn)this.walkOption(r,s,n);else if(r instanceof er)this.walkAtLeastOne(r,s,n);else if(r instanceof tr)this.walkAtLeastOneSep(r,s,n);else if(r instanceof Mn)this.walkManySep(r,s,n);else if(r instanceof gt)this.walkMany(r,s,n);else if(r instanceof On)this.walkOr(r,s,n);else throw Error("non exhaustive match")})}walkTerminal(e,n,r){}walkProdRef(e,n,r){}walkFlat(e,n,r){const i=n.concat(r);this.walk(e,i)}walkOption(e,n,r){const i=n.concat(r);this.walk(e,i)}walkAtLeastOne(e,n,r){const i=[new tn({definition:e.definition})].concat(n,r);this.walk(e,i)}walkAtLeastOneSep(e,n,r){const i=Gx(e,n,r);this.walk(e,i)}walkMany(e,n,r){const i=[new tn({definition:e.definition})].concat(n,r);this.walk(e,i)}walkManySep(e,n,r){const i=Gx(e,n,r);this.walk(e,i)}walkOr(e,n,r){const i=n.concat(r);U(e.definition,s=>{const a=new Fn({definition:[s]});this.walk(a,i)})}}function Gx(t,e,n){return[new tn({definition:[new st({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}function Tl(t){if(t instanceof Dn)return Tl(t.referencedRule);if(t instanceof st)return GG(t);if(PG(t))return BG(t);if($G(t))return UG(t);throw Error("non exhaustive match")}function BG(t){let e=[];const n=t.definition;let r=0,i=n.length>r,s,a=!0;for(;i&&a;)s=n[r],a=gf(s),e=e.concat(Tl(s)),r=r+1,i=n.length>r;return dm(e)}function UG(t){const e=ne(t.definition,n=>Tl(n));return dm(Qt(e))}function GG(t){return[t.terminalType]}const xT="_~IN~_";class zG extends Td{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,n,r){}walkProdRef(e,n,r){const i=HG(e.referencedRule,e.idx)+this.topProd.name,s=n.concat(r),a=new Fn({definition:s}),o=Tl(a);this.follows[i]=o}}function WG(t){const e={};return U(t,n=>{const r=new zG(n).startWalking();jn(e,r)}),e}function HG(t,e){return t.name+e+xT}let sh={};const YG=new lT;function kd(t){const e=t.toString();if(sh.hasOwnProperty(e))return sh[e];{const n=YG.pattern(e);return sh[e]=n,n}}function VG(){sh={}}const ET="Complement Sets are not supported for first char optimization",mf=`Unable to use "first char" lexer optimizations:
`;function qG(t,e=!1){try{const n=kd(t);return Rg(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===ET)e&&yT(`${mf}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";e&&(r=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Fg(`${mf}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}function Rg(t,e,n){switch(t.type){case"Disjunction":for(let i=0;i<t.value.length;i++)Rg(t.value[i],e,n);break;case"Alternative":const r=t.value;for(let i=0;i<r.length;i++){const s=r[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":Dc(a.value,e,n);break;case"Set":if(a.complement===!0)throw Error(ET);U(a.value,u=>{if(typeof u=="number")Dc(u,e,n);else{const l=u;if(n===!0)for(let c=l.from;c<=l.to;c++)Dc(c,e,n);else{for(let c=l.from;c<=l.to&&c<Du;c++)Dc(c,e,n);if(l.to>=Du){const c=l.from>=Du?l.from:Du,h=l.to,d=ji(c),f=ji(h);for(let p=d;p<=f;p++)e[p]=p}}}});break;case"Group":Rg(a.value,e,n);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&Mg(a)===!1||a.type!=="Group"&&o===!1)break}break;default:throw Error("non exhaustive match!")}return Qe(e)}function Dc(t,e,n){const r=ji(t);e[r]=r,n===!0&&XG(t,e)}function XG(t,e){const n=String.fromCharCode(t),r=n.toUpperCase();if(r!==n){const i=ji(r.charCodeAt(0));e[i]=i}else{const i=n.toLowerCase();if(i!==n){const s=ji(i.charCodeAt(0));e[s]=s}}}function zx(t,e){return Ei(t.value,n=>{if(typeof n=="number")return _n(e,n);{const r=n;return Ei(e,i=>r.from<=i&&i<=r.to)!==void 0}})}function Mg(t){const e=t.quantifier;return e&&e.atLeast===0?!0:t.value?qn(t.value)?Dr(t.value,Mg):Mg(t.value):!1}class jG extends Cd{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){_n(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?zx(e,this.targetCharCodes)===void 0&&(this.found=!0):zx(e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function ny(t,e){if(e instanceof RegExp){const n=kd(e),r=new jG(t);return r.visit(n),r.found}else return Ei(e,n=>_n(t,n.charCodeAt(0)))!==void 0}const Us="PATTERN",Eu="defaultMode",wc="modes";let DT=typeof new RegExp("(?:)").sticky=="boolean";function KG(t,e){e=Lf(e,{useSticky:DT,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(b,v)=>v()});const n=e.tracer;n("initCharCodeToOptimizedIndexMap",()=>{bz()});let r;n("Reject Lexer.NA",()=>{r=Pf(t,b=>b[Us]===Sn.NA)});let i=!1,s;n("Transform Patterns",()=>{i=!1,s=ne(r,b=>{const v=b[Us];if(Di(v)){const E=v.source;return E.length===1&&E!=="^"&&E!=="$"&&E!=="."&&!v.ignoreCase?E:E.length===2&&E[0]==="\\"&&!_n(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],E[1])?E[1]:e.useSticky?Hx(v):Wx(v)}else{if(xi(v))return i=!0,{exec:v};if(typeof v=="object")return i=!0,v;if(typeof v=="string"){if(v.length===1)return v;{const E=v.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),w=new RegExp(E);return e.useSticky?Hx(w):Wx(w)}}else throw Error("non exhaustive match")}})});let a,o,u,l,c;n("misc mapping",()=>{a=ne(r,b=>b.tokenTypeIdx),o=ne(r,b=>{const v=b.GROUP;if(v!==Sn.SKIPPED){if(Kn(v))return v;if(Ye(v))return!1;throw Error("non exhaustive match")}}),u=ne(r,b=>{const v=b.LONGER_ALT;if(v)return qn(v)?ne(v,w=>my(r,w)):[my(r,v)]}),l=ne(r,b=>b.PUSH_MODE),c=ne(r,b=>ye(b,"POP_MODE"))});let h;n("Line Terminator Handling",()=>{const b=CT(e.lineTerminatorCharacters);h=ne(r,v=>!1),e.positionTracking!=="onlyOffset"&&(h=ne(r,v=>ye(v,"LINE_BREAKS")?!!v.LINE_BREAKS:_T(v,b)===!1&&ny(b,v.PATTERN)))});let d,f,p,g;n("Misc Mapping #2",()=>{d=ne(r,wT),f=ne(s,mz),p=Ct(r,(b,v)=>{const E=v.GROUP;return Kn(E)&&E!==Sn.SKIPPED&&(b[E]=[]),b},{}),g=ne(s,(b,v)=>({pattern:s[v],longerAlt:u[v],canLineTerminator:h[v],isCustom:d[v],short:f[v],group:o[v],push:l[v],pop:c[v],tokenTypeIdx:a[v],tokenType:r[v]}))});let m=!0,y=[];return e.safeMode||n("First Char Optimization",()=>{y=Ct(r,(b,v,E)=>{if(typeof v.PATTERN=="string"){const w=v.PATTERN.charCodeAt(0),N=ji(w);r0(b,N,g[E])}else if(qn(v.START_CHARS_HINT)){let w;U(v.START_CHARS_HINT,N=>{const D=typeof N=="string"?N.charCodeAt(0):N,k=ji(D);w!==k&&(w=k,r0(b,k,g[E]))})}else if(Di(v.PATTERN))if(v.PATTERN.unicode)m=!1,e.ensureOptimizations&&Fg(`${mf}	Unable to analyze < ${v.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const w=qG(v.PATTERN,e.ensureOptimizations);Xe(w)&&(m=!1),U(w,N=>{r0(b,N,g[E])})}else e.ensureOptimizations&&Fg(`${mf}	TokenType: <${v.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),m=!1;return b},[])}),{emptyGroups:p,patternIdxToConfig:g,charCodeToPatternIdxToConfig:y,hasCustom:i,canBeOptimized:m}}function JG(t,e){let n=[];const r=QG(t);n=n.concat(r.errors);const i=ez(r.valid),s=i.valid;return n=n.concat(i.errors),n=n.concat(ZG(s)),n=n.concat(uz(s)),n=n.concat(lz(s,e)),n=n.concat(cz(s)),n}function ZG(t){let e=[];const n=yt(t,r=>Di(r[Us]));return e=e.concat(nz(n)),e=e.concat(sz(n)),e=e.concat(az(n)),e=e.concat(oz(n)),e=e.concat(rz(n)),e}function QG(t){const e=yt(t,i=>!ye(i,Us)),n=ne(e,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:mt.MISSING_PATTERN,tokenTypes:[i]})),r=$f(t,e);return{errors:n,valid:r}}function ez(t){const e=yt(t,i=>{const s=i[Us];return!Di(s)&&!xi(s)&&!ye(s,"exec")&&!Kn(s)}),n=ne(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:mt.INVALID_PATTERN,tokenTypes:[i]})),r=$f(t,e);return{errors:n,valid:r}}const tz=/[^\\][$]/;function nz(t){class e extends Cd{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=yt(t,i=>{const s=i.PATTERN;try{const a=kd(s),o=new e;return o.visit(a),o.found}catch{return tz.test(s.source)}});return ne(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:mt.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function rz(t){const e=yt(t,r=>r.PATTERN.test(""));return ne(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:mt.EMPTY_MATCH_PATTERN,tokenTypes:[r]}))}const iz=/[^\\[][\^]|^\^/;function sz(t){class e extends Cd{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=yt(t,i=>{const s=i.PATTERN;try{const a=kd(s),o=new e;return o.visit(a),o.found}catch{return iz.test(s.source)}});return ne(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:mt.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function az(t){const e=yt(t,r=>{const i=r[Us];return i instanceof RegExp&&(i.multiline||i.global)});return ne(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:mt.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}))}function oz(t){const e=[];let n=ne(t,s=>Ct(t,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!_n(e,o)&&o.PATTERN!==Sn.NA&&(e.push(o),a.push(o)),a),[]));n=ol(n);const r=yt(n,s=>s.length>1);return ne(r,s=>{const a=ne(s,u=>u.name);return{message:`The same RegExp pattern ->${_r(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:mt.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function uz(t){const e=yt(t,r=>{if(!ye(r,"GROUP"))return!1;const i=r.GROUP;return i!==Sn.SKIPPED&&i!==Sn.NA&&!Kn(i)});return ne(e,r=>({message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:mt.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}))}function lz(t,e){const n=yt(t,i=>i.PUSH_MODE!==void 0&&!_n(e,i.PUSH_MODE));return ne(n,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:mt.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function cz(t){const e=[],n=Ct(t,(r,i,s)=>{const a=i.PATTERN;return a===Sn.NA||(Kn(a)?r.push({str:a,idx:s,tokenType:i}):Di(a)&&fz(a)&&r.push({str:a.source,idx:s,tokenType:i})),r},[]);return U(t,(r,i)=>{U(n,({str:s,idx:a,tokenType:o})=>{if(i<a&&hz(s,r.PATTERN)){const u=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${r.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:mt.UNREACHABLE_PATTERN,tokenTypes:[r,o]})}})}),e}function hz(t,e){if(Di(e)){const n=e.exec(t);return n!==null&&n.index===0}else{if(xi(e))return e(t,0,[],{});if(ye(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function fz(t){return Ei([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>t.source.indexOf(n)!==-1)===void 0}function Wx(t){const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function Hx(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function dz(t,e,n){const r=[];return ye(t,Eu)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Eu+`> property in its definition
`,type:mt.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),ye(t,wc)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+wc+`> property in its definition
`,type:mt.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),ye(t,wc)&&ye(t,Eu)&&!ye(t.modes,t.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${Eu}: <${t.defaultMode}>which does not exist
`,type:mt.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),ye(t,wc)&&U(t.modes,(i,s)=>{U(i,(a,o)=>{if(Ye(a))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:mt.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(ye(a,"LONGER_ALT")){const u=qn(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];U(u,l=>{!Ye(l)&&!_n(i,l)&&r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${l.name}> on token <${a.name}> outside of mode <${s}>
`,type:mt.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),r}function pz(t,e,n){const r=[];let i=!1;const s=ol(Qt(Qe(t.modes))),a=Pf(s,u=>u[Us]===Sn.NA),o=CT(n);return e&&U(a,u=>{const l=_T(u,o);if(l!==!1){const h={message:vz(u,l),type:l.issue,tokenType:u};r.push(h)}else ye(u,"LINE_BREAKS")?u.LINE_BREAKS===!0&&(i=!0):ny(o,u.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:mt.NO_LINE_BREAKS_FLAGS}),r}function gz(t){const e={},n=gr(t);return U(n,r=>{const i=t[r];if(qn(i))e[r]=[];else throw Error("non exhaustive match")}),e}function wT(t){const e=t.PATTERN;if(Di(e))return!1;if(xi(e))return!0;if(ye(e,"exec"))return!0;if(Kn(e))return!1;throw Error("non exhaustive match")}function mz(t){return Kn(t)&&t.length===1?t.charCodeAt(0):!1}const yz={test:function(t){const e=t.length;for(let n=this.lastIndex;n<e;n++){const r=t.charCodeAt(n);if(r===10)return this.lastIndex=n+1,!0;if(r===13)return t.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function _T(t,e){if(ye(t,"LINE_BREAKS"))return!1;if(Di(t.PATTERN)){try{ny(e,t.PATTERN)}catch(n){return{issue:mt.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(Kn(t.PATTERN))return!1;if(wT(t))return{issue:mt.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function vz(t,e){if(e.issue===mt.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===mt.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function CT(t){return ne(t,n=>Kn(n)?n.charCodeAt(0):n)}function r0(t,e,n){t[e]===void 0?t[e]=[n]:t[e].push(n)}const Du=256;let ah=[];function ji(t){return t<Du?t:ah[t]}function bz(){if(Xe(ah)){ah=new Array(65536);for(let t=0;t<65536;t++)ah[t]=t>255?255+~~(t/255):t}}function kl(t,e){const n=t.tokenTypeIdx;return n===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[n]===!0}function yf(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let Yx=1;const AT={};function Sl(t){const e=xz(t);Ez(e),wz(e),Dz(e),U(e,n=>{n.isParent=n.categoryMatches.length>0})}function xz(t){let e=Ut(t),n=t,r=!0;for(;r;){n=ol(Qt(ne(n,s=>s.CATEGORIES)));const i=$f(n,e);e=e.concat(i),Xe(i)?r=!1:n=i}return e}function Ez(t){U(t,e=>{kT(e)||(AT[Yx]=e,e.tokenTypeIdx=Yx++),Vx(e)&&!qn(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),Vx(e)||(e.CATEGORIES=[]),_z(e)||(e.categoryMatches=[]),Cz(e)||(e.categoryMatchesMap={})})}function Dz(t){U(t,e=>{e.categoryMatches=[],U(e.categoryMatchesMap,(n,r)=>{e.categoryMatches.push(AT[r].tokenTypeIdx)})})}function wz(t){U(t,e=>{TT([],e)})}function TT(t,e){U(t,n=>{e.categoryMatchesMap[n.tokenTypeIdx]=!0}),U(e.CATEGORIES,n=>{const r=t.concat(e);_n(r,n)||TT(r,n)})}function kT(t){return ye(t,"tokenTypeIdx")}function Vx(t){return ye(t,"CATEGORIES")}function _z(t){return ye(t,"categoryMatches")}function Cz(t){return ye(t,"categoryMatchesMap")}function Az(t){return ye(t,"tokenTypeIdx")}const Og={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,n,r,i){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${n} characters.`}};var mt;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(mt||(mt={}));const wu={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Og,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(wu);class Sn{constructor(e,n=wu){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${i}>`);const{time:o,value:u}=vT(s),l=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(`${a}<-- <${i}> time: ${o}ms`),this.traceInitIndent--,u}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=jn({},wu,n);const r=this.config.traceInitPerf;r===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof r=="number"&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===wu.lineTerminatorsPattern)this.config.lineTerminatorsPattern=yz;else if(this.config.lineTerminatorCharacters===wu.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),qn(e)?i={modes:{defaultMode:Ut(e)},defaultMode:Eu}:(s=!1,i=Ut(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(dz(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(pz(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},U(i.modes,(o,u)=>{i.modes[u]=Pf(o,l=>Ye(l))});const a=gr(i.modes);if(U(i.modes,(o,u)=>{this.TRACE_INIT(`Mode: <${u}> processing`,()=>{if(this.modes.push(u),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(JG(o,a))}),Xe(this.lexerDefinitionErrors)){Sl(o);let l;this.TRACE_INIT("analyzeTokenTypes",()=>{l=KG(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[u]=l.patternIdxToConfig,this.charCodeToPatternIdxToConfig[u]=l.charCodeToPatternIdxToConfig,this.emptyGroups=jn({},this.emptyGroups,l.emptyGroups),this.hasCustom=l.hasCustom||this.hasCustom,this.canModeBeOptimized[u]=l.canBeOptimized}})}),this.defaultMode=i.defaultMode,!Xe(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const u=ne(this.lexerDefinitionErrors,l=>l.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}U(this.lexerDefinitionWarning,o=>{yT(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(DT?(this.chopInput=yy,this.match=this.matchWithTest):(this.updateLastIndex=Lt,this.match=this.matchWithExec),s&&(this.handleModes=Lt),this.trackStartLines===!1&&(this.computeNewColumn=yy),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=Lt),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const o=Ct(this.canModeBeOptimized,(u,l,c)=>(l===!1&&u.push(c),u),[]);if(n.ensureOptimizations&&!Xe(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{VG()}),this.TRACE_INIT("toFastProperties",()=>{bT(this)})})}tokenize(e,n=this.defaultMode){if(!Xe(this.lexerDefinitionErrors)){const i=ne(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(e,n)}tokenizeInternal(e,n){let r,i,s,a,o,u,l,c,h,d,f,p,g,m,y;const b=e,v=b.length;let E=0,w=0;const N=this.hasCustom?0:Math.floor(e.length/10),D=new Array(N),k=[];let F=this.trackStartLines?1:void 0,M=this.trackStartLines?1:void 0;const S=gz(this.emptyGroups),R=this.trackStartLines,I=this.config.lineTerminatorsPattern;let x=0,_=[],C=[];const A=[],T=[];Object.freeze(T);let O;function L(){return _}function P(q){const Z=ji(q),J=C[Z];return J===void 0?T:J}const Y=q=>{if(A.length===1&&q.tokenType.PUSH_MODE===void 0){const Z=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(q);k.push({offset:q.startOffset,line:q.startLine,column:q.startColumn,length:q.image.length,message:Z})}else{A.pop();const Z=jr(A);_=this.patternIdxToConfig[Z],C=this.charCodeToPatternIdxToConfig[Z],x=_.length;const J=this.canModeBeOptimized[Z]&&this.config.safeMode===!1;C&&J?O=P:O=L}};function W(q){A.push(q),C=this.charCodeToPatternIdxToConfig[q],_=this.patternIdxToConfig[q],x=_.length,x=_.length;const Z=this.canModeBeOptimized[q]&&this.config.safeMode===!1;C&&Z?O=P:O=L}W.call(this,n);let X;const V=this.config.recoveryEnabled;for(;E<v;){u=null;const q=b.charCodeAt(E),Z=O(q),J=Z.length;for(r=0;r<J;r++){X=Z[r];const B=X.pattern;l=null;const H=X.short;if(H!==!1?q===H&&(u=B):X.isCustom===!0?(y=B.exec(b,E,D,S),y!==null?(u=y[0],y.payload!==void 0&&(l=y.payload)):u=null):(this.updateLastIndex(B,E),u=this.match(B,e,E)),u!==null){if(o=X.longerAlt,o!==void 0){const j=o.length;for(s=0;s<j;s++){const G=_[o[s]],re=G.pattern;if(c=null,G.isCustom===!0?(y=re.exec(b,E,D,S),y!==null?(a=y[0],y.payload!==void 0&&(c=y.payload)):a=null):(this.updateLastIndex(re,E),a=this.match(re,e,E)),a&&a.length>u.length){u=a,l=c,X=G;break}}}break}}if(u!==null){if(h=u.length,d=X.group,d!==void 0&&(f=X.tokenTypeIdx,p=this.createTokenInstance(u,E,f,X.tokenType,F,M,h),this.handlePayload(p,l),d===!1?w=this.addToken(D,w,p):S[d].push(p)),e=this.chopInput(e,h),E=E+h,M=this.computeNewColumn(M,h),R===!0&&X.canLineTerminator===!0){let B=0,H,j;I.lastIndex=0;do H=I.test(u),H===!0&&(j=I.lastIndex-1,B++);while(H===!0);B!==0&&(F=F+B,M=h-j,this.updateTokenEndLineColumnLocation(p,d,j,B,F,M,h))}this.handleModes(X,Y,W,p)}else{const B=E,H=F,j=M;let G=V===!1;for(;G===!1&&E<v;)for(e=this.chopInput(e,1),E++,i=0;i<x;i++){const re=_[i],K=re.pattern,_e=re.short;if(_e!==!1?b.charCodeAt(E)===_e&&(G=!0):re.isCustom===!0?G=K.exec(b,E,D,S)!==null:(this.updateLastIndex(K,E),G=K.exec(e)!==null),G===!0)break}if(g=E-B,M=this.computeNewColumn(M,g),m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(b,B,g,H,j),k.push({offset:B,line:H,column:j,length:g,message:m}),V===!1)break}}return this.hasCustom||(D.length=w),{tokens:D,groups:S,errors:k}}handleModes(e,n,r,i){if(e.pop===!0){const s=e.push;n(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)}chopInput(e,n){return e.substring(n)}updateLastIndex(e,n){e.lastIndex=n}updateTokenEndLineColumnLocation(e,n,r,i,s,a,o){let u,l;n!==void 0&&(u=r===o-1,l=u?-1:0,i===1&&u===!0||(e.endLine=s+l,e.endColumn=a-1+-l))}computeNewColumn(e,n){return e+n}createOffsetOnlyToken(e,n,r,i){return{image:e,startOffset:n,tokenTypeIdx:r,tokenType:i}}createStartOnlyToken(e,n,r,i,s,a){return{image:e,startOffset:n,startLine:s,startColumn:a,tokenTypeIdx:r,tokenType:i}}createFullToken(e,n,r,i,s,a,o){return{image:e,startOffset:n,endOffset:n+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+o-1,tokenTypeIdx:r,tokenType:i}}addTokenUsingPush(e,n,r){return e.push(r),n}addTokenUsingMemberAccess(e,n,r){return e[n]=r,n++,n}handlePayloadNoCustom(e,n){}handlePayloadWithCustom(e,n){n!==null&&(e.payload=n)}matchWithTest(e,n,r){return e.test(n)===!0?n.substring(r,e.lastIndex):null}matchWithExec(e,n){const r=e.exec(n);return r!==null?r[0]:null}}Sn.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Sn.NA=/NOT_APPLICABLE/;function Ma(t){return ST(t)?t.LABEL:t.name}function ST(t){return Kn(t.LABEL)&&t.LABEL!==""}const Tz="parent",qx="categories",Xx="label",jx="group",Kx="push_mode",Jx="pop_mode",Zx="longer_alt",Qx="line_breaks",eE="start_chars_hint";function NT(t){return kz(t)}function kz(t){const e=t.pattern,n={};if(n.name=t.name,Ye(e)||(n.PATTERN=e),ye(t,Tz))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return ye(t,qx)&&(n.CATEGORIES=t[qx]),Sl([n]),ye(t,Xx)&&(n.LABEL=t[Xx]),ye(t,jx)&&(n.GROUP=t[jx]),ye(t,Jx)&&(n.POP_MODE=t[Jx]),ye(t,Kx)&&(n.PUSH_MODE=t[Kx]),ye(t,Zx)&&(n.LONGER_ALT=t[Zx]),ye(t,Qx)&&(n.LINE_BREAKS=t[Qx]),ye(t,eE)&&(n.START_CHARS_HINT=t[eE]),n}const Ki=NT({name:"EOF",pattern:Sn.NA});Sl([Ki]);function ry(t,e,n,r,i,s,a,o){return{image:e,startOffset:n,endOffset:r,startLine:i,endLine:s,startColumn:a,endColumn:o,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function FT(t,e){return kl(t,e)}const va={buildMismatchTokenMessage({expected:t,actual:e,previous:n,ruleName:r}){return`Expecting ${ST(t)?`--> ${Ma(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:n,customUserDescription:r,ruleName:i}){const s="Expecting: ",o=`
but found: '`+_r(e).image+"'";if(r)return s+r+o;{const u=Ct(t,(d,f)=>d.concat(f),[]),l=ne(u,d=>`[${ne(d,f=>Ma(f)).join(", ")}]`),h=`one of these possible Token sequences:
${ne(l,(d,f)=>`  ${f+1}. ${d}`).join(`
`)}`;return s+h+o}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:n,ruleName:r}){const i="Expecting: ",a=`
but found: '`+_r(e).image+"'";if(n)return i+n+a;{const u=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${ne(t,l=>`[${ne(l,c=>Ma(c)).join(",")}]`).join(" ,")}>`;return i+u+a}}};Object.freeze(va);const Sz={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},Ds={buildDuplicateFoundError(t,e){function n(c){return c instanceof st?c.terminalType.name:c instanceof Dn?c.nonTerminalName:""}const r=t.name,i=_r(e),s=i.idx,a=Gr(i),o=n(i),u=s>0;let l=`->${a}${u?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){const e=ne(t.prefixPath,i=>Ma(i)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){const e=ne(t.prefixPath,i=>Ma(i)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError(t){let e=Gr(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){const e=t.topLevelRule.name,n=ne(t.leftRecursionPath,s=>s.name),r=`${e} --> ${n.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${r}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof ao?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function Nz(t,e){const n=new Fz(t,e);return n.resolveRefs(),n.errors}class Fz extends oo{constructor(e,n){super(),this.nameToTopRule=e,this.errMsgProvider=n,this.errors=[]}resolveRefs(){U(Qe(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const n=this.nameToTopRule[e.nonTerminalName];if(n)e.referencedRule=n;else{const r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:wn.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class Rz extends Td{constructor(e,n){super(),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Ut(this.path.ruleStack).reverse(),this.occurrenceStack=Ut(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,n=[]){this.found||super.walk(e,n)}walkProdRef(e,n,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const i=n.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,i)}}updateExpectedNext(){Xe(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class Mz extends Rz{constructor(e,n){super(e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,n,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const i=n.concat(r),s=new Fn({definition:i});this.possibleTokTypes=Tl(s),this.found=!0}}}class Sd extends Td{constructor(e,n){super(),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class Oz extends Sd{walkMany(e,n,r){if(e.idx===this.occurrence){const i=_r(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof st&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(e,n,r)}}class tE extends Sd{walkManySep(e,n,r){if(e.idx===this.occurrence){const i=_r(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof st&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(e,n,r)}}class Iz extends Sd{walkAtLeastOne(e,n,r){if(e.idx===this.occurrence){const i=_r(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof st&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(e,n,r)}}class nE extends Sd{walkAtLeastOneSep(e,n,r){if(e.idx===this.occurrence){const i=_r(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof st&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(e,n,r)}}function Ig(t,e,n=[]){n=Ut(n);let r=[],i=0;function s(o){return o.concat(Vt(t,i+1))}function a(o){const u=Ig(s(o),e,n);return r.concat(u)}for(;n.length<e&&i<t.length;){const o=t[i];if(o instanceof Fn)return a(o.definition);if(o instanceof Dn)return a(o.definition);if(o instanceof tn)r=a(o.definition);else if(o instanceof er){const u=o.definition.concat([new gt({definition:o.definition})]);return a(u)}else if(o instanceof tr){const u=[new Fn({definition:o.definition}),new gt({definition:[new st({terminalType:o.separator})].concat(o.definition)})];return a(u)}else if(o instanceof Mn){const u=o.definition.concat([new gt({definition:[new st({terminalType:o.separator})].concat(o.definition)})]);r=a(u)}else if(o instanceof gt){const u=o.definition.concat([new gt({definition:o.definition})]);r=a(u)}else{if(o instanceof On)return U(o.definition,u=>{Xe(u.definition)===!1&&(r=a(u.definition))}),r;if(o instanceof st)n.push(o.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:n,suffixDef:Vt(t,i)}),r}function RT(t,e,n,r){const i="EXIT_NONE_TERMINAL",s=[i],a="EXIT_ALTERNATIVE";let o=!1;const u=e.length,l=u-r-1,c=[],h=[];for(h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Xe(h);){const d=h.pop();if(d===a){o&&jr(h).idx<=l&&h.pop();continue}const f=d.def,p=d.idx,g=d.ruleStack,m=d.occurrenceStack;if(Xe(f))continue;const y=f[0];if(y===i){const b={idx:p,def:Vt(f),ruleStack:Lu(g),occurrenceStack:Lu(m)};h.push(b)}else if(y instanceof st)if(p<u-1){const b=p+1,v=e[b];if(n(v,y.terminalType)){const E={idx:b,def:Vt(f),ruleStack:g,occurrenceStack:m};h.push(E)}}else if(p===u-1)c.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:g,occurrenceStack:m}),o=!0;else throw Error("non exhaustive match");else if(y instanceof Dn){const b=Ut(g);b.push(y.nonTerminalName);const v=Ut(m);v.push(y.idx);const E={idx:p,def:y.definition.concat(s,Vt(f)),ruleStack:b,occurrenceStack:v};h.push(E)}else if(y instanceof tn){const b={idx:p,def:Vt(f),ruleStack:g,occurrenceStack:m};h.push(b),h.push(a);const v={idx:p,def:y.definition.concat(Vt(f)),ruleStack:g,occurrenceStack:m};h.push(v)}else if(y instanceof er){const b=new gt({definition:y.definition,idx:y.idx}),v=y.definition.concat([b],Vt(f)),E={idx:p,def:v,ruleStack:g,occurrenceStack:m};h.push(E)}else if(y instanceof tr){const b=new st({terminalType:y.separator}),v=new gt({definition:[b].concat(y.definition),idx:y.idx}),E=y.definition.concat([v],Vt(f)),w={idx:p,def:E,ruleStack:g,occurrenceStack:m};h.push(w)}else if(y instanceof Mn){const b={idx:p,def:Vt(f),ruleStack:g,occurrenceStack:m};h.push(b),h.push(a);const v=new st({terminalType:y.separator}),E=new gt({definition:[v].concat(y.definition),idx:y.idx}),w=y.definition.concat([E],Vt(f)),N={idx:p,def:w,ruleStack:g,occurrenceStack:m};h.push(N)}else if(y instanceof gt){const b={idx:p,def:Vt(f),ruleStack:g,occurrenceStack:m};h.push(b),h.push(a);const v=new gt({definition:y.definition,idx:y.idx}),E=y.definition.concat([v],Vt(f)),w={idx:p,def:E,ruleStack:g,occurrenceStack:m};h.push(w)}else if(y instanceof On)for(let b=y.definition.length-1;b>=0;b--){const v=y.definition[b],E={idx:p,def:v.definition.concat(Vt(f)),ruleStack:g,occurrenceStack:m};h.push(E),h.push(a)}else if(y instanceof Fn)h.push({idx:p,def:y.definition.concat(Vt(f)),ruleStack:g,occurrenceStack:m});else if(y instanceof ao)h.push(Lz(y,p,g,m));else throw Error("non exhaustive match")}return c}function Lz(t,e,n,r){const i=Ut(n);i.push(t.name);const s=Ut(r);return s.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:s}}var ht;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(ht||(ht={}));function iy(t){if(t instanceof tn||t==="Option")return ht.OPTION;if(t instanceof gt||t==="Repetition")return ht.REPETITION;if(t instanceof er||t==="RepetitionMandatory")return ht.REPETITION_MANDATORY;if(t instanceof tr||t==="RepetitionMandatoryWithSeparator")return ht.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Mn||t==="RepetitionWithSeparator")return ht.REPETITION_WITH_SEPARATOR;if(t instanceof On||t==="Alternation")return ht.ALTERNATION;throw Error("non exhaustive match")}function rE(t){const{occurrence:e,rule:n,prodType:r,maxLookahead:i}=t,s=iy(r);return s===ht.ALTERNATION?Nd(e,n,i):Fd(e,n,s,i)}function Pz(t,e,n,r,i,s){const a=Nd(t,e,n),o=IT(a)?yf:kl;return s(a,r,o,i)}function $z(t,e,n,r,i,s){const a=Fd(t,e,i,n),o=IT(a)?yf:kl;return s(a[0],o,r)}function Bz(t,e,n,r){const i=t.length,s=Dr(t,a=>Dr(a,o=>o.length===1));if(e)return function(a){const o=ne(a,u=>u.GATE);for(let u=0;u<i;u++){const l=t[u],c=l.length,h=o[u];if(!(h!==void 0&&h.call(this)===!1))e:for(let d=0;d<c;d++){const f=l[d],p=f.length;for(let g=0;g<p;g++){const m=this.LA(g+1);if(n(m,f[g])===!1)continue e}return u}}};if(s&&!r){const a=ne(t,u=>Qt(u)),o=Ct(a,(u,l,c)=>(U(l,h=>{ye(u,h.tokenTypeIdx)||(u[h.tokenTypeIdx]=c),U(h.categoryMatches,d=>{ye(u,d)||(u[d]=c)})}),u),{});return function(){const u=this.LA(1);return o[u.tokenTypeIdx]}}else return function(){for(let a=0;a<i;a++){const o=t[a],u=o.length;e:for(let l=0;l<u;l++){const c=o[l],h=c.length;for(let d=0;d<h;d++){const f=this.LA(d+1);if(n(f,c[d])===!1)continue e}return a}}}}function Uz(t,e,n){const r=Dr(t,s=>s.length===1),i=t.length;if(r&&!n){const s=Qt(t);if(s.length===1&&Xe(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{const a=Ct(s,(o,u,l)=>(o[u.tokenTypeIdx]=!0,U(u.categoryMatches,c=>{o[c]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<i;s++){const a=t[s],o=a.length;for(let u=0;u<o;u++){const l=this.LA(u+1);if(e(l,a[u])===!1)continue e}return!0}return!1}}class Gz extends Td{constructor(e,n,r){super(),this.topProd=e,this.targetOccurrence=n,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,n,r,i){return e.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=r.concat(i),!0):!1}walkOption(e,n,r){this.checkIsTarget(e,ht.OPTION,n,r)||super.walkOption(e,n,r)}walkAtLeastOne(e,n,r){this.checkIsTarget(e,ht.REPETITION_MANDATORY,n,r)||super.walkOption(e,n,r)}walkAtLeastOneSep(e,n,r){this.checkIsTarget(e,ht.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||super.walkOption(e,n,r)}walkMany(e,n,r){this.checkIsTarget(e,ht.REPETITION,n,r)||super.walkOption(e,n,r)}walkManySep(e,n,r){this.checkIsTarget(e,ht.REPETITION_WITH_SEPARATOR,n,r)||super.walkOption(e,n,r)}}class MT extends oo{constructor(e,n,r){super(),this.targetOccurrence=e,this.targetProdType=n,this.targetRef=r,this.result=[]}checkIsTarget(e,n){e.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,ht.OPTION)}visitRepetition(e){this.checkIsTarget(e,ht.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,ht.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,ht.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,ht.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,ht.ALTERNATION)}}function iE(t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}function i0(t){let e=[""];for(let n=0;n<t.length;n++){const r=t[n],i=[];for(let s=0;s<e.length;s++){const a=e[s];i.push(a+"_"+r.tokenTypeIdx);for(let o=0;o<r.categoryMatches.length;o++){const u="_"+r.categoryMatches[o];i.push(a+u)}}e=i}return e}function zz(t,e,n){for(let r=0;r<t.length;r++){if(r===n)continue;const i=t[r];for(let s=0;s<e.length;s++){const a=e[s];if(i[a]===!0)return!1}}return!0}function OT(t,e){const n=ne(t,a=>Ig([a],1)),r=iE(n.length),i=ne(n,a=>{const o={};return U(a,u=>{const l=i0(u.partialPath);U(l,c=>{o[c]=!0})}),o});let s=n;for(let a=1;a<=e;a++){const o=s;s=iE(o.length);for(let u=0;u<o.length;u++){const l=o[u];for(let c=0;c<l.length;c++){const h=l[c].partialPath,d=l[c].suffixDef,f=i0(h);if(zz(i,f,u)||Xe(d)||h.length===e){const g=r[u];if(Lg(g,h)===!1){g.push(h);for(let m=0;m<f.length;m++){const y=f[m];i[u][y]=!0}}}else{const g=Ig(d,a+1,h);s[u]=s[u].concat(g),U(g,m=>{const y=i0(m.partialPath);U(y,b=>{i[u][b]=!0})})}}}}return r}function Nd(t,e,n,r){const i=new MT(t,ht.ALTERNATION,r);return e.accept(i),OT(i.result,n)}function Fd(t,e,n,r){const i=new MT(t,n);e.accept(i);const s=i.result,o=new Gz(e,t,n).startWalking(),u=new Fn({definition:s}),l=new Fn({definition:o});return OT([u,l],r)}function Lg(t,e){e:for(let n=0;n<t.length;n++){const r=t[n];if(r.length===e.length){for(let i=0;i<r.length;i++){const s=e[i],a=r[i];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function Wz(t,e){return t.length<e.length&&Dr(t,(n,r)=>{const i=e[r];return n===i||i.categoryMatchesMap[n.tokenTypeIdx]})}function IT(t){return Dr(t,e=>Dr(e,n=>Dr(n,r=>Xe(r.categoryMatches))))}function Hz(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.grammarName});return ne(e,n=>Object.assign({type:wn.CUSTOM_LOOKAHEAD_VALIDATION},n))}function Yz(t,e,n,r){const i=Xn(t,u=>Vz(u,n)),s=iW(t,e,n),a=Xn(t,u=>eW(u,n)),o=Xn(t,u=>jz(u,t,r,n));return i.concat(s,a,o)}function Vz(t,e){const n=new Xz;t.accept(n);const r=n.allProductions,i=$k(r,qz),s=Tr(i,o=>o.length>1);return ne(Qe(s),o=>{const u=_r(o),l=e.buildDuplicateFoundError(t,o),c=Gr(u),h={message:l,type:wn.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:c,occurrence:u.idx},d=LT(u);return d&&(h.parameter=d),h})}function qz(t){return`${Gr(t)}_#_${t.idx}_#_${LT(t)}`}function LT(t){return t instanceof st?t.terminalType.name:t instanceof Dn?t.nonTerminalName:""}class Xz extends oo{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function jz(t,e,n,r){const i=[];if(Ct(e,(a,o)=>o.name===t.name?a+1:a,0)>1){const a=r.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});i.push({message:a,type:wn.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function Kz(t,e,n){const r=[];let i;return _n(e,t)||(i=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${n}<-as it is not defined in any of the super grammars `,r.push({message:i,type:wn.INVALID_RULE_OVERRIDE,ruleName:t})),r}function PT(t,e,n,r=[]){const i=[],s=oh(e.definition);if(Xe(s))return[];{const a=t.name;_n(s,t)&&i.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:r}),type:wn.LEFT_RECURSION,ruleName:a});const u=$f(s,r.concat([t])),l=Xn(u,c=>{const h=Ut(r);return h.push(c),PT(t,c,n,h)});return i.concat(l)}}function oh(t){let e=[];if(Xe(t))return e;const n=_r(t);if(n instanceof Dn)e.push(n.referencedRule);else if(n instanceof Fn||n instanceof tn||n instanceof er||n instanceof tr||n instanceof Mn||n instanceof gt)e=e.concat(oh(n.definition));else if(n instanceof On)e=Qt(ne(n.definition,s=>oh(s.definition)));else if(!(n instanceof st))throw Error("non exhaustive match");const r=gf(n),i=t.length>1;if(r&&i){const s=Vt(t);return e.concat(oh(s))}else return e}class sy extends oo{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function Jz(t,e){const n=new sy;t.accept(n);const r=n.alternations;return Xn(r,s=>{const a=Lu(s.definition);return Xn(a,(o,u)=>{const l=RT([o],[],kl,1);return Xe(l)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:s,emptyChoiceIdx:u}),type:wn.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:s.idx,alternative:u+1}]:[]})})}function Zz(t,e,n){const r=new sy;t.accept(r);let i=r.alternations;return i=Pf(i,a=>a.ignoreAmbiguities===!0),Xn(i,a=>{const o=a.idx,u=a.maxLookahead||e,l=Nd(o,t,u,a),c=nW(l,a,t,n),h=rW(l,a,t,n);return c.concat(h)})}class Qz extends oo{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function eW(t,e){const n=new sy;t.accept(n);const r=n.alternations;return Xn(r,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:s}),type:wn.TOO_MANY_ALTS,ruleName:t.name,occurrence:s.idx}]:[])}function tW(t,e,n){const r=[];return U(t,i=>{const s=new Qz;i.accept(s);const a=s.allProductions;U(a,o=>{const u=iy(o),l=o.maxLookahead||e,c=o.idx,d=Fd(c,i,u,l)[0];if(Xe(Qt(d))){const f=n.buildEmptyRepetitionError({topLevelRule:i,repetition:o});r.push({message:f,type:wn.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function nW(t,e,n,r){const i=[],s=Ct(t,(o,u,l)=>(e.definition[l].ignoreAmbiguities===!0||U(u,c=>{const h=[l];U(t,(d,f)=>{l!==f&&Lg(d,c)&&e.definition[f].ignoreAmbiguities!==!0&&h.push(f)}),h.length>1&&!Lg(i,c)&&(i.push(c),o.push({alts:h,path:c}))}),o),[]);return ne(s,o=>{const u=ne(o.alts,c=>c+1);return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:u,prefixPath:o.path}),type:wn.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:o.alts}})}function rW(t,e,n,r){const i=Ct(t,(a,o,u)=>{const l=ne(o,c=>({idx:u,path:c}));return a.concat(l)},[]);return ol(Xn(i,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const u=a.idx,l=a.path,c=yt(i,d=>e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<u&&Wz(d.path,l));return ne(c,d=>{const f=[d.idx+1,u+1],p=e.idx===0?"":e.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:f,prefixPath:d.path}),type:wn.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:p,alternatives:f}})}))}function iW(t,e,n){const r=[],i=ne(e,s=>s.name);return U(t,s=>{const a=s.name;if(_n(i,a)){const o=n.buildNamespaceConflictError(s);r.push({message:o,type:wn.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),r}function sW(t){const e=Lf(t,{errMsgProvider:Sz}),n={};return U(t.rules,r=>{n[r.name]=r}),Nz(n,e.errMsgProvider)}function aW(t){return t=Lf(t,{errMsgProvider:Ds}),Yz(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}const $T="MismatchedTokenException",BT="NoViableAltException",UT="EarlyExitException",GT="NotAllInputParsedException",zT=[$T,BT,UT,GT];Object.freeze(zT);function vf(t){return _n(zT,t.name)}class Rd extends Error{constructor(e,n){super(e),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class WT extends Rd{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=$T}}class oW extends Rd{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=BT}}class uW extends Rd{constructor(e,n){super(e,n),this.name=GT}}class lW extends Rd{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=UT}}const s0={},HT="InRuleRecoveryException";class cW extends Error{constructor(e){super(e),this.name=HT}}class hW{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=ye(e,"recoveryEnabled")?e.recoveryEnabled:Ai.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=fW)}getTokenToInsert(e){const n=ry(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,n,r,i){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let u=!1;const l=this.LA(1);let c=this.LA(1);const h=()=>{const d=this.LA(0),f=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:l,previous:d,ruleName:this.getCurrRuleFullName()}),p=new WT(f,l,this.LA(0));p.resyncedTokens=Lu(o),this.SAVE_ERROR(p)};for(;!u;)if(this.tokenMatcher(c,i)){h();return}else if(r.call(this)){h(),e.apply(this,n);return}else this.tokenMatcher(c,s)?u=!0:(c=this.SKIP_TOKEN(),this.addToResyncTokens(c,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,n,r){return!(r===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,n)))}getFollowsForInRuleRecovery(e,n){const r=this.getCurrentGrammarPath(e,n);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(e,n){if(this.canRecoverWithSingleTokenInsertion(e,n))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){const r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new cW("sad sad panda")}canPerformInRuleRecovery(e,n){return this.canRecoverWithSingleTokenInsertion(e,n)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,n){if(!this.canTokenTypeBeInsertedInRecovery(e)||Xe(n))return!1;const r=this.LA(1);return Ei(n,s=>this.tokenMatcher(r,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){const n=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(n);return _n(r,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let n=this.LA(1),r=2;for(;;){const i=Ei(e,s=>FT(n,s));if(i!==void 0)return i;n=this.LA(r),r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return s0;const e=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:n,inRule:this.shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return ne(e,(r,i)=>i===0?s0:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:n[i],inRule:this.shortRuleNameToFullName(e[i-1])})}flattenFollowSet(){const e=ne(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return Qt(e)}getFollowSetFromFollowKey(e){if(e===s0)return[Ki];const n=e.ruleName+e.idxInCallingRule+xT+e.inRule;return this.resyncFollows[n]}addToResyncTokens(e,n){return this.tokenMatcher(e,Ki)||n.push(e),n}reSyncTo(e){const n=[];let r=this.LA(1);for(;this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,n);return Lu(n)}attemptInRepetitionRecovery(e,n,r,i,s,a,o){}getCurrentGrammarPath(e,n){const r=this.getHumanReadableRuleStack(),i=Ut(this.RULE_OCCURRENCE_STACK);return{ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:n}}getHumanReadableRuleStack(){return ne(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function fW(t,e,n,r,i,s,a){const o=this.getKeyForAutomaticLookahead(r,i);let u=this.firstAfterRepMap[o];if(u===void 0){const d=this.getCurrRuleFullName(),f=this.getGAstProductions()[d];u=new s(f,i).startWalking(),this.firstAfterRepMap[o]=u}let l=u.token,c=u.occurrence;const h=u.isEndOfRule;this.RULE_STACK.length===1&&h&&l===void 0&&(l=Ki,c=1),!(l===void 0||c===void 0)&&this.shouldInRepetitionRecoveryBeTried(l,c,a)&&this.tryInRepetitionRecovery(t,e,n,l)}const dW=4,ns=8,YT=1<<ns,VT=2<<ns,Pg=3<<ns,$g=4<<ns,Bg=5<<ns,uh=6<<ns;function a0(t,e,n){return n|e|t}class ay{constructor(e){var n;this.maxLookahead=(n=e==null?void 0:e.maxLookahead)!==null&&n!==void 0?n:Ai.maxLookahead}validate(e){const n=this.validateNoLeftRecursion(e.rules);if(Xe(n)){const r=this.validateEmptyOrAlternatives(e.rules),i=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...n,...r,...i,...s]}return n}validateNoLeftRecursion(e){return Xn(e,n=>PT(n,n,Ds))}validateEmptyOrAlternatives(e){return Xn(e,n=>Jz(n,Ds))}validateAmbiguousAlternationAlternatives(e,n){return Xn(e,r=>Zz(r,n,Ds))}validateSomeNonEmptyLookaheadPath(e,n){return tW(e,n,Ds)}buildLookaheadForAlternation(e){return Pz(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,Bz)}buildLookaheadForOptional(e){return $z(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,iy(e.prodType),Uz)}}class pW{initLooksAhead(e){this.dynamicTokensEnabled=ye(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Ai.dynamicTokensEnabled,this.maxLookahead=ye(e,"maxLookahead")?e.maxLookahead:Ai.maxLookahead,this.lookaheadStrategy=ye(e,"lookaheadStrategy")?e.lookaheadStrategy:new ay({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){U(e,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:r,repetition:i,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:u}=mW(n);U(r,l=>{const c=l.idx===0?"":l.idx;this.TRACE_INIT(`${Gr(l)}${c}`,()=>{const h=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:l.idx,rule:n,maxLookahead:l.maxLookahead||this.maxLookahead,hasPredicates:l.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),d=a0(this.fullRuleNameToShort[n.name],YT,l.idx);this.setLaFuncCache(d,h)})}),U(i,l=>{this.computeLookaheadFunc(n,l.idx,Pg,"Repetition",l.maxLookahead,Gr(l))}),U(s,l=>{this.computeLookaheadFunc(n,l.idx,VT,"Option",l.maxLookahead,Gr(l))}),U(a,l=>{this.computeLookaheadFunc(n,l.idx,$g,"RepetitionMandatory",l.maxLookahead,Gr(l))}),U(o,l=>{this.computeLookaheadFunc(n,l.idx,uh,"RepetitionMandatoryWithSeparator",l.maxLookahead,Gr(l))}),U(u,l=>{this.computeLookaheadFunc(n,l.idx,Bg,"RepetitionWithSeparator",l.maxLookahead,Gr(l))})})})}computeLookaheadFunc(e,n,r,i,s,a){this.TRACE_INIT(`${a}${n===0?"":n}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:i}),u=a0(this.fullRuleNameToShort[e.name],r,n);this.setLaFuncCache(u,o)})}getKeyForAutomaticLookahead(e,n){const r=this.getLastExplicitRuleShortName();return a0(r,e,n)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,n){this.lookAheadFuncsCache.set(e,n)}}class gW extends oo{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const _c=new gW;function mW(t){_c.reset(),t.accept(_c);const e=_c.dslMethods;return _c.reset(),e}function sE(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function aE(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function yW(t,e,n){t.children[n]===void 0?t.children[n]=[e]:t.children[n].push(e)}function vW(t,e,n){t.children[e]===void 0?t.children[e]=[n]:t.children[e].push(n)}const bW="name";function qT(t,e){Object.defineProperty(t,bW,{enumerable:!1,configurable:!0,writable:!1,value:e})}function xW(t,e){const n=gr(t),r=n.length;for(let i=0;i<r;i++){const s=n[i],a=t[s],o=a.length;for(let u=0;u<o;u++){const l=a[u];l.tokenTypeIdx===void 0&&this[l.name](l.children,e)}}}function EW(t,e){const n=function(){};qT(n,t+"BaseSemantics");const r={visit:function(i,s){if(qn(i)&&(i=i[0]),!Ye(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=wW(this,e);if(!Xe(i)){const s=ne(i,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=r,n.prototype.constructor=n,n._RULE_NAMES=e,n}function DW(t,e,n){const r=function(){};qT(r,t+"BaseSemanticsWithDefaults");const i=Object.create(n.prototype);return U(e,s=>{i[s]=xW}),r.prototype=i,r.prototype.constructor=r,r}var Ug;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(Ug||(Ug={}));function wW(t,e){return _W(t,e)}function _W(t,e){const n=yt(e,i=>xi(t[i])===!1),r=ne(n,i=>({msg:`Missing visitor method: <${i}> on ${t.constructor.name} CST Visitor.`,type:Ug.MISSING_METHOD,methodName:i}));return ol(r)}class CW{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=ye(e,"nodeLocationTracking")?e.nodeLocationTracking:Ai.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Lt,this.cstFinallyStateUpdate=Lt,this.cstPostTerminal=Lt,this.cstPostNonTerminal=Lt,this.cstPostRule=Lt;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=aE,this.setNodeLocationFromNode=aE,this.cstPostRule=Lt,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Lt,this.setNodeLocationFromNode=Lt,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=sE,this.setNodeLocationFromNode=sE,this.cstPostRule=Lt,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Lt,this.setNodeLocationFromNode=Lt,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Lt,this.setNodeLocationFromNode=Lt,this.cstPostRule=Lt,this.setInitialNodeLocation=Lt;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const n=this.LA(1);e.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const n={name:e,children:Object.create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const n=this.LA(0),r=e.location;r.startOffset<=n.startOffset?(r.endOffset=n.endOffset,r.endLine=n.endLine,r.endColumn=n.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(e){const n=this.LA(0),r=e.location;r.startOffset<=n.startOffset?r.endOffset=n.endOffset:r.startOffset=NaN}cstPostTerminal(e,n){const r=this.CST_STACK[this.CST_STACK.length-1];yW(r,n,e),this.setNodeLocationFromToken(r.location,n)}cstPostNonTerminal(e,n){const r=this.CST_STACK[this.CST_STACK.length-1];vW(r,n,e),this.setNodeLocationFromNode(r.location,e.location)}getBaseCstVisitorConstructor(){if(Ye(this.baseCstVisitorConstructor)){const e=EW(this.className,gr(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(Ye(this.baseCstVisitorWithDefaultsConstructor)){const e=DW(this.className,gr(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class AW{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):xf}LA(e){const n=this.currIdx+e;return n<0||this.tokVectorLength<=n?xf:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class TW{ACTION(e){return e.call(this)}consume(e,n,r){return this.consumeInternal(n,e,r)}subrule(e,n,r){return this.subruleInternal(n,e,r)}option(e,n){return this.optionInternal(n,e)}or(e,n){return this.orInternal(n,e)}many(e,n){return this.manyInternal(e,n)}atLeastOne(e,n){return this.atLeastOneInternal(e,n)}CONSUME(e,n){return this.consumeInternal(e,0,n)}CONSUME1(e,n){return this.consumeInternal(e,1,n)}CONSUME2(e,n){return this.consumeInternal(e,2,n)}CONSUME3(e,n){return this.consumeInternal(e,3,n)}CONSUME4(e,n){return this.consumeInternal(e,4,n)}CONSUME5(e,n){return this.consumeInternal(e,5,n)}CONSUME6(e,n){return this.consumeInternal(e,6,n)}CONSUME7(e,n){return this.consumeInternal(e,7,n)}CONSUME8(e,n){return this.consumeInternal(e,8,n)}CONSUME9(e,n){return this.consumeInternal(e,9,n)}SUBRULE(e,n){return this.subruleInternal(e,0,n)}SUBRULE1(e,n){return this.subruleInternal(e,1,n)}SUBRULE2(e,n){return this.subruleInternal(e,2,n)}SUBRULE3(e,n){return this.subruleInternal(e,3,n)}SUBRULE4(e,n){return this.subruleInternal(e,4,n)}SUBRULE5(e,n){return this.subruleInternal(e,5,n)}SUBRULE6(e,n){return this.subruleInternal(e,6,n)}SUBRULE7(e,n){return this.subruleInternal(e,7,n)}SUBRULE8(e,n){return this.subruleInternal(e,8,n)}SUBRULE9(e,n){return this.subruleInternal(e,9,n)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,n,r=Ef){if(_n(this.definedRulesNames,e)){const a={message:Ds.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:wn.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const i=this.defineRule(e,n,r);return this[e]=i,i}OVERRIDE_RULE(e,n,r=Ef){const i=Kz(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(e,n,r);return this[e]=s,s}BACKTRACK(e,n){return function(){this.isBackTrackingStack.push(1);const r=this.saveRecogState();try{return e.apply(this,n),!0}catch(i){if(vf(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return LG(Qe(this.gastProductionsCache))}}class kW{initRecognizerEngine(e,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=yf,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},ye(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(qn(e)){if(Xe(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(qn(e))this.tokensMap=Ct(e,(s,a)=>(s[a.name]=a,s),{});else if(ye(e,"modes")&&Dr(Qt(Qe(e.modes)),Az)){const s=Qt(Qe(e.modes)),a=dm(s);this.tokensMap=Ct(a,(o,u)=>(o[u.name]=u,o),{})}else if(Bk(e))this.tokensMap=Ut(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Ki;const r=ye(e,"modes")?Qt(Qe(e.modes)):Qe(e),i=Dr(r,s=>Xe(s.categoryMatches));this.tokenMatcher=i?yf:kl,Sl(Qe(this.tokensMap))}defineRule(e,n,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=ye(r,"resyncEnabled")?r.resyncEnabled:Ef.resyncEnabled,s=ye(r,"recoveryValueFunc")?r.recoveryValueFunc:Ef.recoveryValueFunc,a=this.ruleShortNameIdx<<dW+ns;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...c){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,c);const h=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(h),h}catch(h){return this.invokeRuleCatch(h,i,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...c){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,c)}catch(h){return this.invokeRuleCatch(h,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:n})}invokeRuleCatch(e,n,r){const i=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(vf(e)){const a=e;if(s){const o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const u=this.CST_STACK[this.CST_STACK.length-1];return u.recoveredNode=!0,u}else return r(e);else{if(this.outputCst){const u=this.CST_STACK[this.CST_STACK.length-1];u.recoveredNode=!0,a.partialCstResult=u}throw a}}else{if(i)return this.moveToTerminatedState(),r(e);throw a}}else throw e}optionInternal(e,n){const r=this.getKeyForAutomaticLookahead(VT,n);return this.optionInternalLogic(e,n,r)}optionInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=e;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(e,n){const r=this.getKeyForAutomaticLookahead($g,e);return this.atLeastOneInternalLogic(e,n,r)}atLeastOneInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=n;if(i.call(this)===!0){let a=this.doSingleRepetition(s);for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,ht.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,n],i,$g,e,Iz)}atLeastOneSepFirstInternal(e,n){const r=this.getKeyForAutomaticLookahead(uh,e);this.atLeastOneSepFirstInternalLogic(e,n,r)}atLeastOneSepFirstInternalLogic(e,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,nE],o,uh,e,nE)}else throw this.raiseEarlyExitException(e,ht.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(e,n){const r=this.getKeyForAutomaticLookahead(Pg,e);return this.manyInternalLogic(e,n,r)}manyInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const o=n.GATE;if(o!==void 0){const u=i;i=()=>o.call(this)&&u.call(this)}}else s=n;let a=!0;for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,n],i,Pg,e,Oz,a)}manySepFirstInternal(e,n){const r=this.getKeyForAutomaticLookahead(Bg,e);this.manySepFirstInternalLogic(e,n,r)}manySepFirstInternalLogic(e,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,tE],o,Bg,e,tE)}}repetitionSepSecondInternal(e,n,r,i,s){for(;r();)this.CONSUME(n),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,i,s],r,uh,e,s)}doSingleRepetition(e){const n=this.getLexerPosition();return e.call(this),this.getLexerPosition()>n}orInternal(e,n){const r=this.getKeyForAutomaticLookahead(YT,n),i=qn(e)?e:e.DEF,a=this.getLaFuncFromCache(r).call(this,i);if(a!==void 0)return i[a].ALT.call(this);this.raiseNoAltException(n,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new uW(n,e))}}subruleInternal(e,n,r){let i;try{const s=r!==void 0?r.ARGS:void 0;return this.subruleIdx=n,i=e.apply(this,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(s){throw this.subruleInternalError(s,r,e.ruleName)}}subruleInternalError(e,n,r){throw vf(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:r),delete e.partialCstResult),e}consumeInternal(e,n,r){let i;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,r)}catch(s){i=this.consumeInternalRecovery(e,n,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i}consumeInternalError(e,n,r){let i;const s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new WT(i,n,s))}consumeInternalRecovery(e,n,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){const i=this.getFollowsForInRuleRecovery(e,n);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===HT?r:s}}else throw r}saveRecogState(){const e=this.errors,n=Ut(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,n,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),Ki)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class SW{initErrorHandler(e){this._errors=[],this.errorMessageProvider=ye(e,"errorMessageProvider")?e.errorMessageProvider:Ai.errorMessageProvider}SAVE_ERROR(e){if(vf(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Ut(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Ut(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,n,r){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=Fd(e,s,n,this.maxLookahead)[0],u=[];for(let c=1;c<=this.maxLookahead;c++)u.push(this.LA(c));const l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:u,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new lW(l,this.LA(1),this.LA(0)))}raiseNoAltException(e,n){const r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=Nd(e,i,this.maxLookahead),a=[];for(let l=1;l<=this.maxLookahead;l++)a.push(this.LA(l));const o=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new oW(u,this.LA(1),o))}}class NW{initContentAssist(){}computeContentAssist(e,n){const r=this.gastProductionsCache[e];if(Ye(r))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return RT([r],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const n=_r(e.ruleStack),i=this.getGAstProductions()[n];return new Mz(i,e).startWalking()}}const Md={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Md);const oE=!0,uE=Math.pow(2,ns)-1,XT=NT({name:"RECORDING_PHASE_TOKEN",pattern:Sn.NA});Sl([XT]);const jT=ry(XT,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(jT);const FW={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class RW{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const n=e>0?e:"";this[`CONSUME${n}`]=function(r,i){return this.consumeInternalRecord(r,e,i)},this[`SUBRULE${n}`]=function(r,i){return this.subruleInternalRecord(r,e,i)},this[`OPTION${n}`]=function(r){return this.optionInternalRecord(r,e)},this[`OR${n}`]=function(r){return this.orInternalRecord(r,e)},this[`MANY${n}`]=function(r){this.manyInternalRecord(e,r)},this[`MANY_SEP${n}`]=function(r){this.manySepFirstInternalRecord(e,r)},this[`AT_LEAST_ONE${n}`]=function(r){this.atLeastOneInternalRecord(e,r)},this[`AT_LEAST_ONE_SEP${n}`]=function(r){this.atLeastOneSepFirstInternalRecord(e,r)}}this.consume=function(e,n,r){return this.consumeInternalRecord(n,e,r)},this.subrule=function(e,n,r){return this.subruleInternalRecord(n,e,r)},this.option=function(e,n){return this.optionInternalRecord(n,e)},this.or=function(e,n){return this.orInternalRecord(n,e)},this.many=function(e,n){this.manyInternalRecord(e,n)},this.atLeastOne=function(e,n){this.atLeastOneInternalRecord(e,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let n=0;n<10;n++){const r=n>0?n:"";delete e[`CONSUME${r}`],delete e[`SUBRULE${r}`],delete e[`OPTION${r}`],delete e[`OR${r}`],delete e[`MANY${r}`],delete e[`MANY_SEP${r}`],delete e[`AT_LEAST_ONE${r}`],delete e[`AT_LEAST_ONE_SEP${r}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,n){return()=>!0}LA_RECORD(e){return xf}topLevelRuleRecord(e,n){try{const r=new ao({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),n.call(this),this.recordingProdStack.pop(),r}catch(r){if(r.KNOWN_RECORDER_ERROR!==!0)try{r.message=r.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw r}throw r}}optionInternalRecord(e,n){return So.call(this,tn,e,n)}atLeastOneInternalRecord(e,n){So.call(this,er,n,e)}atLeastOneSepFirstInternalRecord(e,n){So.call(this,tr,n,e,oE)}manyInternalRecord(e,n){So.call(this,gt,n,e)}manySepFirstInternalRecord(e,n){So.call(this,Mn,n,e,oE)}orInternalRecord(e,n){return MW.call(this,e,n)}subruleInternalRecord(e,n,r){if(bf(n),!e||ye(e,"ruleName")===!1){const o=new Error(`<SUBRULE${lE(n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=jr(this.recordingProdStack),s=e.ruleName,a=new Dn({idx:n,nonTerminalName:s,label:r==null?void 0:r.LABEL,referencedRule:void 0});return i.definition.push(a),this.outputCst?FW:Md}consumeInternalRecord(e,n,r){if(bf(n),!kT(e)){const a=new Error(`<CONSUME${lE(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=jr(this.recordingProdStack),s=new st({idx:n,terminalType:e,label:r==null?void 0:r.LABEL});return i.definition.push(s),jT}}function So(t,e,n,r=!1){bf(n);const i=jr(this.recordingProdStack),s=xi(e)?e:e.DEF,a=new t({definition:[],idx:n});return r&&(a.separator=e.SEP),ye(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),i.definition.push(a),this.recordingProdStack.pop(),Md}function MW(t,e){bf(e);const n=jr(this.recordingProdStack),r=qn(t)===!1,i=r===!1?t:t.DEF,s=new On({definition:[],idx:e,ignoreAmbiguities:r&&t.IGNORE_AMBIGUITIES===!0});ye(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD);const a=HD(i,o=>xi(o.GATE));return s.hasPredicates=a,n.definition.push(s),U(i,o=>{const u=new Fn({definition:[]});s.definition.push(u),ye(o,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:ye(o,"GATE")&&(u.ignoreAmbiguities=!0),this.recordingProdStack.push(u),o.ALT.call(this),this.recordingProdStack.pop()}),Md}function lE(t){return t===0?"":`${t}`}function bf(t){if(t<0||t>uE){const e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${uE+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class OW{initPerformanceTracer(e){if(ye(e,"traceInitPerf")){const n=e.traceInitPerf,r=typeof n=="number";this.traceInitMaxIdent=r?n:1/0,this.traceInitPerf=r?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=Ai.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${r}--> <${e}>`);const{time:i,value:s}=vT(n),a=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${r}<-- <${e}> time: ${i}ms`),this.traceInitIndent--,s}else return n()}}function IW(t,e){e.forEach(n=>{const r=n.prototype;Object.getOwnPropertyNames(r).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(t.prototype,i,s):t.prototype[i]=n.prototype[i]})})}const xf=ry(Ki,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(xf);const Ai=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:va,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Ef=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var wn;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(wn||(wn={}));function cE(t=void 0){return function(){return t}}class Nl{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{bT(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),U(this.definedRulesNames,i=>{const a=this[i].originalGrammarAction;let o;this.TRACE_INIT(`${i} Rule`,()=>{o=this.topLevelRuleRecord(i,a)}),this.gastProductionsCache[i]=o})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=sW({rules:Qe(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if(Xe(r)&&this.skipValidations===!1){const i=aW({rules:Qe(this.gastProductionsCache),tokenTypes:Qe(this.tokensMap),errMsgProvider:Ds,grammarName:n}),s=Hz({lookaheadStrategy:this.lookaheadStrategy,rules:Qe(this.gastProductionsCache),tokenTypes:Qe(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(i,s)}}),Xe(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=WG(Qe(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:Qe(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(Qe(this.gastProductionsCache))})),!Nl.DEFER_DEFINITION_ERRORS_HANDLING&&!Xe(this.definitionErrors))throw e=ne(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const r=this;if(r.initErrorHandler(n),r.initLexerAdapter(),r.initLooksAhead(n),r.initRecognizerEngine(e,n),r.initRecoverable(n),r.initTreeBuilder(n),r.initContentAssist(),r.initGastRecorder(n),r.initPerformanceTracer(n),ye(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=ye(n,"skipValidations")?n.skipValidations:Ai.skipValidations}}Nl.DEFER_DEFINITION_ERRORS_HANDLING=!1;IW(Nl,[hW,pW,CW,AW,kW,TW,SW,NW,RW,OW]);class LW extends Nl{constructor(e,n=Ai){const r=Ut(n);r.outputCst=!1,super(e,r)}}function ja(t,e,n){return`${t.name}_${e}_${n}`}const Ji=1,PW=2,KT=4,JT=5,Fl=7,$W=8,BW=9,UW=10,GW=11,ZT=12;class oy{constructor(e){this.target=e}isEpsilon(){return!1}}class uy extends oy{constructor(e,n){super(e),this.tokenType=n}}class QT extends oy{constructor(e){super(e)}isEpsilon(){return!0}}class ly extends oy{constructor(e,n,r){super(e),this.rule=n,this.followState=r}isEpsilon(){return!0}}function zW(t){const e={decisionMap:{},decisionStates:[],ruleToStartState:new Map,ruleToStopState:new Map,states:[]};WW(e,t);const n=t.length;for(let r=0;r<n;r++){const i=t[r],s=Js(e,i,i);s!==void 0&&eH(e,i,s)}return e}function WW(t,e){const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=Bt(t,i,void 0,{type:PW}),a=Bt(t,i,void 0,{type:Fl});s.stop=a,t.ruleToStartState.set(i,s),t.ruleToStopState.set(i,a)}}function ek(t,e,n){return n instanceof st?cy(t,e,n.terminalType,n):n instanceof Dn?QW(t,e,n):n instanceof On?XW(t,e,n):n instanceof tn?jW(t,e,n):n instanceof gt?HW(t,e,n):n instanceof Mn?YW(t,e,n):n instanceof er?VW(t,e,n):n instanceof tr?qW(t,e,n):Js(t,e,n)}function HW(t,e,n){const r=Bt(t,e,n,{type:JT});rs(t,r);const i=uo(t,e,r,n,Js(t,e,n));return nk(t,e,n,i)}function YW(t,e,n){const r=Bt(t,e,n,{type:JT});rs(t,r);const i=uo(t,e,r,n,Js(t,e,n)),s=cy(t,e,n.separator,n);return nk(t,e,n,i,s)}function VW(t,e,n){const r=Bt(t,e,n,{type:KT});rs(t,r);const i=uo(t,e,r,n,Js(t,e,n));return tk(t,e,n,i)}function qW(t,e,n){const r=Bt(t,e,n,{type:KT});rs(t,r);const i=uo(t,e,r,n,Js(t,e,n)),s=cy(t,e,n.separator,n);return tk(t,e,n,i,s)}function XW(t,e,n){const r=Bt(t,e,n,{type:Ji});rs(t,r);const i=ne(n.definition,a=>ek(t,e,a));return uo(t,e,r,n,...i)}function jW(t,e,n){const r=Bt(t,e,n,{type:Ji});rs(t,r);const i=uo(t,e,r,n,Js(t,e,n));return KW(t,e,n,i)}function Js(t,e,n){const r=yt(ne(n.definition,i=>ek(t,e,i)),i=>i!==void 0);return r.length===1?r[0]:r.length===0?void 0:ZW(t,r)}function tk(t,e,n,r,i){const s=r.left,a=r.right,o=Bt(t,e,n,{type:GW});rs(t,o);const u=Bt(t,e,n,{type:ZT});return s.loopback=o,u.loopback=o,t.decisionMap[ja(e,i?"RepetitionMandatoryWithSeparator":"RepetitionMandatory",n.idx)]=o,Dt(a,o),i===void 0?(Dt(o,s),Dt(o,u)):(Dt(o,u),Dt(o,i.left),Dt(i.right,s)),{left:s,right:u}}function nk(t,e,n,r,i){const s=r.left,a=r.right,o=Bt(t,e,n,{type:UW});rs(t,o);const u=Bt(t,e,n,{type:ZT}),l=Bt(t,e,n,{type:BW});return o.loopback=l,u.loopback=l,Dt(o,s),Dt(o,u),Dt(a,l),i!==void 0?(Dt(l,u),Dt(l,i.left),Dt(i.right,s)):Dt(l,o),t.decisionMap[ja(e,i?"RepetitionWithSeparator":"Repetition",n.idx)]=o,{left:o,right:u}}function KW(t,e,n,r){const i=r.left,s=r.right;return Dt(i,s),t.decisionMap[ja(e,"Option",n.idx)]=i,r}function rs(t,e){return t.decisionStates.push(e),e.decision=t.decisionStates.length-1,e.decision}function uo(t,e,n,r,...i){const s=Bt(t,e,r,{type:$W,start:n});n.end=s;for(const o of i)o!==void 0?(Dt(n,o.left),Dt(o.right,s)):Dt(n,s);const a={left:n,right:s};return t.decisionMap[ja(e,JW(r),r.idx)]=n,a}function JW(t){if(t instanceof On)return"Alternation";if(t instanceof tn)return"Option";if(t instanceof gt)return"Repetition";if(t instanceof Mn)return"RepetitionWithSeparator";if(t instanceof er)return"RepetitionMandatory";if(t instanceof tr)return"RepetitionMandatoryWithSeparator";throw new Error("Invalid production type encountered")}function ZW(t,e){const n=e.length;for(let s=0;s<n-1;s++){const a=e[s];let o;a.left.transitions.length===1&&(o=a.left.transitions[0]);const u=o instanceof ly,l=o,c=e[s+1].left;a.left.type===Ji&&a.right.type===Ji&&o!==void 0&&(u&&l.followState===a.right||o.target===a.right)?(u?l.followState=c:o.target=c,tH(t,a.right)):Dt(a.right,c)}const r=e[0],i=e[n-1];return{left:r.left,right:i.right}}function cy(t,e,n,r){const i=Bt(t,e,r,{type:Ji}),s=Bt(t,e,r,{type:Ji});return hy(i,new uy(s,n)),{left:i,right:s}}function QW(t,e,n){const r=n.referencedRule,i=t.ruleToStartState.get(r),s=Bt(t,e,n,{type:Ji}),a=Bt(t,e,n,{type:Ji}),o=new ly(i,r,a);return hy(s,o),{left:s,right:a}}function eH(t,e,n){const r=t.ruleToStartState.get(e);Dt(r,n.left);const i=t.ruleToStopState.get(e);return Dt(n.right,i),{left:r,right:i}}function Dt(t,e){const n=new QT(e);hy(t,n)}function Bt(t,e,n,r){const i=Object.assign({atn:t,production:n,epsilonOnlyTransitions:!1,rule:e,transitions:[],nextTokenWithinRule:[],stateNumber:t.states.length},r);return t.states.push(i),i}function hy(t,e){t.transitions.length===0&&(t.epsilonOnlyTransitions=e.isEpsilon()),t.transitions.push(e)}function tH(t,e){t.states.splice(t.states.indexOf(e),1)}const Df={};class Gg{constructor(){this.map={},this.configs=[]}get size(){return this.configs.length}finalize(){this.map={}}add(e){const n=rk(e);n in this.map||(this.map[n]=this.configs.length,this.configs.push(e))}get elements(){return this.configs}get alts(){return ne(this.configs,e=>e.alt)}get key(){let e="";for(const n in this.map)e+=n+":";return e}}function rk(t,e=!0){return`${e?`a${t.alt}`:""}s${t.state.stateNumber}:${t.stack.map(n=>n.stateNumber.toString()).join("_")}`}function nH(t,e){const n={};return r=>{const i=r.toString();let s=n[i];return s!==void 0||(s={atnStartState:t,decision:e,states:{}},n[i]=s),s}}class ik{constructor(){this.predicates=[]}is(e){return e>=this.predicates.length||this.predicates[e]}set(e,n){this.predicates[e]=n}toString(){let e="";const n=this.predicates.length;for(let r=0;r<n;r++)e+=this.predicates[r]===!0?"1":"0";return e}}const hE=new ik;class rH extends ay{constructor(e){var n;super(),this.logging=(n=e==null?void 0:e.logging)!==null&&n!==void 0?n:r=>console.log(r)}initialize(e){this.atn=zW(e.rules),this.dfas=iH(this.atn)}validateAmbiguousAlternationAlternatives(){return[]}validateEmptyOrAlternatives(){return[]}buildLookaheadForAlternation(e){const{prodOccurrence:n,rule:r,hasPredicates:i,dynamicTokensEnabled:s}=e,a=this.dfas,o=this.logging,u=ja(r,"Alternation",n),c=this.atn.decisionMap[u].decision,h=ne(rE({maxLookahead:1,occurrence:n,prodType:"Alternation",rule:r}),d=>ne(d,f=>f[0]));if(fE(h,!1)&&!s){const d=Ct(h,(f,p,g)=>(U(p,m=>{m&&(f[m.tokenTypeIdx]=g,U(m.categoryMatches,y=>{f[y]=g}))}),f),{});return i?function(f){var p;const g=this.LA(1),m=d[g.tokenTypeIdx];if(f!==void 0&&m!==void 0){const y=(p=f[m])===null||p===void 0?void 0:p.GATE;if(y!==void 0&&y.call(this)===!1)return}return m}:function(){const f=this.LA(1);return d[f.tokenTypeIdx]}}else return i?function(d){const f=new ik,p=d===void 0?0:d.length;for(let m=0;m<p;m++){const y=d==null?void 0:d[m].GATE;f.set(m,y===void 0||y.call(this))}const g=o0.call(this,a,c,f,o);return typeof g=="number"?g:void 0}:function(){const d=o0.call(this,a,c,hE,o);return typeof d=="number"?d:void 0}}buildLookaheadForOptional(e){const{prodOccurrence:n,rule:r,prodType:i,dynamicTokensEnabled:s}=e,a=this.dfas,o=this.logging,u=ja(r,i,n),c=this.atn.decisionMap[u].decision,h=ne(rE({maxLookahead:1,occurrence:n,prodType:i,rule:r}),d=>ne(d,f=>f[0]));if(fE(h)&&h[0][0]&&!s){const d=h[0],f=Qt(d);if(f.length===1&&Xe(f[0].categoryMatches)){const g=f[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===g}}else{const p=Ct(f,(g,m)=>(m!==void 0&&(g[m.tokenTypeIdx]=!0,U(m.categoryMatches,y=>{g[y]=!0})),g),{});return function(){const g=this.LA(1);return p[g.tokenTypeIdx]===!0}}}return function(){const d=o0.call(this,a,c,hE,o);return typeof d=="object"?!1:d===0}}}function fE(t,e=!0){const n=new Set;for(const r of t){const i=new Set;for(const s of r){if(s===void 0){if(e)break;return!1}const a=[s.tokenTypeIdx].concat(s.categoryMatches);for(const o of a)if(n.has(o)){if(!i.has(o))return!1}else n.add(o),i.add(o)}}return!0}function iH(t){const e=t.decisionStates.length,n=Array(e);for(let r=0;r<e;r++)n[r]=nH(t.decisionStates[r],r);return n}function o0(t,e,n,r){const i=t[e](n);let s=i.start;if(s===void 0){const o=gH(i.atnStartState);s=ak(i,sk(o)),i.start=s}return sH.apply(this,[i,s,n,r])}function sH(t,e,n,r){let i=e,s=1;const a=[];let o=this.LA(s++);for(;;){let u=hH(i,o);if(u===void 0&&(u=aH.apply(this,[t,i,o,s,n,r])),u===Df)return cH(a,i,o);if(u.isAcceptState===!0)return u.prediction;i=u,a.push(o),o=this.LA(s++)}}function aH(t,e,n,r,i,s){const a=fH(e.configs,n,i);if(a.size===0)return dE(t,e,n,Df),Df;let o=sk(a);const u=pH(a,i);if(u!==void 0)o.isAcceptState=!0,o.prediction=u,o.configs.uniqueAlt=u;else if(bH(a)){const l=Ia(a.alts);o.isAcceptState=!0,o.prediction=l,o.configs.uniqueAlt=l,oH.apply(this,[t,r,a.alts,s])}return o=dE(t,e,n,o),o}function oH(t,e,n,r){const i=[];for(let l=1;l<=e;l++)i.push(this.LA(l).tokenType);const s=t.atnStartState,a=s.rule,o=s.production,u=uH({topLevelRule:a,ambiguityIndices:n,production:o,prefixPath:i});r(u)}function uH(t){const e=ne(t.prefixPath,i=>Ma(i)).join(", "),n=t.production.idx===0?"":t.production.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(", ")}> in <${lH(t.production)}${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r}function lH(t){if(t instanceof Dn)return"SUBRULE";if(t instanceof tn)return"OPTION";if(t instanceof On)return"OR";if(t instanceof er)return"AT_LEAST_ONE";if(t instanceof tr)return"AT_LEAST_ONE_SEP";if(t instanceof Mn)return"MANY_SEP";if(t instanceof gt)return"MANY";if(t instanceof st)return"CONSUME";throw Error("non exhaustive match")}function cH(t,e,n){const r=Xn(e.configs.elements,s=>s.state.transitions),i=Uk(r.filter(s=>s instanceof uy).map(s=>s.tokenType),s=>s.tokenTypeIdx);return{actualToken:n,possibleTokenTypes:i,tokenPath:t}}function hH(t,e){return t.edges[e.tokenTypeIdx]}function fH(t,e,n){const r=new Gg,i=[];for(const a of t.elements){if(n.is(a.alt)===!1)continue;if(a.state.type===Fl){i.push(a);continue}const o=a.state.transitions.length;for(let u=0;u<o;u++){const l=a.state.transitions[u],c=dH(l,e);c!==void 0&&r.add({state:c,alt:a.alt,stack:a.stack})}}let s;if(i.length===0&&r.size===1&&(s=r),s===void 0){s=new Gg;for(const a of r.elements)wf(a,s)}if(i.length>0&&!yH(s))for(const a of i)s.add(a);return s}function dH(t,e){if(t instanceof uy&&FT(e,t.tokenType))return t.target}function pH(t,e){let n;for(const r of t.elements)if(e.is(r.alt)===!0){if(n===void 0)n=r.alt;else if(n!==r.alt)return}return n}function sk(t){return{configs:t,edges:{},isAcceptState:!1,prediction:-1}}function dE(t,e,n,r){return r=ak(t,r),e.edges[n.tokenTypeIdx]=r,r}function ak(t,e){if(e===Df)return e;const n=e.configs.key,r=t.states[n];return r!==void 0?r:(e.configs.finalize(),t.states[n]=e,e)}function gH(t){const e=new Gg,n=t.transitions.length;for(let r=0;r<n;r++){const s={state:t.transitions[r].target,alt:r,stack:[]};wf(s,e)}return e}function wf(t,e){const n=t.state;if(n.type===Fl){if(t.stack.length>0){const i=[...t.stack],a={state:i.pop(),alt:t.alt,stack:i};wf(a,e)}else e.add(t);return}n.epsilonOnlyTransitions||e.add(t);const r=n.transitions.length;for(let i=0;i<r;i++){const s=n.transitions[i],a=mH(t,s);a!==void 0&&wf(a,e)}}function mH(t,e){if(e instanceof QT)return{state:e.target,alt:t.alt,stack:t.stack};if(e instanceof ly){const n=[...t.stack,e.followState];return{state:e.target,alt:t.alt,stack:n}}}function yH(t){for(const e of t.elements)if(e.state.type===Fl)return!0;return!1}function vH(t){for(const e of t.elements)if(e.state.type!==Fl)return!1;return!0}function bH(t){if(vH(t))return!0;const e=xH(t.elements);return EH(e)&&!DH(e)}function xH(t){const e=new Map;for(const n of t){const r=rk(n,!1);let i=e.get(r);i===void 0&&(i={},e.set(r,i)),i[n.alt]=!0}return e}function EH(t){for(const e of Array.from(t.values()))if(Object.keys(e).length>1)return!0;return!1}function DH(t){for(const e of Array.from(t.values()))if(Object.keys(e).length===1)return!0;return!1}var pE;(function(t){function e(n){return typeof n=="string"}t.is=e})(pE||(pE={}));var zg;(function(t){function e(n){return typeof n=="string"}t.is=e})(zg||(zg={}));var gE;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(gE||(gE={}));var _f;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(_f||(_f={}));var He;(function(t){function e(r,i){return r===Number.MAX_VALUE&&(r=_f.MAX_VALUE),i===Number.MAX_VALUE&&(i=_f.MAX_VALUE),{line:r,character:i}}t.create=e;function n(r){let i=r;return z.objectLiteral(i)&&z.uinteger(i.line)&&z.uinteger(i.character)}t.is=n})(He||(He={}));var Le;(function(t){function e(r,i,s,a){if(z.uinteger(r)&&z.uinteger(i)&&z.uinteger(s)&&z.uinteger(a))return{start:He.create(r,i),end:He.create(s,a)};if(He.is(r)&&He.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${s}, ${a}]`)}t.create=e;function n(r){let i=r;return z.objectLiteral(i)&&He.is(i.start)&&He.is(i.end)}t.is=n})(Le||(Le={}));var Cf;(function(t){function e(r,i){return{uri:r,range:i}}t.create=e;function n(r){let i=r;return z.objectLiteral(i)&&Le.is(i.range)&&(z.string(i.uri)||z.undefined(i.uri))}t.is=n})(Cf||(Cf={}));var mE;(function(t){function e(r,i,s,a){return{targetUri:r,targetRange:i,targetSelectionRange:s,originSelectionRange:a}}t.create=e;function n(r){let i=r;return z.objectLiteral(i)&&Le.is(i.targetRange)&&z.string(i.targetUri)&&Le.is(i.targetSelectionRange)&&(Le.is(i.originSelectionRange)||z.undefined(i.originSelectionRange))}t.is=n})(mE||(mE={}));var Wg;(function(t){function e(r,i,s,a){return{red:r,green:i,blue:s,alpha:a}}t.create=e;function n(r){const i=r;return z.objectLiteral(i)&&z.numberRange(i.red,0,1)&&z.numberRange(i.green,0,1)&&z.numberRange(i.blue,0,1)&&z.numberRange(i.alpha,0,1)}t.is=n})(Wg||(Wg={}));var yE;(function(t){function e(r,i){return{range:r,color:i}}t.create=e;function n(r){const i=r;return z.objectLiteral(i)&&Le.is(i.range)&&Wg.is(i.color)}t.is=n})(yE||(yE={}));var vE;(function(t){function e(r,i,s){return{label:r,textEdit:i,additionalTextEdits:s}}t.create=e;function n(r){const i=r;return z.objectLiteral(i)&&z.string(i.label)&&(z.undefined(i.textEdit)||Ja.is(i))&&(z.undefined(i.additionalTextEdits)||z.typedArray(i.additionalTextEdits,Ja.is))}t.is=n})(vE||(vE={}));var bE;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(bE||(bE={}));var xE;(function(t){function e(r,i,s,a,o,u){const l={startLine:r,endLine:i};return z.defined(s)&&(l.startCharacter=s),z.defined(a)&&(l.endCharacter=a),z.defined(o)&&(l.kind=o),z.defined(u)&&(l.collapsedText=u),l}t.create=e;function n(r){const i=r;return z.objectLiteral(i)&&z.uinteger(i.startLine)&&z.uinteger(i.startLine)&&(z.undefined(i.startCharacter)||z.uinteger(i.startCharacter))&&(z.undefined(i.endCharacter)||z.uinteger(i.endCharacter))&&(z.undefined(i.kind)||z.string(i.kind))}t.is=n})(xE||(xE={}));var Hg;(function(t){function e(r,i){return{location:r,message:i}}t.create=e;function n(r){let i=r;return z.defined(i)&&Cf.is(i.location)&&z.string(i.message)}t.is=n})(Hg||(Hg={}));var EE;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(EE||(EE={}));var DE;(function(t){t.Unnecessary=1,t.Deprecated=2})(DE||(DE={}));var wE;(function(t){function e(n){const r=n;return z.objectLiteral(r)&&z.string(r.href)}t.is=e})(wE||(wE={}));var Af;(function(t){function e(r,i,s,a,o,u){let l={range:r,message:i};return z.defined(s)&&(l.severity=s),z.defined(a)&&(l.code=a),z.defined(o)&&(l.source=o),z.defined(u)&&(l.relatedInformation=u),l}t.create=e;function n(r){var i;let s=r;return z.defined(s)&&Le.is(s.range)&&z.string(s.message)&&(z.number(s.severity)||z.undefined(s.severity))&&(z.integer(s.code)||z.string(s.code)||z.undefined(s.code))&&(z.undefined(s.codeDescription)||z.string((i=s.codeDescription)===null||i===void 0?void 0:i.href))&&(z.string(s.source)||z.undefined(s.source))&&(z.undefined(s.relatedInformation)||z.typedArray(s.relatedInformation,Hg.is))}t.is=n})(Af||(Af={}));var Ka;(function(t){function e(r,i,...s){let a={title:r,command:i};return z.defined(s)&&s.length>0&&(a.arguments=s),a}t.create=e;function n(r){let i=r;return z.defined(i)&&z.string(i.title)&&z.string(i.command)}t.is=n})(Ka||(Ka={}));var Ja;(function(t){function e(s,a){return{range:s,newText:a}}t.replace=e;function n(s,a){return{range:{start:s,end:s},newText:a}}t.insert=n;function r(s){return{range:s,newText:""}}t.del=r;function i(s){const a=s;return z.objectLiteral(a)&&z.string(a.newText)&&Le.is(a.range)}t.is=i})(Ja||(Ja={}));var Yg;(function(t){function e(r,i,s){const a={label:r};return i!==void 0&&(a.needsConfirmation=i),s!==void 0&&(a.description=s),a}t.create=e;function n(r){const i=r;return z.objectLiteral(i)&&z.string(i.label)&&(z.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(z.string(i.description)||i.description===void 0)}t.is=n})(Yg||(Yg={}));var Za;(function(t){function e(n){const r=n;return z.string(r)}t.is=e})(Za||(Za={}));var _E;(function(t){function e(s,a,o){return{range:s,newText:a,annotationId:o}}t.replace=e;function n(s,a,o){return{range:{start:s,end:s},newText:a,annotationId:o}}t.insert=n;function r(s,a){return{range:s,newText:"",annotationId:a}}t.del=r;function i(s){const a=s;return Ja.is(a)&&(Yg.is(a.annotationId)||Za.is(a.annotationId))}t.is=i})(_E||(_E={}));var Vg;(function(t){function e(r,i){return{textDocument:r,edits:i}}t.create=e;function n(r){let i=r;return z.defined(i)&&Jg.is(i.textDocument)&&Array.isArray(i.edits)}t.is=n})(Vg||(Vg={}));var qg;(function(t){function e(r,i,s){let a={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}t.create=e;function n(r){let i=r;return i&&i.kind==="create"&&z.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||z.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||z.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Za.is(i.annotationId))}t.is=n})(qg||(qg={}));var Xg;(function(t){function e(r,i,s,a){let o={kind:"rename",oldUri:r,newUri:i};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(o.options=s),a!==void 0&&(o.annotationId=a),o}t.create=e;function n(r){let i=r;return i&&i.kind==="rename"&&z.string(i.oldUri)&&z.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||z.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||z.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Za.is(i.annotationId))}t.is=n})(Xg||(Xg={}));var jg;(function(t){function e(r,i,s){let a={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}t.create=e;function n(r){let i=r;return i&&i.kind==="delete"&&z.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||z.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||z.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Za.is(i.annotationId))}t.is=n})(jg||(jg={}));var Kg;(function(t){function e(n){let r=n;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(i=>z.string(i.kind)?qg.is(i)||Xg.is(i)||jg.is(i):Vg.is(i)))}t.is=e})(Kg||(Kg={}));var CE;(function(t){function e(r){return{uri:r}}t.create=e;function n(r){let i=r;return z.defined(i)&&z.string(i.uri)}t.is=n})(CE||(CE={}));var AE;(function(t){function e(r,i){return{uri:r,version:i}}t.create=e;function n(r){let i=r;return z.defined(i)&&z.string(i.uri)&&z.integer(i.version)}t.is=n})(AE||(AE={}));var Jg;(function(t){function e(r,i){return{uri:r,version:i}}t.create=e;function n(r){let i=r;return z.defined(i)&&z.string(i.uri)&&(i.version===null||z.integer(i.version))}t.is=n})(Jg||(Jg={}));var TE;(function(t){function e(r,i,s,a){return{uri:r,languageId:i,version:s,text:a}}t.create=e;function n(r){let i=r;return z.defined(i)&&z.string(i.uri)&&z.string(i.languageId)&&z.integer(i.version)&&z.string(i.text)}t.is=n})(TE||(TE={}));var Zg;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function e(n){const r=n;return r===t.PlainText||r===t.Markdown}t.is=e})(Zg||(Zg={}));var il;(function(t){function e(n){const r=n;return z.objectLiteral(n)&&Zg.is(r.kind)&&z.string(r.value)}t.is=e})(il||(il={}));var kE;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(kE||(kE={}));var SE;(function(t){t.PlainText=1,t.Snippet=2})(SE||(SE={}));var NE;(function(t){t.Deprecated=1})(NE||(NE={}));var FE;(function(t){function e(r,i,s){return{newText:r,insert:i,replace:s}}t.create=e;function n(r){const i=r;return i&&z.string(i.newText)&&Le.is(i.insert)&&Le.is(i.replace)}t.is=n})(FE||(FE={}));var RE;(function(t){t.asIs=1,t.adjustIndentation=2})(RE||(RE={}));var ME;(function(t){function e(n){const r=n;return r&&(z.string(r.detail)||r.detail===void 0)&&(z.string(r.description)||r.description===void 0)}t.is=e})(ME||(ME={}));var OE;(function(t){function e(n){return{label:n}}t.create=e})(OE||(OE={}));var IE;(function(t){function e(n,r){return{items:n||[],isIncomplete:!!r}}t.create=e})(IE||(IE={}));var Tf;(function(t){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=e;function n(r){const i=r;return z.string(i)||z.objectLiteral(i)&&z.string(i.language)&&z.string(i.value)}t.is=n})(Tf||(Tf={}));var LE;(function(t){function e(n){let r=n;return!!r&&z.objectLiteral(r)&&(il.is(r.contents)||Tf.is(r.contents)||z.typedArray(r.contents,Tf.is))&&(n.range===void 0||Le.is(n.range))}t.is=e})(LE||(LE={}));var PE;(function(t){function e(n,r){return r?{label:n,documentation:r}:{label:n}}t.create=e})(PE||(PE={}));var $E;(function(t){function e(n,r,...i){let s={label:n};return z.defined(r)&&(s.documentation=r),z.defined(i)?s.parameters=i:s.parameters=[],s}t.create=e})($E||($E={}));var BE;(function(t){t.Text=1,t.Read=2,t.Write=3})(BE||(BE={}));var UE;(function(t){function e(n,r){let i={range:n};return z.number(r)&&(i.kind=r),i}t.create=e})(UE||(UE={}));var GE;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(GE||(GE={}));var zE;(function(t){t.Deprecated=1})(zE||(zE={}));var WE;(function(t){function e(n,r,i,s,a){let o={name:n,kind:r,location:{uri:s,range:i}};return a&&(o.containerName=a),o}t.create=e})(WE||(WE={}));var HE;(function(t){function e(n,r,i,s){return s!==void 0?{name:n,kind:r,location:{uri:i,range:s}}:{name:n,kind:r,location:{uri:i}}}t.create=e})(HE||(HE={}));var YE;(function(t){function e(r,i,s,a,o,u){let l={name:r,detail:i,kind:s,range:a,selectionRange:o};return u!==void 0&&(l.children=u),l}t.create=e;function n(r){let i=r;return i&&z.string(i.name)&&z.number(i.kind)&&Le.is(i.range)&&Le.is(i.selectionRange)&&(i.detail===void 0||z.string(i.detail))&&(i.deprecated===void 0||z.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}t.is=n})(YE||(YE={}));var VE;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(VE||(VE={}));var kf;(function(t){t.Invoked=1,t.Automatic=2})(kf||(kf={}));var qE;(function(t){function e(r,i,s){let a={diagnostics:r};return i!=null&&(a.only=i),s!=null&&(a.triggerKind=s),a}t.create=e;function n(r){let i=r;return z.defined(i)&&z.typedArray(i.diagnostics,Af.is)&&(i.only===void 0||z.typedArray(i.only,z.string))&&(i.triggerKind===void 0||i.triggerKind===kf.Invoked||i.triggerKind===kf.Automatic)}t.is=n})(qE||(qE={}));var XE;(function(t){function e(r,i,s){let a={title:r},o=!0;return typeof i=="string"?(o=!1,a.kind=i):Ka.is(i)?a.command=i:a.edit=i,o&&s!==void 0&&(a.kind=s),a}t.create=e;function n(r){let i=r;return i&&z.string(i.title)&&(i.diagnostics===void 0||z.typedArray(i.diagnostics,Af.is))&&(i.kind===void 0||z.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Ka.is(i.command))&&(i.isPreferred===void 0||z.boolean(i.isPreferred))&&(i.edit===void 0||Kg.is(i.edit))}t.is=n})(XE||(XE={}));var jE;(function(t){function e(r,i){let s={range:r};return z.defined(i)&&(s.data=i),s}t.create=e;function n(r){let i=r;return z.defined(i)&&Le.is(i.range)&&(z.undefined(i.command)||Ka.is(i.command))}t.is=n})(jE||(jE={}));var KE;(function(t){function e(r,i){return{tabSize:r,insertSpaces:i}}t.create=e;function n(r){let i=r;return z.defined(i)&&z.uinteger(i.tabSize)&&z.boolean(i.insertSpaces)}t.is=n})(KE||(KE={}));var JE;(function(t){function e(r,i,s){return{range:r,target:i,data:s}}t.create=e;function n(r){let i=r;return z.defined(i)&&Le.is(i.range)&&(z.undefined(i.target)||z.string(i.target))}t.is=n})(JE||(JE={}));var ZE;(function(t){function e(r,i){return{range:r,parent:i}}t.create=e;function n(r){let i=r;return z.objectLiteral(i)&&Le.is(i.range)&&(i.parent===void 0||t.is(i.parent))}t.is=n})(ZE||(ZE={}));var QE;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(QE||(QE={}));var eD;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(eD||(eD={}));var tD;(function(t){function e(n){const r=n;return z.objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}t.is=e})(tD||(tD={}));var nD;(function(t){function e(r,i){return{range:r,text:i}}t.create=e;function n(r){const i=r;return i!=null&&Le.is(i.range)&&z.string(i.text)}t.is=n})(nD||(nD={}));var rD;(function(t){function e(r,i,s){return{range:r,variableName:i,caseSensitiveLookup:s}}t.create=e;function n(r){const i=r;return i!=null&&Le.is(i.range)&&z.boolean(i.caseSensitiveLookup)&&(z.string(i.variableName)||i.variableName===void 0)}t.is=n})(rD||(rD={}));var iD;(function(t){function e(r,i){return{range:r,expression:i}}t.create=e;function n(r){const i=r;return i!=null&&Le.is(i.range)&&(z.string(i.expression)||i.expression===void 0)}t.is=n})(iD||(iD={}));var sD;(function(t){function e(r,i){return{frameId:r,stoppedLocation:i}}t.create=e;function n(r){const i=r;return z.defined(i)&&Le.is(r.stoppedLocation)}t.is=n})(sD||(sD={}));var Qg;(function(t){t.Type=1,t.Parameter=2;function e(n){return n===1||n===2}t.is=e})(Qg||(Qg={}));var em;(function(t){function e(r){return{value:r}}t.create=e;function n(r){const i=r;return z.objectLiteral(i)&&(i.tooltip===void 0||z.string(i.tooltip)||il.is(i.tooltip))&&(i.location===void 0||Cf.is(i.location))&&(i.command===void 0||Ka.is(i.command))}t.is=n})(em||(em={}));var aD;(function(t){function e(r,i,s){const a={position:r,label:i};return s!==void 0&&(a.kind=s),a}t.create=e;function n(r){const i=r;return z.objectLiteral(i)&&He.is(i.position)&&(z.string(i.label)||z.typedArray(i.label,em.is))&&(i.kind===void 0||Qg.is(i.kind))&&i.textEdits===void 0||z.typedArray(i.textEdits,Ja.is)&&(i.tooltip===void 0||z.string(i.tooltip)||il.is(i.tooltip))&&(i.paddingLeft===void 0||z.boolean(i.paddingLeft))&&(i.paddingRight===void 0||z.boolean(i.paddingRight))}t.is=n})(aD||(aD={}));var oD;(function(t){function e(n){return{kind:"snippet",value:n}}t.createSnippet=e})(oD||(oD={}));var uD;(function(t){function e(n,r,i,s){return{insertText:n,filterText:r,range:i,command:s}}t.create=e})(uD||(uD={}));var lD;(function(t){function e(n){return{items:n}}t.create=e})(lD||(lD={}));var cD;(function(t){t.Invoked=0,t.Automatic=1})(cD||(cD={}));var hD;(function(t){function e(n,r){return{range:n,text:r}}t.create=e})(hD||(hD={}));var fD;(function(t){function e(n,r){return{triggerKind:n,selectedCompletionInfo:r}}t.create=e})(fD||(fD={}));var dD;(function(t){function e(n){const r=n;return z.objectLiteral(r)&&zg.is(r.uri)&&z.string(r.name)}t.is=e})(dD||(dD={}));var pD;(function(t){function e(s,a,o,u){return new wH(s,a,o,u)}t.create=e;function n(s){let a=s;return!!(z.defined(a)&&z.string(a.uri)&&(z.undefined(a.languageId)||z.string(a.languageId))&&z.uinteger(a.lineCount)&&z.func(a.getText)&&z.func(a.positionAt)&&z.func(a.offsetAt))}t.is=n;function r(s,a){let o=s.getText(),u=i(a,(c,h)=>{let d=c.range.start.line-h.range.start.line;return d===0?c.range.start.character-h.range.start.character:d}),l=o.length;for(let c=u.length-1;c>=0;c--){let h=u[c],d=s.offsetAt(h.range.start),f=s.offsetAt(h.range.end);if(f<=l)o=o.substring(0,d)+h.newText+o.substring(f,o.length);else throw new Error("Overlapping edit");l=d}return o}t.applyEdits=r;function i(s,a){if(s.length<=1)return s;const o=s.length/2|0,u=s.slice(0,o),l=s.slice(o);i(u,a),i(l,a);let c=0,h=0,d=0;for(;c<u.length&&h<l.length;)a(u[c],l[h])<=0?s[d++]=u[c++]:s[d++]=l[h++];for(;c<u.length;)s[d++]=u[c++];for(;h<l.length;)s[d++]=l[h++];return s}})(pD||(pD={}));let wH=class{constructor(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){this._content=e.text,this._version=n,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],n=this._content,r=!0;for(let i=0;i<n.length;i++){r&&(e.push(i),r=!1);let s=n.charAt(i);r=s==="\r"||s===`
`,s==="\r"&&i+1<n.length&&n.charAt(i+1)===`
`&&i++}r&&n.length>0&&e.push(n.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return He.create(0,e);for(;r<i;){let a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}let s=r-1;return He.create(s,e-n[s])}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let r=n[e.line],i=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}};var z;(function(t){const e=Object.prototype.toString;function n(f){return typeof f<"u"}t.defined=n;function r(f){return typeof f>"u"}t.undefined=r;function i(f){return f===!0||f===!1}t.boolean=i;function s(f){return e.call(f)==="[object String]"}t.string=s;function a(f){return e.call(f)==="[object Number]"}t.number=a;function o(f,p,g){return e.call(f)==="[object Number]"&&p<=f&&f<=g}t.numberRange=o;function u(f){return e.call(f)==="[object Number]"&&-2147483648<=f&&f<=2147483647}t.integer=u;function l(f){return e.call(f)==="[object Number]"&&0<=f&&f<=2147483647}t.uinteger=l;function c(f){return e.call(f)==="[object Function]"}t.func=c;function h(f){return f!==null&&typeof f=="object"}t.objectLiteral=h;function d(f,p){return Array.isArray(f)&&f.every(p)}t.typedArray=d})(z||(z={}));class _H{constructor(){this.nodeStack=[]}get current(){var e;return(e=this.nodeStack[this.nodeStack.length-1])!==null&&e!==void 0?e:this.rootNode}buildRootNode(e){return this.rootNode=new uk(e),this.rootNode.root=this.rootNode,this.nodeStack=[this.rootNode],this.rootNode}buildCompositeNode(e){const n=new fy;return n.grammarSource=e,n.root=this.rootNode,this.current.content.push(n),this.nodeStack.push(n),n}buildLeafNode(e,n){const r=new tm(e.startOffset,e.image.length,kg(e),e.tokenType,!n);return r.grammarSource=n,r.root=this.rootNode,this.current.content.push(r),r}removeNode(e){const n=e.container;if(n){const r=n.content.indexOf(e);r>=0&&n.content.splice(r,1)}}addHiddenNodes(e){const n=[];for(const s of e){const a=new tm(s.startOffset,s.image.length,kg(s),s.tokenType,!0);a.root=this.rootNode,n.push(a)}let r=this.current,i=!1;if(r.content.length>0){r.content.push(...n);return}for(;r.container;){const s=r.container.content.indexOf(r);if(s>0){r.container.content.splice(s,0,...n),i=!0;break}r=r.container}i||this.rootNode.content.unshift(...n)}construct(e){const n=this.current;typeof e.$type=="string"&&(this.current.astNode=e),e.$cstNode=n;const r=this.nodeStack.pop();(r==null?void 0:r.content.length)===0&&this.removeNode(r)}}class ok{get parent(){return this.container}get feature(){return this.grammarSource}get hidden(){return!1}get astNode(){var e,n;const r=typeof((e=this._astNode)===null||e===void 0?void 0:e.$type)=="string"?this._astNode:(n=this.container)===null||n===void 0?void 0:n.astNode;if(!r)throw new Error("This node has no associated AST element");return r}set astNode(e){this._astNode=e}get element(){return this.astNode}get text(){return this.root.fullText.substring(this.offset,this.end)}}class tm extends ok{get offset(){return this._offset}get length(){return this._length}get end(){return this._offset+this._length}get hidden(){return this._hidden}get tokenType(){return this._tokenType}get range(){return this._range}constructor(e,n,r,i,s=!1){super(),this._hidden=s,this._offset=e,this._tokenType=i,this._length=n,this._range=r}}class fy extends ok{constructor(){super(...arguments),this.content=new dy(this)}get children(){return this.content}get offset(){var e,n;return(n=(e=this.firstNonHiddenNode)===null||e===void 0?void 0:e.offset)!==null&&n!==void 0?n:0}get length(){return this.end-this.offset}get end(){var e,n;return(n=(e=this.lastNonHiddenNode)===null||e===void 0?void 0:e.end)!==null&&n!==void 0?n:0}get range(){const e=this.firstNonHiddenNode,n=this.lastNonHiddenNode;if(e&&n){if(this._rangeCache===void 0){const{range:r}=e,{range:i}=n;this._rangeCache={start:r.start,end:i.end.line<r.start.line?r.start:i.end}}return this._rangeCache}else return{start:He.create(0,0),end:He.create(0,0)}}get firstNonHiddenNode(){for(const e of this.content)if(!e.hidden)return e;return this.content[0]}get lastNonHiddenNode(){for(let e=this.content.length-1;e>=0;e--){const n=this.content[e];if(!n.hidden)return n}return this.content[this.content.length-1]}}class dy extends Array{constructor(e){super(),this.parent=e,Object.setPrototypeOf(this,dy.prototype)}push(...e){return this.addParents(e),super.push(...e)}unshift(...e){return this.addParents(e),super.unshift(...e)}splice(e,n,...r){return this.addParents(r),super.splice(e,n,...r)}addParents(e){for(const n of e)n.container=this.parent}}class uk extends fy{get text(){return this._text.substring(this.offset,this.end)}get fullText(){return this._text}constructor(e){super(),this._text="",this._text=e??""}}const nm=Symbol("Datatype");function u0(t){return t.$type===nm}const gD="",lk=t=>t.endsWith(gD)?t:t+gD;class ck{constructor(e){this._unorderedGroups=new Map,this.allRules=new Map,this.lexer=e.parser.Lexer;const n=this.lexer.definition,r=e.LanguageMetaData.mode==="production";this.wrapper=new SH(n,Object.assign(Object.assign({},e.parser.ParserConfig),{skipValidations:r,errorMessageProvider:e.parser.ParserErrorMessageProvider}))}alternatives(e,n){this.wrapper.wrapOr(e,n)}optional(e,n){this.wrapper.wrapOption(e,n)}many(e,n){this.wrapper.wrapMany(e,n)}atLeastOne(e,n){this.wrapper.wrapAtLeastOne(e,n)}getRule(e){return this.allRules.get(e)}isRecording(){return this.wrapper.IS_RECORDING}get unorderedGroups(){return this._unorderedGroups}getRuleStack(){return this.wrapper.RULE_STACK}finalize(){this.wrapper.wrapSelfAnalysis()}}class CH extends ck{get current(){return this.stack[this.stack.length-1]}constructor(e){super(e),this.nodeBuilder=new _H,this.stack=[],this.assignmentMap=new Map,this.linker=e.references.Linker,this.converter=e.parser.ValueConverter,this.astReflection=e.shared.AstReflection}rule(e,n){const r=this.computeRuleType(e),i=this.wrapper.DEFINE_RULE(lk(e.name),this.startImplementation(r,n).bind(this));return this.allRules.set(e.name,i),e.entry&&(this.mainRule=i),i}computeRuleType(e){if(!e.fragment){if(gT(e))return nm;{const n=Z1(e);return n??e.name}}}parse(e,n={}){this.nodeBuilder.buildRootNode(e);const r=this.lexerResult=this.lexer.tokenize(e);this.wrapper.input=r.tokens;const i=n.rule?this.allRules.get(n.rule):this.mainRule;if(!i)throw new Error(n.rule?`No rule found with name '${n.rule}'`:"No main rule available.");const s=i.call(this.wrapper,{});return this.nodeBuilder.addHiddenNodes(r.hidden),this.unorderedGroups.clear(),this.lexerResult=void 0,{value:s,lexerErrors:r.errors,lexerReport:r.report,parserErrors:this.wrapper.errors}}startImplementation(e,n){return r=>{const i=!this.isRecording()&&e!==void 0;if(i){const a={$type:e};this.stack.push(a),e===nm&&(a.value="")}let s;try{s=n(r)}catch{s=void 0}return s===void 0&&i&&(s=this.construct()),s}}extractHiddenTokens(e){const n=this.lexerResult.hidden;if(!n.length)return[];const r=e.startOffset;for(let i=0;i<n.length;i++)if(n[i].startOffset>r)return n.splice(0,i);return n.splice(0,n.length)}consume(e,n,r){const i=this.wrapper.wrapConsume(e,n);if(!this.isRecording()&&this.isValidToken(i)){const s=this.extractHiddenTokens(i);this.nodeBuilder.addHiddenNodes(s);const a=this.nodeBuilder.buildLeafNode(i,r),{assignment:o,isCrossRef:u}=this.getAssignment(r),l=this.current;if(o){const c=$s(r)?i.image:this.converter.convert(i.image,a);this.assign(o.operator,o.feature,c,a,u)}else if(u0(l)){let c=i.image;$s(r)||(c=this.converter.convert(c,a).toString()),l.value+=c}}}isValidToken(e){return!e.isInsertedInRecovery&&!isNaN(e.startOffset)&&typeof e.endOffset=="number"&&!isNaN(e.endOffset)}subrule(e,n,r,i,s){let a;!this.isRecording()&&!r&&(a=this.nodeBuilder.buildCompositeNode(i));const o=this.wrapper.wrapSubrule(e,n,s);!this.isRecording()&&a&&a.length>0&&this.performSubruleAssignment(o,i,a)}performSubruleAssignment(e,n,r){const{assignment:i,isCrossRef:s}=this.getAssignment(n);if(i)this.assign(i.operator,i.feature,e,r,s);else if(!i){const a=this.current;if(u0(a))a.value+=e.toString();else if(typeof e=="object"&&e){const u=this.assignWithoutOverride(e,a);this.stack.pop(),this.stack.push(u)}}}action(e,n){if(!this.isRecording()){let r=this.current;if(n.feature&&n.operator){r=this.construct(),this.nodeBuilder.removeNode(r.$cstNode),this.nodeBuilder.buildCompositeNode(n).content.push(r.$cstNode);const s={$type:e};this.stack.push(s),this.assign(n.operator,n.feature,r,r.$cstNode,!1)}else r.$type=e}}construct(){if(this.isRecording())return;const e=this.current;return sG(e),this.nodeBuilder.construct(e),this.stack.pop(),u0(e)?this.converter.convert(e.value,e.$cstNode):(aG(this.astReflection,e),e)}getAssignment(e){if(!this.assignmentMap.has(e)){const n=_d(e,Ps);this.assignmentMap.set(e,{assignment:n,isCrossRef:n?X1(n.terminal):!1})}return this.assignmentMap.get(e)}assign(e,n,r,i,s){const a=this.current;let o;switch(s&&typeof r=="string"?o=this.linker.buildReference(a,n,i,r):o=r,e){case"=":{a[n]=o;break}case"?=":{a[n]=!0;break}case"+=":Array.isArray(a[n])||(a[n]=[]),a[n].push(o)}}assignWithoutOverride(e,n){for(const[i,s]of Object.entries(n)){const a=e[i];a===void 0?e[i]=s:Array.isArray(a)&&Array.isArray(s)&&(s.push(...a),e[i]=s)}const r=e.$cstNode;return r&&(r.astNode=void 0,e.$cstNode=void 0),e}get definitionErrors(){return this.wrapper.definitionErrors}}class AH{buildMismatchTokenMessage(e){return va.buildMismatchTokenMessage(e)}buildNotAllInputParsedMessage(e){return va.buildNotAllInputParsedMessage(e)}buildNoViableAltMessage(e){return va.buildNoViableAltMessage(e)}buildEarlyExitMessage(e){return va.buildEarlyExitMessage(e)}}class hk extends AH{buildMismatchTokenMessage({expected:e,actual:n}){return`Expecting ${e.LABEL?"`"+e.LABEL+"`":e.name.endsWith(":KW")?`keyword '${e.name.substring(0,e.name.length-3)}'`:`token of type '${e.name}'`} but found \`${n.image}\`.`}buildNotAllInputParsedMessage({firstRedundant:e}){return`Expecting end of file but found \`${e.image}\`.`}}class TH extends ck{constructor(){super(...arguments),this.tokens=[],this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}action(){}construct(){}parse(e){this.resetState();const n=this.lexer.tokenize(e,{mode:"partial"});return this.tokens=n.tokens,this.wrapper.input=[...this.tokens],this.mainRule.call(this.wrapper,{}),this.unorderedGroups.clear(),{tokens:this.tokens,elementStack:[...this.lastElementStack],tokenIndex:this.nextTokenIndex}}rule(e,n){const r=this.wrapper.DEFINE_RULE(lk(e.name),this.startImplementation(n).bind(this));return this.allRules.set(e.name,r),e.entry&&(this.mainRule=r),r}resetState(){this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}startImplementation(e){return n=>{const r=this.keepStackSize();try{e(n)}finally{this.resetStackSize(r)}}}removeUnexpectedElements(){this.elementStack.splice(this.stackSize)}keepStackSize(){const e=this.elementStack.length;return this.stackSize=e,e}resetStackSize(e){this.removeUnexpectedElements(),this.stackSize=e}consume(e,n,r){this.wrapper.wrapConsume(e,n),this.isRecording()||(this.lastElementStack=[...this.elementStack,r],this.nextTokenIndex=this.currIdx+1)}subrule(e,n,r,i,s){this.before(i),this.wrapper.wrapSubrule(e,n,s),this.after(i)}before(e){this.isRecording()||this.elementStack.push(e)}after(e){if(!this.isRecording()){const n=this.elementStack.lastIndexOf(e);n>=0&&this.elementStack.splice(n)}}get currIdx(){return this.wrapper.currIdx}}const kH={recoveryEnabled:!0,nodeLocationTracking:"full",skipValidations:!0,errorMessageProvider:new hk};class SH extends LW{constructor(e,n){const r=n&&"maxLookahead"in n;super(e,Object.assign(Object.assign(Object.assign({},kH),{lookaheadStrategy:r?new ay({maxLookahead:n.maxLookahead}):new rH({logging:n.skipValidations?()=>{}:void 0})}),n))}get IS_RECORDING(){return this.RECORDING_PHASE}DEFINE_RULE(e,n){return this.RULE(e,n)}wrapSelfAnalysis(){this.performSelfAnalysis()}wrapConsume(e,n){return this.consume(e,n)}wrapSubrule(e,n,r){return this.subrule(e,n,{ARGS:[r]})}wrapOr(e,n){this.or(e,n)}wrapOption(e,n){this.option(e,n)}wrapMany(e,n){this.many(e,n)}wrapAtLeastOne(e,n){this.atLeastOne(e,n)}}function fk(t,e,n){return NH({parser:e,tokens:n,ruleNames:new Map},t),e}function NH(t,e){const n=cT(e,!1),r=Zt(e.rules).filter(hr).filter(i=>n.has(i));for(const i of r){const s=Object.assign(Object.assign({},t),{consume:1,optional:1,subrule:1,many:1,or:1});t.parser.rule(i,Gs(s,i.definition))}}function Gs(t,e,n=!1){let r;if($s(e))r=PH(t,e);else if(wd(e))r=FH(t,e);else if(Ps(e))r=Gs(t,e.terminal);else if(X1(e))r=dk(t,e);else if(Bs(e))r=RH(t,e);else if(iT(e))r=OH(t,e);else if(sT(e))r=IH(t,e);else if(j1(e))r=LH(t,e);else if(JU(e)){const i=t.consume++;r=()=>t.parser.consume(i,Ki,e)}else throw new eT(e.$cstNode,`Unexpected element type: ${e.$type}`);return pk(t,n?void 0:Sf(e),r,e.cardinality)}function FH(t,e){const n=Q1(e);return()=>t.parser.action(n,e)}function RH(t,e){const n=e.rule.ref;if(hr(n)){const r=t.subrule++,i=n.fragment,s=e.arguments.length>0?MH(n,e.arguments):()=>({});return a=>t.parser.subrule(r,gk(t,n),i,e,s(a))}else if(Ks(n)){const r=t.consume++,i=rm(t,n.name);return()=>t.parser.consume(r,i,e)}else if(n)Cl();else throw new eT(e.$cstNode,`Undefined rule: ${e.rule.$refText}`)}function MH(t,e){const n=e.map(r=>pi(r.value));return r=>{const i={};for(let s=0;s<n.length;s++){const a=t.parameters[s],o=n[s];i[a.name]=o(r)}return i}}function pi(t){if(YU(t)){const e=pi(t.left),n=pi(t.right);return r=>e(r)||n(r)}else if(HU(t)){const e=pi(t.left),n=pi(t.right);return r=>e(r)&&n(r)}else if(VU(t)){const e=pi(t.value);return n=>!e(n)}else if(qU(t)){const e=t.parameter.ref.name;return n=>n!==void 0&&n[e]===!0}else if(WU(t)){const e=!!t.true;return()=>e}Cl()}function OH(t,e){if(e.elements.length===1)return Gs(t,e.elements[0]);{const n=[];for(const i of e.elements){const s={ALT:Gs(t,i,!0)},a=Sf(i);a&&(s.GATE=pi(a)),n.push(s)}const r=t.or++;return i=>t.parser.alternatives(r,n.map(s=>{const a={ALT:()=>s.ALT(i)},o=s.GATE;return o&&(a.GATE=()=>o(i)),a}))}}function IH(t,e){if(e.elements.length===1)return Gs(t,e.elements[0]);const n=[];for(const o of e.elements){const u={ALT:Gs(t,o,!0)},l=Sf(o);l&&(u.GATE=pi(l)),n.push(u)}const r=t.or++,i=(o,u)=>{const l=u.getRuleStack().join("-");return`uGroup_${o}_${l}`},s=o=>t.parser.alternatives(r,n.map((u,l)=>{const c={ALT:()=>!0},h=t.parser;c.ALT=()=>{if(u.ALT(o),!h.isRecording()){const f=i(r,h);h.unorderedGroups.get(f)||h.unorderedGroups.set(f,[]);const p=h.unorderedGroups.get(f);typeof(p==null?void 0:p[l])>"u"&&(p[l]=!0)}};const d=u.GATE;return d?c.GATE=()=>d(o):c.GATE=()=>{const f=h.unorderedGroups.get(i(r,h));return!(f!=null&&f[l])},c})),a=pk(t,Sf(e),s,"*");return o=>{a(o),t.parser.isRecording()||t.parser.unorderedGroups.delete(i(r,t.parser))}}function LH(t,e){const n=e.elements.map(r=>Gs(t,r));return r=>n.forEach(i=>i(r))}function Sf(t){if(j1(t))return t.guardCondition}function dk(t,e,n=e.terminal){if(n)if(Bs(n)&&hr(n.rule.ref)){const r=n.rule.ref,i=t.subrule++;return s=>t.parser.subrule(i,gk(t,r),!1,e,s)}else if(Bs(n)&&Ks(n.rule.ref)){const r=t.consume++,i=rm(t,n.rule.ref.name);return()=>t.parser.consume(r,i,e)}else if($s(n)){const r=t.consume++,i=rm(t,n.value);return()=>t.parser.consume(r,i,e)}else throw new Error("Could not build cross reference parser");else{if(!e.type.ref)throw new Error("Could not resolve reference to type: "+e.type.$refText);const r=dT(e.type.ref),i=r==null?void 0:r.terminal;if(!i)throw new Error("Could not find name assignment for type: "+Q1(e.type.ref));return dk(t,e,i)}}function PH(t,e){const n=t.consume++,r=t.tokens[e.value];if(!r)throw new Error("Could not find token for keyword: "+e.value);return()=>t.parser.consume(n,r,e)}function pk(t,e,n,r){const i=e&&pi(e);if(!r)if(i){const s=t.or++;return a=>t.parser.alternatives(s,[{ALT:()=>n(a),GATE:()=>i(a)},{ALT:cE(),GATE:()=>!i(a)}])}else return n;if(r==="*"){const s=t.many++;return a=>t.parser.many(s,{DEF:()=>n(a),GATE:i?()=>i(a):void 0})}else if(r==="+"){const s=t.many++;if(i){const a=t.or++;return o=>t.parser.alternatives(a,[{ALT:()=>t.parser.atLeastOne(s,{DEF:()=>n(o)}),GATE:()=>i(o)},{ALT:cE(),GATE:()=>!i(o)}])}else return a=>t.parser.atLeastOne(s,{DEF:()=>n(a)})}else if(r==="?"){const s=t.optional++;return a=>t.parser.optional(s,{DEF:()=>n(a),GATE:i?()=>i(a):void 0})}else Cl()}function gk(t,e){const n=$H(t,e),r=t.parser.getRule(n);if(!r)throw new Error(`Rule "${n}" not found."`);return r}function $H(t,e){if(hr(e))return e.name;if(t.ruleNames.has(e))return t.ruleNames.get(e);{let n=e,r=n.$container,i=e.$type;for(;!hr(r);)(j1(r)||iT(r)||sT(r))&&(i=r.elements.indexOf(n).toString()+":"+i),n=r,r=r.$container;return i=r.name+":"+i,t.ruleNames.set(e,i),i}}function rm(t,e){const n=t.tokens[e];if(!n)throw new Error(`Token "${e}" not found."`);return n}function BH(t){const e=t.Grammar,n=t.parser.Lexer,r=new TH(t);return fk(e,r,n.definition),r.finalize(),r}function UH(t){const e=GH(t);return e.finalize(),e}function GH(t){const e=t.Grammar,n=t.parser.Lexer,r=new CH(t);return fk(e,r,n.definition)}class zH{constructor(){this.diagnostics=[]}buildTokens(e,n){const r=Zt(cT(e,!1)),i=this.buildTerminalTokens(r),s=this.buildKeywordTokens(r,i,n);return i.forEach(a=>{const o=a.PATTERN;typeof o=="object"&&o&&"test"in o&&Ng(o)?s.unshift(a):s.push(a)}),s}flushLexingReport(e){return{diagnostics:this.popDiagnostics()}}popDiagnostics(){const e=[...this.diagnostics];return this.diagnostics=[],e}buildTerminalTokens(e){return e.filter(Ks).filter(n=>!n.fragment).map(n=>this.buildTerminalToken(n)).toArray()}buildTerminalToken(e){const n=ey(e),r=this.requiresCustomPattern(n)?this.regexPatternFunction(n):n,i={name:e.name,PATTERN:r};return typeof r=="function"&&(i.LINE_BREAKS=!0),e.hidden&&(i.GROUP=Ng(n)?Sn.SKIPPED:"hidden"),i}requiresCustomPattern(e){return e.flags.includes("u")||e.flags.includes("s")?!0:!!(e.source.includes("?<=")||e.source.includes("?<!"))}regexPatternFunction(e){const n=new RegExp(e,e.flags+"y");return(r,i)=>(n.lastIndex=i,n.exec(r))}buildKeywordTokens(e,n,r){return e.filter(hr).flatMap(i=>Al(i).filter($s)).distinct(i=>i.value).toArray().sort((i,s)=>s.value.length-i.value.length).map(i=>this.buildKeywordToken(i,n,!!(r!=null&&r.caseInsensitive)))}buildKeywordToken(e,n,r){const i=this.buildKeywordPattern(e,r),s={name:e.value,PATTERN:i,LONGER_ALT:this.findLongerAlt(e,n)};return typeof i=="function"&&(s.LINE_BREAKS=!0),s}buildKeywordPattern(e,n){return n?new RegExp(gG(e.value)):e.value}findLongerAlt(e,n){return n.reduce((r,i)=>{const s=i==null?void 0:i.PATTERN;return s!=null&&s.source&&mG("^"+s.source+"$",e.value)&&r.push(i),r},[])}}class WH{convert(e,n){let r=n.grammarSource;if(X1(r)&&(r=xG(r)),Bs(r)){const i=r.rule.ref;if(!i)throw new Error("This cst node was not parsed by a rule.");return this.runConverter(i,e,n)}return e}runConverter(e,n,r){var i;switch(e.name.toUpperCase()){case"INT":return fi.convertInt(n);case"STRING":return fi.convertString(n);case"ID":return fi.convertID(n)}switch((i=TG(e))===null||i===void 0?void 0:i.toLowerCase()){case"number":return fi.convertNumber(n);case"boolean":return fi.convertBoolean(n);case"bigint":return fi.convertBigint(n);case"date":return fi.convertDate(n);default:return n}}}var fi;(function(t){function e(l){let c="";for(let h=1;h<l.length-1;h++){const d=l.charAt(h);if(d==="\\"){const f=l.charAt(++h);c+=n(f)}else c+=d}return c}t.convertString=e;function n(l){switch(l){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"0":return"\0";default:return l}}function r(l){return l.charAt(0)==="^"?l.substring(1):l}t.convertID=r;function i(l){return parseInt(l)}t.convertInt=i;function s(l){return BigInt(l)}t.convertBigint=s;function a(l){return new Date(l)}t.convertDate=a;function o(l){return Number(l)}t.convertNumber=o;function u(l){return l.toLowerCase()==="true"}t.convertBoolean=u})(fi||(fi={}));var ls={},Cc={},mD;function mk(){if(mD)return Cc;mD=1,Object.defineProperty(Cc,"__esModule",{value:!0});let t;function e(){if(t===void 0)throw new Error("No runtime abstraction layer installed");return t}return function(n){function r(i){if(i===void 0)throw new Error("No runtime abstraction layer provided");t=i}n.install=r}(e||(e={})),Cc.default=e,Cc}var Ht={},yD;function HH(){if(yD)return Ht;yD=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.stringArray=Ht.array=Ht.func=Ht.error=Ht.number=Ht.string=Ht.boolean=void 0;function t(o){return o===!0||o===!1}Ht.boolean=t;function e(o){return typeof o=="string"||o instanceof String}Ht.string=e;function n(o){return typeof o=="number"||o instanceof Number}Ht.number=n;function r(o){return o instanceof Error}Ht.error=r;function i(o){return typeof o=="function"}Ht.func=i;function s(o){return Array.isArray(o)}Ht.array=s;function a(o){return s(o)&&o.every(u=>e(u))}return Ht.stringArray=a,Ht}var cs={},vD;function yk(){if(vD)return cs;vD=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.Emitter=cs.Event=void 0;const t=mk();var e;(function(i){const s={dispose(){}};i.None=function(){return s}})(e||(cs.Event=e={}));class n{add(s,a=null,o){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(s),this._contexts.push(a),Array.isArray(o)&&o.push({dispose:()=>this.remove(s,a)})}remove(s,a=null){if(!this._callbacks)return;let o=!1;for(let u=0,l=this._callbacks.length;u<l;u++)if(this._callbacks[u]===s)if(this._contexts[u]===a){this._callbacks.splice(u,1),this._contexts.splice(u,1);return}else o=!0;if(o)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...s){if(!this._callbacks)return[];const a=[],o=this._callbacks.slice(0),u=this._contexts.slice(0);for(let l=0,c=o.length;l<c;l++)try{a.push(o[l].apply(u[l],s))}catch(h){(0,t.default)().console.error(h)}return a}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class r{constructor(s){this._options=s}get event(){return this._event||(this._event=(s,a,o)=>{this._callbacks||(this._callbacks=new n),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(s,a);const u={dispose:()=>{this._callbacks&&(this._callbacks.remove(s,a),u.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(o)&&o.push(u),u}),this._event}fire(s){this._callbacks&&this._callbacks.invoke.call(this._callbacks,s)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return cs.Emitter=r,r._noop=function(){},cs}var bD;function YH(){if(bD)return ls;bD=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.CancellationTokenSource=ls.CancellationToken=void 0;const t=mk(),e=HH(),n=yk();var r;(function(o){o.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:n.Event.None}),o.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:n.Event.None});function u(l){const c=l;return c&&(c===o.None||c===o.Cancelled||e.boolean(c.isCancellationRequested)&&!!c.onCancellationRequested)}o.is=u})(r||(ls.CancellationToken=r={}));const i=Object.freeze(function(o,u){const l=(0,t.default)().timer.setTimeout(o.bind(u),0);return{dispose(){l.dispose()}}});class s{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?i:(this._emitter||(this._emitter=new n.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class a{get token(){return this._token||(this._token=new s),this._token}cancel(){this._token?this._token.cancel():this._token=r.Cancelled}dispose(){this._token?this._token instanceof s&&this._token.dispose():this._token=r.None}}return ls.CancellationTokenSource=a,ls}var ft=YH();function VH(){return new Promise(t=>{typeof setImmediate>"u"?setTimeout(t,0):setImmediate(t)})}let lh=0,qH=10;function XH(){return lh=performance.now(),new ft.CancellationTokenSource}const Nf=Symbol("OperationCancelled");function Od(t){return t===Nf}async function Hn(t){if(t===ft.CancellationToken.None)return;const e=performance.now();if(e-lh>=qH&&(lh=e,await VH(),lh=performance.now()),t.isCancellationRequested)throw Nf}class py{constructor(){this.promise=new Promise((e,n)=>{this.resolve=r=>(e(r),this),this.reject=r=>(n(r),this)})}}class sl{constructor(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){const n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){for(const r of e)if(sl.isIncremental(r)){const i=bk(r.range),s=this.offsetAt(i.start),a=this.offsetAt(i.end);this._content=this._content.substring(0,s)+r.text+this._content.substring(a,this._content.length);const o=Math.max(i.start.line,0),u=Math.max(i.end.line,0);let l=this._lineOffsets;const c=xD(r.text,!1,s);if(u-o===c.length)for(let d=0,f=c.length;d<f;d++)l[d+o+1]=c[d];else c.length<1e4?l.splice(o+1,u-o,...c):this._lineOffsets=l=l.slice(0,o+1).concat(c,l.slice(u+1));const h=r.text.length-(a-s);if(h!==0)for(let d=o+1+c.length,f=l.length;d<f;d++)l[d]=l[d]+h}else if(sl.isFull(r))this._content=r.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=xD(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const n=this.getLineOffsets();let r=0,i=n.length;if(i===0)return{line:0,character:e};for(;r<i;){const a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}const s=r-1;return e=this.ensureBeforeEOL(e,n[s]),{line:s,character:e-n[s]}}offsetAt(e){const n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;const r=n[e.line];if(e.character<=0)return r;const i=e.line+1<n.length?n[e.line+1]:this._content.length,s=Math.min(r+e.character,i);return this.ensureBeforeEOL(s,r)}ensureBeforeEOL(e,n){for(;e>n&&vk(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){const n=e;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||typeof n.rangeLength=="number")}static isFull(e){const n=e;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}}var im;(function(t){function e(i,s,a,o){return new sl(i,s,a,o)}t.create=e;function n(i,s,a){if(i instanceof sl)return i.update(s,a),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=n;function r(i,s){const a=i.getText(),o=sm(s.map(jH),(c,h)=>{const d=c.range.start.line-h.range.start.line;return d===0?c.range.start.character-h.range.start.character:d});let u=0;const l=[];for(const c of o){const h=i.offsetAt(c.range.start);if(h<u)throw new Error("Overlapping edit");h>u&&l.push(a.substring(u,h)),c.newText.length&&l.push(c.newText),u=i.offsetAt(c.range.end)}return l.push(a.substr(u)),l.join("")}t.applyEdits=r})(im||(im={}));function sm(t,e){if(t.length<=1)return t;const n=t.length/2|0,r=t.slice(0,n),i=t.slice(n);sm(r,e),sm(i,e);let s=0,a=0,o=0;for(;s<r.length&&a<i.length;)e(r[s],i[a])<=0?t[o++]=r[s++]:t[o++]=i[a++];for(;s<r.length;)t[o++]=r[s++];for(;a<i.length;)t[o++]=i[a++];return t}function xD(t,e,n=0){const r=e?[n]:[];for(let i=0;i<t.length;i++){const s=t.charCodeAt(i);vk(s)&&(s===13&&i+1<t.length&&t.charCodeAt(i+1)===10&&i++,r.push(n+i+1))}return r}function vk(t){return t===13||t===10}function bk(t){const e=t.start,n=t.end;return e.line>n.line||e.line===n.line&&e.character>n.character?{start:n,end:e}:t}function jH(t){const e=bk(t.range);return e!==t.range?{newText:t.newText,range:e}:t}var xk;(()=>{var t={470:i=>{function s(u){if(typeof u!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(u))}function a(u,l){for(var c,h="",d=0,f=-1,p=0,g=0;g<=u.length;++g){if(g<u.length)c=u.charCodeAt(g);else{if(c===47)break;c=47}if(c===47){if(!(f===g-1||p===1))if(f!==g-1&&p===2){if(h.length<2||d!==2||h.charCodeAt(h.length-1)!==46||h.charCodeAt(h.length-2)!==46){if(h.length>2){var m=h.lastIndexOf("/");if(m!==h.length-1){m===-1?(h="",d=0):d=(h=h.slice(0,m)).length-1-h.lastIndexOf("/"),f=g,p=0;continue}}else if(h.length===2||h.length===1){h="",d=0,f=g,p=0;continue}}l&&(h.length>0?h+="/..":h="..",d=2)}else h.length>0?h+="/"+u.slice(f+1,g):h=u.slice(f+1,g),d=g-f-1;f=g,p=0}else c===46&&p!==-1?++p:p=-1}return h}var o={resolve:function(){for(var u,l="",c=!1,h=arguments.length-1;h>=-1&&!c;h--){var d;h>=0?d=arguments[h]:(u===void 0&&(u=process.cwd()),d=u),s(d),d.length!==0&&(l=d+"/"+l,c=d.charCodeAt(0)===47)}return l=a(l,!c),c?l.length>0?"/"+l:"/":l.length>0?l:"."},normalize:function(u){if(s(u),u.length===0)return".";var l=u.charCodeAt(0)===47,c=u.charCodeAt(u.length-1)===47;return(u=a(u,!l)).length!==0||l||(u="."),u.length>0&&c&&(u+="/"),l?"/"+u:u},isAbsolute:function(u){return s(u),u.length>0&&u.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var u,l=0;l<arguments.length;++l){var c=arguments[l];s(c),c.length>0&&(u===void 0?u=c:u+="/"+c)}return u===void 0?".":o.normalize(u)},relative:function(u,l){if(s(u),s(l),u===l||(u=o.resolve(u))===(l=o.resolve(l)))return"";for(var c=1;c<u.length&&u.charCodeAt(c)===47;++c);for(var h=u.length,d=h-c,f=1;f<l.length&&l.charCodeAt(f)===47;++f);for(var p=l.length-f,g=d<p?d:p,m=-1,y=0;y<=g;++y){if(y===g){if(p>g){if(l.charCodeAt(f+y)===47)return l.slice(f+y+1);if(y===0)return l.slice(f+y)}else d>g&&(u.charCodeAt(c+y)===47?m=y:y===0&&(m=0));break}var b=u.charCodeAt(c+y);if(b!==l.charCodeAt(f+y))break;b===47&&(m=y)}var v="";for(y=c+m+1;y<=h;++y)y!==h&&u.charCodeAt(y)!==47||(v.length===0?v+="..":v+="/..");return v.length>0?v+l.slice(f+m):(f+=m,l.charCodeAt(f)===47&&++f,l.slice(f))},_makeLong:function(u){return u},dirname:function(u){if(s(u),u.length===0)return".";for(var l=u.charCodeAt(0),c=l===47,h=-1,d=!0,f=u.length-1;f>=1;--f)if((l=u.charCodeAt(f))===47){if(!d){h=f;break}}else d=!1;return h===-1?c?"/":".":c&&h===1?"//":u.slice(0,h)},basename:function(u,l){if(l!==void 0&&typeof l!="string")throw new TypeError('"ext" argument must be a string');s(u);var c,h=0,d=-1,f=!0;if(l!==void 0&&l.length>0&&l.length<=u.length){if(l.length===u.length&&l===u)return"";var p=l.length-1,g=-1;for(c=u.length-1;c>=0;--c){var m=u.charCodeAt(c);if(m===47){if(!f){h=c+1;break}}else g===-1&&(f=!1,g=c+1),p>=0&&(m===l.charCodeAt(p)?--p==-1&&(d=c):(p=-1,d=g))}return h===d?d=g:d===-1&&(d=u.length),u.slice(h,d)}for(c=u.length-1;c>=0;--c)if(u.charCodeAt(c)===47){if(!f){h=c+1;break}}else d===-1&&(f=!1,d=c+1);return d===-1?"":u.slice(h,d)},extname:function(u){s(u);for(var l=-1,c=0,h=-1,d=!0,f=0,p=u.length-1;p>=0;--p){var g=u.charCodeAt(p);if(g!==47)h===-1&&(d=!1,h=p+1),g===46?l===-1?l=p:f!==1&&(f=1):l!==-1&&(f=-1);else if(!d){c=p+1;break}}return l===-1||h===-1||f===0||f===1&&l===h-1&&l===c+1?"":u.slice(l,h)},format:function(u){if(u===null||typeof u!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof u);return function(l,c){var h=c.dir||c.root,d=c.base||(c.name||"")+(c.ext||"");return h?h===c.root?h+d:h+"/"+d:d}(0,u)},parse:function(u){s(u);var l={root:"",dir:"",base:"",ext:"",name:""};if(u.length===0)return l;var c,h=u.charCodeAt(0),d=h===47;d?(l.root="/",c=1):c=0;for(var f=-1,p=0,g=-1,m=!0,y=u.length-1,b=0;y>=c;--y)if((h=u.charCodeAt(y))!==47)g===-1&&(m=!1,g=y+1),h===46?f===-1?f=y:b!==1&&(b=1):f!==-1&&(b=-1);else if(!m){p=y+1;break}return f===-1||g===-1||b===0||b===1&&f===g-1&&f===p+1?g!==-1&&(l.base=l.name=p===0&&d?u.slice(1,g):u.slice(p,g)):(p===0&&d?(l.name=u.slice(1,f),l.base=u.slice(1,g)):(l.name=u.slice(p,f),l.base=u.slice(p,g)),l.ext=u.slice(f,g)),p>0?l.dir=u.slice(0,p-1):d&&(l.dir="/"),l},sep:"/",delimiter:":",win32:null,posix:null};o.posix=o,i.exports=o}},e={};function n(i){var s=e[i];if(s!==void 0)return s.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,n),a.exports}n.d=(i,s)=>{for(var a in s)n.o(s,a)&&!n.o(i,a)&&Object.defineProperty(i,a,{enumerable:!0,get:s[a]})},n.o=(i,s)=>Object.prototype.hasOwnProperty.call(i,s),n.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var r={};(()=>{let i;n.r(r),n.d(r,{URI:()=>d,Utils:()=>M}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);const s=/^\w[\w\d+.-]*$/,a=/^\//,o=/^\/\//;function u(S,R){if(!S.scheme&&R)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${S.authority}", path: "${S.path}", query: "${S.query}", fragment: "${S.fragment}"}`);if(S.scheme&&!s.test(S.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(S.path){if(S.authority){if(!a.test(S.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(o.test(S.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}const l="",c="/",h=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class d{constructor(R,I,x,_,C,A=!1){Oe(this,"scheme");Oe(this,"authority");Oe(this,"path");Oe(this,"query");Oe(this,"fragment");typeof R=="object"?(this.scheme=R.scheme||l,this.authority=R.authority||l,this.path=R.path||l,this.query=R.query||l,this.fragment=R.fragment||l):(this.scheme=function(T,O){return T||O?T:"file"}(R,A),this.authority=I||l,this.path=function(T,O){switch(T){case"https":case"http":case"file":O?O[0]!==c&&(O=c+O):O=c}return O}(this.scheme,x||l),this.query=_||l,this.fragment=C||l,u(this,A))}static isUri(R){return R instanceof d||!!R&&typeof R.authority=="string"&&typeof R.fragment=="string"&&typeof R.path=="string"&&typeof R.query=="string"&&typeof R.scheme=="string"&&typeof R.fsPath=="string"&&typeof R.with=="function"&&typeof R.toString=="function"}get fsPath(){return b(this)}with(R){if(!R)return this;let{scheme:I,authority:x,path:_,query:C,fragment:A}=R;return I===void 0?I=this.scheme:I===null&&(I=l),x===void 0?x=this.authority:x===null&&(x=l),_===void 0?_=this.path:_===null&&(_=l),C===void 0?C=this.query:C===null&&(C=l),A===void 0?A=this.fragment:A===null&&(A=l),I===this.scheme&&x===this.authority&&_===this.path&&C===this.query&&A===this.fragment?this:new p(I,x,_,C,A)}static parse(R,I=!1){const x=h.exec(R);return x?new p(x[2]||l,N(x[4]||l),N(x[5]||l),N(x[7]||l),N(x[9]||l),I):new p(l,l,l,l,l)}static file(R){let I=l;if(i&&(R=R.replace(/\\/g,c)),R[0]===c&&R[1]===c){const x=R.indexOf(c,2);x===-1?(I=R.substring(2),R=c):(I=R.substring(2,x),R=R.substring(x)||c)}return new p("file",I,R,l,l)}static from(R){const I=new p(R.scheme,R.authority,R.path,R.query,R.fragment);return u(I,!0),I}toString(R=!1){return v(this,R)}toJSON(){return this}static revive(R){if(R){if(R instanceof d)return R;{const I=new p(R);return I._formatted=R.external,I._fsPath=R._sep===f?R.fsPath:null,I}}return R}}const f=i?1:void 0;class p extends d{constructor(){super(...arguments);Oe(this,"_formatted",null);Oe(this,"_fsPath",null)}get fsPath(){return this._fsPath||(this._fsPath=b(this)),this._fsPath}toString(I=!1){return I?v(this,!0):(this._formatted||(this._formatted=v(this,!1)),this._formatted)}toJSON(){const I={$mid:1};return this._fsPath&&(I.fsPath=this._fsPath,I._sep=f),this._formatted&&(I.external=this._formatted),this.path&&(I.path=this.path),this.scheme&&(I.scheme=this.scheme),this.authority&&(I.authority=this.authority),this.query&&(I.query=this.query),this.fragment&&(I.fragment=this.fragment),I}}const g={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function m(S,R,I){let x,_=-1;for(let C=0;C<S.length;C++){const A=S.charCodeAt(C);if(A>=97&&A<=122||A>=65&&A<=90||A>=48&&A<=57||A===45||A===46||A===95||A===126||R&&A===47||I&&A===91||I&&A===93||I&&A===58)_!==-1&&(x+=encodeURIComponent(S.substring(_,C)),_=-1),x!==void 0&&(x+=S.charAt(C));else{x===void 0&&(x=S.substr(0,C));const T=g[A];T!==void 0?(_!==-1&&(x+=encodeURIComponent(S.substring(_,C)),_=-1),x+=T):_===-1&&(_=C)}}return _!==-1&&(x+=encodeURIComponent(S.substring(_))),x!==void 0?x:S}function y(S){let R;for(let I=0;I<S.length;I++){const x=S.charCodeAt(I);x===35||x===63?(R===void 0&&(R=S.substr(0,I)),R+=g[x]):R!==void 0&&(R+=S[I])}return R!==void 0?R:S}function b(S,R){let I;return I=S.authority&&S.path.length>1&&S.scheme==="file"?`//${S.authority}${S.path}`:S.path.charCodeAt(0)===47&&(S.path.charCodeAt(1)>=65&&S.path.charCodeAt(1)<=90||S.path.charCodeAt(1)>=97&&S.path.charCodeAt(1)<=122)&&S.path.charCodeAt(2)===58?S.path[1].toLowerCase()+S.path.substr(2):S.path,i&&(I=I.replace(/\//g,"\\")),I}function v(S,R){const I=R?y:m;let x="",{scheme:_,authority:C,path:A,query:T,fragment:O}=S;if(_&&(x+=_,x+=":"),(C||_==="file")&&(x+=c,x+=c),C){let L=C.indexOf("@");if(L!==-1){const P=C.substr(0,L);C=C.substr(L+1),L=P.lastIndexOf(":"),L===-1?x+=I(P,!1,!1):(x+=I(P.substr(0,L),!1,!1),x+=":",x+=I(P.substr(L+1),!1,!0)),x+="@"}C=C.toLowerCase(),L=C.lastIndexOf(":"),L===-1?x+=I(C,!1,!0):(x+=I(C.substr(0,L),!1,!0),x+=C.substr(L))}if(A){if(A.length>=3&&A.charCodeAt(0)===47&&A.charCodeAt(2)===58){const L=A.charCodeAt(1);L>=65&&L<=90&&(A=`/${String.fromCharCode(L+32)}:${A.substr(3)}`)}else if(A.length>=2&&A.charCodeAt(1)===58){const L=A.charCodeAt(0);L>=65&&L<=90&&(A=`${String.fromCharCode(L+32)}:${A.substr(2)}`)}x+=I(A,!0,!1)}return T&&(x+="?",x+=I(T,!1,!1)),O&&(x+="#",x+=R?O:m(O,!1,!1)),x}function E(S){try{return decodeURIComponent(S)}catch{return S.length>3?S.substr(0,3)+E(S.substr(3)):S}}const w=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function N(S){return S.match(w)?S.replace(w,R=>E(R)):S}var D=n(470);const k=D.posix||D,F="/";var M;(function(S){S.joinPath=function(R,...I){return R.with({path:k.join(R.path,...I)})},S.resolvePath=function(R,...I){let x=R.path,_=!1;x[0]!==F&&(x=F+x,_=!0);let C=k.resolve(x,...I);return _&&C[0]===F&&!R.authority&&(C=C.substring(1)),R.with({path:C})},S.dirname=function(R){if(R.path.length===0||R.path===F)return R;let I=k.dirname(R.path);return I.length===1&&I.charCodeAt(0)===46&&(I=""),R.with({path:I})},S.basename=function(R){return k.basename(R.path)},S.extname=function(R){return k.extname(R.path)}})(M||(M={}))})(),xk=r})();const{URI:zs,Utils:No}=xk;var Zi;(function(t){t.basename=No.basename,t.dirname=No.dirname,t.extname=No.extname,t.joinPath=No.joinPath,t.resolvePath=No.resolvePath;function e(i,s){return(i==null?void 0:i.toString())===(s==null?void 0:s.toString())}t.equals=e;function n(i,s){const a=typeof i=="string"?i:i.path,o=typeof s=="string"?s:s.path,u=a.split("/").filter(f=>f.length>0),l=o.split("/").filter(f=>f.length>0);let c=0;for(;c<u.length&&u[c]===l[c];c++);const h="../".repeat(u.length-c),d=l.slice(c).join("/");return h+d}t.relative=n;function r(i){return zs.parse(i.toString()).toString()}t.normalize=r})(Zi||(Zi={}));var ot;(function(t){t[t.Changed=0]="Changed",t[t.Parsed=1]="Parsed",t[t.IndexedContent=2]="IndexedContent",t[t.ComputedScopes=3]="ComputedScopes",t[t.Linked=4]="Linked",t[t.IndexedReferences=5]="IndexedReferences",t[t.Validated=6]="Validated"})(ot||(ot={}));class KH{constructor(e){this.serviceRegistry=e.ServiceRegistry,this.textDocuments=e.workspace.TextDocuments,this.fileSystemProvider=e.workspace.FileSystemProvider}async fromUri(e,n=ft.CancellationToken.None){const r=await this.fileSystemProvider.readFile(e);return this.createAsync(e,r,n)}fromTextDocument(e,n,r){return n=n??zs.parse(e.uri),ft.CancellationToken.is(r)?this.createAsync(n,e,r):this.create(n,e,r)}fromString(e,n,r){return ft.CancellationToken.is(r)?this.createAsync(n,e,r):this.create(n,e,r)}fromModel(e,n){return this.create(n,{$model:e})}create(e,n,r){if(typeof n=="string"){const i=this.parse(e,n,r);return this.createLangiumDocument(i,e,void 0,n)}else if("$model"in n){const i={value:n.$model,parserErrors:[],lexerErrors:[]};return this.createLangiumDocument(i,e)}else{const i=this.parse(e,n.getText(),r);return this.createLangiumDocument(i,e,n)}}async createAsync(e,n,r){if(typeof n=="string"){const i=await this.parseAsync(e,n,r);return this.createLangiumDocument(i,e,void 0,n)}else{const i=await this.parseAsync(e,n.getText(),r);return this.createLangiumDocument(i,e,n)}}createLangiumDocument(e,n,r,i){let s;if(r)s={parseResult:e,uri:n,state:ot.Parsed,references:[],textDocument:r};else{const a=this.createTextDocumentGetter(n,i);s={parseResult:e,uri:n,state:ot.Parsed,references:[],get textDocument(){return a()}}}return e.value.$document=s,s}async update(e,n){var r,i;const s=(r=e.parseResult.value.$cstNode)===null||r===void 0?void 0:r.root.fullText,a=(i=this.textDocuments)===null||i===void 0?void 0:i.get(e.uri.toString()),o=a?a.getText():await this.fileSystemProvider.readFile(e.uri);if(a)Object.defineProperty(e,"textDocument",{value:a});else{const u=this.createTextDocumentGetter(e.uri,o);Object.defineProperty(e,"textDocument",{get:u})}return s!==o&&(e.parseResult=await this.parseAsync(e.uri,o,n),e.parseResult.value.$document=e),e.state=ot.Parsed,e}parse(e,n,r){return this.serviceRegistry.getServices(e).parser.LangiumParser.parse(n,r)}parseAsync(e,n,r){return this.serviceRegistry.getServices(e).parser.AsyncParser.parse(n,r)}createTextDocumentGetter(e,n){const r=this.serviceRegistry;let i;return()=>i??(i=im.create(e.toString(),r.getServices(e).LanguageMetaData.languageId,0,n??""))}}class JH{constructor(e){this.documentMap=new Map,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory,this.serviceRegistry=e.ServiceRegistry}get all(){return Zt(this.documentMap.values())}addDocument(e){const n=e.uri.toString();if(this.documentMap.has(n))throw new Error(`A document with the URI '${n}' is already present.`);this.documentMap.set(n,e)}getDocument(e){const n=e.toString();return this.documentMap.get(n)}async getOrCreateDocument(e,n){let r=this.getDocument(e);return r||(r=await this.langiumDocumentFactory.fromUri(e,n),this.addDocument(r),r)}createDocument(e,n,r){if(r)return this.langiumDocumentFactory.fromString(n,e,r).then(i=>(this.addDocument(i),i));{const i=this.langiumDocumentFactory.fromString(n,e);return this.addDocument(i),i}}hasDocument(e){return this.documentMap.has(e.toString())}invalidateDocument(e){const n=e.toString(),r=this.documentMap.get(n);return r&&(this.serviceRegistry.getServices(e).references.Linker.unlink(r),r.state=ot.Changed,r.precomputedScopes=void 0,r.diagnostics=void 0),r}deleteDocument(e){const n=e.toString(),r=this.documentMap.get(n);return r&&(r.state=ot.Changed,this.documentMap.delete(n)),r}}const l0=Symbol("ref_resolving");class ZH{constructor(e){this.reflection=e.shared.AstReflection,this.langiumDocuments=()=>e.shared.workspace.LangiumDocuments,this.scopeProvider=e.references.ScopeProvider,this.astNodeLocator=e.workspace.AstNodeLocator}async link(e,n=ft.CancellationToken.None){for(const r of Ra(e.parseResult.value))await Hn(n),oT(r).forEach(i=>this.doLink(i,e))}doLink(e,n){var r;const i=e.reference;if(i._ref===void 0){i._ref=l0;try{const s=this.getCandidate(e);if(nh(s))i._ref=s;else if(i._nodeDescription=s,this.langiumDocuments().hasDocument(s.documentUri)){const a=this.loadAstNode(s);i._ref=a??this.createLinkingError(e,s)}else i._ref=void 0}catch(s){console.error(`An error occurred while resolving reference to '${i.$refText}':`,s);const a=(r=s.message)!==null&&r!==void 0?r:String(s);i._ref=Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to '${i.$refText}': ${a}`})}n.references.push(i)}}unlink(e){for(const n of e.references)delete n._ref,delete n._nodeDescription;e.references=[]}getCandidate(e){const r=this.scopeProvider.getScope(e).getElement(e.reference.$refText);return r??this.createLinkingError(e)}buildReference(e,n,r,i){const s=this,a={$refNode:r,$refText:i,get ref(){var o;if(dn(this._ref))return this._ref;if(RU(this._nodeDescription)){const u=s.loadAstNode(this._nodeDescription);this._ref=u??s.createLinkingError({reference:a,container:e,property:n},this._nodeDescription)}else if(this._ref===void 0){this._ref=l0;const u=Sg(e).$document,l=s.getLinkedNode({reference:a,container:e,property:n});if(l.error&&u&&u.state<ot.ComputedScopes)return this._ref=void 0;this._ref=(o=l.node)!==null&&o!==void 0?o:l.error,this._nodeDescription=l.descr,u==null||u.references.push(this)}else if(this._ref===l0)throw new Error(`Cyclic reference resolution detected: ${s.astNodeLocator.getAstNodePath(e)}/${n} (symbol '${i}')`);return dn(this._ref)?this._ref:void 0},get $nodeDescription(){return this._nodeDescription},get error(){return nh(this._ref)?this._ref:void 0}};return a}getLinkedNode(e){var n;try{const r=this.getCandidate(e);if(nh(r))return{error:r};const i=this.loadAstNode(r);return i?{node:i,descr:r}:{descr:r,error:this.createLinkingError(e,r)}}catch(r){console.error(`An error occurred while resolving reference to '${e.reference.$refText}':`,r);const i=(n=r.message)!==null&&n!==void 0?n:String(r);return{error:Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to '${e.reference.$refText}': ${i}`})}}}loadAstNode(e){if(e.node)return e.node;const n=this.langiumDocuments().getDocument(e.documentUri);if(n)return this.astNodeLocator.getAstNode(n.parseResult.value,e.path)}createLinkingError(e,n){const r=Sg(e.container).$document;r&&r.state<ot.ComputedScopes&&console.warn(`Attempted reference resolution before document reached ComputedScopes state (${r.uri}).`);const i=this.reflection.getReferenceType(e);return Object.assign(Object.assign({},e),{message:`Could not resolve reference to ${i} named '${e.reference.$refText}'.`,targetDescription:n})}}function QH(t){return typeof t.name=="string"}class eY{getName(e){if(QH(e))return e.name}getNameNode(e){return fT(e.$cstNode,"name")}}class tY{constructor(e){this.nameProvider=e.references.NameProvider,this.index=e.shared.workspace.IndexManager,this.nodeLocator=e.workspace.AstNodeLocator}findDeclaration(e){if(e){const n=CG(e),r=e.astNode;if(n&&r){const i=r[n.feature];if(Vr(i))return i.ref;if(Array.isArray(i)){for(const s of i)if(Vr(s)&&s.$refNode&&s.$refNode.offset<=e.offset&&s.$refNode.end>=e.end)return s.ref}}if(r){const i=this.nameProvider.getNameNode(r);if(i&&(i===e||LU(e,i)))return r}}}findDeclarationNode(e){const n=this.findDeclaration(e);if(n!=null&&n.$cstNode){const r=this.nameProvider.getNameNode(n);return r??n.$cstNode}}findReferences(e,n){const r=[];if(n.includeDeclaration){const s=this.getReferenceToSelf(e);s&&r.push(s)}let i=this.index.findAllReferences(e,this.nodeLocator.getAstNodePath(e));return n.documentUri&&(i=i.filter(s=>Zi.equals(s.sourceUri,n.documentUri))),r.push(...i),Zt(r)}getReferenceToSelf(e){const n=this.nameProvider.getNameNode(e);if(n){const r=Xi(e),i=this.nodeLocator.getAstNodePath(e);return{sourceUri:r.uri,sourcePath:i,targetUri:r.uri,targetPath:i,segment:ff(n),local:!0}}}}class Ff{constructor(e){if(this.map=new Map,e)for(const[n,r]of e)this.add(n,r)}get size(){return Ag.sum(Zt(this.map.values()).map(e=>e.length))}clear(){this.map.clear()}delete(e,n){if(n===void 0)return this.map.delete(e);{const r=this.map.get(e);if(r){const i=r.indexOf(n);if(i>=0)return r.length===1?this.map.delete(e):r.splice(i,1),!0}return!1}}get(e){var n;return(n=this.map.get(e))!==null&&n!==void 0?n:[]}has(e,n){if(n===void 0)return this.map.has(e);{const r=this.map.get(e);return r?r.indexOf(n)>=0:!1}}add(e,n){return this.map.has(e)?this.map.get(e).push(n):this.map.set(e,[n]),this}addAll(e,n){return this.map.has(e)?this.map.get(e).push(...n):this.map.set(e,Array.from(n)),this}forEach(e){this.map.forEach((n,r)=>n.forEach(i=>e(i,r,this)))}[Symbol.iterator](){return this.entries().iterator()}entries(){return Zt(this.map.entries()).flatMap(([e,n])=>n.map(r=>[e,r]))}keys(){return Zt(this.map.keys())}values(){return Zt(this.map.values()).flat()}entriesGroupedByKey(){return Zt(this.map.entries())}}class ED{get size(){return this.map.size}constructor(e){if(this.map=new Map,this.inverse=new Map,e)for(const[n,r]of e)this.set(n,r)}clear(){this.map.clear(),this.inverse.clear()}set(e,n){return this.map.set(e,n),this.inverse.set(n,e),this}get(e){return this.map.get(e)}getKey(e){return this.inverse.get(e)}delete(e){const n=this.map.get(e);return n!==void 0?(this.map.delete(e),this.inverse.delete(n),!0):!1}}class nY{constructor(e){this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider}async computeExports(e,n=ft.CancellationToken.None){return this.computeExportsForNode(e.parseResult.value,e,void 0,n)}async computeExportsForNode(e,n,r=K1,i=ft.CancellationToken.None){const s=[];this.exportNode(e,s,n);for(const a of r(e))await Hn(i),this.exportNode(a,s,n);return s}exportNode(e,n,r){const i=this.nameProvider.getName(e);i&&n.push(this.descriptions.createDescription(e,i,r))}async computeLocalScopes(e,n=ft.CancellationToken.None){const r=e.parseResult.value,i=new Ff;for(const s of Al(r))await Hn(n),this.processNode(s,e,i);return i}processNode(e,n,r){const i=e.$container;if(i){const s=this.nameProvider.getName(e);s&&r.add(i,this.descriptions.createDescription(e,s,n))}}}class DD{constructor(e,n,r){var i;this.elements=e,this.outerScope=n,this.caseInsensitive=(i=r==null?void 0:r.caseInsensitive)!==null&&i!==void 0?i:!1}getAllElements(){return this.outerScope?this.elements.concat(this.outerScope.getAllElements()):this.elements}getElement(e){const n=this.caseInsensitive?this.elements.find(r=>r.name.toLowerCase()===e.toLowerCase()):this.elements.find(r=>r.name===e);if(n)return n;if(this.outerScope)return this.outerScope.getElement(e)}}class rY{constructor(e,n,r){var i;this.elements=new Map,this.caseInsensitive=(i=r==null?void 0:r.caseInsensitive)!==null&&i!==void 0?i:!1;for(const s of e){const a=this.caseInsensitive?s.name.toLowerCase():s.name;this.elements.set(a,s)}this.outerScope=n}getElement(e){const n=this.caseInsensitive?e.toLowerCase():e,r=this.elements.get(n);if(r)return r;if(this.outerScope)return this.outerScope.getElement(e)}getAllElements(){let e=Zt(this.elements.values());return this.outerScope&&(e=e.concat(this.outerScope.getAllElements())),e}}class Ek{constructor(){this.toDispose=[],this.isDisposed=!1}onDispose(e){this.toDispose.push(e)}dispose(){this.throwIfDisposed(),this.clear(),this.isDisposed=!0,this.toDispose.forEach(e=>e.dispose())}throwIfDisposed(){if(this.isDisposed)throw new Error("This cache has already been disposed")}}class iY extends Ek{constructor(){super(...arguments),this.cache=new Map}has(e){return this.throwIfDisposed(),this.cache.has(e)}set(e,n){this.throwIfDisposed(),this.cache.set(e,n)}get(e,n){if(this.throwIfDisposed(),this.cache.has(e))return this.cache.get(e);if(n){const r=n();return this.cache.set(e,r),r}else return}delete(e){return this.throwIfDisposed(),this.cache.delete(e)}clear(){this.throwIfDisposed(),this.cache.clear()}}class sY extends Ek{constructor(e){super(),this.cache=new Map,this.converter=e??(n=>n)}has(e,n){return this.throwIfDisposed(),this.cacheForContext(e).has(n)}set(e,n,r){this.throwIfDisposed(),this.cacheForContext(e).set(n,r)}get(e,n,r){this.throwIfDisposed();const i=this.cacheForContext(e);if(i.has(n))return i.get(n);if(r){const s=r();return i.set(n,s),s}else return}delete(e,n){return this.throwIfDisposed(),this.cacheForContext(e).delete(n)}clear(e){if(this.throwIfDisposed(),e){const n=this.converter(e);this.cache.delete(n)}else this.cache.clear()}cacheForContext(e){const n=this.converter(e);let r=this.cache.get(n);return r||(r=new Map,this.cache.set(n,r)),r}}class aY extends iY{constructor(e,n){super(),n?(this.toDispose.push(e.workspace.DocumentBuilder.onBuildPhase(n,()=>{this.clear()})),this.toDispose.push(e.workspace.DocumentBuilder.onUpdate((r,i)=>{i.length>0&&this.clear()}))):this.toDispose.push(e.workspace.DocumentBuilder.onUpdate(()=>{this.clear()}))}}class oY{constructor(e){this.reflection=e.shared.AstReflection,this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider,this.indexManager=e.shared.workspace.IndexManager,this.globalScopeCache=new aY(e.shared)}getScope(e){const n=[],r=this.reflection.getReferenceType(e),i=Xi(e.container).precomputedScopes;if(i){let a=e.container;do{const o=i.get(a);o.length>0&&n.push(Zt(o).filter(u=>this.reflection.isSubtype(u.type,r))),a=a.$container}while(a)}let s=this.getGlobalScope(r,e);for(let a=n.length-1;a>=0;a--)s=this.createScope(n[a],s);return s}createScope(e,n,r){return new DD(Zt(e),n,r)}createScopeForNodes(e,n,r){const i=Zt(e).map(s=>{const a=this.nameProvider.getName(s);if(a)return this.descriptions.createDescription(s,a)}).nonNullable();return new DD(i,n,r)}getGlobalScope(e,n){return this.globalScopeCache.get(e,()=>new rY(this.indexManager.allElements(e)))}}function uY(t){return typeof t.$comment=="string"}function wD(t){return typeof t=="object"&&!!t&&("$ref"in t||"$error"in t)}class lY{constructor(e){this.ignoreProperties=new Set(["$container","$containerProperty","$containerIndex","$document","$cstNode"]),this.langiumDocuments=e.shared.workspace.LangiumDocuments,this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider,this.commentProvider=e.documentation.CommentProvider}serialize(e,n){const r=n??{},i=n==null?void 0:n.replacer,s=(o,u)=>this.replacer(o,u,r),a=i?(o,u)=>i(o,u,s):s;try{return this.currentDocument=Xi(e),JSON.stringify(e,a,n==null?void 0:n.space)}finally{this.currentDocument=void 0}}deserialize(e,n){const r=n??{},i=JSON.parse(e);return this.linkNode(i,i,r),i}replacer(e,n,{refText:r,sourceText:i,textRegions:s,comments:a,uriConverter:o}){var u,l,c,h;if(!this.ignoreProperties.has(e))if(Vr(n)){const d=n.ref,f=r?n.$refText:void 0;if(d){const p=Xi(d);let g="";this.currentDocument&&this.currentDocument!==p&&(o?g=o(p.uri,n):g=p.uri.toString());const m=this.astNodeLocator.getAstNodePath(d);return{$ref:`${g}#${m}`,$refText:f}}else return{$error:(l=(u=n.error)===null||u===void 0?void 0:u.message)!==null&&l!==void 0?l:"Could not resolve reference",$refText:f}}else if(dn(n)){let d;if(s&&(d=this.addAstNodeRegionWithAssignmentsTo(Object.assign({},n)),(!e||n.$document)&&(d!=null&&d.$textRegion)&&(d.$textRegion.documentURI=(c=this.currentDocument)===null||c===void 0?void 0:c.uri.toString())),i&&!e&&(d??(d=Object.assign({},n)),d.$sourceText=(h=n.$cstNode)===null||h===void 0?void 0:h.text),a){d??(d=Object.assign({},n));const f=this.commentProvider.getComment(n);f&&(d.$comment=f.replace(/\r/g,""))}return d??n}else return n}addAstNodeRegionWithAssignmentsTo(e){const n=r=>({offset:r.offset,end:r.end,length:r.length,range:r.range});if(e.$cstNode){const r=e.$textRegion=n(e.$cstNode),i=r.assignments={};return Object.keys(e).filter(s=>!s.startsWith("$")).forEach(s=>{const a=DG(e.$cstNode,s).map(n);a.length!==0&&(i[s]=a)}),e}}linkNode(e,n,r,i,s,a){for(const[u,l]of Object.entries(e))if(Array.isArray(l))for(let c=0;c<l.length;c++){const h=l[c];wD(h)?l[c]=this.reviveReference(e,u,n,h,r):dn(h)&&this.linkNode(h,n,r,e,u,c)}else wD(l)?e[u]=this.reviveReference(e,u,n,l,r):dn(l)&&this.linkNode(l,n,r,e,u);const o=e;o.$container=i,o.$containerProperty=s,o.$containerIndex=a}reviveReference(e,n,r,i,s){let a=i.$refText,o=i.$error;if(i.$ref){const u=this.getRefNode(r,i.$ref,s.uriConverter);if(dn(u))return a||(a=this.nameProvider.getName(u)),{$refText:a??"",ref:u};o=u}if(o){const u={$refText:a??""};return u.error={container:e,property:n,message:o,reference:u},u}else return}getRefNode(e,n,r){try{const i=n.indexOf("#");if(i===0){const u=this.astNodeLocator.getAstNode(e,n.substring(1));return u||"Could not resolve path: "+n}if(i<0){const u=r?r(n):zs.parse(n),l=this.langiumDocuments.getDocument(u);return l?l.parseResult.value:"Could not find document for URI: "+n}const s=r?r(n.substring(0,i)):zs.parse(n.substring(0,i)),a=this.langiumDocuments.getDocument(s);if(!a)return"Could not find document for URI: "+n;if(i===n.length-1)return a.parseResult.value;const o=this.astNodeLocator.getAstNode(a.parseResult.value,n.substring(i+1));return o||"Could not resolve URI: "+n}catch(i){return String(i)}}}class cY{get map(){return this.fileExtensionMap}constructor(e){this.languageIdMap=new Map,this.fileExtensionMap=new Map,this.textDocuments=e==null?void 0:e.workspace.TextDocuments}register(e){const n=e.LanguageMetaData;for(const r of n.fileExtensions)this.fileExtensionMap.has(r)&&console.warn(`The file extension ${r} is used by multiple languages. It is now assigned to '${n.languageId}'.`),this.fileExtensionMap.set(r,e);this.languageIdMap.set(n.languageId,e),this.languageIdMap.size===1?this.singleton=e:this.singleton=void 0}getServices(e){var n,r;if(this.singleton!==void 0)return this.singleton;if(this.languageIdMap.size===0)throw new Error("The service registry is empty. Use `register` to register the services of a language.");const i=(r=(n=this.textDocuments)===null||n===void 0?void 0:n.get(e))===null||r===void 0?void 0:r.languageId;if(i!==void 0){const o=this.languageIdMap.get(i);if(o)return o}const s=Zi.extname(e),a=this.fileExtensionMap.get(s);if(!a)throw i?new Error(`The service registry contains no services for the extension '${s}' for language '${i}'.`):new Error(`The service registry contains no services for the extension '${s}'.`);return a}hasServices(e){try{return this.getServices(e),!0}catch{return!1}}get all(){return Array.from(this.languageIdMap.values())}}function _u(t){return{code:t}}var Rf;(function(t){t.all=["fast","slow","built-in"]})(Rf||(Rf={}));class hY{constructor(e){this.entries=new Ff,this.entriesBefore=[],this.entriesAfter=[],this.reflection=e.shared.AstReflection}register(e,n=this,r="fast"){if(r==="built-in")throw new Error("The 'built-in' category is reserved for lexer, parser, and linker errors.");for(const[i,s]of Object.entries(e)){const a=s;if(Array.isArray(a))for(const o of a){const u={check:this.wrapValidationException(o,n),category:r};this.addEntry(i,u)}else if(typeof a=="function"){const o={check:this.wrapValidationException(a,n),category:r};this.addEntry(i,o)}else Cl()}}wrapValidationException(e,n){return async(r,i,s)=>{await this.handleException(()=>e.call(n,r,i,s),"An error occurred during validation",i,r)}}async handleException(e,n,r,i){try{await e()}catch(s){if(Od(s))throw s;console.error(`${n}:`,s),s instanceof Error&&s.stack&&console.error(s.stack);const a=s instanceof Error?s.message:String(s);r("error",`${n}: ${a}`,{node:i})}}addEntry(e,n){if(e==="AstNode"){this.entries.add("AstNode",n);return}for(const r of this.reflection.getAllSubTypes(e))this.entries.add(r,n)}getChecks(e,n){let r=Zt(this.entries.get(e)).concat(this.entries.get("AstNode"));return n&&(r=r.filter(i=>n.includes(i.category))),r.map(i=>i.check)}registerBeforeDocument(e,n=this){this.entriesBefore.push(this.wrapPreparationException(e,"An error occurred during set-up of the validation",n))}registerAfterDocument(e,n=this){this.entriesAfter.push(this.wrapPreparationException(e,"An error occurred during tear-down of the validation",n))}wrapPreparationException(e,n,r){return async(i,s,a,o)=>{await this.handleException(()=>e.call(r,i,s,a,o),n,s,i)}}get checksBefore(){return this.entriesBefore}get checksAfter(){return this.entriesAfter}}class fY{constructor(e){this.validationRegistry=e.validation.ValidationRegistry,this.metadata=e.LanguageMetaData}async validateDocument(e,n={},r=ft.CancellationToken.None){const i=e.parseResult,s=[];if(await Hn(r),(!n.categories||n.categories.includes("built-in"))&&(this.processLexingErrors(i,s,n),n.stopAfterLexingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===xr.LexingError})||(this.processParsingErrors(i,s,n),n.stopAfterParsingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===xr.ParsingError}))||(this.processLinkingErrors(e,s,n),n.stopAfterLinkingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===xr.LinkingError}))))return s;try{s.push(...await this.validateAst(i.value,n,r))}catch(a){if(Od(a))throw a;console.error("An error occurred during validation:",a)}return await Hn(r),s}processLexingErrors(e,n,r){var i,s,a;const o=[...e.lexerErrors,...(s=(i=e.lexerReport)===null||i===void 0?void 0:i.diagnostics)!==null&&s!==void 0?s:[]];for(const u of o){const l=(a=u.severity)!==null&&a!==void 0?a:"error",c={severity:c0(l),range:{start:{line:u.line-1,character:u.column-1},end:{line:u.line-1,character:u.column+u.length-1}},message:u.message,data:pY(l),source:this.getSource()};n.push(c)}}processParsingErrors(e,n,r){for(const i of e.parserErrors){let s;if(isNaN(i.token.startOffset)){if("previousToken"in i){const a=i.previousToken;if(isNaN(a.startOffset)){const o={line:0,character:0};s={start:o,end:o}}else{const o={line:a.endLine-1,character:a.endColumn};s={start:o,end:o}}}}else s=kg(i.token);if(s){const a={severity:c0("error"),range:s,message:i.message,data:_u(xr.ParsingError),source:this.getSource()};n.push(a)}}}processLinkingErrors(e,n,r){for(const i of e.references){const s=i.error;if(s){const a={node:s.container,property:s.property,index:s.index,data:{code:xr.LinkingError,containerType:s.container.$type,property:s.property,refText:s.reference.$refText}};n.push(this.toDiagnostic("error",s.message,a))}}}async validateAst(e,n,r=ft.CancellationToken.None){const i=[],s=(a,o,u)=>{i.push(this.toDiagnostic(a,o,u))};return await this.validateAstBefore(e,n,s,r),await this.validateAstNodes(e,n,s,r),await this.validateAstAfter(e,n,s,r),i}async validateAstBefore(e,n,r,i=ft.CancellationToken.None){var s;const a=this.validationRegistry.checksBefore;for(const o of a)await Hn(i),await o(e,r,(s=n.categories)!==null&&s!==void 0?s:[],i)}async validateAstNodes(e,n,r,i=ft.CancellationToken.None){await Promise.all(Ra(e).map(async s=>{await Hn(i);const a=this.validationRegistry.getChecks(s.$type,n.categories);for(const o of a)await o(s,r,i)}))}async validateAstAfter(e,n,r,i=ft.CancellationToken.None){var s;const a=this.validationRegistry.checksAfter;for(const o of a)await Hn(i),await o(e,r,(s=n.categories)!==null&&s!==void 0?s:[],i)}toDiagnostic(e,n,r){return{message:n,range:dY(r),severity:c0(e),code:r.code,codeDescription:r.codeDescription,tags:r.tags,relatedInformation:r.relatedInformation,data:r.data,source:this.getSource()}}getSource(){return this.metadata.languageId}}function dY(t){if(t.range)return t.range;let e;return typeof t.property=="string"?e=fT(t.node.$cstNode,t.property,t.index):typeof t.keyword=="string"&&(e=wG(t.node.$cstNode,t.keyword,t.index)),e??(e=t.node.$cstNode),e?e.range:{start:{line:0,character:0},end:{line:0,character:0}}}function c0(t){switch(t){case"error":return 1;case"warning":return 2;case"info":return 3;case"hint":return 4;default:throw new Error("Invalid diagnostic severity: "+t)}}function pY(t){switch(t){case"error":return _u(xr.LexingError);case"warning":return _u(xr.LexingWarning);case"info":return _u(xr.LexingInfo);case"hint":return _u(xr.LexingHint);default:throw new Error("Invalid diagnostic severity: "+t)}}var xr;(function(t){t.LexingError="lexing-error",t.LexingWarning="lexing-warning",t.LexingInfo="lexing-info",t.LexingHint="lexing-hint",t.ParsingError="parsing-error",t.LinkingError="linking-error"})(xr||(xr={}));class gY{constructor(e){this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider}createDescription(e,n,r){const i=r??Xi(e);n??(n=this.nameProvider.getName(e));const s=this.astNodeLocator.getAstNodePath(e);if(!n)throw new Error(`Node at path ${s} has no name.`);let a;const o=()=>{var u;return a??(a=ff((u=this.nameProvider.getNameNode(e))!==null&&u!==void 0?u:e.$cstNode))};return{node:e,name:n,get nameSegment(){return o()},selectionSegment:ff(e.$cstNode),type:e.$type,documentUri:i.uri,path:s}}}class mY{constructor(e){this.nodeLocator=e.workspace.AstNodeLocator}async createDescriptions(e,n=ft.CancellationToken.None){const r=[],i=e.parseResult.value;for(const s of Ra(i))await Hn(n),oT(s).filter(a=>!nh(a)).forEach(a=>{const o=this.createDescription(a);o&&r.push(o)});return r}createDescription(e){const n=e.reference.$nodeDescription,r=e.reference.$refNode;if(!n||!r)return;const i=Xi(e.container).uri;return{sourceUri:i,sourcePath:this.nodeLocator.getAstNodePath(e.container),targetUri:n.documentUri,targetPath:n.path,segment:ff(r),local:Zi.equals(n.documentUri,i)}}}class yY{constructor(){this.segmentSeparator="/",this.indexSeparator="@"}getAstNodePath(e){if(e.$container){const n=this.getAstNodePath(e.$container),r=this.getPathSegment(e);return n+this.segmentSeparator+r}return""}getPathSegment({$containerProperty:e,$containerIndex:n}){if(!e)throw new Error("Missing '$containerProperty' in AST node.");return n!==void 0?e+this.indexSeparator+n:e}getAstNode(e,n){return n.split(this.segmentSeparator).reduce((i,s)=>{if(!i||s.length===0)return i;const a=s.indexOf(this.indexSeparator);if(a>0){const o=s.substring(0,a),u=parseInt(s.substring(a+1)),l=i[o];return l==null?void 0:l[u]}return i[s]},e)}}var vY=yk();class bY{constructor(e){this._ready=new py,this.settings={},this.workspaceConfig=!1,this.onConfigurationSectionUpdateEmitter=new vY.Emitter,this.serviceRegistry=e.ServiceRegistry}get ready(){return this._ready.promise}initialize(e){var n,r;this.workspaceConfig=(r=(n=e.capabilities.workspace)===null||n===void 0?void 0:n.configuration)!==null&&r!==void 0?r:!1}async initialized(e){if(this.workspaceConfig){if(e.register){const n=this.serviceRegistry.all;e.register({section:n.map(r=>this.toSectionName(r.LanguageMetaData.languageId))})}if(e.fetchConfiguration){const n=this.serviceRegistry.all.map(i=>({section:this.toSectionName(i.LanguageMetaData.languageId)})),r=await e.fetchConfiguration(n);n.forEach((i,s)=>{this.updateSectionConfiguration(i.section,r[s])})}}this._ready.resolve()}updateConfiguration(e){e.settings&&Object.keys(e.settings).forEach(n=>{const r=e.settings[n];this.updateSectionConfiguration(n,r),this.onConfigurationSectionUpdateEmitter.fire({section:n,configuration:r})})}updateSectionConfiguration(e,n){this.settings[e]=n}async getConfiguration(e,n){await this.ready;const r=this.toSectionName(e);if(this.settings[r])return this.settings[r][n]}toSectionName(e){return`${e}`}get onConfigurationSectionUpdate(){return this.onConfigurationSectionUpdateEmitter.event}}var Iu;(function(t){function e(n){return{dispose:async()=>await n()}}t.create=e})(Iu||(Iu={}));class xY{constructor(e){this.updateBuildOptions={validation:{categories:["built-in","fast"]}},this.updateListeners=[],this.buildPhaseListeners=new Ff,this.documentPhaseListeners=new Ff,this.buildState=new Map,this.documentBuildWaiters=new Map,this.currentState=ot.Changed,this.langiumDocuments=e.workspace.LangiumDocuments,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory,this.textDocuments=e.workspace.TextDocuments,this.indexManager=e.workspace.IndexManager,this.serviceRegistry=e.ServiceRegistry}async build(e,n={},r=ft.CancellationToken.None){var i,s;for(const a of e){const o=a.uri.toString();if(a.state===ot.Validated){if(typeof n.validation=="boolean"&&n.validation)a.state=ot.IndexedReferences,a.diagnostics=void 0,this.buildState.delete(o);else if(typeof n.validation=="object"){const u=this.buildState.get(o),l=(i=u==null?void 0:u.result)===null||i===void 0?void 0:i.validationChecks;if(l){const h=((s=n.validation.categories)!==null&&s!==void 0?s:Rf.all).filter(d=>!l.includes(d));h.length>0&&(this.buildState.set(o,{completed:!1,options:{validation:Object.assign(Object.assign({},n.validation),{categories:h})},result:u.result}),a.state=ot.IndexedReferences)}}}else this.buildState.delete(o)}this.currentState=ot.Changed,await this.emitUpdate(e.map(a=>a.uri),[]),await this.buildDocuments(e,n,r)}async update(e,n,r=ft.CancellationToken.None){this.currentState=ot.Changed;for(const a of n)this.langiumDocuments.deleteDocument(a),this.buildState.delete(a.toString()),this.indexManager.remove(a);for(const a of e){if(!this.langiumDocuments.invalidateDocument(a)){const u=this.langiumDocumentFactory.fromModel({$type:"INVALID"},a);u.state=ot.Changed,this.langiumDocuments.addDocument(u)}this.buildState.delete(a.toString())}const i=Zt(e).concat(n).map(a=>a.toString()).toSet();this.langiumDocuments.all.filter(a=>!i.has(a.uri.toString())&&this.shouldRelink(a,i)).forEach(a=>{this.serviceRegistry.getServices(a.uri).references.Linker.unlink(a),a.state=Math.min(a.state,ot.ComputedScopes),a.diagnostics=void 0}),await this.emitUpdate(e,n),await Hn(r);const s=this.sortDocuments(this.langiumDocuments.all.filter(a=>{var o;return a.state<ot.Linked||!(!((o=this.buildState.get(a.uri.toString()))===null||o===void 0)&&o.completed)}).toArray());await this.buildDocuments(s,this.updateBuildOptions,r)}async emitUpdate(e,n){await Promise.all(this.updateListeners.map(r=>r(e,n)))}sortDocuments(e){let n=0,r=e.length-1;for(;n<r;){for(;n<e.length&&this.hasTextDocument(e[n]);)n++;for(;r>=0&&!this.hasTextDocument(e[r]);)r--;n<r&&([e[n],e[r]]=[e[r],e[n]])}return e}hasTextDocument(e){var n;return!!(!((n=this.textDocuments)===null||n===void 0)&&n.get(e.uri))}shouldRelink(e,n){return e.references.some(r=>r.error!==void 0)?!0:this.indexManager.isAffected(e,n)}onUpdate(e){return this.updateListeners.push(e),Iu.create(()=>{const n=this.updateListeners.indexOf(e);n>=0&&this.updateListeners.splice(n,1)})}async buildDocuments(e,n,r){this.prepareBuild(e,n),await this.runCancelable(e,ot.Parsed,r,s=>this.langiumDocumentFactory.update(s,r)),await this.runCancelable(e,ot.IndexedContent,r,s=>this.indexManager.updateContent(s,r)),await this.runCancelable(e,ot.ComputedScopes,r,async s=>{const a=this.serviceRegistry.getServices(s.uri).references.ScopeComputation;s.precomputedScopes=await a.computeLocalScopes(s,r)}),await this.runCancelable(e,ot.Linked,r,s=>this.serviceRegistry.getServices(s.uri).references.Linker.link(s,r)),await this.runCancelable(e,ot.IndexedReferences,r,s=>this.indexManager.updateReferences(s,r));const i=e.filter(s=>this.shouldValidate(s));await this.runCancelable(i,ot.Validated,r,s=>this.validate(s,r));for(const s of e){const a=this.buildState.get(s.uri.toString());a&&(a.completed=!0)}}prepareBuild(e,n){for(const r of e){const i=r.uri.toString(),s=this.buildState.get(i);(!s||s.completed)&&this.buildState.set(i,{completed:!1,options:n,result:s==null?void 0:s.result})}}async runCancelable(e,n,r,i){const s=e.filter(o=>o.state<n);for(const o of s)await Hn(r),await i(o),o.state=n,await this.notifyDocumentPhase(o,n,r);const a=e.filter(o=>o.state===n);await this.notifyBuildPhase(a,n,r),this.currentState=n}onBuildPhase(e,n){return this.buildPhaseListeners.add(e,n),Iu.create(()=>{this.buildPhaseListeners.delete(e,n)})}onDocumentPhase(e,n){return this.documentPhaseListeners.add(e,n),Iu.create(()=>{this.documentPhaseListeners.delete(e,n)})}waitUntil(e,n,r){let i;if(n&&"path"in n?i=n:r=n,r??(r=ft.CancellationToken.None),i){const s=this.langiumDocuments.getDocument(i);if(s&&s.state>e)return Promise.resolve(i)}return this.currentState>=e?Promise.resolve(void 0):r.isCancellationRequested?Promise.reject(Nf):new Promise((s,a)=>{const o=this.onBuildPhase(e,()=>{if(o.dispose(),u.dispose(),i){const l=this.langiumDocuments.getDocument(i);s(l==null?void 0:l.uri)}else s(void 0)}),u=r.onCancellationRequested(()=>{o.dispose(),u.dispose(),a(Nf)})})}async notifyDocumentPhase(e,n,r){const s=this.documentPhaseListeners.get(n).slice();for(const a of s)try{await a(e,r)}catch(o){if(!Od(o))throw o}}async notifyBuildPhase(e,n,r){if(e.length===0)return;const s=this.buildPhaseListeners.get(n).slice();for(const a of s)await Hn(r),await a(e,r)}shouldValidate(e){return!!this.getBuildOptions(e).validation}async validate(e,n){var r,i;const s=this.serviceRegistry.getServices(e.uri).validation.DocumentValidator,a=this.getBuildOptions(e).validation,o=typeof a=="object"?a:void 0,u=await s.validateDocument(e,o,n);e.diagnostics?e.diagnostics.push(...u):e.diagnostics=u;const l=this.buildState.get(e.uri.toString());if(l){(r=l.result)!==null&&r!==void 0||(l.result={});const c=(i=o==null?void 0:o.categories)!==null&&i!==void 0?i:Rf.all;l.result.validationChecks?l.result.validationChecks.push(...c):l.result.validationChecks=[...c]}}getBuildOptions(e){var n,r;return(r=(n=this.buildState.get(e.uri.toString()))===null||n===void 0?void 0:n.options)!==null&&r!==void 0?r:{}}}class EY{constructor(e){this.symbolIndex=new Map,this.symbolByTypeIndex=new sY,this.referenceIndex=new Map,this.documents=e.workspace.LangiumDocuments,this.serviceRegistry=e.ServiceRegistry,this.astReflection=e.AstReflection}findAllReferences(e,n){const r=Xi(e).uri,i=[];return this.referenceIndex.forEach(s=>{s.forEach(a=>{Zi.equals(a.targetUri,r)&&a.targetPath===n&&i.push(a)})}),Zt(i)}allElements(e,n){let r=Zt(this.symbolIndex.keys());return n&&(r=r.filter(i=>!n||n.has(i))),r.map(i=>this.getFileDescriptions(i,e)).flat()}getFileDescriptions(e,n){var r;return n?this.symbolByTypeIndex.get(e,n,()=>{var s;return((s=this.symbolIndex.get(e))!==null&&s!==void 0?s:[]).filter(o=>this.astReflection.isSubtype(o.type,n))}):(r=this.symbolIndex.get(e))!==null&&r!==void 0?r:[]}remove(e){const n=e.toString();this.symbolIndex.delete(n),this.symbolByTypeIndex.clear(n),this.referenceIndex.delete(n)}async updateContent(e,n=ft.CancellationToken.None){const i=await this.serviceRegistry.getServices(e.uri).references.ScopeComputation.computeExports(e,n),s=e.uri.toString();this.symbolIndex.set(s,i),this.symbolByTypeIndex.clear(s)}async updateReferences(e,n=ft.CancellationToken.None){const i=await this.serviceRegistry.getServices(e.uri).workspace.ReferenceDescriptionProvider.createDescriptions(e,n);this.referenceIndex.set(e.uri.toString(),i)}isAffected(e,n){const r=this.referenceIndex.get(e.uri.toString());return r?r.some(i=>!i.local&&n.has(i.targetUri.toString())):!1}}class DY{constructor(e){this.initialBuildOptions={},this._ready=new py,this.serviceRegistry=e.ServiceRegistry,this.langiumDocuments=e.workspace.LangiumDocuments,this.documentBuilder=e.workspace.DocumentBuilder,this.fileSystemProvider=e.workspace.FileSystemProvider,this.mutex=e.workspace.WorkspaceLock}get ready(){return this._ready.promise}get workspaceFolders(){return this.folders}initialize(e){var n;this.folders=(n=e.workspaceFolders)!==null&&n!==void 0?n:void 0}initialized(e){return this.mutex.write(n=>{var r;return this.initializeWorkspace((r=this.folders)!==null&&r!==void 0?r:[],n)})}async initializeWorkspace(e,n=ft.CancellationToken.None){const r=await this.performStartup(e);await Hn(n),await this.documentBuilder.build(r,this.initialBuildOptions,n)}async performStartup(e){const n=this.serviceRegistry.all.flatMap(s=>s.LanguageMetaData.fileExtensions),r=[],i=s=>{r.push(s),this.langiumDocuments.hasDocument(s.uri)||this.langiumDocuments.addDocument(s)};return await this.loadAdditionalDocuments(e,i),await Promise.all(e.map(s=>[s,this.getRootFolder(s)]).map(async s=>this.traverseFolder(...s,n,i))),this._ready.resolve(),r}loadAdditionalDocuments(e,n){return Promise.resolve()}getRootFolder(e){return zs.parse(e.uri)}async traverseFolder(e,n,r,i){const s=await this.fileSystemProvider.readDirectory(n);await Promise.all(s.map(async a=>{if(this.includeEntry(e,a,r)){if(a.isDirectory)await this.traverseFolder(e,a.uri,r,i);else if(a.isFile){const o=await this.langiumDocuments.getOrCreateDocument(a.uri);i(o)}}}))}includeEntry(e,n,r){const i=Zi.basename(n.uri);if(i.startsWith("."))return!1;if(n.isDirectory)return i!=="node_modules"&&i!=="out";if(n.isFile){const s=Zi.extname(n.uri);return r.includes(s)}return!1}}class wY{buildUnexpectedCharactersMessage(e,n,r,i,s){return Og.buildUnexpectedCharactersMessage(e,n,r,i,s)}buildUnableToPopLexerModeMessage(e){return Og.buildUnableToPopLexerModeMessage(e)}}const _Y={mode:"full"};class CY{constructor(e){this.errorMessageProvider=e.parser.LexerErrorMessageProvider,this.tokenBuilder=e.parser.TokenBuilder;const n=this.tokenBuilder.buildTokens(e.Grammar,{caseInsensitive:e.LanguageMetaData.caseInsensitive});this.tokenTypes=this.toTokenTypeDictionary(n);const r=_D(n)?Object.values(n):n,i=e.LanguageMetaData.mode==="production";this.chevrotainLexer=new Sn(r,{positionTracking:"full",skipValidations:i,errorMessageProvider:this.errorMessageProvider})}get definition(){return this.tokenTypes}tokenize(e,n=_Y){var r,i,s;const a=this.chevrotainLexer.tokenize(e);return{tokens:a.tokens,errors:a.errors,hidden:(r=a.groups.hidden)!==null&&r!==void 0?r:[],report:(s=(i=this.tokenBuilder).flushLexingReport)===null||s===void 0?void 0:s.call(i,e)}}toTokenTypeDictionary(e){if(_D(e))return e;const n=Dk(e)?Object.values(e.modes).flat():e,r={};return n.forEach(i=>r[i.name]=i),r}}function AY(t){return Array.isArray(t)&&(t.length===0||"name"in t[0])}function Dk(t){return t&&"modes"in t&&"defaultMode"in t}function _D(t){return!AY(t)&&!Dk(t)}function TY(t,e,n){let r,i;typeof t=="string"?(i=e,r=n):(i=t.range.start,r=e),i||(i=He.create(0,0));const s=wk(t),a=gy(r),o=NY({lines:s,position:i,options:a});return IY({index:0,tokens:o,position:i})}function kY(t,e){const n=gy(e),r=wk(t);if(r.length===0)return!1;const i=r[0],s=r[r.length-1],a=n.start,o=n.end;return!!(a!=null&&a.exec(i))&&!!(o!=null&&o.exec(s))}function wk(t){let e="";return typeof t=="string"?e=t:e=t.text,e.split(cG)}const CD=/\s*(@([\p{L}][\p{L}\p{N}]*)?)/uy,SY=/\{(@[\p{L}][\p{L}\p{N}]*)(\s*)([^\r\n}]+)?\}/gu;function NY(t){var e,n,r;const i=[];let s=t.position.line,a=t.position.character;for(let o=0;o<t.lines.length;o++){const u=o===0,l=o===t.lines.length-1;let c=t.lines[o],h=0;if(u&&t.options.start){const f=(e=t.options.start)===null||e===void 0?void 0:e.exec(c);f&&(h=f.index+f[0].length)}else{const f=(n=t.options.line)===null||n===void 0?void 0:n.exec(c);f&&(h=f.index+f[0].length)}if(l){const f=(r=t.options.end)===null||r===void 0?void 0:r.exec(c);f&&(c=c.substring(0,f.index))}if(c=c.substring(0,OY(c)),am(c,h)>=c.length){if(i.length>0){const f=He.create(s,a);i.push({type:"break",content:"",range:Le.create(f,f)})}}else{CD.lastIndex=h;const f=CD.exec(c);if(f){const p=f[0],g=f[1],m=He.create(s,a+h),y=He.create(s,a+h+p.length);i.push({type:"tag",content:g,range:Le.create(m,y)}),h+=p.length,h=am(c,h)}if(h<c.length){const p=c.substring(h),g=Array.from(p.matchAll(SY));i.push(...FY(g,p,s,a+h))}}s++,a=0}return i.length>0&&i[i.length-1].type==="break"?i.slice(0,-1):i}function FY(t,e,n,r){const i=[];if(t.length===0){const s=He.create(n,r),a=He.create(n,r+e.length);i.push({type:"text",content:e,range:Le.create(s,a)})}else{let s=0;for(const o of t){const u=o.index,l=e.substring(s,u);l.length>0&&i.push({type:"text",content:e.substring(s,u),range:Le.create(He.create(n,s+r),He.create(n,u+r))});let c=l.length+1;const h=o[1];if(i.push({type:"inline-tag",content:h,range:Le.create(He.create(n,s+c+r),He.create(n,s+c+h.length+r))}),c+=h.length,o.length===4){c+=o[2].length;const d=o[3];i.push({type:"text",content:d,range:Le.create(He.create(n,s+c+r),He.create(n,s+c+d.length+r))})}else i.push({type:"text",content:"",range:Le.create(He.create(n,s+c+r),He.create(n,s+c+r))});s=u+o[0].length}const a=e.substring(s);a.length>0&&i.push({type:"text",content:a,range:Le.create(He.create(n,s+r),He.create(n,s+r+a.length))})}return i}const RY=/\S/,MY=/\s*$/;function am(t,e){const n=t.substring(e).match(RY);return n?e+n.index:t.length}function OY(t){const e=t.match(MY);if(e&&typeof e.index=="number")return e.index}function IY(t){var e,n,r,i;const s=He.create(t.position.line,t.position.character);if(t.tokens.length===0)return new AD([],Le.create(s,s));const a=[];for(;t.index<t.tokens.length;){const l=LY(t,a[a.length-1]);l&&a.push(l)}const o=(n=(e=a[0])===null||e===void 0?void 0:e.range.start)!==null&&n!==void 0?n:s,u=(i=(r=a[a.length-1])===null||r===void 0?void 0:r.range.end)!==null&&i!==void 0?i:s;return new AD(a,Le.create(o,u))}function LY(t,e){const n=t.tokens[t.index];if(n.type==="tag")return Ck(t,!1);if(n.type==="text"||n.type==="inline-tag")return _k(t);PY(n,e),t.index++}function PY(t,e){if(e){const n=new Tk("",t.range);"inlines"in e?e.inlines.push(n):e.content.inlines.push(n)}}function _k(t){let e=t.tokens[t.index];const n=e;let r=e;const i=[];for(;e&&e.type!=="break"&&e.type!=="tag";)i.push($Y(t)),r=e,e=t.tokens[t.index];return new om(i,Le.create(n.range.start,r.range.end))}function $Y(t){return t.tokens[t.index].type==="inline-tag"?Ck(t,!0):Ak(t)}function Ck(t,e){const n=t.tokens[t.index++],r=n.content.substring(1),i=t.tokens[t.index];if((i==null?void 0:i.type)==="text")if(e){const s=Ak(t);return new f0(r,new om([s],s.range),e,Le.create(n.range.start,s.range.end))}else{const s=_k(t);return new f0(r,s,e,Le.create(n.range.start,s.range.end))}else{const s=n.range;return new f0(r,new om([],s),e,s)}}function Ak(t){const e=t.tokens[t.index++];return new Tk(e.content,e.range)}function gy(t){if(!t)return gy({start:"/**",end:"*/",line:"*"});const{start:e,end:n,line:r}=t;return{start:h0(e,!0),end:h0(n,!1),line:h0(r,!0)}}function h0(t,e){if(typeof t=="string"||typeof t=="object"){const n=typeof t=="string"?Ad(t):t.source;return e?new RegExp(`^\\s*${n}`):new RegExp(`\\s*${n}\\s*$`)}else return t}class AD{constructor(e,n){this.elements=e,this.range=n}getTag(e){return this.getAllTags().find(n=>n.name===e)}getTags(e){return this.getAllTags().filter(n=>n.name===e)}getAllTags(){return this.elements.filter(e=>"name"in e)}toString(){let e="";for(const n of this.elements)if(e.length===0)e=n.toString();else{const r=n.toString();e+=TD(e)+r}return e.trim()}toMarkdown(e){let n="";for(const r of this.elements)if(n.length===0)n=r.toMarkdown(e);else{const i=r.toMarkdown(e);n+=TD(n)+i}return n.trim()}}class f0{constructor(e,n,r,i){this.name=e,this.content=n,this.inline=r,this.range=i}toString(){let e=`@${this.name}`;const n=this.content.toString();return this.content.inlines.length===1?e=`${e} ${n}`:this.content.inlines.length>1&&(e=`${e}
${n}`),this.inline?`{${e}}`:e}toMarkdown(e){var n,r;return(r=(n=e==null?void 0:e.renderTag)===null||n===void 0?void 0:n.call(e,this))!==null&&r!==void 0?r:this.toMarkdownDefault(e)}toMarkdownDefault(e){const n=this.content.toMarkdown(e);if(this.inline){const s=BY(this.name,n,e??{});if(typeof s=="string")return s}let r="";(e==null?void 0:e.tag)==="italic"||(e==null?void 0:e.tag)===void 0?r="*":(e==null?void 0:e.tag)==="bold"?r="**":(e==null?void 0:e.tag)==="bold-italic"&&(r="***");let i=`${r}@${this.name}${r}`;return this.content.inlines.length===1?i=`${i}  ${n}`:this.content.inlines.length>1&&(i=`${i}
${n}`),this.inline?`{${i}}`:i}}function BY(t,e,n){var r,i;if(t==="linkplain"||t==="linkcode"||t==="link"){const s=e.indexOf(" ");let a=e;if(s>0){const u=am(e,s);a=e.substring(u),e=e.substring(0,s)}return(t==="linkcode"||t==="link"&&n.link==="code")&&(a=`\`${a}\``),(i=(r=n.renderLink)===null||r===void 0?void 0:r.call(n,e,a))!==null&&i!==void 0?i:UY(e,a)}}function UY(t,e){try{return zs.parse(t,!0),`[${e}](${t})`}catch{return t}}class om{constructor(e,n){this.inlines=e,this.range=n}toString(){let e="";for(let n=0;n<this.inlines.length;n++){const r=this.inlines[n],i=this.inlines[n+1];e+=r.toString(),i&&i.range.start.line>r.range.start.line&&(e+=`
`)}return e}toMarkdown(e){let n="";for(let r=0;r<this.inlines.length;r++){const i=this.inlines[r],s=this.inlines[r+1];n+=i.toMarkdown(e),s&&s.range.start.line>i.range.start.line&&(n+=`
`)}return n}}class Tk{constructor(e,n){this.text=e,this.range=n}toString(){return this.text}toMarkdown(){return this.text}}function TD(t){return t.endsWith(`
`)?`
`:`

`}class GY{constructor(e){this.indexManager=e.shared.workspace.IndexManager,this.commentProvider=e.documentation.CommentProvider}getDocumentation(e){const n=this.commentProvider.getComment(e);if(n&&kY(n))return TY(n).toMarkdown({renderLink:(i,s)=>this.documentationLinkRenderer(e,i,s),renderTag:i=>this.documentationTagRenderer(e,i)})}documentationLinkRenderer(e,n,r){var i;const s=(i=this.findNameInPrecomputedScopes(e,n))!==null&&i!==void 0?i:this.findNameInGlobalScope(e,n);if(s&&s.nameSegment){const a=s.nameSegment.range.start.line+1,o=s.nameSegment.range.start.character+1,u=s.documentUri.with({fragment:`L${a},${o}`});return`[${r}](${u.toString()})`}else return}documentationTagRenderer(e,n){}findNameInPrecomputedScopes(e,n){const i=Xi(e).precomputedScopes;if(!i)return;let s=e;do{const o=i.get(s).find(u=>u.name===n);if(o)return o;s=s.$container}while(s)}findNameInGlobalScope(e,n){return this.indexManager.allElements().find(i=>i.name===n)}}class zY{constructor(e){this.grammarConfig=()=>e.parser.GrammarConfig}getComment(e){var n;return uY(e)?e.$comment:(n=UU(e.$cstNode,this.grammarConfig().multilineCommentRules))===null||n===void 0?void 0:n.text}}class WY{constructor(e){this.syncParser=e.parser.LangiumParser}parse(e,n){return Promise.resolve(this.syncParser.parse(e))}}class HY{constructor(){this.previousTokenSource=new ft.CancellationTokenSource,this.writeQueue=[],this.readQueue=[],this.done=!0}write(e){this.cancelWrite();const n=XH();return this.previousTokenSource=n,this.enqueue(this.writeQueue,e,n.token)}read(e){return this.enqueue(this.readQueue,e)}enqueue(e,n,r=ft.CancellationToken.None){const i=new py,s={action:n,deferred:i,cancellationToken:r};return e.push(s),this.performNextOperation(),i.promise}async performNextOperation(){if(!this.done)return;const e=[];if(this.writeQueue.length>0)e.push(this.writeQueue.shift());else if(this.readQueue.length>0)e.push(...this.readQueue.splice(0,this.readQueue.length));else return;this.done=!1,await Promise.all(e.map(async({action:n,deferred:r,cancellationToken:i})=>{try{const s=await Promise.resolve().then(()=>n(i));r.resolve(s)}catch(s){Od(s)?r.resolve(void 0):r.reject(s)}})),this.done=!0,this.performNextOperation()}cancelWrite(){this.previousTokenSource.cancel()}}class YY{constructor(e){this.grammarElementIdMap=new ED,this.tokenTypeIdMap=new ED,this.grammar=e.Grammar,this.lexer=e.parser.Lexer,this.linker=e.references.Linker}dehydrate(e){return{lexerErrors:e.lexerErrors,lexerReport:e.lexerReport?this.dehydrateLexerReport(e.lexerReport):void 0,parserErrors:e.parserErrors.map(n=>Object.assign(Object.assign({},n),{message:n.message})),value:this.dehydrateAstNode(e.value,this.createDehyrationContext(e.value))}}dehydrateLexerReport(e){return e}createDehyrationContext(e){const n=new Map,r=new Map;for(const i of Ra(e))n.set(i,{});if(e.$cstNode)for(const i of Tg(e.$cstNode))r.set(i,{});return{astNodes:n,cstNodes:r}}dehydrateAstNode(e,n){const r=n.astNodes.get(e);r.$type=e.$type,r.$containerIndex=e.$containerIndex,r.$containerProperty=e.$containerProperty,e.$cstNode!==void 0&&(r.$cstNode=this.dehydrateCstNode(e.$cstNode,n));for(const[i,s]of Object.entries(e))if(!i.startsWith("$"))if(Array.isArray(s)){const a=[];r[i]=a;for(const o of s)dn(o)?a.push(this.dehydrateAstNode(o,n)):Vr(o)?a.push(this.dehydrateReference(o,n)):a.push(o)}else dn(s)?r[i]=this.dehydrateAstNode(s,n):Vr(s)?r[i]=this.dehydrateReference(s,n):s!==void 0&&(r[i]=s);return r}dehydrateReference(e,n){const r={};return r.$refText=e.$refText,e.$refNode&&(r.$refNode=n.cstNodes.get(e.$refNode)),r}dehydrateCstNode(e,n){const r=n.cstNodes.get(e);return QA(e)?r.fullText=e.fullText:r.grammarSource=this.getGrammarElementId(e.grammarSource),r.hidden=e.hidden,r.astNode=n.astNodes.get(e.astNode),rl(e)?r.content=e.content.map(i=>this.dehydrateCstNode(i,n)):ZA(e)&&(r.tokenType=e.tokenType.name,r.offset=e.offset,r.length=e.length,r.startLine=e.range.start.line,r.startColumn=e.range.start.character,r.endLine=e.range.end.line,r.endColumn=e.range.end.character),r}hydrate(e){const n=e.value,r=this.createHydrationContext(n);return"$cstNode"in n&&this.hydrateCstNode(n.$cstNode,r),{lexerErrors:e.lexerErrors,lexerReport:e.lexerReport,parserErrors:e.parserErrors,value:this.hydrateAstNode(n,r)}}createHydrationContext(e){const n=new Map,r=new Map;for(const s of Ra(e))n.set(s,{});let i;if(e.$cstNode)for(const s of Tg(e.$cstNode)){let a;"fullText"in s?(a=new uk(s.fullText),i=a):"content"in s?a=new fy:"tokenType"in s&&(a=this.hydrateCstLeafNode(s)),a&&(r.set(s,a),a.root=i)}return{astNodes:n,cstNodes:r}}hydrateAstNode(e,n){const r=n.astNodes.get(e);r.$type=e.$type,r.$containerIndex=e.$containerIndex,r.$containerProperty=e.$containerProperty,e.$cstNode&&(r.$cstNode=n.cstNodes.get(e.$cstNode));for(const[i,s]of Object.entries(e))if(!i.startsWith("$"))if(Array.isArray(s)){const a=[];r[i]=a;for(const o of s)dn(o)?a.push(this.setParent(this.hydrateAstNode(o,n),r)):Vr(o)?a.push(this.hydrateReference(o,r,i,n)):a.push(o)}else dn(s)?r[i]=this.setParent(this.hydrateAstNode(s,n),r):Vr(s)?r[i]=this.hydrateReference(s,r,i,n):s!==void 0&&(r[i]=s);return r}setParent(e,n){return e.$container=n,e}hydrateReference(e,n,r,i){return this.linker.buildReference(n,r,i.cstNodes.get(e.$refNode),e.$refText)}hydrateCstNode(e,n,r=0){const i=n.cstNodes.get(e);if(typeof e.grammarSource=="number"&&(i.grammarSource=this.getGrammarElement(e.grammarSource)),i.astNode=n.astNodes.get(e.astNode),rl(i))for(const s of e.content){const a=this.hydrateCstNode(s,n,r++);i.content.push(a)}return i}hydrateCstLeafNode(e){const n=this.getTokenType(e.tokenType),r=e.offset,i=e.length,s=e.startLine,a=e.startColumn,o=e.endLine,u=e.endColumn,l=e.hidden;return new tm(r,i,{start:{line:s,character:a},end:{line:o,character:u}},n,l)}getTokenType(e){return this.lexer.definition[e]}getGrammarElementId(e){if(e)return this.grammarElementIdMap.size===0&&this.createGrammarElementIdMap(),this.grammarElementIdMap.get(e)}getGrammarElement(e){return this.grammarElementIdMap.size===0&&this.createGrammarElementIdMap(),this.grammarElementIdMap.getKey(e)}createGrammarElementIdMap(){let e=0;for(const n of Ra(this.grammar))zU(n)&&this.grammarElementIdMap.set(n,e++)}}function VY(t){return{documentation:{CommentProvider:e=>new zY(e),DocumentationProvider:e=>new GY(e)},parser:{AsyncParser:e=>new WY(e),GrammarConfig:e=>MG(e),LangiumParser:e=>UH(e),CompletionParser:e=>BH(e),ValueConverter:()=>new WH,TokenBuilder:()=>new zH,Lexer:e=>new CY(e),ParserErrorMessageProvider:()=>new hk,LexerErrorMessageProvider:()=>new wY},workspace:{AstNodeLocator:()=>new yY,AstNodeDescriptionProvider:e=>new gY(e),ReferenceDescriptionProvider:e=>new mY(e)},references:{Linker:e=>new ZH(e),NameProvider:()=>new eY,ScopeProvider:e=>new oY(e),ScopeComputation:e=>new nY(e),References:e=>new tY(e)},serializer:{Hydrator:e=>new YY(e),JsonSerializer:e=>new lY(e)},validation:{DocumentValidator:e=>new fY(e),ValidationRegistry:e=>new hY(e)},shared:()=>t.shared}}function qY(t){return{ServiceRegistry:e=>new cY(e),workspace:{LangiumDocuments:e=>new JH(e),LangiumDocumentFactory:e=>new KH(e),DocumentBuilder:e=>new xY(e),IndexManager:e=>new EY(e),WorkspaceManager:e=>new DY(e),FileSystemProvider:e=>t.fileSystemProvider(e),WorkspaceLock:()=>new HY,ConfigurationProvider:e=>new bY(e)}}}var kD;(function(t){t.merge=(e,n)=>Mf(Mf({},e),n)})(kD||(kD={}));function SD(t,e,n,r,i,s,a,o,u){const l=[t,e,n,r,i,s,a,o,u].reduce(Mf,{});return kk(l)}const XY=Symbol("isProxy");function kk(t,e){const n=new Proxy({},{deleteProperty:()=>!1,set:()=>{throw new Error("Cannot set property on injected service container")},get:(r,i)=>i===XY?!0:FD(r,i,t,e||n),getOwnPropertyDescriptor:(r,i)=>(FD(r,i,t,e||n),Object.getOwnPropertyDescriptor(r,i)),has:(r,i)=>i in t,ownKeys:()=>[...Object.getOwnPropertyNames(t)]});return n}const ND=Symbol();function FD(t,e,n,r){if(e in t){if(t[e]instanceof Error)throw new Error("Construction failure. Please make sure that your dependencies are constructable.",{cause:t[e]});if(t[e]===ND)throw new Error('Cycle detected. Please make "'+String(e)+'" lazy. Visit https://langium.org/docs/reference/configuration-services/#resolving-cyclic-dependencies');return t[e]}else if(e in n){const i=n[e];t[e]=ND;try{t[e]=typeof i=="function"?i(r):kk(i,r)}catch(s){throw t[e]=s instanceof Error?s:void 0,s}return t[e]}else return}function Mf(t,e){if(e){for(const[n,r]of Object.entries(e))if(r!==void 0){const i=t[n];i!==null&&r!==null&&typeof i=="object"&&typeof r=="object"?t[n]=Mf(i,r):t[n]=r}}return t}class jY{readFile(){throw new Error("No file system is available.")}async readDirectory(){return[]}}const KY={fileSystemProvider:()=>new jY},JY={Grammar:()=>{},LanguageMetaData:()=>({caseInsensitive:!1,fileExtensions:[".langium"],languageId:"langium"})},ZY={AstReflection:()=>new aT};function QY(){const t=SD(qY(KY),ZY),e=SD(VY({shared:t}),JY);return t.ServiceRegistry.register(e),e}function $X(t){var e;const n=QY(),r=n.serializer.JsonSerializer.deserialize(t);return n.shared.workspace.LangiumDocumentFactory.fromModel(r,zs.parse(`memory://${(e=r.name)!==null&&e!==void 0?e:"grammar"}.langium`)),r}var ch={exports:{}},eV=ch.exports,RD;function tV(){return RD||(RD=1,function(t,e){(function(n,r){t.exports=r()})(eV,function(){var n="day";return function(r,i,s){var a=function(l){return l.add(4-l.isoWeekday(),n)},o=i.prototype;o.isoWeekYear=function(){return a(this).year()},o.isoWeek=function(l){if(!this.$utils().u(l))return this.add(7*(l-this.isoWeek()),n);var c,h,d,f,p=a(this),g=(c=this.isoWeekYear(),h=this.$u,d=(h?s.utc:s)().year(c).startOf("year"),f=4-d.isoWeekday(),d.isoWeekday()>4&&(f+=7),d.add(f,n));return p.diff(g,"week")+1},o.isoWeekday=function(l){return this.$utils().u(l)?this.day()||7:this.day(this.day()%7?l:l-7)};var u=o.startOf;o.startOf=function(l,c){var h=this.$utils(),d=!!h.u(c)||c;return h.p(l)==="isoweek"?d?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):u.bind(this)(l,c)}}})}(ch)),ch.exports}var nV=tV();const BX=ad(nV);var hh={exports:{}},rV=hh.exports,MD;function iV(){return MD||(MD=1,function(t,e){(function(n,r){t.exports=r()})(rV,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,s=/\d\d/,a=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,u={},l=function(m){return(m=+m)+(m>68?1900:2e3)},c=function(m){return function(y){this[m]=+y}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(m){(this.zone||(this.zone={})).offset=function(y){if(!y||y==="Z")return 0;var b=y.match(/([+-]|\d\d)/g),v=60*b[1]+(+b[2]||0);return v===0?0:b[0]==="+"?-v:v}(m)}],d=function(m){var y=u[m];return y&&(y.indexOf?y:y.s.concat(y.f))},f=function(m,y){var b,v=u.meridiem;if(v){for(var E=1;E<=24;E+=1)if(m.indexOf(v(E,0,y))>-1){b=E>12;break}}else b=m===(y?"pm":"PM");return b},p={A:[o,function(m){this.afternoon=f(m,!1)}],a:[o,function(m){this.afternoon=f(m,!0)}],Q:[i,function(m){this.month=3*(m-1)+1}],S:[i,function(m){this.milliseconds=100*+m}],SS:[s,function(m){this.milliseconds=10*+m}],SSS:[/\d{3}/,function(m){this.milliseconds=+m}],s:[a,c("seconds")],ss:[a,c("seconds")],m:[a,c("minutes")],mm:[a,c("minutes")],H:[a,c("hours")],h:[a,c("hours")],HH:[a,c("hours")],hh:[a,c("hours")],D:[a,c("day")],DD:[s,c("day")],Do:[o,function(m){var y=u.ordinal,b=m.match(/\d+/);if(this.day=b[0],y)for(var v=1;v<=31;v+=1)y(v).replace(/\[|\]/g,"")===m&&(this.day=v)}],w:[a,c("week")],ww:[s,c("week")],M:[a,c("month")],MM:[s,c("month")],MMM:[o,function(m){var y=d("months"),b=(d("monthsShort")||y.map(function(v){return v.slice(0,3)})).indexOf(m)+1;if(b<1)throw new Error;this.month=b%12||b}],MMMM:[o,function(m){var y=d("months").indexOf(m)+1;if(y<1)throw new Error;this.month=y%12||y}],Y:[/[+-]?\d+/,c("year")],YY:[s,function(m){this.year=l(m)}],YYYY:[/\d{4}/,c("year")],Z:h,ZZ:h};function g(m){var y,b;y=m,b=u&&u.formats;for(var v=(m=y.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(M,S,R){var I=R&&R.toUpperCase();return S||b[R]||n[R]||b[I].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(x,_,C){return _||C.slice(1)})})).match(r),E=v.length,w=0;w<E;w+=1){var N=v[w],D=p[N],k=D&&D[0],F=D&&D[1];v[w]=F?{regex:k,parser:F}:N.replace(/^\[|\]$/g,"")}return function(M){for(var S={},R=0,I=0;R<E;R+=1){var x=v[R];if(typeof x=="string")I+=x.length;else{var _=x.regex,C=x.parser,A=M.slice(I),T=_.exec(A)[0];C.call(S,T),M=M.replace(T,"")}}return function(O){var L=O.afternoon;if(L!==void 0){var P=O.hours;L?P<12&&(O.hours+=12):P===12&&(O.hours=0),delete O.afternoon}}(S),S}}return function(m,y,b){b.p.customParseFormat=!0,m&&m.parseTwoDigitYear&&(l=m.parseTwoDigitYear);var v=y.prototype,E=v.parse;v.parse=function(w){var N=w.date,D=w.utc,k=w.args;this.$u=D;var F=k[1];if(typeof F=="string"){var M=k[2]===!0,S=k[3]===!0,R=M||S,I=k[2];S&&(I=k[2]),u=this.$locale(),!M&&I&&(u=b.Ls[I]),this.$d=function(A,T,O,L){try{if(["x","X"].indexOf(T)>-1)return new Date((T==="X"?1e3:1)*A);var P=g(T)(A),Y=P.year,W=P.month,X=P.day,V=P.hours,q=P.minutes,Z=P.seconds,J=P.milliseconds,B=P.zone,H=P.week,j=new Date,G=X||(Y||W?1:j.getDate()),re=Y||j.getFullYear(),K=0;Y&&!W||(K=W>0?W-1:j.getMonth());var _e,ve=V||0,dt=q||0,ut=Z||0,Me=J||0;return B?new Date(Date.UTC(re,K,G,ve,dt,ut,Me+60*B.offset*1e3)):O?new Date(Date.UTC(re,K,G,ve,dt,ut,Me)):(_e=new Date(re,K,G,ve,dt,ut,Me),H&&(_e=L(_e).week(H).toDate()),_e)}catch{return new Date("")}}(N,F,D,b),this.init(),I&&I!==!0&&(this.$L=this.locale(I).$L),R&&N!=this.format(F)&&(this.$d=new Date("")),u={}}else if(F instanceof Array)for(var x=F.length,_=1;_<=x;_+=1){k[1]=F[_-1];var C=b.apply(this,k);if(C.isValid()){this.$d=C.$d,this.$L=C.$L,this.init();break}_===x&&(this.$d=new Date(""))}else E.call(this,w)}}})}(hh)),hh.exports}var sV=iV();const UX=ad(sV);var fh={exports:{}},aV=fh.exports,OD;function oV(){return OD||(OD=1,function(t,e){(function(n,r){t.exports=r()})(aV,function(){return function(n,r){var i=r.prototype,s=i.format;i.format=function(a){var o=this,u=this.$locale();if(!this.isValid())return s.bind(this)(a);var l=this.$utils(),c=(a||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(h){switch(h){case"Q":return Math.ceil((o.$M+1)/3);case"Do":return u.ordinal(o.$D);case"gggg":return o.weekYear();case"GGGG":return o.isoWeekYear();case"wo":return u.ordinal(o.week(),"W");case"w":case"ww":return l.s(o.week(),h==="w"?1:2,"0");case"W":case"WW":return l.s(o.isoWeek(),h==="W"?1:2,"0");case"k":case"kk":return l.s(String(o.$H===0?24:o.$H),h==="k"?1:2,"0");case"X":return Math.floor(o.$d.getTime()/1e3);case"x":return o.$d.getTime();case"z":return"["+o.offsetName()+"]";case"zzz":return"["+o.offsetName("long")+"]";default:return h}});return s.bind(this)(c)}}})}(fh)),fh.exports}var uV=oV();const GX=ad(uV),Yt=[];for(let t=0;t<256;++t)Yt.push((t+256).toString(16).slice(1));function lV(t,e=0){return(Yt[t[e+0]]+Yt[t[e+1]]+Yt[t[e+2]]+Yt[t[e+3]]+"-"+Yt[t[e+4]]+Yt[t[e+5]]+"-"+Yt[t[e+6]]+Yt[t[e+7]]+"-"+Yt[t[e+8]]+Yt[t[e+9]]+"-"+Yt[t[e+10]]+Yt[t[e+11]]+Yt[t[e+12]]+Yt[t[e+13]]+Yt[t[e+14]]+Yt[t[e+15]]).toLowerCase()}let d0;const cV=new Uint8Array(16);function hV(){if(!d0){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");d0=crypto.getRandomValues.bind(crypto)}return d0(cV)}const fV=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ID={randomUUID:fV};function zX(t,e,n){var i;if(ID.randomUUID&&!t)return ID.randomUUID();t=t||{};const r=t.random??((i=t.rng)==null?void 0:i.call(t))??hV();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,lV(r)}function LD(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Sk(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function p0(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function dV(t){return t.target.depth}function WX(t){return t.depth}function HX(t,e){return e-1-t.height}function pV(t,e){return t.sourceLinks.length?t.depth:e-1}function YX(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?Sk(t.sourceLinks,dV)-1:0}function Ac(t){return function(){return t}}function PD(t,e){return Of(t.source,e.source)||t.index-e.index}function $D(t,e){return Of(t.target,e.target)||t.index-e.index}function Of(t,e){return t.y0-e.y0}function g0(t){return t.value}function gV(t){return t.index}function mV(t){return t.nodes}function yV(t){return t.links}function BD(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function UD({nodes:t}){for(const e of t){let n=e.y0,r=n;for(const i of e.sourceLinks)i.y0=n+i.width/2,n+=i.width;for(const i of e.targetLinks)i.y1=r+i.width/2,r+=i.width}}function VX(){let t=0,e=0,n=1,r=1,i=24,s=8,a,o=gV,u=pV,l,c,h=mV,d=yV,f=6;function p(){const _={nodes:h.apply(null,arguments),links:d.apply(null,arguments)};return g(_),m(_),y(_),b(_),w(_),UD(_),_}p.update=function(_){return UD(_),_},p.nodeId=function(_){return arguments.length?(o=typeof _=="function"?_:Ac(_),p):o},p.nodeAlign=function(_){return arguments.length?(u=typeof _=="function"?_:Ac(_),p):u},p.nodeSort=function(_){return arguments.length?(l=_,p):l},p.nodeWidth=function(_){return arguments.length?(i=+_,p):i},p.nodePadding=function(_){return arguments.length?(s=a=+_,p):s},p.nodes=function(_){return arguments.length?(h=typeof _=="function"?_:Ac(_),p):h},p.links=function(_){return arguments.length?(d=typeof _=="function"?_:Ac(_),p):d},p.linkSort=function(_){return arguments.length?(c=_,p):c},p.size=function(_){return arguments.length?(t=e=0,n=+_[0],r=+_[1],p):[n-t,r-e]},p.extent=function(_){return arguments.length?(t=+_[0][0],n=+_[1][0],e=+_[0][1],r=+_[1][1],p):[[t,e],[n,r]]},p.iterations=function(_){return arguments.length?(f=+_,p):f};function g({nodes:_,links:C}){for(const[T,O]of _.entries())O.index=T,O.sourceLinks=[],O.targetLinks=[];const A=new Map(_.map((T,O)=>[o(T,O,_),T]));for(const[T,O]of C.entries()){O.index=T;let{source:L,target:P}=O;typeof L!="object"&&(L=O.source=BD(A,L)),typeof P!="object"&&(P=O.target=BD(A,P)),L.sourceLinks.push(O),P.targetLinks.push(O)}if(c!=null)for(const{sourceLinks:T,targetLinks:O}of _)T.sort(c),O.sort(c)}function m({nodes:_}){for(const C of _)C.value=C.fixedValue===void 0?Math.max(p0(C.sourceLinks,g0),p0(C.targetLinks,g0)):C.fixedValue}function y({nodes:_}){const C=_.length;let A=new Set(_),T=new Set,O=0;for(;A.size;){for(const L of A){L.depth=O;for(const{target:P}of L.sourceLinks)T.add(P)}if(++O>C)throw new Error("circular link");A=T,T=new Set}}function b({nodes:_}){const C=_.length;let A=new Set(_),T=new Set,O=0;for(;A.size;){for(const L of A){L.height=O;for(const{source:P}of L.targetLinks)T.add(P)}if(++O>C)throw new Error("circular link");A=T,T=new Set}}function v({nodes:_}){const C=LD(_,O=>O.depth)+1,A=(n-t-i)/(C-1),T=new Array(C);for(const O of _){const L=Math.max(0,Math.min(C-1,Math.floor(u.call(null,O,C))));O.layer=L,O.x0=t+L*A,O.x1=O.x0+i,T[L]?T[L].push(O):T[L]=[O]}if(l)for(const O of T)O.sort(l);return T}function E(_){const C=Sk(_,A=>(r-e-(A.length-1)*a)/p0(A,g0));for(const A of _){let T=e;for(const O of A){O.y0=T,O.y1=T+O.value*C,T=O.y1+a;for(const L of O.sourceLinks)L.width=L.value*C}T=(r-T+a)/(A.length+1);for(let O=0;O<A.length;++O){const L=A[O];L.y0+=T*(O+1),L.y1+=T*(O+1)}R(A)}}function w(_){const C=v(_);a=Math.min(s,(r-e)/(LD(C,A=>A.length)-1)),E(C);for(let A=0;A<f;++A){const T=Math.pow(.99,A),O=Math.max(1-T,(A+1)/f);D(C,T,O),N(C,T,O)}}function N(_,C,A){for(let T=1,O=_.length;T<O;++T){const L=_[T];for(const P of L){let Y=0,W=0;for(const{source:V,value:q}of P.targetLinks){let Z=q*(P.layer-V.layer);Y+=I(V,P)*Z,W+=Z}if(!(W>0))continue;let X=(Y/W-P.y0)*C;P.y0+=X,P.y1+=X,S(P)}l===void 0&&L.sort(Of),k(L,A)}}function D(_,C,A){for(let T=_.length,O=T-2;O>=0;--O){const L=_[O];for(const P of L){let Y=0,W=0;for(const{target:V,value:q}of P.sourceLinks){let Z=q*(V.layer-P.layer);Y+=x(P,V)*Z,W+=Z}if(!(W>0))continue;let X=(Y/W-P.y0)*C;P.y0+=X,P.y1+=X,S(P)}l===void 0&&L.sort(Of),k(L,A)}}function k(_,C){const A=_.length>>1,T=_[A];M(_,T.y0-a,A-1,C),F(_,T.y1+a,A+1,C),M(_,r,_.length-1,C),F(_,e,0,C)}function F(_,C,A,T){for(;A<_.length;++A){const O=_[A],L=(C-O.y0)*T;L>1e-6&&(O.y0+=L,O.y1+=L),C=O.y1+a}}function M(_,C,A,T){for(;A>=0;--A){const O=_[A],L=(O.y1-C)*T;L>1e-6&&(O.y0-=L,O.y1-=L),C=O.y0-a}}function S({sourceLinks:_,targetLinks:C}){if(c===void 0){for(const{source:{sourceLinks:A}}of C)A.sort($D);for(const{target:{targetLinks:A}}of _)A.sort(PD)}}function R(_){if(c===void 0)for(const{sourceLinks:C,targetLinks:A}of _)C.sort($D),A.sort(PD)}function I(_,C){let A=_.y0-(_.sourceLinks.length-1)*a/2;for(const{target:T,width:O}of _.sourceLinks){if(T===C)break;A+=O+a}for(const{source:T,width:O}of C.targetLinks){if(T===_)break;A-=O}return A}function x(_,C){let A=C.y0-(C.targetLinks.length-1)*a/2;for(const{source:T,width:O}of C.targetLinks){if(T===_)break;A+=O+a}for(const{target:T,width:O}of _.sourceLinks){if(T===C)break;A-=O}return A}return p}var um=Math.PI,lm=2*um,ds=1e-6,vV=lm-ds;function cm(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Nk(){return new cm}cm.prototype=Nk.prototype={constructor:cm,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var s=this._x1,a=this._y1,o=n-t,u=r-e,l=s-t,c=a-e,h=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>ds)if(!(Math.abs(c*o-u*l)>ds)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var d=n-s,f=r-a,p=o*o+u*u,g=d*d+f*f,m=Math.sqrt(p),y=Math.sqrt(h),b=i*Math.tan((um-Math.acos((p+h-g)/(2*m*y)))/2),v=b/y,E=b/m;Math.abs(v-1)>ds&&(this._+="L"+(t+v*l)+","+(e+v*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*f)+","+(this._x1=t+E*o)+","+(this._y1=e+E*u)}},arc:function(t,e,n,r,i,s){t=+t,e=+e,n=+n,s=!!s;var a=n*Math.cos(r),o=n*Math.sin(r),u=t+a,l=e+o,c=1^s,h=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>ds||Math.abs(this._y1-l)>ds)&&(this._+="L"+u+","+l),n&&(h<0&&(h=h%lm+lm),h>vV?this._+="A"+n+","+n+",0,1,"+c+","+(t-a)+","+(e-o)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):h>ds&&(this._+="A"+n+","+n+",0,"+ +(h>=um)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function GD(t){return function(){return t}}function bV(t){return t[0]}function xV(t){return t[1]}var EV=Array.prototype.slice;function DV(t){return t.source}function wV(t){return t.target}function _V(t){var e=DV,n=wV,r=bV,i=xV,s=null;function a(){var o,u=EV.call(arguments),l=e.apply(this,u),c=n.apply(this,u);if(s||(s=o=Nk()),t(s,+r.apply(this,(u[0]=l,u)),+i.apply(this,u),+r.apply(this,(u[0]=c,u)),+i.apply(this,u)),o)return s=null,o+""||null}return a.source=function(o){return arguments.length?(e=o,a):e},a.target=function(o){return arguments.length?(n=o,a):n},a.x=function(o){return arguments.length?(r=typeof o=="function"?o:GD(+o),a):r},a.y=function(o){return arguments.length?(i=typeof o=="function"?o:GD(+o),a):i},a.context=function(o){return arguments.length?(s=o??null,a):s},a}function CV(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function AV(){return _V(CV)}function TV(t){return[t.source.x1,t.y0]}function kV(t){return[t.target.x0,t.y1]}function qX(){return AV().source(TV).target(kV)}var dh={exports:{}},ph={exports:{}},SV=ph.exports,zD;function NV(){return zD||(zD=1,function(t,e){(function(r,i){t.exports=i()})(SV,function(){return function(n){var r={};function i(s){if(r[s])return r[s].exports;var a=r[s]={i:s,l:!1,exports:{}};return n[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=n,i.c=r,i.i=function(s){return s},i.d=function(s,a,o){i.o(s,a)||Object.defineProperty(s,a,{configurable:!1,enumerable:!0,get:o})},i.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(a,"a",a),a},i.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},i.p="",i(i.s=28)}([function(n,r,i){function s(){}s.QUALITY=1,s.DEFAULT_CREATE_BENDS_AS_NEEDED=!1,s.DEFAULT_INCREMENTAL=!1,s.DEFAULT_ANIMATION_ON_LAYOUT=!0,s.DEFAULT_ANIMATION_DURING_LAYOUT=!1,s.DEFAULT_ANIMATION_PERIOD=50,s.DEFAULT_UNIFORM_LEAF_NODE_SIZES=!1,s.DEFAULT_GRAPH_MARGIN=15,s.NODE_DIMENSIONS_INCLUDE_LABELS=!1,s.SIMPLE_NODE_SIZE=40,s.SIMPLE_NODE_HALF_SIZE=s.SIMPLE_NODE_SIZE/2,s.EMPTY_COMPOUND_NODE_SIZE=40,s.MIN_EDGE_LENGTH=1,s.WORLD_BOUNDARY=1e6,s.INITIAL_WORLD_BOUNDARY=s.WORLD_BOUNDARY/1e3,s.WORLD_CENTER_X=1200,s.WORLD_CENTER_Y=900,n.exports=s},function(n,r,i){var s=i(2),a=i(8),o=i(9);function u(c,h,d){s.call(this,d),this.isOverlapingSourceAndTarget=!1,this.vGraphObject=d,this.bendpoints=[],this.source=c,this.target=h}u.prototype=Object.create(s.prototype);for(var l in s)u[l]=s[l];u.prototype.getSource=function(){return this.source},u.prototype.getTarget=function(){return this.target},u.prototype.isInterGraph=function(){return this.isInterGraph},u.prototype.getLength=function(){return this.length},u.prototype.isOverlapingSourceAndTarget=function(){return this.isOverlapingSourceAndTarget},u.prototype.getBendpoints=function(){return this.bendpoints},u.prototype.getLca=function(){return this.lca},u.prototype.getSourceInLca=function(){return this.sourceInLca},u.prototype.getTargetInLca=function(){return this.targetInLca},u.prototype.getOtherEnd=function(c){if(this.source===c)return this.target;if(this.target===c)return this.source;throw"Node is not incident with this edge"},u.prototype.getOtherEndInGraph=function(c,h){for(var d=this.getOtherEnd(c),f=h.getGraphManager().getRoot();;){if(d.getOwner()==h)return d;if(d.getOwner()==f)break;d=d.getOwner().getParent()}return null},u.prototype.updateLength=function(){var c=new Array(4);this.isOverlapingSourceAndTarget=a.getIntersection(this.target.getRect(),this.source.getRect(),c),this.isOverlapingSourceAndTarget||(this.lengthX=c[0]-c[2],this.lengthY=c[1]-c[3],Math.abs(this.lengthX)<1&&(this.lengthX=o.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=o.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY))},u.prototype.updateLengthSimple=function(){this.lengthX=this.target.getCenterX()-this.source.getCenterX(),this.lengthY=this.target.getCenterY()-this.source.getCenterY(),Math.abs(this.lengthX)<1&&(this.lengthX=o.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=o.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY)},n.exports=u},function(n,r,i){function s(a){this.vGraphObject=a}n.exports=s},function(n,r,i){var s=i(2),a=i(10),o=i(13),u=i(0),l=i(16),c=i(5);function h(f,p,g,m){g==null&&m==null&&(m=p),s.call(this,m),f.graphManager!=null&&(f=f.graphManager),this.estimatedSize=a.MIN_VALUE,this.inclusionTreeDepth=a.MAX_VALUE,this.vGraphObject=m,this.edges=[],this.graphManager=f,g!=null&&p!=null?this.rect=new o(p.x,p.y,g.width,g.height):this.rect=new o}h.prototype=Object.create(s.prototype);for(var d in s)h[d]=s[d];h.prototype.getEdges=function(){return this.edges},h.prototype.getChild=function(){return this.child},h.prototype.getOwner=function(){return this.owner},h.prototype.getWidth=function(){return this.rect.width},h.prototype.setWidth=function(f){this.rect.width=f},h.prototype.getHeight=function(){return this.rect.height},h.prototype.setHeight=function(f){this.rect.height=f},h.prototype.getCenterX=function(){return this.rect.x+this.rect.width/2},h.prototype.getCenterY=function(){return this.rect.y+this.rect.height/2},h.prototype.getCenter=function(){return new c(this.rect.x+this.rect.width/2,this.rect.y+this.rect.height/2)},h.prototype.getLocation=function(){return new c(this.rect.x,this.rect.y)},h.prototype.getRect=function(){return this.rect},h.prototype.getDiagonal=function(){return Math.sqrt(this.rect.width*this.rect.width+this.rect.height*this.rect.height)},h.prototype.getHalfTheDiagonal=function(){return Math.sqrt(this.rect.height*this.rect.height+this.rect.width*this.rect.width)/2},h.prototype.setRect=function(f,p){this.rect.x=f.x,this.rect.y=f.y,this.rect.width=p.width,this.rect.height=p.height},h.prototype.setCenter=function(f,p){this.rect.x=f-this.rect.width/2,this.rect.y=p-this.rect.height/2},h.prototype.setLocation=function(f,p){this.rect.x=f,this.rect.y=p},h.prototype.moveBy=function(f,p){this.rect.x+=f,this.rect.y+=p},h.prototype.getEdgeListToNode=function(f){var p=[],g=this;return g.edges.forEach(function(m){if(m.target==f){if(m.source!=g)throw"Incorrect edge source!";p.push(m)}}),p},h.prototype.getEdgesBetween=function(f){var p=[],g=this;return g.edges.forEach(function(m){if(!(m.source==g||m.target==g))throw"Incorrect edge source and/or target";(m.target==f||m.source==f)&&p.push(m)}),p},h.prototype.getNeighborsList=function(){var f=new Set,p=this;return p.edges.forEach(function(g){if(g.source==p)f.add(g.target);else{if(g.target!=p)throw"Incorrect incidency!";f.add(g.source)}}),f},h.prototype.withChildren=function(){var f=new Set,p,g;if(f.add(this),this.child!=null)for(var m=this.child.getNodes(),y=0;y<m.length;y++)p=m[y],g=p.withChildren(),g.forEach(function(b){f.add(b)});return f},h.prototype.getNoOfChildren=function(){var f=0,p;if(this.child==null)f=1;else for(var g=this.child.getNodes(),m=0;m<g.length;m++)p=g[m],f+=p.getNoOfChildren();return f==0&&(f=1),f},h.prototype.getEstimatedSize=function(){if(this.estimatedSize==a.MIN_VALUE)throw"assert failed";return this.estimatedSize},h.prototype.calcEstimatedSize=function(){return this.child==null?this.estimatedSize=(this.rect.width+this.rect.height)/2:(this.estimatedSize=this.child.calcEstimatedSize(),this.rect.width=this.estimatedSize,this.rect.height=this.estimatedSize,this.estimatedSize)},h.prototype.scatter=function(){var f,p,g=-u.INITIAL_WORLD_BOUNDARY,m=u.INITIAL_WORLD_BOUNDARY;f=u.WORLD_CENTER_X+l.nextDouble()*(m-g)+g;var y=-u.INITIAL_WORLD_BOUNDARY,b=u.INITIAL_WORLD_BOUNDARY;p=u.WORLD_CENTER_Y+l.nextDouble()*(b-y)+y,this.rect.x=f,this.rect.y=p},h.prototype.updateBounds=function(){if(this.getChild()==null)throw"assert failed";if(this.getChild().getNodes().length!=0){var f=this.getChild();if(f.updateBounds(!0),this.rect.x=f.getLeft(),this.rect.y=f.getTop(),this.setWidth(f.getRight()-f.getLeft()),this.setHeight(f.getBottom()-f.getTop()),u.NODE_DIMENSIONS_INCLUDE_LABELS){var p=f.getRight()-f.getLeft(),g=f.getBottom()-f.getTop();this.labelWidth&&(this.labelPosHorizontal=="left"?(this.rect.x-=this.labelWidth,this.setWidth(p+this.labelWidth)):this.labelPosHorizontal=="center"&&this.labelWidth>p?(this.rect.x-=(this.labelWidth-p)/2,this.setWidth(this.labelWidth)):this.labelPosHorizontal=="right"&&this.setWidth(p+this.labelWidth)),this.labelHeight&&(this.labelPosVertical=="top"?(this.rect.y-=this.labelHeight,this.setHeight(g+this.labelHeight)):this.labelPosVertical=="center"&&this.labelHeight>g?(this.rect.y-=(this.labelHeight-g)/2,this.setHeight(this.labelHeight)):this.labelPosVertical=="bottom"&&this.setHeight(g+this.labelHeight))}}},h.prototype.getInclusionTreeDepth=function(){if(this.inclusionTreeDepth==a.MAX_VALUE)throw"assert failed";return this.inclusionTreeDepth},h.prototype.transform=function(f){var p=this.rect.x;p>u.WORLD_BOUNDARY?p=u.WORLD_BOUNDARY:p<-u.WORLD_BOUNDARY&&(p=-u.WORLD_BOUNDARY);var g=this.rect.y;g>u.WORLD_BOUNDARY?g=u.WORLD_BOUNDARY:g<-u.WORLD_BOUNDARY&&(g=-u.WORLD_BOUNDARY);var m=new c(p,g),y=f.inverseTransformPoint(m);this.setLocation(y.x,y.y)},h.prototype.getLeft=function(){return this.rect.x},h.prototype.getRight=function(){return this.rect.x+this.rect.width},h.prototype.getTop=function(){return this.rect.y},h.prototype.getBottom=function(){return this.rect.y+this.rect.height},h.prototype.getParent=function(){return this.owner==null?null:this.owner.getParent()},n.exports=h},function(n,r,i){var s=i(0);function a(){}for(var o in s)a[o]=s[o];a.MAX_ITERATIONS=2500,a.DEFAULT_EDGE_LENGTH=50,a.DEFAULT_SPRING_STRENGTH=.45,a.DEFAULT_REPULSION_STRENGTH=4500,a.DEFAULT_GRAVITY_STRENGTH=.4,a.DEFAULT_COMPOUND_GRAVITY_STRENGTH=1,a.DEFAULT_GRAVITY_RANGE_FACTOR=3.8,a.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=1.5,a.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION=!0,a.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION=!0,a.DEFAULT_COOLING_FACTOR_INCREMENTAL=.3,a.COOLING_ADAPTATION_FACTOR=.33,a.ADAPTATION_LOWER_NODE_LIMIT=1e3,a.ADAPTATION_UPPER_NODE_LIMIT=5e3,a.MAX_NODE_DISPLACEMENT_INCREMENTAL=100,a.MAX_NODE_DISPLACEMENT=a.MAX_NODE_DISPLACEMENT_INCREMENTAL*3,a.MIN_REPULSION_DIST=a.DEFAULT_EDGE_LENGTH/10,a.CONVERGENCE_CHECK_PERIOD=100,a.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=.1,a.MIN_EDGE_LENGTH=1,a.GRID_CALCULATION_CHECK_PERIOD=10,n.exports=a},function(n,r,i){function s(a,o){a==null&&o==null?(this.x=0,this.y=0):(this.x=a,this.y=o)}s.prototype.getX=function(){return this.x},s.prototype.getY=function(){return this.y},s.prototype.setX=function(a){this.x=a},s.prototype.setY=function(a){this.y=a},s.prototype.getDifference=function(a){return new DimensionD(this.x-a.x,this.y-a.y)},s.prototype.getCopy=function(){return new s(this.x,this.y)},s.prototype.translate=function(a){return this.x+=a.width,this.y+=a.height,this},n.exports=s},function(n,r,i){var s=i(2),a=i(10),o=i(0),u=i(7),l=i(3),c=i(1),h=i(13),d=i(12),f=i(11);function p(m,y,b){s.call(this,b),this.estimatedSize=a.MIN_VALUE,this.margin=o.DEFAULT_GRAPH_MARGIN,this.edges=[],this.nodes=[],this.isConnected=!1,this.parent=m,y!=null&&y instanceof u?this.graphManager=y:y!=null&&y instanceof Layout&&(this.graphManager=y.graphManager)}p.prototype=Object.create(s.prototype);for(var g in s)p[g]=s[g];p.prototype.getNodes=function(){return this.nodes},p.prototype.getEdges=function(){return this.edges},p.prototype.getGraphManager=function(){return this.graphManager},p.prototype.getParent=function(){return this.parent},p.prototype.getLeft=function(){return this.left},p.prototype.getRight=function(){return this.right},p.prototype.getTop=function(){return this.top},p.prototype.getBottom=function(){return this.bottom},p.prototype.isConnected=function(){return this.isConnected},p.prototype.add=function(m,y,b){if(y==null&&b==null){var v=m;if(this.graphManager==null)throw"Graph has no graph mgr!";if(this.getNodes().indexOf(v)>-1)throw"Node already in graph!";return v.owner=this,this.getNodes().push(v),v}else{var E=m;if(!(this.getNodes().indexOf(y)>-1&&this.getNodes().indexOf(b)>-1))throw"Source or target not in graph!";if(!(y.owner==b.owner&&y.owner==this))throw"Both owners must be this graph!";return y.owner!=b.owner?null:(E.source=y,E.target=b,E.isInterGraph=!1,this.getEdges().push(E),y.edges.push(E),b!=y&&b.edges.push(E),E)}},p.prototype.remove=function(m){var y=m;if(m instanceof l){if(y==null)throw"Node is null!";if(!(y.owner!=null&&y.owner==this))throw"Owner graph is invalid!";if(this.graphManager==null)throw"Owner graph manager is invalid!";for(var b=y.edges.slice(),v,E=b.length,w=0;w<E;w++)v=b[w],v.isInterGraph?this.graphManager.remove(v):v.source.owner.remove(v);var N=this.nodes.indexOf(y);if(N==-1)throw"Node not in owner node list!";this.nodes.splice(N,1)}else if(m instanceof c){var v=m;if(v==null)throw"Edge is null!";if(!(v.source!=null&&v.target!=null))throw"Source and/or target is null!";if(!(v.source.owner!=null&&v.target.owner!=null&&v.source.owner==this&&v.target.owner==this))throw"Source and/or target owner is invalid!";var D=v.source.edges.indexOf(v),k=v.target.edges.indexOf(v);if(!(D>-1&&k>-1))throw"Source and/or target doesn't know this edge!";v.source.edges.splice(D,1),v.target!=v.source&&v.target.edges.splice(k,1);var N=v.source.owner.getEdges().indexOf(v);if(N==-1)throw"Not in owner's edge list!";v.source.owner.getEdges().splice(N,1)}},p.prototype.updateLeftTop=function(){for(var m=a.MAX_VALUE,y=a.MAX_VALUE,b,v,E,w=this.getNodes(),N=w.length,D=0;D<N;D++){var k=w[D];b=k.getTop(),v=k.getLeft(),m>b&&(m=b),y>v&&(y=v)}return m==a.MAX_VALUE?null:(w[0].getParent().paddingLeft!=null?E=w[0].getParent().paddingLeft:E=this.margin,this.left=y-E,this.top=m-E,new d(this.left,this.top))},p.prototype.updateBounds=function(m){for(var y=a.MAX_VALUE,b=-a.MAX_VALUE,v=a.MAX_VALUE,E=-a.MAX_VALUE,w,N,D,k,F,M=this.nodes,S=M.length,R=0;R<S;R++){var I=M[R];m&&I.child!=null&&I.updateBounds(),w=I.getLeft(),N=I.getRight(),D=I.getTop(),k=I.getBottom(),y>w&&(y=w),b<N&&(b=N),v>D&&(v=D),E<k&&(E=k)}var x=new h(y,v,b-y,E-v);y==a.MAX_VALUE&&(this.left=this.parent.getLeft(),this.right=this.parent.getRight(),this.top=this.parent.getTop(),this.bottom=this.parent.getBottom()),M[0].getParent().paddingLeft!=null?F=M[0].getParent().paddingLeft:F=this.margin,this.left=x.x-F,this.right=x.x+x.width+F,this.top=x.y-F,this.bottom=x.y+x.height+F},p.calculateBounds=function(m){for(var y=a.MAX_VALUE,b=-a.MAX_VALUE,v=a.MAX_VALUE,E=-a.MAX_VALUE,w,N,D,k,F=m.length,M=0;M<F;M++){var S=m[M];w=S.getLeft(),N=S.getRight(),D=S.getTop(),k=S.getBottom(),y>w&&(y=w),b<N&&(b=N),v>D&&(v=D),E<k&&(E=k)}var R=new h(y,v,b-y,E-v);return R},p.prototype.getInclusionTreeDepth=function(){return this==this.graphManager.getRoot()?1:this.parent.getInclusionTreeDepth()},p.prototype.getEstimatedSize=function(){if(this.estimatedSize==a.MIN_VALUE)throw"assert failed";return this.estimatedSize},p.prototype.calcEstimatedSize=function(){for(var m=0,y=this.nodes,b=y.length,v=0;v<b;v++){var E=y[v];m+=E.calcEstimatedSize()}return m==0?this.estimatedSize=o.EMPTY_COMPOUND_NODE_SIZE:this.estimatedSize=m/Math.sqrt(this.nodes.length),this.estimatedSize},p.prototype.updateConnected=function(){var m=this;if(this.nodes.length==0){this.isConnected=!0;return}var y=new f,b=new Set,v=this.nodes[0],E,w,N=v.withChildren();for(N.forEach(function(R){y.push(R),b.add(R)});y.length!==0;){v=y.shift(),E=v.getEdges();for(var D=E.length,k=0;k<D;k++){var F=E[k];if(w=F.getOtherEndInGraph(v,this),w!=null&&!b.has(w)){var M=w.withChildren();M.forEach(function(R){y.push(R),b.add(R)})}}}if(this.isConnected=!1,b.size>=this.nodes.length){var S=0;b.forEach(function(R){R.owner==m&&S++}),S==this.nodes.length&&(this.isConnected=!0)}},n.exports=p},function(n,r,i){var s,a=i(1);function o(u){s=i(6),this.layout=u,this.graphs=[],this.edges=[]}o.prototype.addRoot=function(){var u=this.layout.newGraph(),l=this.layout.newNode(null),c=this.add(u,l);return this.setRootGraph(c),this.rootGraph},o.prototype.add=function(u,l,c,h,d){if(c==null&&h==null&&d==null){if(u==null)throw"Graph is null!";if(l==null)throw"Parent node is null!";if(this.graphs.indexOf(u)>-1)throw"Graph already in this graph mgr!";if(this.graphs.push(u),u.parent!=null)throw"Already has a parent!";if(l.child!=null)throw"Already has a child!";return u.parent=l,l.child=u,u}else{d=c,h=l,c=u;var f=h.getOwner(),p=d.getOwner();if(!(f!=null&&f.getGraphManager()==this))throw"Source not in this graph mgr!";if(!(p!=null&&p.getGraphManager()==this))throw"Target not in this graph mgr!";if(f==p)return c.isInterGraph=!1,f.add(c,h,d);if(c.isInterGraph=!0,c.source=h,c.target=d,this.edges.indexOf(c)>-1)throw"Edge already in inter-graph edge list!";if(this.edges.push(c),!(c.source!=null&&c.target!=null))throw"Edge source and/or target is null!";if(!(c.source.edges.indexOf(c)==-1&&c.target.edges.indexOf(c)==-1))throw"Edge already in source and/or target incidency list!";return c.source.edges.push(c),c.target.edges.push(c),c}},o.prototype.remove=function(u){if(u instanceof s){var l=u;if(l.getGraphManager()!=this)throw"Graph not in this graph mgr";if(!(l==this.rootGraph||l.parent!=null&&l.parent.graphManager==this))throw"Invalid parent node!";var c=[];c=c.concat(l.getEdges());for(var h,d=c.length,f=0;f<d;f++)h=c[f],l.remove(h);var p=[];p=p.concat(l.getNodes());var g;d=p.length;for(var f=0;f<d;f++)g=p[f],l.remove(g);l==this.rootGraph&&this.setRootGraph(null);var m=this.graphs.indexOf(l);this.graphs.splice(m,1),l.parent=null}else if(u instanceof a){if(h=u,h==null)throw"Edge is null!";if(!h.isInterGraph)throw"Not an inter-graph edge!";if(!(h.source!=null&&h.target!=null))throw"Source and/or target is null!";if(!(h.source.edges.indexOf(h)!=-1&&h.target.edges.indexOf(h)!=-1))throw"Source and/or target doesn't know this edge!";var m=h.source.edges.indexOf(h);if(h.source.edges.splice(m,1),m=h.target.edges.indexOf(h),h.target.edges.splice(m,1),!(h.source.owner!=null&&h.source.owner.getGraphManager()!=null))throw"Edge owner graph or owner graph manager is null!";if(h.source.owner.getGraphManager().edges.indexOf(h)==-1)throw"Not in owner graph manager's edge list!";var m=h.source.owner.getGraphManager().edges.indexOf(h);h.source.owner.getGraphManager().edges.splice(m,1)}},o.prototype.updateBounds=function(){this.rootGraph.updateBounds(!0)},o.prototype.getGraphs=function(){return this.graphs},o.prototype.getAllNodes=function(){if(this.allNodes==null){for(var u=[],l=this.getGraphs(),c=l.length,h=0;h<c;h++)u=u.concat(l[h].getNodes());this.allNodes=u}return this.allNodes},o.prototype.resetAllNodes=function(){this.allNodes=null},o.prototype.resetAllEdges=function(){this.allEdges=null},o.prototype.resetAllNodesToApplyGravitation=function(){this.allNodesToApplyGravitation=null},o.prototype.getAllEdges=function(){if(this.allEdges==null){var u=[],l=this.getGraphs();l.length;for(var c=0;c<l.length;c++)u=u.concat(l[c].getEdges());u=u.concat(this.edges),this.allEdges=u}return this.allEdges},o.prototype.getAllNodesToApplyGravitation=function(){return this.allNodesToApplyGravitation},o.prototype.setAllNodesToApplyGravitation=function(u){if(this.allNodesToApplyGravitation!=null)throw"assert failed";this.allNodesToApplyGravitation=u},o.prototype.getRoot=function(){return this.rootGraph},o.prototype.setRootGraph=function(u){if(u.getGraphManager()!=this)throw"Root not in this graph mgr!";this.rootGraph=u,u.parent==null&&(u.parent=this.layout.newNode("Root node"))},o.prototype.getLayout=function(){return this.layout},o.prototype.isOneAncestorOfOther=function(u,l){if(!(u!=null&&l!=null))throw"assert failed";if(u==l)return!0;var c=u.getOwner(),h;do{if(h=c.getParent(),h==null)break;if(h==l)return!0;if(c=h.getOwner(),c==null)break}while(!0);c=l.getOwner();do{if(h=c.getParent(),h==null)break;if(h==u)return!0;if(c=h.getOwner(),c==null)break}while(!0);return!1},o.prototype.calcLowestCommonAncestors=function(){for(var u,l,c,h,d,f=this.getAllEdges(),p=f.length,g=0;g<p;g++){if(u=f[g],l=u.source,c=u.target,u.lca=null,u.sourceInLca=l,u.targetInLca=c,l==c){u.lca=l.getOwner();continue}for(h=l.getOwner();u.lca==null;){for(u.targetInLca=c,d=c.getOwner();u.lca==null;){if(d==h){u.lca=d;break}if(d==this.rootGraph)break;if(u.lca!=null)throw"assert failed";u.targetInLca=d.getParent(),d=u.targetInLca.getOwner()}if(h==this.rootGraph)break;u.lca==null&&(u.sourceInLca=h.getParent(),h=u.sourceInLca.getOwner())}if(u.lca==null)throw"assert failed"}},o.prototype.calcLowestCommonAncestor=function(u,l){if(u==l)return u.getOwner();var c=u.getOwner();do{if(c==null)break;var h=l.getOwner();do{if(h==null)break;if(h==c)return h;h=h.getParent().getOwner()}while(!0);c=c.getParent().getOwner()}while(!0);return c},o.prototype.calcInclusionTreeDepths=function(u,l){u==null&&l==null&&(u=this.rootGraph,l=1);for(var c,h=u.getNodes(),d=h.length,f=0;f<d;f++)c=h[f],c.inclusionTreeDepth=l,c.child!=null&&this.calcInclusionTreeDepths(c.child,l+1)},o.prototype.includesInvalidEdge=function(){for(var u,l=[],c=this.edges.length,h=0;h<c;h++)u=this.edges[h],this.isOneAncestorOfOther(u.source,u.target)&&l.push(u);for(var h=0;h<l.length;h++)this.remove(l[h]);return!1},n.exports=o},function(n,r,i){var s=i(12);function a(){}a.calcSeparationAmount=function(o,u,l,c){if(!o.intersects(u))throw"assert failed";var h=new Array(2);this.decideDirectionsForOverlappingNodes(o,u,h),l[0]=Math.min(o.getRight(),u.getRight())-Math.max(o.x,u.x),l[1]=Math.min(o.getBottom(),u.getBottom())-Math.max(o.y,u.y),o.getX()<=u.getX()&&o.getRight()>=u.getRight()?l[0]+=Math.min(u.getX()-o.getX(),o.getRight()-u.getRight()):u.getX()<=o.getX()&&u.getRight()>=o.getRight()&&(l[0]+=Math.min(o.getX()-u.getX(),u.getRight()-o.getRight())),o.getY()<=u.getY()&&o.getBottom()>=u.getBottom()?l[1]+=Math.min(u.getY()-o.getY(),o.getBottom()-u.getBottom()):u.getY()<=o.getY()&&u.getBottom()>=o.getBottom()&&(l[1]+=Math.min(o.getY()-u.getY(),u.getBottom()-o.getBottom()));var d=Math.abs((u.getCenterY()-o.getCenterY())/(u.getCenterX()-o.getCenterX()));u.getCenterY()===o.getCenterY()&&u.getCenterX()===o.getCenterX()&&(d=1);var f=d*l[0],p=l[1]/d;l[0]<p?p=l[0]:f=l[1],l[0]=-1*h[0]*(p/2+c),l[1]=-1*h[1]*(f/2+c)},a.decideDirectionsForOverlappingNodes=function(o,u,l){o.getCenterX()<u.getCenterX()?l[0]=-1:l[0]=1,o.getCenterY()<u.getCenterY()?l[1]=-1:l[1]=1},a.getIntersection2=function(o,u,l){var c=o.getCenterX(),h=o.getCenterY(),d=u.getCenterX(),f=u.getCenterY();if(o.intersects(u))return l[0]=c,l[1]=h,l[2]=d,l[3]=f,!0;var p=o.getX(),g=o.getY(),m=o.getRight(),y=o.getX(),b=o.getBottom(),v=o.getRight(),E=o.getWidthHalf(),w=o.getHeightHalf(),N=u.getX(),D=u.getY(),k=u.getRight(),F=u.getX(),M=u.getBottom(),S=u.getRight(),R=u.getWidthHalf(),I=u.getHeightHalf(),x=!1,_=!1;if(c===d){if(h>f)return l[0]=c,l[1]=g,l[2]=d,l[3]=M,!1;if(h<f)return l[0]=c,l[1]=b,l[2]=d,l[3]=D,!1}else if(h===f){if(c>d)return l[0]=p,l[1]=h,l[2]=k,l[3]=f,!1;if(c<d)return l[0]=m,l[1]=h,l[2]=N,l[3]=f,!1}else{var C=o.height/o.width,A=u.height/u.width,T=(f-h)/(d-c),O=void 0,L=void 0,P=void 0,Y=void 0,W=void 0,X=void 0;if(-C===T?c>d?(l[0]=y,l[1]=b,x=!0):(l[0]=m,l[1]=g,x=!0):C===T&&(c>d?(l[0]=p,l[1]=g,x=!0):(l[0]=v,l[1]=b,x=!0)),-A===T?d>c?(l[2]=F,l[3]=M,_=!0):(l[2]=k,l[3]=D,_=!0):A===T&&(d>c?(l[2]=N,l[3]=D,_=!0):(l[2]=S,l[3]=M,_=!0)),x&&_)return!1;if(c>d?h>f?(O=this.getCardinalDirection(C,T,4),L=this.getCardinalDirection(A,T,2)):(O=this.getCardinalDirection(-C,T,3),L=this.getCardinalDirection(-A,T,1)):h>f?(O=this.getCardinalDirection(-C,T,1),L=this.getCardinalDirection(-A,T,3)):(O=this.getCardinalDirection(C,T,2),L=this.getCardinalDirection(A,T,4)),!x)switch(O){case 1:Y=g,P=c+-w/T,l[0]=P,l[1]=Y;break;case 2:P=v,Y=h+E*T,l[0]=P,l[1]=Y;break;case 3:Y=b,P=c+w/T,l[0]=P,l[1]=Y;break;case 4:P=y,Y=h+-E*T,l[0]=P,l[1]=Y;break}if(!_)switch(L){case 1:X=D,W=d+-I/T,l[2]=W,l[3]=X;break;case 2:W=S,X=f+R*T,l[2]=W,l[3]=X;break;case 3:X=M,W=d+I/T,l[2]=W,l[3]=X;break;case 4:W=F,X=f+-R*T,l[2]=W,l[3]=X;break}}return!1},a.getCardinalDirection=function(o,u,l){return o>u?l:1+l%4},a.getIntersection=function(o,u,l,c){if(c==null)return this.getIntersection2(o,u,l);var h=o.x,d=o.y,f=u.x,p=u.y,g=l.x,m=l.y,y=c.x,b=c.y,v=void 0,E=void 0,w=void 0,N=void 0,D=void 0,k=void 0,F=void 0,M=void 0,S=void 0;return w=p-d,D=h-f,F=f*d-h*p,N=b-m,k=g-y,M=y*m-g*b,S=w*k-N*D,S===0?null:(v=(D*M-k*F)/S,E=(N*F-w*M)/S,new s(v,E))},a.angleOfVector=function(o,u,l,c){var h=void 0;return o!==l?(h=Math.atan((c-u)/(l-o)),l<o?h+=Math.PI:c<u&&(h+=this.TWO_PI)):c<u?h=this.ONE_AND_HALF_PI:h=this.HALF_PI,h},a.doIntersect=function(o,u,l,c){var h=o.x,d=o.y,f=u.x,p=u.y,g=l.x,m=l.y,y=c.x,b=c.y,v=(f-h)*(b-m)-(y-g)*(p-d);if(v===0)return!1;var E=((b-m)*(y-h)+(g-y)*(b-d))/v,w=((d-p)*(y-h)+(f-h)*(b-d))/v;return 0<E&&E<1&&0<w&&w<1},a.findCircleLineIntersections=function(o,u,l,c,h,d,f){var p=(l-o)*(l-o)+(c-u)*(c-u),g=2*((o-h)*(l-o)+(u-d)*(c-u)),m=(o-h)*(o-h)+(u-d)*(u-d)-f*f,y=g*g-4*p*m;if(y>=0){var b=(-g+Math.sqrt(g*g-4*p*m))/(2*p),v=(-g-Math.sqrt(g*g-4*p*m))/(2*p),E=null;return b>=0&&b<=1?[b]:v>=0&&v<=1?[v]:E}else return null},a.HALF_PI=.5*Math.PI,a.ONE_AND_HALF_PI=1.5*Math.PI,a.TWO_PI=2*Math.PI,a.THREE_PI=3*Math.PI,n.exports=a},function(n,r,i){function s(){}s.sign=function(a){return a>0?1:a<0?-1:0},s.floor=function(a){return a<0?Math.ceil(a):Math.floor(a)},s.ceil=function(a){return a<0?Math.floor(a):Math.ceil(a)},n.exports=s},function(n,r,i){function s(){}s.MAX_VALUE=2147483647,s.MIN_VALUE=-2147483648,n.exports=s},function(n,r,i){var s=function(){function h(d,f){for(var p=0;p<f.length;p++){var g=f[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}}return function(d,f,p){return f&&h(d.prototype,f),p&&h(d,p),d}}();function a(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}var o=function(d){return{value:d,next:null,prev:null}},u=function(d,f,p,g){return d!==null?d.next=f:g.head=f,p!==null?p.prev=f:g.tail=f,f.prev=d,f.next=p,g.length++,f},l=function(d,f){var p=d.prev,g=d.next;return p!==null?p.next=g:f.head=g,g!==null?g.prev=p:f.tail=p,d.prev=d.next=null,f.length--,d},c=function(){function h(d){var f=this;a(this,h),this.length=0,this.head=null,this.tail=null,d!=null&&d.forEach(function(p){return f.push(p)})}return s(h,[{key:"size",value:function(){return this.length}},{key:"insertBefore",value:function(f,p){return u(p.prev,o(f),p,this)}},{key:"insertAfter",value:function(f,p){return u(p,o(f),p.next,this)}},{key:"insertNodeBefore",value:function(f,p){return u(p.prev,f,p,this)}},{key:"insertNodeAfter",value:function(f,p){return u(p,f,p.next,this)}},{key:"push",value:function(f){return u(this.tail,o(f),null,this)}},{key:"unshift",value:function(f){return u(null,o(f),this.head,this)}},{key:"remove",value:function(f){return l(f,this)}},{key:"pop",value:function(){return l(this.tail,this).value}},{key:"popNode",value:function(){return l(this.tail,this)}},{key:"shift",value:function(){return l(this.head,this).value}},{key:"shiftNode",value:function(){return l(this.head,this)}},{key:"get_object_at",value:function(f){if(f<=this.length()){for(var p=1,g=this.head;p<f;)g=g.next,p++;return g.value}}},{key:"set_object_at",value:function(f,p){if(f<=this.length()){for(var g=1,m=this.head;g<f;)m=m.next,g++;m.value=p}}}]),h}();n.exports=c},function(n,r,i){function s(a,o,u){this.x=null,this.y=null,a==null&&o==null&&u==null?(this.x=0,this.y=0):typeof a=="number"&&typeof o=="number"&&u==null?(this.x=a,this.y=o):a.constructor.name=="Point"&&o==null&&u==null&&(u=a,this.x=u.x,this.y=u.y)}s.prototype.getX=function(){return this.x},s.prototype.getY=function(){return this.y},s.prototype.getLocation=function(){return new s(this.x,this.y)},s.prototype.setLocation=function(a,o,u){a.constructor.name=="Point"&&o==null&&u==null?(u=a,this.setLocation(u.x,u.y)):typeof a=="number"&&typeof o=="number"&&u==null&&(parseInt(a)==a&&parseInt(o)==o?this.move(a,o):(this.x=Math.floor(a+.5),this.y=Math.floor(o+.5)))},s.prototype.move=function(a,o){this.x=a,this.y=o},s.prototype.translate=function(a,o){this.x+=a,this.y+=o},s.prototype.equals=function(a){if(a.constructor.name=="Point"){var o=a;return this.x==o.x&&this.y==o.y}return this==a},s.prototype.toString=function(){return new s().constructor.name+"[x="+this.x+",y="+this.y+"]"},n.exports=s},function(n,r,i){function s(a,o,u,l){this.x=0,this.y=0,this.width=0,this.height=0,a!=null&&o!=null&&u!=null&&l!=null&&(this.x=a,this.y=o,this.width=u,this.height=l)}s.prototype.getX=function(){return this.x},s.prototype.setX=function(a){this.x=a},s.prototype.getY=function(){return this.y},s.prototype.setY=function(a){this.y=a},s.prototype.getWidth=function(){return this.width},s.prototype.setWidth=function(a){this.width=a},s.prototype.getHeight=function(){return this.height},s.prototype.setHeight=function(a){this.height=a},s.prototype.getRight=function(){return this.x+this.width},s.prototype.getBottom=function(){return this.y+this.height},s.prototype.intersects=function(a){return!(this.getRight()<a.x||this.getBottom()<a.y||a.getRight()<this.x||a.getBottom()<this.y)},s.prototype.getCenterX=function(){return this.x+this.width/2},s.prototype.getMinX=function(){return this.getX()},s.prototype.getMaxX=function(){return this.getX()+this.width},s.prototype.getCenterY=function(){return this.y+this.height/2},s.prototype.getMinY=function(){return this.getY()},s.prototype.getMaxY=function(){return this.getY()+this.height},s.prototype.getWidthHalf=function(){return this.width/2},s.prototype.getHeightHalf=function(){return this.height/2},n.exports=s},function(n,r,i){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};function a(){}a.lastID=0,a.createID=function(o){return a.isPrimitive(o)?o:(o.uniqueID!=null||(o.uniqueID=a.getString(),a.lastID++),o.uniqueID)},a.getString=function(o){return o==null&&(o=a.lastID),"Object#"+o},a.isPrimitive=function(o){var u=typeof o>"u"?"undefined":s(o);return o==null||u!="object"&&u!="function"},n.exports=a},function(n,r,i){function s(g){if(Array.isArray(g)){for(var m=0,y=Array(g.length);m<g.length;m++)y[m]=g[m];return y}else return Array.from(g)}var a=i(0),o=i(7),u=i(3),l=i(1),c=i(6),h=i(5),d=i(17),f=i(29);function p(g){f.call(this),this.layoutQuality=a.QUALITY,this.createBendsAsNeeded=a.DEFAULT_CREATE_BENDS_AS_NEEDED,this.incremental=a.DEFAULT_INCREMENTAL,this.animationOnLayout=a.DEFAULT_ANIMATION_ON_LAYOUT,this.animationDuringLayout=a.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=a.DEFAULT_ANIMATION_PERIOD,this.uniformLeafNodeSizes=a.DEFAULT_UNIFORM_LEAF_NODE_SIZES,this.edgeToDummyNodes=new Map,this.graphManager=new o(this),this.isLayoutFinished=!1,this.isSubLayout=!1,this.isRemoteUse=!1,g!=null&&(this.isRemoteUse=g)}p.RANDOM_SEED=1,p.prototype=Object.create(f.prototype),p.prototype.getGraphManager=function(){return this.graphManager},p.prototype.getAllNodes=function(){return this.graphManager.getAllNodes()},p.prototype.getAllEdges=function(){return this.graphManager.getAllEdges()},p.prototype.getAllNodesToApplyGravitation=function(){return this.graphManager.getAllNodesToApplyGravitation()},p.prototype.newGraphManager=function(){var g=new o(this);return this.graphManager=g,g},p.prototype.newGraph=function(g){return new c(null,this.graphManager,g)},p.prototype.newNode=function(g){return new u(this.graphManager,g)},p.prototype.newEdge=function(g){return new l(null,null,g)},p.prototype.checkLayoutSuccess=function(){return this.graphManager.getRoot()==null||this.graphManager.getRoot().getNodes().length==0||this.graphManager.includesInvalidEdge()},p.prototype.runLayout=function(){this.isLayoutFinished=!1,this.tilingPreLayout&&this.tilingPreLayout(),this.initParameters();var g;return this.checkLayoutSuccess()?g=!1:g=this.layout(),a.ANIMATE==="during"?!1:(g&&(this.isSubLayout||this.doPostLayout()),this.tilingPostLayout&&this.tilingPostLayout(),this.isLayoutFinished=!0,g)},p.prototype.doPostLayout=function(){this.incremental||this.transform(),this.update()},p.prototype.update2=function(){if(this.createBendsAsNeeded&&(this.createBendpointsFromDummyNodes(),this.graphManager.resetAllEdges()),!this.isRemoteUse){for(var g=this.graphManager.getAllEdges(),m=0;m<g.length;m++)g[m];for(var y=this.graphManager.getRoot().getNodes(),m=0;m<y.length;m++)y[m];this.update(this.graphManager.getRoot())}},p.prototype.update=function(g){if(g==null)this.update2();else if(g instanceof u){var m=g;if(m.getChild()!=null)for(var y=m.getChild().getNodes(),b=0;b<y.length;b++)update(y[b]);if(m.vGraphObject!=null){var v=m.vGraphObject;v.update(m)}}else if(g instanceof l){var E=g;if(E.vGraphObject!=null){var w=E.vGraphObject;w.update(E)}}else if(g instanceof c){var N=g;if(N.vGraphObject!=null){var D=N.vGraphObject;D.update(N)}}},p.prototype.initParameters=function(){this.isSubLayout||(this.layoutQuality=a.QUALITY,this.animationDuringLayout=a.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=a.DEFAULT_ANIMATION_PERIOD,this.animationOnLayout=a.DEFAULT_ANIMATION_ON_LAYOUT,this.incremental=a.DEFAULT_INCREMENTAL,this.createBendsAsNeeded=a.DEFAULT_CREATE_BENDS_AS_NEEDED,this.uniformLeafNodeSizes=a.DEFAULT_UNIFORM_LEAF_NODE_SIZES),this.animationDuringLayout&&(this.animationOnLayout=!1)},p.prototype.transform=function(g){if(g==null)this.transform(new h(0,0));else{var m=new d,y=this.graphManager.getRoot().updateLeftTop();if(y!=null){m.setWorldOrgX(g.x),m.setWorldOrgY(g.y),m.setDeviceOrgX(y.x),m.setDeviceOrgY(y.y);for(var b=this.getAllNodes(),v,E=0;E<b.length;E++)v=b[E],v.transform(m)}}},p.prototype.positionNodesRandomly=function(g){if(g==null)this.positionNodesRandomly(this.getGraphManager().getRoot()),this.getGraphManager().getRoot().updateBounds(!0);else for(var m,y,b=g.getNodes(),v=0;v<b.length;v++)m=b[v],y=m.getChild(),y==null||y.getNodes().length==0?m.scatter():(this.positionNodesRandomly(y),m.updateBounds())},p.prototype.getFlatForest=function(){for(var g=[],m=!0,y=this.graphManager.getRoot().getNodes(),b=!0,v=0;v<y.length;v++)y[v].getChild()!=null&&(b=!1);if(!b)return g;var E=new Set,w=[],N=new Map,D=[];for(D=D.concat(y);D.length>0&&m;){for(w.push(D[0]);w.length>0&&m;){var k=w[0];w.splice(0,1),E.add(k);for(var F=k.getEdges(),v=0;v<F.length;v++){var M=F[v].getOtherEnd(k);if(N.get(k)!=M)if(!E.has(M))w.push(M),N.set(M,k);else{m=!1;break}}}if(!m)g=[];else{var S=[].concat(s(E));g.push(S);for(var v=0;v<S.length;v++){var R=S[v],I=D.indexOf(R);I>-1&&D.splice(I,1)}E=new Set,N=new Map}}return g},p.prototype.createDummyNodesForBendpoints=function(g){for(var m=[],y=g.source,b=this.graphManager.calcLowestCommonAncestor(g.source,g.target),v=0;v<g.bendpoints.length;v++){var E=this.newNode(null);E.setRect(new Point(0,0),new Dimension(1,1)),b.add(E);var w=this.newEdge(null);this.graphManager.add(w,y,E),m.add(E),y=E}var w=this.newEdge(null);return this.graphManager.add(w,y,g.target),this.edgeToDummyNodes.set(g,m),g.isInterGraph()?this.graphManager.remove(g):b.remove(g),m},p.prototype.createBendpointsFromDummyNodes=function(){var g=[];g=g.concat(this.graphManager.getAllEdges()),g=[].concat(s(this.edgeToDummyNodes.keys())).concat(g);for(var m=0;m<g.length;m++){var y=g[m];if(y.bendpoints.length>0){for(var b=this.edgeToDummyNodes.get(y),v=0;v<b.length;v++){var E=b[v],w=new h(E.getCenterX(),E.getCenterY()),N=y.bendpoints.get(v);N.x=w.x,N.y=w.y,E.getOwner().remove(E)}this.graphManager.add(y,y.source,y.target)}}},p.transform=function(g,m,y,b){if(y!=null&&b!=null){var v=m;if(g<=50){var E=m/y;v-=(m-E)/50*(50-g)}else{var w=m*b;v+=(w-m)/50*(g-50)}return v}else{var N,D;return g<=50?(N=9*m/500,D=m/10):(N=9*m/50,D=-8*m),N*g+D}},p.findCenterOfTree=function(g){var m=[];m=m.concat(g);var y=[],b=new Map,v=!1,E=null;(m.length==1||m.length==2)&&(v=!0,E=m[0]);for(var w=0;w<m.length;w++){var N=m[w],D=N.getNeighborsList().size;b.set(N,N.getNeighborsList().size),D==1&&y.push(N)}var k=[];for(k=k.concat(y);!v;){var F=[];F=F.concat(k),k=[];for(var w=0;w<m.length;w++){var N=m[w],M=m.indexOf(N);M>=0&&m.splice(M,1);var S=N.getNeighborsList();S.forEach(function(x){if(y.indexOf(x)<0){var _=b.get(x),C=_-1;C==1&&k.push(x),b.set(x,C)}})}y=y.concat(k),(m.length==1||m.length==2)&&(v=!0,E=m[0])}return E},p.prototype.setGraphManager=function(g){this.graphManager=g},n.exports=p},function(n,r,i){function s(){}s.seed=1,s.x=0,s.nextDouble=function(){return s.x=Math.sin(s.seed++)*1e4,s.x-Math.floor(s.x)},n.exports=s},function(n,r,i){var s=i(5);function a(o,u){this.lworldOrgX=0,this.lworldOrgY=0,this.ldeviceOrgX=0,this.ldeviceOrgY=0,this.lworldExtX=1,this.lworldExtY=1,this.ldeviceExtX=1,this.ldeviceExtY=1}a.prototype.getWorldOrgX=function(){return this.lworldOrgX},a.prototype.setWorldOrgX=function(o){this.lworldOrgX=o},a.prototype.getWorldOrgY=function(){return this.lworldOrgY},a.prototype.setWorldOrgY=function(o){this.lworldOrgY=o},a.prototype.getWorldExtX=function(){return this.lworldExtX},a.prototype.setWorldExtX=function(o){this.lworldExtX=o},a.prototype.getWorldExtY=function(){return this.lworldExtY},a.prototype.setWorldExtY=function(o){this.lworldExtY=o},a.prototype.getDeviceOrgX=function(){return this.ldeviceOrgX},a.prototype.setDeviceOrgX=function(o){this.ldeviceOrgX=o},a.prototype.getDeviceOrgY=function(){return this.ldeviceOrgY},a.prototype.setDeviceOrgY=function(o){this.ldeviceOrgY=o},a.prototype.getDeviceExtX=function(){return this.ldeviceExtX},a.prototype.setDeviceExtX=function(o){this.ldeviceExtX=o},a.prototype.getDeviceExtY=function(){return this.ldeviceExtY},a.prototype.setDeviceExtY=function(o){this.ldeviceExtY=o},a.prototype.transformX=function(o){var u=0,l=this.lworldExtX;return l!=0&&(u=this.ldeviceOrgX+(o-this.lworldOrgX)*this.ldeviceExtX/l),u},a.prototype.transformY=function(o){var u=0,l=this.lworldExtY;return l!=0&&(u=this.ldeviceOrgY+(o-this.lworldOrgY)*this.ldeviceExtY/l),u},a.prototype.inverseTransformX=function(o){var u=0,l=this.ldeviceExtX;return l!=0&&(u=this.lworldOrgX+(o-this.ldeviceOrgX)*this.lworldExtX/l),u},a.prototype.inverseTransformY=function(o){var u=0,l=this.ldeviceExtY;return l!=0&&(u=this.lworldOrgY+(o-this.ldeviceOrgY)*this.lworldExtY/l),u},a.prototype.inverseTransformPoint=function(o){var u=new s(this.inverseTransformX(o.x),this.inverseTransformY(o.y));return u},n.exports=a},function(n,r,i){function s(f){if(Array.isArray(f)){for(var p=0,g=Array(f.length);p<f.length;p++)g[p]=f[p];return g}else return Array.from(f)}var a=i(15),o=i(4),u=i(0),l=i(8),c=i(9);function h(){a.call(this),this.useSmartIdealEdgeLengthCalculation=o.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=o.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=o.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=o.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=o.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.displacementThresholdPerNode=3*o.DEFAULT_EDGE_LENGTH/100,this.coolingFactor=o.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.initialCoolingFactor=o.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.totalDisplacement=0,this.oldTotalDisplacement=0,this.maxIterations=o.MAX_ITERATIONS}h.prototype=Object.create(a.prototype);for(var d in a)h[d]=a[d];h.prototype.initParameters=function(){a.prototype.initParameters.call(this,arguments),this.totalIterations=0,this.notAnimatedIterations=0,this.useFRGridVariant=o.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION,this.grid=[]},h.prototype.calcIdealEdgeLengths=function(){for(var f,p,g,m,y,b,v,E=this.getGraphManager().getAllEdges(),w=0;w<E.length;w++)f=E[w],p=f.idealLength,f.isInterGraph&&(m=f.getSource(),y=f.getTarget(),b=f.getSourceInLca().getEstimatedSize(),v=f.getTargetInLca().getEstimatedSize(),this.useSmartIdealEdgeLengthCalculation&&(f.idealLength+=b+v-2*u.SIMPLE_NODE_SIZE),g=f.getLca().getInclusionTreeDepth(),f.idealLength+=p*o.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR*(m.getInclusionTreeDepth()+y.getInclusionTreeDepth()-2*g))},h.prototype.initSpringEmbedder=function(){var f=this.getAllNodes().length;this.incremental?(f>o.ADAPTATION_LOWER_NODE_LIMIT&&(this.coolingFactor=Math.max(this.coolingFactor*o.COOLING_ADAPTATION_FACTOR,this.coolingFactor-(f-o.ADAPTATION_LOWER_NODE_LIMIT)/(o.ADAPTATION_UPPER_NODE_LIMIT-o.ADAPTATION_LOWER_NODE_LIMIT)*this.coolingFactor*(1-o.COOLING_ADAPTATION_FACTOR))),this.maxNodeDisplacement=o.MAX_NODE_DISPLACEMENT_INCREMENTAL):(f>o.ADAPTATION_LOWER_NODE_LIMIT?this.coolingFactor=Math.max(o.COOLING_ADAPTATION_FACTOR,1-(f-o.ADAPTATION_LOWER_NODE_LIMIT)/(o.ADAPTATION_UPPER_NODE_LIMIT-o.ADAPTATION_LOWER_NODE_LIMIT)*(1-o.COOLING_ADAPTATION_FACTOR)):this.coolingFactor=1,this.initialCoolingFactor=this.coolingFactor,this.maxNodeDisplacement=o.MAX_NODE_DISPLACEMENT),this.maxIterations=Math.max(this.getAllNodes().length*5,this.maxIterations),this.displacementThresholdPerNode=3*o.DEFAULT_EDGE_LENGTH/100,this.totalDisplacementThreshold=this.displacementThresholdPerNode*this.getAllNodes().length,this.repulsionRange=this.calcRepulsionRange()},h.prototype.calcSpringForces=function(){for(var f=this.getAllEdges(),p,g=0;g<f.length;g++)p=f[g],this.calcSpringForce(p,p.idealLength)},h.prototype.calcRepulsionForces=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g,m,y,b,v=this.getAllNodes(),E;if(this.useFRGridVariant)for(this.totalIterations%o.GRID_CALCULATION_CHECK_PERIOD==1&&f&&this.updateGrid(),E=new Set,g=0;g<v.length;g++)y=v[g],this.calculateRepulsionForceOfANode(y,E,f,p),E.add(y);else for(g=0;g<v.length;g++)for(y=v[g],m=g+1;m<v.length;m++)b=v[m],y.getOwner()==b.getOwner()&&this.calcRepulsionForce(y,b)},h.prototype.calcGravitationalForces=function(){for(var f,p=this.getAllNodesToApplyGravitation(),g=0;g<p.length;g++)f=p[g],this.calcGravitationalForce(f)},h.prototype.moveNodes=function(){for(var f=this.getAllNodes(),p,g=0;g<f.length;g++)p=f[g],p.move()},h.prototype.calcSpringForce=function(f,p){var g=f.getSource(),m=f.getTarget(),y,b,v,E;if(this.uniformLeafNodeSizes&&g.getChild()==null&&m.getChild()==null)f.updateLengthSimple();else if(f.updateLength(),f.isOverlapingSourceAndTarget)return;y=f.getLength(),y!=0&&(b=f.edgeElasticity*(y-p),v=b*(f.lengthX/y),E=b*(f.lengthY/y),g.springForceX+=v,g.springForceY+=E,m.springForceX-=v,m.springForceY-=E)},h.prototype.calcRepulsionForce=function(f,p){var g=f.getRect(),m=p.getRect(),y=new Array(2),b=new Array(4),v,E,w,N,D,k,F;if(g.intersects(m)){l.calcSeparationAmount(g,m,y,o.DEFAULT_EDGE_LENGTH/2),k=2*y[0],F=2*y[1];var M=f.noOfChildren*p.noOfChildren/(f.noOfChildren+p.noOfChildren);f.repulsionForceX-=M*k,f.repulsionForceY-=M*F,p.repulsionForceX+=M*k,p.repulsionForceY+=M*F}else this.uniformLeafNodeSizes&&f.getChild()==null&&p.getChild()==null?(v=m.getCenterX()-g.getCenterX(),E=m.getCenterY()-g.getCenterY()):(l.getIntersection(g,m,b),v=b[2]-b[0],E=b[3]-b[1]),Math.abs(v)<o.MIN_REPULSION_DIST&&(v=c.sign(v)*o.MIN_REPULSION_DIST),Math.abs(E)<o.MIN_REPULSION_DIST&&(E=c.sign(E)*o.MIN_REPULSION_DIST),w=v*v+E*E,N=Math.sqrt(w),D=(f.nodeRepulsion/2+p.nodeRepulsion/2)*f.noOfChildren*p.noOfChildren/w,k=D*v/N,F=D*E/N,f.repulsionForceX-=k,f.repulsionForceY-=F,p.repulsionForceX+=k,p.repulsionForceY+=F},h.prototype.calcGravitationalForce=function(f){var p,g,m,y,b,v,E,w;p=f.getOwner(),g=(p.getRight()+p.getLeft())/2,m=(p.getTop()+p.getBottom())/2,y=f.getCenterX()-g,b=f.getCenterY()-m,v=Math.abs(y)+f.getWidth()/2,E=Math.abs(b)+f.getHeight()/2,f.getOwner()==this.graphManager.getRoot()?(w=p.getEstimatedSize()*this.gravityRangeFactor,(v>w||E>w)&&(f.gravitationForceX=-this.gravityConstant*y,f.gravitationForceY=-this.gravityConstant*b)):(w=p.getEstimatedSize()*this.compoundGravityRangeFactor,(v>w||E>w)&&(f.gravitationForceX=-this.gravityConstant*y*this.compoundGravityConstant,f.gravitationForceY=-this.gravityConstant*b*this.compoundGravityConstant))},h.prototype.isConverged=function(){var f,p=!1;return this.totalIterations>this.maxIterations/3&&(p=Math.abs(this.totalDisplacement-this.oldTotalDisplacement)<2),f=this.totalDisplacement<this.totalDisplacementThreshold,this.oldTotalDisplacement=this.totalDisplacement,f||p},h.prototype.animate=function(){this.animationDuringLayout&&!this.isSubLayout&&(this.notAnimatedIterations==this.animationPeriod?(this.update(),this.notAnimatedIterations=0):this.notAnimatedIterations++)},h.prototype.calcNoOfChildrenForAllNodes=function(){for(var f,p=this.graphManager.getAllNodes(),g=0;g<p.length;g++)f=p[g],f.noOfChildren=f.getNoOfChildren()},h.prototype.calcGrid=function(f){var p=0,g=0;p=parseInt(Math.ceil((f.getRight()-f.getLeft())/this.repulsionRange)),g=parseInt(Math.ceil((f.getBottom()-f.getTop())/this.repulsionRange));for(var m=new Array(p),y=0;y<p;y++)m[y]=new Array(g);for(var y=0;y<p;y++)for(var b=0;b<g;b++)m[y][b]=new Array;return m},h.prototype.addNodeToGrid=function(f,p,g){var m=0,y=0,b=0,v=0;m=parseInt(Math.floor((f.getRect().x-p)/this.repulsionRange)),y=parseInt(Math.floor((f.getRect().width+f.getRect().x-p)/this.repulsionRange)),b=parseInt(Math.floor((f.getRect().y-g)/this.repulsionRange)),v=parseInt(Math.floor((f.getRect().height+f.getRect().y-g)/this.repulsionRange));for(var E=m;E<=y;E++)for(var w=b;w<=v;w++)this.grid[E][w].push(f),f.setGridCoordinates(m,y,b,v)},h.prototype.updateGrid=function(){var f,p,g=this.getAllNodes();for(this.grid=this.calcGrid(this.graphManager.getRoot()),f=0;f<g.length;f++)p=g[f],this.addNodeToGrid(p,this.graphManager.getRoot().getLeft(),this.graphManager.getRoot().getTop())},h.prototype.calculateRepulsionForceOfANode=function(f,p,g,m){if(this.totalIterations%o.GRID_CALCULATION_CHECK_PERIOD==1&&g||m){var y=new Set;f.surrounding=new Array;for(var b,v=this.grid,E=f.startX-1;E<f.finishX+2;E++)for(var w=f.startY-1;w<f.finishY+2;w++)if(!(E<0||w<0||E>=v.length||w>=v[0].length)){for(var N=0;N<v[E][w].length;N++)if(b=v[E][w][N],!(f.getOwner()!=b.getOwner()||f==b)&&!p.has(b)&&!y.has(b)){var D=Math.abs(f.getCenterX()-b.getCenterX())-(f.getWidth()/2+b.getWidth()/2),k=Math.abs(f.getCenterY()-b.getCenterY())-(f.getHeight()/2+b.getHeight()/2);D<=this.repulsionRange&&k<=this.repulsionRange&&y.add(b)}}f.surrounding=[].concat(s(y))}for(E=0;E<f.surrounding.length;E++)this.calcRepulsionForce(f,f.surrounding[E])},h.prototype.calcRepulsionRange=function(){return 0},n.exports=h},function(n,r,i){var s=i(1),a=i(4);function o(l,c,h){s.call(this,l,c,h),this.idealLength=a.DEFAULT_EDGE_LENGTH,this.edgeElasticity=a.DEFAULT_SPRING_STRENGTH}o.prototype=Object.create(s.prototype);for(var u in s)o[u]=s[u];n.exports=o},function(n,r,i){var s=i(3),a=i(4);function o(l,c,h,d){s.call(this,l,c,h,d),this.nodeRepulsion=a.DEFAULT_REPULSION_STRENGTH,this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0,this.startX=0,this.finishX=0,this.startY=0,this.finishY=0,this.surrounding=[]}o.prototype=Object.create(s.prototype);for(var u in s)o[u]=s[u];o.prototype.setGridCoordinates=function(l,c,h,d){this.startX=l,this.finishX=c,this.startY=h,this.finishY=d},n.exports=o},function(n,r,i){function s(a,o){this.width=0,this.height=0,a!==null&&o!==null&&(this.height=o,this.width=a)}s.prototype.getWidth=function(){return this.width},s.prototype.setWidth=function(a){this.width=a},s.prototype.getHeight=function(){return this.height},s.prototype.setHeight=function(a){this.height=a},n.exports=s},function(n,r,i){var s=i(14);function a(){this.map={},this.keys=[]}a.prototype.put=function(o,u){var l=s.createID(o);this.contains(l)||(this.map[l]=u,this.keys.push(o))},a.prototype.contains=function(o){return s.createID(o),this.map[o]!=null},a.prototype.get=function(o){var u=s.createID(o);return this.map[u]},a.prototype.keySet=function(){return this.keys},n.exports=a},function(n,r,i){var s=i(14);function a(){this.set={}}a.prototype.add=function(o){var u=s.createID(o);this.contains(u)||(this.set[u]=o)},a.prototype.remove=function(o){delete this.set[s.createID(o)]},a.prototype.clear=function(){this.set={}},a.prototype.contains=function(o){return this.set[s.createID(o)]==o},a.prototype.isEmpty=function(){return this.size()===0},a.prototype.size=function(){return Object.keys(this.set).length},a.prototype.addAllTo=function(o){for(var u=Object.keys(this.set),l=u.length,c=0;c<l;c++)o.push(this.set[u[c]])},a.prototype.size=function(){return Object.keys(this.set).length},a.prototype.addAll=function(o){for(var u=o.length,l=0;l<u;l++){var c=o[l];this.add(c)}},n.exports=a},function(n,r,i){function s(){}s.multMat=function(a,o){for(var u=[],l=0;l<a.length;l++){u[l]=[];for(var c=0;c<o[0].length;c++){u[l][c]=0;for(var h=0;h<a[0].length;h++)u[l][c]+=a[l][h]*o[h][c]}}return u},s.transpose=function(a){for(var o=[],u=0;u<a[0].length;u++){o[u]=[];for(var l=0;l<a.length;l++)o[u][l]=a[l][u]}return o},s.multCons=function(a,o){for(var u=[],l=0;l<a.length;l++)u[l]=a[l]*o;return u},s.minusOp=function(a,o){for(var u=[],l=0;l<a.length;l++)u[l]=a[l]-o[l];return u},s.dotProduct=function(a,o){for(var u=0,l=0;l<a.length;l++)u+=a[l]*o[l];return u},s.mag=function(a){return Math.sqrt(this.dotProduct(a,a))},s.normalize=function(a){for(var o=[],u=this.mag(a),l=0;l<a.length;l++)o[l]=a[l]/u;return o},s.multGamma=function(a){for(var o=[],u=0,l=0;l<a.length;l++)u+=a[l];u*=-1/a.length;for(var c=0;c<a.length;c++)o[c]=u+a[c];return o},s.multL=function(a,o,u){for(var l=[],c=[],h=[],d=0;d<o[0].length;d++){for(var f=0,p=0;p<o.length;p++)f+=-.5*o[p][d]*a[p];c[d]=f}for(var g=0;g<u.length;g++){for(var m=0,y=0;y<u.length;y++)m+=u[g][y]*c[y];h[g]=m}for(var b=0;b<o.length;b++){for(var v=0,E=0;E<o[0].length;E++)v+=o[b][E]*h[E];l[b]=v}return l},n.exports=s},function(n,r,i){var s=function(){function l(c,h){for(var d=0;d<h.length;d++){var f=h[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(c,f.key,f)}}return function(c,h,d){return h&&l(c.prototype,h),d&&l(c,d),c}}();function a(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var o=i(11),u=function(){function l(c,h){a(this,l),(h!==null||h!==void 0)&&(this.compareFunction=this._defaultCompareFunction);var d=void 0;c instanceof o?d=c.size():d=c.length,this._quicksort(c,0,d-1)}return s(l,[{key:"_quicksort",value:function(h,d,f){if(d<f){var p=this._partition(h,d,f);this._quicksort(h,d,p),this._quicksort(h,p+1,f)}}},{key:"_partition",value:function(h,d,f){for(var p=this._get(h,d),g=d,m=f;;){for(;this.compareFunction(p,this._get(h,m));)m--;for(;this.compareFunction(this._get(h,g),p);)g++;if(g<m)this._swap(h,g,m),g++,m--;else return m}}},{key:"_get",value:function(h,d){return h instanceof o?h.get_object_at(d):h[d]}},{key:"_set",value:function(h,d,f){h instanceof o?h.set_object_at(d,f):h[d]=f}},{key:"_swap",value:function(h,d,f){var p=this._get(h,d);this._set(h,d,this._get(h,f)),this._set(h,f,p)}},{key:"_defaultCompareFunction",value:function(h,d){return d>h}}]),l}();n.exports=u},function(n,r,i){function s(){}s.svd=function(a){this.U=null,this.V=null,this.s=null,this.m=0,this.n=0,this.m=a.length,this.n=a[0].length;var o=Math.min(this.m,this.n);this.s=function(ke){for(var Fe=[];ke-- >0;)Fe.push(0);return Fe}(Math.min(this.m+1,this.n)),this.U=function(ke){var Fe=function lt(tt){if(tt.length==0)return 0;for(var an=[],at=0;at<tt[0];at++)an.push(lt(tt.slice(1)));return an};return Fe(ke)}([this.m,o]),this.V=function(ke){var Fe=function lt(tt){if(tt.length==0)return 0;for(var an=[],at=0;at<tt[0];at++)an.push(lt(tt.slice(1)));return an};return Fe(ke)}([this.n,this.n]);for(var u=function(ke){for(var Fe=[];ke-- >0;)Fe.push(0);return Fe}(this.n),l=function(ke){for(var Fe=[];ke-- >0;)Fe.push(0);return Fe}(this.m),c=!0,h=Math.min(this.m-1,this.n),d=Math.max(0,Math.min(this.n-2,this.m)),f=0;f<Math.max(h,d);f++){if(f<h){this.s[f]=0;for(var p=f;p<this.m;p++)this.s[f]=s.hypot(this.s[f],a[p][f]);if(this.s[f]!==0){a[f][f]<0&&(this.s[f]=-this.s[f]);for(var g=f;g<this.m;g++)a[g][f]/=this.s[f];a[f][f]+=1}this.s[f]=-this.s[f]}for(var m=f+1;m<this.n;m++){if(function(ke,Fe){return ke&&Fe}(f<h,this.s[f]!==0)){for(var y=0,b=f;b<this.m;b++)y+=a[b][f]*a[b][m];y=-y/a[f][f];for(var v=f;v<this.m;v++)a[v][m]+=y*a[v][f]}u[m]=a[f][m]}if(function(ke,Fe){return Fe}(c,f<h))for(var E=f;E<this.m;E++)this.U[E][f]=a[E][f];if(f<d){u[f]=0;for(var w=f+1;w<this.n;w++)u[f]=s.hypot(u[f],u[w]);if(u[f]!==0){u[f+1]<0&&(u[f]=-u[f]);for(var N=f+1;N<this.n;N++)u[N]/=u[f];u[f+1]+=1}if(u[f]=-u[f],function(ke,Fe){return ke&&Fe}(f+1<this.m,u[f]!==0)){for(var D=f+1;D<this.m;D++)l[D]=0;for(var k=f+1;k<this.n;k++)for(var F=f+1;F<this.m;F++)l[F]+=u[k]*a[F][k];for(var M=f+1;M<this.n;M++)for(var S=-u[M]/u[f+1],R=f+1;R<this.m;R++)a[R][M]+=S*l[R]}for(var I=f+1;I<this.n;I++)this.V[I][f]=u[I]}}var x=Math.min(this.n,this.m+1);h<this.n&&(this.s[h]=a[h][h]),this.m<x&&(this.s[x-1]=0),d+1<x&&(u[d]=a[d][x-1]),u[x-1]=0;{for(var _=h;_<o;_++){for(var C=0;C<this.m;C++)this.U[C][_]=0;this.U[_][_]=1}for(var A=h-1;A>=0;A--)if(this.s[A]!==0){for(var T=A+1;T<o;T++){for(var O=0,L=A;L<this.m;L++)O+=this.U[L][A]*this.U[L][T];O=-O/this.U[A][A];for(var P=A;P<this.m;P++)this.U[P][T]+=O*this.U[P][A]}for(var Y=A;Y<this.m;Y++)this.U[Y][A]=-this.U[Y][A];this.U[A][A]=1+this.U[A][A];for(var W=0;W<A-1;W++)this.U[W][A]=0}else{for(var X=0;X<this.m;X++)this.U[X][A]=0;this.U[A][A]=1}}for(var V=this.n-1;V>=0;V--){if(function(ke,Fe){return ke&&Fe}(V<d,u[V]!==0))for(var q=V+1;q<o;q++){for(var Z=0,J=V+1;J<this.n;J++)Z+=this.V[J][V]*this.V[J][q];Z=-Z/this.V[V+1][V];for(var B=V+1;B<this.n;B++)this.V[B][q]+=Z*this.V[B][V]}for(var H=0;H<this.n;H++)this.V[H][V]=0;this.V[V][V]=1}for(var j=x-1,G=Math.pow(2,-52),re=Math.pow(2,-966);x>0;){var K=void 0,_e=void 0;for(K=x-2;K>=-1&&K!==-1;K--)if(Math.abs(u[K])<=re+G*(Math.abs(this.s[K])+Math.abs(this.s[K+1]))){u[K]=0;break}if(K===x-2)_e=4;else{var ve=void 0;for(ve=x-1;ve>=K&&ve!==K;ve--){var dt=(ve!==x?Math.abs(u[ve]):0)+(ve!==K+1?Math.abs(u[ve-1]):0);if(Math.abs(this.s[ve])<=re+G*dt){this.s[ve]=0;break}}ve===K?_e=3:ve===x-1?_e=1:(_e=2,K=ve)}switch(K++,_e){case 1:{var ut=u[x-2];u[x-2]=0;for(var Me=x-2;Me>=K;Me--){var rn=s.hypot(this.s[Me],ut),In=this.s[Me]/rn,Ti=ut/rn;this.s[Me]=rn,Me!==K&&(ut=-Ti*u[Me-1],u[Me-1]=In*u[Me-1]);for(var Wt=0;Wt<this.n;Wt++)rn=In*this.V[Wt][Me]+Ti*this.V[Wt][x-1],this.V[Wt][x-1]=-Ti*this.V[Wt][Me]+In*this.V[Wt][x-1],this.V[Wt][Me]=rn}}break;case 2:{var Fr=u[K-1];u[K-1]=0;for(var At=K;At<x;At++){var sn=s.hypot(this.s[At],Fr),Ln=this.s[At]/sn,ki=Fr/sn;this.s[At]=sn,Fr=-ki*u[At],u[At]=Ln*u[At];for(var gn=0;gn<this.m;gn++)sn=Ln*this.U[gn][At]+ki*this.U[gn][K-1],this.U[gn][K-1]=-ki*this.U[gn][At]+Ln*this.U[gn][K-1],this.U[gn][At]=sn}}break;case 3:{var nr=Math.max(Math.max(Math.max(Math.max(Math.abs(this.s[x-1]),Math.abs(this.s[x-2])),Math.abs(u[x-2])),Math.abs(this.s[K])),Math.abs(u[K])),mn=this.s[x-1]/nr,Q=this.s[x-2]/nr,ie=u[x-2]/nr,he=this.s[K]/nr,fe=u[K]/nr,ue=((Q+mn)*(Q-mn)+ie*ie)/2,Ce=mn*ie*(mn*ie),je=0;(function(ke,Fe){return ke||Fe})(ue!==0,Ce!==0)&&(je=Math.sqrt(ue*ue+Ce),ue<0&&(je=-je),je=Ce/(ue+je));for(var Ge=(he+mn)*(he-mn)+je,ge=he*fe,oe=K;oe<x-1;oe++){var $e=s.hypot(Ge,ge),ze=Ge/$e,Ie=ge/$e;oe!==K&&(u[oe-1]=$e),Ge=ze*this.s[oe]+Ie*u[oe],u[oe]=ze*u[oe]-Ie*this.s[oe],ge=Ie*this.s[oe+1],this.s[oe+1]=ze*this.s[oe+1];for(var Tt=0;Tt<this.n;Tt++)$e=ze*this.V[Tt][oe]+Ie*this.V[Tt][oe+1],this.V[Tt][oe+1]=-Ie*this.V[Tt][oe]+ze*this.V[Tt][oe+1],this.V[Tt][oe]=$e;if($e=s.hypot(Ge,ge),ze=Ge/$e,Ie=ge/$e,this.s[oe]=$e,Ge=ze*u[oe]+Ie*this.s[oe+1],this.s[oe+1]=-Ie*u[oe]+ze*this.s[oe+1],ge=Ie*u[oe+1],u[oe+1]=ze*u[oe+1],oe<this.m-1)for(var ce=0;ce<this.m;ce++)$e=ze*this.U[ce][oe]+Ie*this.U[ce][oe+1],this.U[ce][oe+1]=-Ie*this.U[ce][oe]+ze*this.U[ce][oe+1],this.U[ce][oe]=$e}u[x-2]=Ge}break;case 4:{if(this.s[K]<=0){this.s[K]=this.s[K]<0?-this.s[K]:0;for(var de=0;de<=j;de++)this.V[de][K]=-this.V[de][K]}for(;K<j&&!(this.s[K]>=this.s[K+1]);){var We=this.s[K];if(this.s[K]=this.s[K+1],this.s[K+1]=We,K<this.n-1)for(var be=0;be<this.n;be++)We=this.V[be][K+1],this.V[be][K+1]=this.V[be][K],this.V[be][K]=We;if(K<this.m-1)for(var me=0;me<this.m;me++)We=this.U[me][K+1],this.U[me][K+1]=this.U[me][K],this.U[me][K]=We;K++}x--}break}}var kt={U:this.U,V:this.V,S:this.s};return kt},s.hypot=function(a,o){var u=void 0;return Math.abs(a)>Math.abs(o)?(u=o/a,u=Math.abs(a)*Math.sqrt(1+u*u)):o!=0?(u=a/o,u=Math.abs(o)*Math.sqrt(1+u*u)):u=0,u},n.exports=s},function(n,r,i){var s=function(){function u(l,c){for(var h=0;h<c.length;h++){var d=c[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(l,d.key,d)}}return function(l,c,h){return c&&u(l.prototype,c),h&&u(l,h),l}}();function a(u,l){if(!(u instanceof l))throw new TypeError("Cannot call a class as a function")}var o=function(){function u(l,c){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;a(this,u),this.sequence1=l,this.sequence2=c,this.match_score=h,this.mismatch_penalty=d,this.gap_penalty=f,this.iMax=l.length+1,this.jMax=c.length+1,this.grid=new Array(this.iMax);for(var p=0;p<this.iMax;p++){this.grid[p]=new Array(this.jMax);for(var g=0;g<this.jMax;g++)this.grid[p][g]=0}this.tracebackGrid=new Array(this.iMax);for(var m=0;m<this.iMax;m++){this.tracebackGrid[m]=new Array(this.jMax);for(var y=0;y<this.jMax;y++)this.tracebackGrid[m][y]=[null,null,null]}this.alignments=[],this.score=-1,this.computeGrids()}return s(u,[{key:"getScore",value:function(){return this.score}},{key:"getAlignments",value:function(){return this.alignments}},{key:"computeGrids",value:function(){for(var c=1;c<this.jMax;c++)this.grid[0][c]=this.grid[0][c-1]+this.gap_penalty,this.tracebackGrid[0][c]=[!1,!1,!0];for(var h=1;h<this.iMax;h++)this.grid[h][0]=this.grid[h-1][0]+this.gap_penalty,this.tracebackGrid[h][0]=[!1,!0,!1];for(var d=1;d<this.iMax;d++)for(var f=1;f<this.jMax;f++){var p=void 0;this.sequence1[d-1]===this.sequence2[f-1]?p=this.grid[d-1][f-1]+this.match_score:p=this.grid[d-1][f-1]+this.mismatch_penalty;var g=this.grid[d-1][f]+this.gap_penalty,m=this.grid[d][f-1]+this.gap_penalty,y=[p,g,m],b=this.arrayAllMaxIndexes(y);this.grid[d][f]=y[b[0]],this.tracebackGrid[d][f]=[b.includes(0),b.includes(1),b.includes(2)]}this.score=this.grid[this.iMax-1][this.jMax-1]}},{key:"alignmentTraceback",value:function(){var c=[];for(c.push({pos:[this.sequence1.length,this.sequence2.length],seq1:"",seq2:""});c[0];){var h=c[0],d=this.tracebackGrid[h.pos[0]][h.pos[1]];d[0]&&c.push({pos:[h.pos[0]-1,h.pos[1]-1],seq1:this.sequence1[h.pos[0]-1]+h.seq1,seq2:this.sequence2[h.pos[1]-1]+h.seq2}),d[1]&&c.push({pos:[h.pos[0]-1,h.pos[1]],seq1:this.sequence1[h.pos[0]-1]+h.seq1,seq2:"-"+h.seq2}),d[2]&&c.push({pos:[h.pos[0],h.pos[1]-1],seq1:"-"+h.seq1,seq2:this.sequence2[h.pos[1]-1]+h.seq2}),h.pos[0]===0&&h.pos[1]===0&&this.alignments.push({sequence1:h.seq1,sequence2:h.seq2}),c.shift()}return this.alignments}},{key:"getAllIndexes",value:function(c,h){for(var d=[],f=-1;(f=c.indexOf(h,f+1))!==-1;)d.push(f);return d}},{key:"arrayAllMaxIndexes",value:function(c){return this.getAllIndexes(c,Math.max.apply(null,c))}}]),u}();n.exports=o},function(n,r,i){var s=function(){};s.FDLayout=i(18),s.FDLayoutConstants=i(4),s.FDLayoutEdge=i(19),s.FDLayoutNode=i(20),s.DimensionD=i(21),s.HashMap=i(22),s.HashSet=i(23),s.IGeometry=i(8),s.IMath=i(9),s.Integer=i(10),s.Point=i(12),s.PointD=i(5),s.RandomSeed=i(16),s.RectangleD=i(13),s.Transform=i(17),s.UniqueIDGeneretor=i(14),s.Quicksort=i(25),s.LinkedList=i(11),s.LGraphObject=i(2),s.LGraph=i(6),s.LEdge=i(1),s.LGraphManager=i(7),s.LNode=i(3),s.Layout=i(15),s.LayoutConstants=i(0),s.NeedlemanWunsch=i(27),s.Matrix=i(24),s.SVD=i(26),n.exports=s},function(n,r,i){function s(){this.listeners=[]}var a=s.prototype;a.addListener=function(o,u){this.listeners.push({event:o,callback:u})},a.removeListener=function(o,u){for(var l=this.listeners.length;l>=0;l--){var c=this.listeners[l];c.event===o&&c.callback===u&&this.listeners.splice(l,1)}},a.emit=function(o,u){for(var l=0;l<this.listeners.length;l++){var c=this.listeners[l];o===c.event&&c.callback(u)}},n.exports=s}])})}(ph)),ph.exports}var FV=dh.exports,WD;function XX(){return WD||(WD=1,function(t,e){(function(r,i){t.exports=i(NV())})(FV,function(n){return(()=>{var r={45:(o,u,l)=>{var c={};c.layoutBase=l(551),c.CoSEConstants=l(806),c.CoSEEdge=l(767),c.CoSEGraph=l(880),c.CoSEGraphManager=l(578),c.CoSELayout=l(765),c.CoSENode=l(991),c.ConstraintHandler=l(902),o.exports=c},806:(o,u,l)=>{var c=l(551).FDLayoutConstants;function h(){}for(var d in c)h[d]=c[d];h.DEFAULT_USE_MULTI_LEVEL_SCALING=!1,h.DEFAULT_RADIAL_SEPARATION=c.DEFAULT_EDGE_LENGTH,h.DEFAULT_COMPONENT_SEPERATION=60,h.TILE=!0,h.TILING_PADDING_VERTICAL=10,h.TILING_PADDING_HORIZONTAL=10,h.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,h.ENFORCE_CONSTRAINTS=!0,h.APPLY_LAYOUT=!0,h.RELAX_MOVEMENT_ON_CONSTRAINTS=!0,h.TREE_REDUCTION_ON_INCREMENTAL=!0,h.PURE_INCREMENTAL=h.DEFAULT_INCREMENTAL,o.exports=h},767:(o,u,l)=>{var c=l(551).FDLayoutEdge;function h(f,p,g){c.call(this,f,p,g)}h.prototype=Object.create(c.prototype);for(var d in c)h[d]=c[d];o.exports=h},880:(o,u,l)=>{var c=l(551).LGraph;function h(f,p,g){c.call(this,f,p,g)}h.prototype=Object.create(c.prototype);for(var d in c)h[d]=c[d];o.exports=h},578:(o,u,l)=>{var c=l(551).LGraphManager;function h(f){c.call(this,f)}h.prototype=Object.create(c.prototype);for(var d in c)h[d]=c[d];o.exports=h},765:(o,u,l)=>{var c=l(551).FDLayout,h=l(578),d=l(880),f=l(991),p=l(767),g=l(806),m=l(902),y=l(551).FDLayoutConstants,b=l(551).LayoutConstants,v=l(551).Point,E=l(551).PointD,w=l(551).DimensionD,N=l(551).Layout,D=l(551).Integer,k=l(551).IGeometry,F=l(551).LGraph,M=l(551).Transform,S=l(551).LinkedList;function R(){c.call(this),this.toBeTiled={},this.constraints={}}R.prototype=Object.create(c.prototype);for(var I in c)R[I]=c[I];R.prototype.newGraphManager=function(){var x=new h(this);return this.graphManager=x,x},R.prototype.newGraph=function(x){return new d(null,this.graphManager,x)},R.prototype.newNode=function(x){return new f(this.graphManager,x)},R.prototype.newEdge=function(x){return new p(null,null,x)},R.prototype.initParameters=function(){c.prototype.initParameters.call(this,arguments),this.isSubLayout||(g.DEFAULT_EDGE_LENGTH<10?this.idealEdgeLength=10:this.idealEdgeLength=g.DEFAULT_EDGE_LENGTH,this.useSmartIdealEdgeLengthCalculation=g.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=y.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=y.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=y.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=y.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.prunedNodesAll=[],this.growTreeIterations=0,this.afterGrowthIterations=0,this.isTreeGrowing=!1,this.isGrowthFinished=!1)},R.prototype.initSpringEmbedder=function(){c.prototype.initSpringEmbedder.call(this),this.coolingCycle=0,this.maxCoolingCycle=this.maxIterations/y.CONVERGENCE_CHECK_PERIOD,this.finalTemperature=.04,this.coolingAdjuster=1},R.prototype.layout=function(){var x=b.DEFAULT_CREATE_BENDS_AS_NEEDED;return x&&(this.createBendpoints(),this.graphManager.resetAllEdges()),this.level=0,this.classicLayout()},R.prototype.classicLayout=function(){if(this.nodesWithGravity=this.calculateNodesToApplyGravitationTo(),this.graphManager.setAllNodesToApplyGravitation(this.nodesWithGravity),this.calcNoOfChildrenForAllNodes(),this.graphManager.calcLowestCommonAncestors(),this.graphManager.calcInclusionTreeDepths(),this.graphManager.getRoot().calcEstimatedSize(),this.calcIdealEdgeLengths(),this.incremental){if(g.TREE_REDUCTION_ON_INCREMENTAL){this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var _=new Set(this.getAllNodes()),C=this.nodesWithGravity.filter(function(O){return _.has(O)});this.graphManager.setAllNodesToApplyGravitation(C)}}else{var x=this.getFlatForest();if(x.length>0)this.positionNodesRadially(x);else{this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var _=new Set(this.getAllNodes()),C=this.nodesWithGravity.filter(function(A){return _.has(A)});this.graphManager.setAllNodesToApplyGravitation(C),this.positionNodesRandomly()}}return Object.keys(this.constraints).length>0&&(m.handleConstraints(this),this.initConstraintVariables()),this.initSpringEmbedder(),g.APPLY_LAYOUT&&this.runSpringEmbedder(),!0},R.prototype.tick=function(){if(this.totalIterations++,this.totalIterations===this.maxIterations&&!this.isTreeGrowing&&!this.isGrowthFinished)if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;if(this.totalIterations%y.CONVERGENCE_CHECK_PERIOD==0&&!this.isTreeGrowing&&!this.isGrowthFinished){if(this.isConverged())if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;this.coolingCycle++,this.layoutQuality==0?this.coolingAdjuster=this.coolingCycle:this.layoutQuality==1&&(this.coolingAdjuster=this.coolingCycle/3),this.coolingFactor=Math.max(this.initialCoolingFactor-Math.pow(this.coolingCycle,Math.log(100*(this.initialCoolingFactor-this.finalTemperature))/Math.log(this.maxCoolingCycle))/100*this.coolingAdjuster,this.finalTemperature),this.animationPeriod=Math.ceil(this.initialAnimationPeriod*Math.sqrt(this.coolingFactor))}if(this.isTreeGrowing){if(this.growTreeIterations%10==0)if(this.prunedNodesAll.length>0){this.graphManager.updateBounds(),this.updateGrid(),this.growTree(this.prunedNodesAll),this.graphManager.resetAllNodesToApplyGravitation();var x=new Set(this.getAllNodes()),_=this.nodesWithGravity.filter(function(T){return x.has(T)});this.graphManager.setAllNodesToApplyGravitation(_),this.graphManager.updateBounds(),this.updateGrid(),g.PURE_INCREMENTAL?this.coolingFactor=y.DEFAULT_COOLING_FACTOR_INCREMENTAL/2:this.coolingFactor=y.DEFAULT_COOLING_FACTOR_INCREMENTAL}else this.isTreeGrowing=!1,this.isGrowthFinished=!0;this.growTreeIterations++}if(this.isGrowthFinished){if(this.isConverged())return!0;this.afterGrowthIterations%10==0&&(this.graphManager.updateBounds(),this.updateGrid()),g.PURE_INCREMENTAL?this.coolingFactor=y.DEFAULT_COOLING_FACTOR_INCREMENTAL/2*((100-this.afterGrowthIterations)/100):this.coolingFactor=y.DEFAULT_COOLING_FACTOR_INCREMENTAL*((100-this.afterGrowthIterations)/100),this.afterGrowthIterations++}var C=!this.isTreeGrowing&&!this.isGrowthFinished,A=this.growTreeIterations%10==1&&this.isTreeGrowing||this.afterGrowthIterations%10==1&&this.isGrowthFinished;return this.totalDisplacement=0,this.graphManager.updateBounds(),this.calcSpringForces(),this.calcRepulsionForces(C,A),this.calcGravitationalForces(),this.moveNodes(),this.animate(),!1},R.prototype.getPositionsData=function(){for(var x=this.graphManager.getAllNodes(),_={},C=0;C<x.length;C++){var A=x[C].rect,T=x[C].id;_[T]={id:T,x:A.getCenterX(),y:A.getCenterY(),w:A.width,h:A.height}}return _},R.prototype.runSpringEmbedder=function(){this.initialAnimationPeriod=25,this.animationPeriod=this.initialAnimationPeriod;var x=!1;if(y.ANIMATE==="during")this.emit("layoutstarted");else{for(;!x;)x=this.tick();this.graphManager.updateBounds()}},R.prototype.moveNodes=function(){for(var x=this.getAllNodes(),_,C=0;C<x.length;C++)_=x[C],_.calculateDisplacement();Object.keys(this.constraints).length>0&&this.updateDisplacements();for(var C=0;C<x.length;C++)_=x[C],_.move()},R.prototype.initConstraintVariables=function(){var x=this;this.idToNodeMap=new Map,this.fixedNodeSet=new Set;for(var _=this.graphManager.getAllNodes(),C=0;C<_.length;C++){var A=_[C];this.idToNodeMap.set(A.id,A)}var T=function B(H){for(var j=H.getChild().getNodes(),G,re=0,K=0;K<j.length;K++)G=j[K],G.getChild()==null?x.fixedNodeSet.has(G.id)&&(re+=100):re+=B(G);return re};if(this.constraints.fixedNodeConstraint){this.constraints.fixedNodeConstraint.forEach(function(j){x.fixedNodeSet.add(j.nodeId)});for(var _=this.graphManager.getAllNodes(),A,C=0;C<_.length;C++)if(A=_[C],A.getChild()!=null){var O=T(A);O>0&&(A.fixedNodeWeight=O)}}if(this.constraints.relativePlacementConstraint){var L=new Map,P=new Map;if(this.dummyToNodeForVerticalAlignment=new Map,this.dummyToNodeForHorizontalAlignment=new Map,this.fixedNodesOnHorizontal=new Set,this.fixedNodesOnVertical=new Set,this.fixedNodeSet.forEach(function(B){x.fixedNodesOnHorizontal.add(B),x.fixedNodesOnVertical.add(B)}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var Y=this.constraints.alignmentConstraint.vertical,C=0;C<Y.length;C++)this.dummyToNodeForVerticalAlignment.set("dummy"+C,[]),Y[C].forEach(function(H){L.set(H,"dummy"+C),x.dummyToNodeForVerticalAlignment.get("dummy"+C).push(H),x.fixedNodeSet.has(H)&&x.fixedNodesOnHorizontal.add("dummy"+C)});if(this.constraints.alignmentConstraint.horizontal)for(var W=this.constraints.alignmentConstraint.horizontal,C=0;C<W.length;C++)this.dummyToNodeForHorizontalAlignment.set("dummy"+C,[]),W[C].forEach(function(H){P.set(H,"dummy"+C),x.dummyToNodeForHorizontalAlignment.get("dummy"+C).push(H),x.fixedNodeSet.has(H)&&x.fixedNodesOnVertical.add("dummy"+C)})}if(g.RELAX_MOVEMENT_ON_CONSTRAINTS)this.shuffle=function(B){var H,j,G;for(G=B.length-1;G>=2*B.length/3;G--)H=Math.floor(Math.random()*(G+1)),j=B[G],B[G]=B[H],B[H]=j;return B},this.nodesInRelativeHorizontal=[],this.nodesInRelativeVertical=[],this.nodeToRelativeConstraintMapHorizontal=new Map,this.nodeToRelativeConstraintMapVertical=new Map,this.nodeToTempPositionMapHorizontal=new Map,this.nodeToTempPositionMapVertical=new Map,this.constraints.relativePlacementConstraint.forEach(function(B){if(B.left){var H=L.has(B.left)?L.get(B.left):B.left,j=L.has(B.right)?L.get(B.right):B.right;x.nodesInRelativeHorizontal.includes(H)||(x.nodesInRelativeHorizontal.push(H),x.nodeToRelativeConstraintMapHorizontal.set(H,[]),x.dummyToNodeForVerticalAlignment.has(H)?x.nodeToTempPositionMapHorizontal.set(H,x.idToNodeMap.get(x.dummyToNodeForVerticalAlignment.get(H)[0]).getCenterX()):x.nodeToTempPositionMapHorizontal.set(H,x.idToNodeMap.get(H).getCenterX())),x.nodesInRelativeHorizontal.includes(j)||(x.nodesInRelativeHorizontal.push(j),x.nodeToRelativeConstraintMapHorizontal.set(j,[]),x.dummyToNodeForVerticalAlignment.has(j)?x.nodeToTempPositionMapHorizontal.set(j,x.idToNodeMap.get(x.dummyToNodeForVerticalAlignment.get(j)[0]).getCenterX()):x.nodeToTempPositionMapHorizontal.set(j,x.idToNodeMap.get(j).getCenterX())),x.nodeToRelativeConstraintMapHorizontal.get(H).push({right:j,gap:B.gap}),x.nodeToRelativeConstraintMapHorizontal.get(j).push({left:H,gap:B.gap})}else{var G=P.has(B.top)?P.get(B.top):B.top,re=P.has(B.bottom)?P.get(B.bottom):B.bottom;x.nodesInRelativeVertical.includes(G)||(x.nodesInRelativeVertical.push(G),x.nodeToRelativeConstraintMapVertical.set(G,[]),x.dummyToNodeForHorizontalAlignment.has(G)?x.nodeToTempPositionMapVertical.set(G,x.idToNodeMap.get(x.dummyToNodeForHorizontalAlignment.get(G)[0]).getCenterY()):x.nodeToTempPositionMapVertical.set(G,x.idToNodeMap.get(G).getCenterY())),x.nodesInRelativeVertical.includes(re)||(x.nodesInRelativeVertical.push(re),x.nodeToRelativeConstraintMapVertical.set(re,[]),x.dummyToNodeForHorizontalAlignment.has(re)?x.nodeToTempPositionMapVertical.set(re,x.idToNodeMap.get(x.dummyToNodeForHorizontalAlignment.get(re)[0]).getCenterY()):x.nodeToTempPositionMapVertical.set(re,x.idToNodeMap.get(re).getCenterY())),x.nodeToRelativeConstraintMapVertical.get(G).push({bottom:re,gap:B.gap}),x.nodeToRelativeConstraintMapVertical.get(re).push({top:G,gap:B.gap})}});else{var X=new Map,V=new Map;this.constraints.relativePlacementConstraint.forEach(function(B){if(B.left){var H=L.has(B.left)?L.get(B.left):B.left,j=L.has(B.right)?L.get(B.right):B.right;X.has(H)?X.get(H).push(j):X.set(H,[j]),X.has(j)?X.get(j).push(H):X.set(j,[H])}else{var G=P.has(B.top)?P.get(B.top):B.top,re=P.has(B.bottom)?P.get(B.bottom):B.bottom;V.has(G)?V.get(G).push(re):V.set(G,[re]),V.has(re)?V.get(re).push(G):V.set(re,[G])}});var q=function(H,j){var G=[],re=[],K=new S,_e=new Set,ve=0;return H.forEach(function(dt,ut){if(!_e.has(ut)){G[ve]=[],re[ve]=!1;var Me=ut;for(K.push(Me),_e.add(Me),G[ve].push(Me);K.length!=0;){Me=K.shift(),j.has(Me)&&(re[ve]=!0);var rn=H.get(Me);rn.forEach(function(In){_e.has(In)||(K.push(In),_e.add(In),G[ve].push(In))})}ve++}}),{components:G,isFixed:re}},Z=q(X,x.fixedNodesOnHorizontal);this.componentsOnHorizontal=Z.components,this.fixedComponentsOnHorizontal=Z.isFixed;var J=q(V,x.fixedNodesOnVertical);this.componentsOnVertical=J.components,this.fixedComponentsOnVertical=J.isFixed}}},R.prototype.updateDisplacements=function(){var x=this;if(this.constraints.fixedNodeConstraint&&this.constraints.fixedNodeConstraint.forEach(function(J){var B=x.idToNodeMap.get(J.nodeId);B.displacementX=0,B.displacementY=0}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var _=this.constraints.alignmentConstraint.vertical,C=0;C<_.length;C++){for(var A=0,T=0;T<_[C].length;T++){if(this.fixedNodeSet.has(_[C][T])){A=0;break}A+=this.idToNodeMap.get(_[C][T]).displacementX}for(var O=A/_[C].length,T=0;T<_[C].length;T++)this.idToNodeMap.get(_[C][T]).displacementX=O}if(this.constraints.alignmentConstraint.horizontal)for(var L=this.constraints.alignmentConstraint.horizontal,C=0;C<L.length;C++){for(var P=0,T=0;T<L[C].length;T++){if(this.fixedNodeSet.has(L[C][T])){P=0;break}P+=this.idToNodeMap.get(L[C][T]).displacementY}for(var Y=P/L[C].length,T=0;T<L[C].length;T++)this.idToNodeMap.get(L[C][T]).displacementY=Y}}if(this.constraints.relativePlacementConstraint)if(g.RELAX_MOVEMENT_ON_CONSTRAINTS)this.totalIterations%10==0&&(this.shuffle(this.nodesInRelativeHorizontal),this.shuffle(this.nodesInRelativeVertical)),this.nodesInRelativeHorizontal.forEach(function(J){if(!x.fixedNodesOnHorizontal.has(J)){var B=0;x.dummyToNodeForVerticalAlignment.has(J)?B=x.idToNodeMap.get(x.dummyToNodeForVerticalAlignment.get(J)[0]).displacementX:B=x.idToNodeMap.get(J).displacementX,x.nodeToRelativeConstraintMapHorizontal.get(J).forEach(function(H){if(H.right){var j=x.nodeToTempPositionMapHorizontal.get(H.right)-x.nodeToTempPositionMapHorizontal.get(J)-B;j<H.gap&&(B-=H.gap-j)}else{var j=x.nodeToTempPositionMapHorizontal.get(J)-x.nodeToTempPositionMapHorizontal.get(H.left)+B;j<H.gap&&(B+=H.gap-j)}}),x.nodeToTempPositionMapHorizontal.set(J,x.nodeToTempPositionMapHorizontal.get(J)+B),x.dummyToNodeForVerticalAlignment.has(J)?x.dummyToNodeForVerticalAlignment.get(J).forEach(function(H){x.idToNodeMap.get(H).displacementX=B}):x.idToNodeMap.get(J).displacementX=B}}),this.nodesInRelativeVertical.forEach(function(J){if(!x.fixedNodesOnHorizontal.has(J)){var B=0;x.dummyToNodeForHorizontalAlignment.has(J)?B=x.idToNodeMap.get(x.dummyToNodeForHorizontalAlignment.get(J)[0]).displacementY:B=x.idToNodeMap.get(J).displacementY,x.nodeToRelativeConstraintMapVertical.get(J).forEach(function(H){if(H.bottom){var j=x.nodeToTempPositionMapVertical.get(H.bottom)-x.nodeToTempPositionMapVertical.get(J)-B;j<H.gap&&(B-=H.gap-j)}else{var j=x.nodeToTempPositionMapVertical.get(J)-x.nodeToTempPositionMapVertical.get(H.top)+B;j<H.gap&&(B+=H.gap-j)}}),x.nodeToTempPositionMapVertical.set(J,x.nodeToTempPositionMapVertical.get(J)+B),x.dummyToNodeForHorizontalAlignment.has(J)?x.dummyToNodeForHorizontalAlignment.get(J).forEach(function(H){x.idToNodeMap.get(H).displacementY=B}):x.idToNodeMap.get(J).displacementY=B}});else{for(var C=0;C<this.componentsOnHorizontal.length;C++){var W=this.componentsOnHorizontal[C];if(this.fixedComponentsOnHorizontal[C])for(var T=0;T<W.length;T++)this.dummyToNodeForVerticalAlignment.has(W[T])?this.dummyToNodeForVerticalAlignment.get(W[T]).forEach(function(H){x.idToNodeMap.get(H).displacementX=0}):this.idToNodeMap.get(W[T]).displacementX=0;else{for(var X=0,V=0,T=0;T<W.length;T++)if(this.dummyToNodeForVerticalAlignment.has(W[T])){var q=this.dummyToNodeForVerticalAlignment.get(W[T]);X+=q.length*this.idToNodeMap.get(q[0]).displacementX,V+=q.length}else X+=this.idToNodeMap.get(W[T]).displacementX,V++;for(var Z=X/V,T=0;T<W.length;T++)this.dummyToNodeForVerticalAlignment.has(W[T])?this.dummyToNodeForVerticalAlignment.get(W[T]).forEach(function(H){x.idToNodeMap.get(H).displacementX=Z}):this.idToNodeMap.get(W[T]).displacementX=Z}}for(var C=0;C<this.componentsOnVertical.length;C++){var W=this.componentsOnVertical[C];if(this.fixedComponentsOnVertical[C])for(var T=0;T<W.length;T++)this.dummyToNodeForHorizontalAlignment.has(W[T])?this.dummyToNodeForHorizontalAlignment.get(W[T]).forEach(function(j){x.idToNodeMap.get(j).displacementY=0}):this.idToNodeMap.get(W[T]).displacementY=0;else{for(var X=0,V=0,T=0;T<W.length;T++)if(this.dummyToNodeForHorizontalAlignment.has(W[T])){var q=this.dummyToNodeForHorizontalAlignment.get(W[T]);X+=q.length*this.idToNodeMap.get(q[0]).displacementY,V+=q.length}else X+=this.idToNodeMap.get(W[T]).displacementY,V++;for(var Z=X/V,T=0;T<W.length;T++)this.dummyToNodeForHorizontalAlignment.has(W[T])?this.dummyToNodeForHorizontalAlignment.get(W[T]).forEach(function(K){x.idToNodeMap.get(K).displacementY=Z}):this.idToNodeMap.get(W[T]).displacementY=Z}}}},R.prototype.calculateNodesToApplyGravitationTo=function(){var x=[],_,C=this.graphManager.getGraphs(),A=C.length,T;for(T=0;T<A;T++)_=C[T],_.updateConnected(),_.isConnected||(x=x.concat(_.getNodes()));return x},R.prototype.createBendpoints=function(){var x=[];x=x.concat(this.graphManager.getAllEdges());var _=new Set,C;for(C=0;C<x.length;C++){var A=x[C];if(!_.has(A)){var T=A.getSource(),O=A.getTarget();if(T==O)A.getBendpoints().push(new E),A.getBendpoints().push(new E),this.createDummyNodesForBendpoints(A),_.add(A);else{var L=[];if(L=L.concat(T.getEdgeListToNode(O)),L=L.concat(O.getEdgeListToNode(T)),!_.has(L[0])){if(L.length>1){var P;for(P=0;P<L.length;P++){var Y=L[P];Y.getBendpoints().push(new E),this.createDummyNodesForBendpoints(Y)}}L.forEach(function(W){_.add(W)})}}}if(_.size==x.length)break}},R.prototype.positionNodesRadially=function(x){for(var _=new v(0,0),C=Math.ceil(Math.sqrt(x.length)),A=0,T=0,O=0,L=new E(0,0),P=0;P<x.length;P++){P%C==0&&(O=0,T=A,P!=0&&(T+=g.DEFAULT_COMPONENT_SEPERATION),A=0);var Y=x[P],W=N.findCenterOfTree(Y);_.x=O,_.y=T,L=R.radialLayout(Y,W,_),L.y>A&&(A=Math.floor(L.y)),O=Math.floor(L.x+g.DEFAULT_COMPONENT_SEPERATION)}this.transform(new E(b.WORLD_CENTER_X-L.x/2,b.WORLD_CENTER_Y-L.y/2))},R.radialLayout=function(x,_,C){var A=Math.max(this.maxDiagonalInTree(x),g.DEFAULT_RADIAL_SEPARATION);R.branchRadialLayout(_,null,0,359,0,A);var T=F.calculateBounds(x),O=new M;O.setDeviceOrgX(T.getMinX()),O.setDeviceOrgY(T.getMinY()),O.setWorldOrgX(C.x),O.setWorldOrgY(C.y);for(var L=0;L<x.length;L++){var P=x[L];P.transform(O)}var Y=new E(T.getMaxX(),T.getMaxY());return O.inverseTransformPoint(Y)},R.branchRadialLayout=function(x,_,C,A,T,O){var L=(A-C+1)/2;L<0&&(L+=180);var P=(L+C)%360,Y=P*k.TWO_PI/360,W=T*Math.cos(Y),X=T*Math.sin(Y);x.setCenter(W,X);var V=[];V=V.concat(x.getEdges());var q=V.length;_!=null&&q--;for(var Z=0,J=V.length,B,H=x.getEdgesBetween(_);H.length>1;){var j=H[0];H.splice(0,1);var G=V.indexOf(j);G>=0&&V.splice(G,1),J--,q--}_!=null?B=(V.indexOf(H[0])+1)%J:B=0;for(var re=Math.abs(A-C)/q,K=B;Z!=q;K=++K%J){var _e=V[K].getOtherEnd(x);if(_e!=_){var ve=(C+Z*re)%360,dt=(ve+re)%360;R.branchRadialLayout(_e,x,ve,dt,T+O,O),Z++}}},R.maxDiagonalInTree=function(x){for(var _=D.MIN_VALUE,C=0;C<x.length;C++){var A=x[C],T=A.getDiagonal();T>_&&(_=T)}return _},R.prototype.calcRepulsionRange=function(){return 2*(this.level+1)*this.idealEdgeLength},R.prototype.groupZeroDegreeMembers=function(){var x=this,_={};this.memberGroups={},this.idToDummyNode={};for(var C=[],A=this.graphManager.getAllNodes(),T=0;T<A.length;T++){var O=A[T],L=O.getParent();this.getNodeDegreeWithChildren(O)===0&&(L.id==null||!this.getToBeTiled(L))&&C.push(O)}for(var T=0;T<C.length;T++){var O=C[T],P=O.getParent().id;typeof _[P]>"u"&&(_[P]=[]),_[P]=_[P].concat(O)}Object.keys(_).forEach(function(Y){if(_[Y].length>1){var W="DummyCompound_"+Y;x.memberGroups[W]=_[Y];var X=_[Y][0].getParent(),V=new f(x.graphManager);V.id=W,V.paddingLeft=X.paddingLeft||0,V.paddingRight=X.paddingRight||0,V.paddingBottom=X.paddingBottom||0,V.paddingTop=X.paddingTop||0,x.idToDummyNode[W]=V;var q=x.getGraphManager().add(x.newGraph(),V),Z=X.getChild();Z.add(V);for(var J=0;J<_[Y].length;J++){var B=_[Y][J];Z.remove(B),q.add(B)}}})},R.prototype.clearCompounds=function(){var x={},_={};this.performDFSOnCompounds();for(var C=0;C<this.compoundOrder.length;C++)_[this.compoundOrder[C].id]=this.compoundOrder[C],x[this.compoundOrder[C].id]=[].concat(this.compoundOrder[C].getChild().getNodes()),this.graphManager.remove(this.compoundOrder[C].getChild()),this.compoundOrder[C].child=null;this.graphManager.resetAllNodes(),this.tileCompoundMembers(x,_)},R.prototype.clearZeroDegreeMembers=function(){var x=this,_=this.tiledZeroDegreePack=[];Object.keys(this.memberGroups).forEach(function(C){var A=x.idToDummyNode[C];if(_[C]=x.tileNodes(x.memberGroups[C],A.paddingLeft+A.paddingRight),A.rect.width=_[C].width,A.rect.height=_[C].height,A.setCenter(_[C].centerX,_[C].centerY),A.labelMarginLeft=0,A.labelMarginTop=0,g.NODE_DIMENSIONS_INCLUDE_LABELS){var T=A.rect.width,O=A.rect.height;A.labelWidth&&(A.labelPosHorizontal=="left"?(A.rect.x-=A.labelWidth,A.setWidth(T+A.labelWidth),A.labelMarginLeft=A.labelWidth):A.labelPosHorizontal=="center"&&A.labelWidth>T?(A.rect.x-=(A.labelWidth-T)/2,A.setWidth(A.labelWidth),A.labelMarginLeft=(A.labelWidth-T)/2):A.labelPosHorizontal=="right"&&A.setWidth(T+A.labelWidth)),A.labelHeight&&(A.labelPosVertical=="top"?(A.rect.y-=A.labelHeight,A.setHeight(O+A.labelHeight),A.labelMarginTop=A.labelHeight):A.labelPosVertical=="center"&&A.labelHeight>O?(A.rect.y-=(A.labelHeight-O)/2,A.setHeight(A.labelHeight),A.labelMarginTop=(A.labelHeight-O)/2):A.labelPosVertical=="bottom"&&A.setHeight(O+A.labelHeight))}})},R.prototype.repopulateCompounds=function(){for(var x=this.compoundOrder.length-1;x>=0;x--){var _=this.compoundOrder[x],C=_.id,A=_.paddingLeft,T=_.paddingTop,O=_.labelMarginLeft,L=_.labelMarginTop;this.adjustLocations(this.tiledMemberPack[C],_.rect.x,_.rect.y,A,T,O,L)}},R.prototype.repopulateZeroDegreeMembers=function(){var x=this,_=this.tiledZeroDegreePack;Object.keys(_).forEach(function(C){var A=x.idToDummyNode[C],T=A.paddingLeft,O=A.paddingTop,L=A.labelMarginLeft,P=A.labelMarginTop;x.adjustLocations(_[C],A.rect.x,A.rect.y,T,O,L,P)})},R.prototype.getToBeTiled=function(x){var _=x.id;if(this.toBeTiled[_]!=null)return this.toBeTiled[_];var C=x.getChild();if(C==null)return this.toBeTiled[_]=!1,!1;for(var A=C.getNodes(),T=0;T<A.length;T++){var O=A[T];if(this.getNodeDegree(O)>0)return this.toBeTiled[_]=!1,!1;if(O.getChild()==null){this.toBeTiled[O.id]=!1;continue}if(!this.getToBeTiled(O))return this.toBeTiled[_]=!1,!1}return this.toBeTiled[_]=!0,!0},R.prototype.getNodeDegree=function(x){x.id;for(var _=x.getEdges(),C=0,A=0;A<_.length;A++){var T=_[A];T.getSource().id!==T.getTarget().id&&(C=C+1)}return C},R.prototype.getNodeDegreeWithChildren=function(x){var _=this.getNodeDegree(x);if(x.getChild()==null)return _;for(var C=x.getChild().getNodes(),A=0;A<C.length;A++){var T=C[A];_+=this.getNodeDegreeWithChildren(T)}return _},R.prototype.performDFSOnCompounds=function(){this.compoundOrder=[],this.fillCompexOrderByDFS(this.graphManager.getRoot().getNodes())},R.prototype.fillCompexOrderByDFS=function(x){for(var _=0;_<x.length;_++){var C=x[_];C.getChild()!=null&&this.fillCompexOrderByDFS(C.getChild().getNodes()),this.getToBeTiled(C)&&this.compoundOrder.push(C)}},R.prototype.adjustLocations=function(x,_,C,A,T,O,L){_+=A+O,C+=T+L;for(var P=_,Y=0;Y<x.rows.length;Y++){var W=x.rows[Y];_=P;for(var X=0,V=0;V<W.length;V++){var q=W[V];q.rect.x=_,q.rect.y=C,_+=q.rect.width+x.horizontalPadding,q.rect.height>X&&(X=q.rect.height)}C+=X+x.verticalPadding}},R.prototype.tileCompoundMembers=function(x,_){var C=this;this.tiledMemberPack=[],Object.keys(x).forEach(function(A){var T=_[A];if(C.tiledMemberPack[A]=C.tileNodes(x[A],T.paddingLeft+T.paddingRight),T.rect.width=C.tiledMemberPack[A].width,T.rect.height=C.tiledMemberPack[A].height,T.setCenter(C.tiledMemberPack[A].centerX,C.tiledMemberPack[A].centerY),T.labelMarginLeft=0,T.labelMarginTop=0,g.NODE_DIMENSIONS_INCLUDE_LABELS){var O=T.rect.width,L=T.rect.height;T.labelWidth&&(T.labelPosHorizontal=="left"?(T.rect.x-=T.labelWidth,T.setWidth(O+T.labelWidth),T.labelMarginLeft=T.labelWidth):T.labelPosHorizontal=="center"&&T.labelWidth>O?(T.rect.x-=(T.labelWidth-O)/2,T.setWidth(T.labelWidth),T.labelMarginLeft=(T.labelWidth-O)/2):T.labelPosHorizontal=="right"&&T.setWidth(O+T.labelWidth)),T.labelHeight&&(T.labelPosVertical=="top"?(T.rect.y-=T.labelHeight,T.setHeight(L+T.labelHeight),T.labelMarginTop=T.labelHeight):T.labelPosVertical=="center"&&T.labelHeight>L?(T.rect.y-=(T.labelHeight-L)/2,T.setHeight(T.labelHeight),T.labelMarginTop=(T.labelHeight-L)/2):T.labelPosVertical=="bottom"&&T.setHeight(L+T.labelHeight))}})},R.prototype.tileNodes=function(x,_){var C=this.tileNodesByFavoringDim(x,_,!0),A=this.tileNodesByFavoringDim(x,_,!1),T=this.getOrgRatio(C),O=this.getOrgRatio(A),L;return O<T?L=A:L=C,L},R.prototype.getOrgRatio=function(x){var _=x.width,C=x.height,A=_/C;return A<1&&(A=1/A),A},R.prototype.calcIdealRowWidth=function(x,_){var C=g.TILING_PADDING_VERTICAL,A=g.TILING_PADDING_HORIZONTAL,T=x.length,O=0,L=0,P=0;x.forEach(function(J){O+=J.getWidth(),L+=J.getHeight(),J.getWidth()>P&&(P=J.getWidth())});var Y=O/T,W=L/T,X=Math.pow(C-A,2)+4*(Y+A)*(W+C)*T,V=(A-C+Math.sqrt(X))/(2*(Y+A)),q;_?(q=Math.ceil(V),q==V&&q++):q=Math.floor(V);var Z=q*(Y+A)-A;return P>Z&&(Z=P),Z+=A*2,Z},R.prototype.tileNodesByFavoringDim=function(x,_,C){var A=g.TILING_PADDING_VERTICAL,T=g.TILING_PADDING_HORIZONTAL,O=g.TILING_COMPARE_BY,L={rows:[],rowWidth:[],rowHeight:[],width:0,height:_,verticalPadding:A,horizontalPadding:T,centerX:0,centerY:0};O&&(L.idealRowWidth=this.calcIdealRowWidth(x,C));var P=function(B){return B.rect.width*B.rect.height},Y=function(B,H){return P(H)-P(B)};x.sort(function(J,B){var H=Y;return L.idealRowWidth?(H=O,H(J.id,B.id)):H(J,B)});for(var W=0,X=0,V=0;V<x.length;V++){var q=x[V];W+=q.getCenterX(),X+=q.getCenterY()}L.centerX=W/x.length,L.centerY=X/x.length;for(var V=0;V<x.length;V++){var q=x[V];if(L.rows.length==0)this.insertNodeToRow(L,q,0,_);else if(this.canAddHorizontal(L,q.rect.width,q.rect.height)){var Z=L.rows.length-1;L.idealRowWidth||(Z=this.getShortestRowIndex(L)),this.insertNodeToRow(L,q,Z,_)}else this.insertNodeToRow(L,q,L.rows.length,_);this.shiftToLastRow(L)}return L},R.prototype.insertNodeToRow=function(x,_,C,A){var T=A;if(C==x.rows.length){var O=[];x.rows.push(O),x.rowWidth.push(T),x.rowHeight.push(0)}var L=x.rowWidth[C]+_.rect.width;x.rows[C].length>0&&(L+=x.horizontalPadding),x.rowWidth[C]=L,x.width<L&&(x.width=L);var P=_.rect.height;C>0&&(P+=x.verticalPadding);var Y=0;P>x.rowHeight[C]&&(Y=x.rowHeight[C],x.rowHeight[C]=P,Y=x.rowHeight[C]-Y),x.height+=Y,x.rows[C].push(_)},R.prototype.getShortestRowIndex=function(x){for(var _=-1,C=Number.MAX_VALUE,A=0;A<x.rows.length;A++)x.rowWidth[A]<C&&(_=A,C=x.rowWidth[A]);return _},R.prototype.getLongestRowIndex=function(x){for(var _=-1,C=Number.MIN_VALUE,A=0;A<x.rows.length;A++)x.rowWidth[A]>C&&(_=A,C=x.rowWidth[A]);return _},R.prototype.canAddHorizontal=function(x,_,C){if(x.idealRowWidth){var A=x.rows.length-1,T=x.rowWidth[A];return T+_+x.horizontalPadding<=x.idealRowWidth}var O=this.getShortestRowIndex(x);if(O<0)return!0;var L=x.rowWidth[O];if(L+x.horizontalPadding+_<=x.width)return!0;var P=0;x.rowHeight[O]<C&&O>0&&(P=C+x.verticalPadding-x.rowHeight[O]);var Y;x.width-L>=_+x.horizontalPadding?Y=(x.height+P)/(L+_+x.horizontalPadding):Y=(x.height+P)/x.width,P=C+x.verticalPadding;var W;return x.width<_?W=(x.height+P)/_:W=(x.height+P)/x.width,W<1&&(W=1/W),Y<1&&(Y=1/Y),Y<W},R.prototype.shiftToLastRow=function(x){var _=this.getLongestRowIndex(x),C=x.rowWidth.length-1,A=x.rows[_],T=A[A.length-1],O=T.width+x.horizontalPadding;if(x.width-x.rowWidth[C]>O&&_!=C){A.splice(-1,1),x.rows[C].push(T),x.rowWidth[_]=x.rowWidth[_]-O,x.rowWidth[C]=x.rowWidth[C]+O,x.width=x.rowWidth[instance.getLongestRowIndex(x)];for(var L=Number.MIN_VALUE,P=0;P<A.length;P++)A[P].height>L&&(L=A[P].height);_>0&&(L+=x.verticalPadding);var Y=x.rowHeight[_]+x.rowHeight[C];x.rowHeight[_]=L,x.rowHeight[C]<T.height+x.verticalPadding&&(x.rowHeight[C]=T.height+x.verticalPadding);var W=x.rowHeight[_]+x.rowHeight[C];x.height+=W-Y,this.shiftToLastRow(x)}},R.prototype.tilingPreLayout=function(){g.TILE&&(this.groupZeroDegreeMembers(),this.clearCompounds(),this.clearZeroDegreeMembers())},R.prototype.tilingPostLayout=function(){g.TILE&&(this.repopulateZeroDegreeMembers(),this.repopulateCompounds())},R.prototype.reduceTrees=function(){for(var x=[],_=!0,C;_;){var A=this.graphManager.getAllNodes(),T=[];_=!1;for(var O=0;O<A.length;O++)if(C=A[O],C.getEdges().length==1&&!C.getEdges()[0].isInterGraph&&C.getChild()==null){if(g.PURE_INCREMENTAL){var L=C.getEdges()[0].getOtherEnd(C),P=new w(C.getCenterX()-L.getCenterX(),C.getCenterY()-L.getCenterY());T.push([C,C.getEdges()[0],C.getOwner(),P])}else T.push([C,C.getEdges()[0],C.getOwner()]);_=!0}if(_==!0){for(var Y=[],W=0;W<T.length;W++)T[W][0].getEdges().length==1&&(Y.push(T[W]),T[W][0].getOwner().remove(T[W][0]));x.push(Y),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()}}this.prunedNodesAll=x},R.prototype.growTree=function(x){for(var _=x.length,C=x[_-1],A,T=0;T<C.length;T++)A=C[T],this.findPlaceforPrunedNode(A),A[2].add(A[0]),A[2].add(A[1],A[1].source,A[1].target);x.splice(x.length-1,1),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()},R.prototype.findPlaceforPrunedNode=function(x){var _,C,A=x[0];if(A==x[1].source?C=x[1].target:C=x[1].source,g.PURE_INCREMENTAL)A.setCenter(C.getCenterX()+x[3].getWidth(),C.getCenterY()+x[3].getHeight());else{var T=C.startX,O=C.finishX,L=C.startY,P=C.finishY,Y=0,W=0,X=0,V=0,q=[Y,X,W,V];if(L>0)for(var Z=T;Z<=O;Z++)q[0]+=this.grid[Z][L-1].length+this.grid[Z][L].length-1;if(O<this.grid.length-1)for(var Z=L;Z<=P;Z++)q[1]+=this.grid[O+1][Z].length+this.grid[O][Z].length-1;if(P<this.grid[0].length-1)for(var Z=T;Z<=O;Z++)q[2]+=this.grid[Z][P+1].length+this.grid[Z][P].length-1;if(T>0)for(var Z=L;Z<=P;Z++)q[3]+=this.grid[T-1][Z].length+this.grid[T][Z].length-1;for(var J=D.MAX_VALUE,B,H,j=0;j<q.length;j++)q[j]<J?(J=q[j],B=1,H=j):q[j]==J&&B++;if(B==3&&J==0)q[0]==0&&q[1]==0&&q[2]==0?_=1:q[0]==0&&q[1]==0&&q[3]==0?_=0:q[0]==0&&q[2]==0&&q[3]==0?_=3:q[1]==0&&q[2]==0&&q[3]==0&&(_=2);else if(B==2&&J==0){var G=Math.floor(Math.random()*2);q[0]==0&&q[1]==0?G==0?_=0:_=1:q[0]==0&&q[2]==0?G==0?_=0:_=2:q[0]==0&&q[3]==0?G==0?_=0:_=3:q[1]==0&&q[2]==0?G==0?_=1:_=2:q[1]==0&&q[3]==0?G==0?_=1:_=3:G==0?_=2:_=3}else if(B==4&&J==0){var G=Math.floor(Math.random()*4);_=G}else _=H;_==0?A.setCenter(C.getCenterX(),C.getCenterY()-C.getHeight()/2-y.DEFAULT_EDGE_LENGTH-A.getHeight()/2):_==1?A.setCenter(C.getCenterX()+C.getWidth()/2+y.DEFAULT_EDGE_LENGTH+A.getWidth()/2,C.getCenterY()):_==2?A.setCenter(C.getCenterX(),C.getCenterY()+C.getHeight()/2+y.DEFAULT_EDGE_LENGTH+A.getHeight()/2):A.setCenter(C.getCenterX()-C.getWidth()/2-y.DEFAULT_EDGE_LENGTH-A.getWidth()/2,C.getCenterY())}},o.exports=R},991:(o,u,l)=>{var c=l(551).FDLayoutNode,h=l(551).IMath;function d(p,g,m,y){c.call(this,p,g,m,y)}d.prototype=Object.create(c.prototype);for(var f in c)d[f]=c[f];d.prototype.calculateDisplacement=function(){var p=this.graphManager.getLayout();this.getChild()!=null&&this.fixedNodeWeight?(this.displacementX+=p.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.fixedNodeWeight,this.displacementY+=p.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.fixedNodeWeight):(this.displacementX+=p.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.noOfChildren,this.displacementY+=p.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.noOfChildren),Math.abs(this.displacementX)>p.coolingFactor*p.maxNodeDisplacement&&(this.displacementX=p.coolingFactor*p.maxNodeDisplacement*h.sign(this.displacementX)),Math.abs(this.displacementY)>p.coolingFactor*p.maxNodeDisplacement&&(this.displacementY=p.coolingFactor*p.maxNodeDisplacement*h.sign(this.displacementY)),this.child&&this.child.getNodes().length>0&&this.propogateDisplacementToChildren(this.displacementX,this.displacementY)},d.prototype.propogateDisplacementToChildren=function(p,g){for(var m=this.getChild().getNodes(),y,b=0;b<m.length;b++)y=m[b],y.getChild()==null?(y.displacementX+=p,y.displacementY+=g):y.propogateDisplacementToChildren(p,g)},d.prototype.move=function(){var p=this.graphManager.getLayout();(this.child==null||this.child.getNodes().length==0)&&(this.moveBy(this.displacementX,this.displacementY),p.totalDisplacement+=Math.abs(this.displacementX)+Math.abs(this.displacementY)),this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0},d.prototype.setPred1=function(p){this.pred1=p},d.prototype.getPred1=function(){return pred1},d.prototype.getPred2=function(){return pred2},d.prototype.setNext=function(p){this.next=p},d.prototype.getNext=function(){return next},d.prototype.setProcessed=function(p){this.processed=p},d.prototype.isProcessed=function(){return processed},o.exports=d},902:(o,u,l)=>{function c(m){if(Array.isArray(m)){for(var y=0,b=Array(m.length);y<m.length;y++)b[y]=m[y];return b}else return Array.from(m)}var h=l(806),d=l(551).LinkedList,f=l(551).Matrix,p=l(551).SVD;function g(){}g.handleConstraints=function(m){var y={};y.fixedNodeConstraint=m.constraints.fixedNodeConstraint,y.alignmentConstraint=m.constraints.alignmentConstraint,y.relativePlacementConstraint=m.constraints.relativePlacementConstraint;for(var b=new Map,v=new Map,E=[],w=[],N=m.getAllNodes(),D=0,k=0;k<N.length;k++){var F=N[k];F.getChild()==null&&(v.set(F.id,D++),E.push(F.getCenterX()),w.push(F.getCenterY()),b.set(F.id,F))}y.relativePlacementConstraint&&y.relativePlacementConstraint.forEach(function(Q){!Q.gap&&Q.gap!=0&&(Q.left?Q.gap=h.DEFAULT_EDGE_LENGTH+b.get(Q.left).getWidth()/2+b.get(Q.right).getWidth()/2:Q.gap=h.DEFAULT_EDGE_LENGTH+b.get(Q.top).getHeight()/2+b.get(Q.bottom).getHeight()/2)});var M=function(ie,he){return{x:ie.x-he.x,y:ie.y-he.y}},S=function(ie){var he=0,fe=0;return ie.forEach(function(ue){he+=E[v.get(ue)],fe+=w[v.get(ue)]}),{x:he/ie.size,y:fe/ie.size}},R=function(ie,he,fe,ue,Ce){function je(ce,de){var We=new Set(ce),be=!0,me=!1,kt=void 0;try{for(var ke=de[Symbol.iterator](),Fe;!(be=(Fe=ke.next()).done);be=!0){var lt=Fe.value;We.add(lt)}}catch(tt){me=!0,kt=tt}finally{try{!be&&ke.return&&ke.return()}finally{if(me)throw kt}}return We}var Ge=new Map;ie.forEach(function(ce,de){Ge.set(de,0)}),ie.forEach(function(ce,de){ce.forEach(function(We){Ge.set(We.id,Ge.get(We.id)+1)})});var ge=new Map,oe=new Map,$e=new d;Ge.forEach(function(ce,de){ce==0?($e.push(de),fe||(he=="horizontal"?ge.set(de,v.has(de)?E[v.get(de)]:ue.get(de)):ge.set(de,v.has(de)?w[v.get(de)]:ue.get(de)))):ge.set(de,Number.NEGATIVE_INFINITY),fe&&oe.set(de,new Set([de]))}),fe&&Ce.forEach(function(ce){var de=[];if(ce.forEach(function(me){fe.has(me)&&de.push(me)}),de.length>0){var We=0;de.forEach(function(me){he=="horizontal"?(ge.set(me,v.has(me)?E[v.get(me)]:ue.get(me)),We+=ge.get(me)):(ge.set(me,v.has(me)?w[v.get(me)]:ue.get(me)),We+=ge.get(me))}),We=We/de.length,ce.forEach(function(me){fe.has(me)||ge.set(me,We)})}else{var be=0;ce.forEach(function(me){he=="horizontal"?be+=v.has(me)?E[v.get(me)]:ue.get(me):be+=v.has(me)?w[v.get(me)]:ue.get(me)}),be=be/ce.length,ce.forEach(function(me){ge.set(me,be)})}});for(var ze=function(){var de=$e.shift(),We=ie.get(de);We.forEach(function(be){if(ge.get(be.id)<ge.get(de)+be.gap)if(fe&&fe.has(be.id)){var me=void 0;if(he=="horizontal"?me=v.has(be.id)?E[v.get(be.id)]:ue.get(be.id):me=v.has(be.id)?w[v.get(be.id)]:ue.get(be.id),ge.set(be.id,me),me<ge.get(de)+be.gap){var kt=ge.get(de)+be.gap-me;oe.get(de).forEach(function(ke){ge.set(ke,ge.get(ke)-kt)})}}else ge.set(be.id,ge.get(de)+be.gap);Ge.set(be.id,Ge.get(be.id)-1),Ge.get(be.id)==0&&$e.push(be.id),fe&&oe.set(be.id,je(oe.get(de),oe.get(be.id)))})};$e.length!=0;)ze();if(fe){var Ie=new Set;ie.forEach(function(ce,de){ce.length==0&&Ie.add(de)});var Tt=[];oe.forEach(function(ce,de){if(Ie.has(de)){var We=!1,be=!0,me=!1,kt=void 0;try{for(var ke=ce[Symbol.iterator](),Fe;!(be=(Fe=ke.next()).done);be=!0){var lt=Fe.value;fe.has(lt)&&(We=!0)}}catch(at){me=!0,kt=at}finally{try{!be&&ke.return&&ke.return()}finally{if(me)throw kt}}if(!We){var tt=!1,an=void 0;Tt.forEach(function(at,Cn){at.has([].concat(c(ce))[0])&&(tt=!0,an=Cn)}),tt?ce.forEach(function(at){Tt[an].add(at)}):Tt.push(new Set(ce))}}}),Tt.forEach(function(ce,de){var We=Number.POSITIVE_INFINITY,be=Number.POSITIVE_INFINITY,me=Number.NEGATIVE_INFINITY,kt=Number.NEGATIVE_INFINITY,ke=!0,Fe=!1,lt=void 0;try{for(var tt=ce[Symbol.iterator](),an;!(ke=(an=tt.next()).done);ke=!0){var at=an.value,Cn=void 0;he=="horizontal"?Cn=v.has(at)?E[v.get(at)]:ue.get(at):Cn=v.has(at)?w[v.get(at)]:ue.get(at);var ii=ge.get(at);Cn<We&&(We=Cn),Cn>me&&(me=Cn),ii<be&&(be=ii),ii>kt&&(kt=ii)}}catch($){Fe=!0,lt=$}finally{try{!ke&&tt.return&&tt.return()}finally{if(Fe)throw lt}}var Pn=(We+me)/2-(be+kt)/2,Rr=!0,si=!1,ai=void 0;try{for(var Mr=ce[Symbol.iterator](),Zs;!(Rr=(Zs=Mr.next()).done);Rr=!0){var le=Zs.value;ge.set(le,ge.get(le)+Pn)}}catch($){si=!0,ai=$}finally{try{!Rr&&Mr.return&&Mr.return()}finally{if(si)throw ai}}})}return ge},I=function(ie){var he=0,fe=0,ue=0,Ce=0;if(ie.forEach(function(oe){oe.left?E[v.get(oe.left)]-E[v.get(oe.right)]>=0?he++:fe++:w[v.get(oe.top)]-w[v.get(oe.bottom)]>=0?ue++:Ce++}),he>fe&&ue>Ce)for(var je=0;je<v.size;je++)E[je]=-1*E[je],w[je]=-1*w[je];else if(he>fe)for(var Ge=0;Ge<v.size;Ge++)E[Ge]=-1*E[Ge];else if(ue>Ce)for(var ge=0;ge<v.size;ge++)w[ge]=-1*w[ge]},x=function(ie){var he=[],fe=new d,ue=new Set,Ce=0;return ie.forEach(function(je,Ge){if(!ue.has(Ge)){he[Ce]=[];var ge=Ge;for(fe.push(ge),ue.add(ge),he[Ce].push(ge);fe.length!=0;){ge=fe.shift();var oe=ie.get(ge);oe.forEach(function($e){ue.has($e.id)||(fe.push($e.id),ue.add($e.id),he[Ce].push($e.id))})}Ce++}}),he},_=function(ie){var he=new Map;return ie.forEach(function(fe,ue){he.set(ue,[])}),ie.forEach(function(fe,ue){fe.forEach(function(Ce){he.get(ue).push(Ce),he.get(Ce.id).push({id:ue,gap:Ce.gap,direction:Ce.direction})})}),he},C=function(ie){var he=new Map;return ie.forEach(function(fe,ue){he.set(ue,[])}),ie.forEach(function(fe,ue){fe.forEach(function(Ce){he.get(Ce.id).push({id:ue,gap:Ce.gap,direction:Ce.direction})})}),he},A=[],T=[],O=!1,L=!1,P=new Set,Y=new Map,W=new Map,X=[];if(y.fixedNodeConstraint&&y.fixedNodeConstraint.forEach(function(Q){P.add(Q.nodeId)}),y.relativePlacementConstraint&&(y.relativePlacementConstraint.forEach(function(Q){Q.left?(Y.has(Q.left)?Y.get(Q.left).push({id:Q.right,gap:Q.gap,direction:"horizontal"}):Y.set(Q.left,[{id:Q.right,gap:Q.gap,direction:"horizontal"}]),Y.has(Q.right)||Y.set(Q.right,[])):(Y.has(Q.top)?Y.get(Q.top).push({id:Q.bottom,gap:Q.gap,direction:"vertical"}):Y.set(Q.top,[{id:Q.bottom,gap:Q.gap,direction:"vertical"}]),Y.has(Q.bottom)||Y.set(Q.bottom,[]))}),W=_(Y),X=x(W)),h.TRANSFORM_ON_CONSTRAINT_HANDLING){if(y.fixedNodeConstraint&&y.fixedNodeConstraint.length>1)y.fixedNodeConstraint.forEach(function(Q,ie){A[ie]=[Q.position.x,Q.position.y],T[ie]=[E[v.get(Q.nodeId)],w[v.get(Q.nodeId)]]}),O=!0;else if(y.alignmentConstraint)(function(){var Q=0;if(y.alignmentConstraint.vertical){for(var ie=y.alignmentConstraint.vertical,he=function(ge){var oe=new Set;ie[ge].forEach(function(Ie){oe.add(Ie)});var $e=new Set([].concat(c(oe)).filter(function(Ie){return P.has(Ie)})),ze=void 0;$e.size>0?ze=E[v.get($e.values().next().value)]:ze=S(oe).x,ie[ge].forEach(function(Ie){A[Q]=[ze,w[v.get(Ie)]],T[Q]=[E[v.get(Ie)],w[v.get(Ie)]],Q++})},fe=0;fe<ie.length;fe++)he(fe);O=!0}if(y.alignmentConstraint.horizontal){for(var ue=y.alignmentConstraint.horizontal,Ce=function(ge){var oe=new Set;ue[ge].forEach(function(Ie){oe.add(Ie)});var $e=new Set([].concat(c(oe)).filter(function(Ie){return P.has(Ie)})),ze=void 0;$e.size>0?ze=E[v.get($e.values().next().value)]:ze=S(oe).y,ue[ge].forEach(function(Ie){A[Q]=[E[v.get(Ie)],ze],T[Q]=[E[v.get(Ie)],w[v.get(Ie)]],Q++})},je=0;je<ue.length;je++)Ce(je);O=!0}y.relativePlacementConstraint&&(L=!0)})();else if(y.relativePlacementConstraint){for(var V=0,q=0,Z=0;Z<X.length;Z++)X[Z].length>V&&(V=X[Z].length,q=Z);if(V<W.size/2)I(y.relativePlacementConstraint),O=!1,L=!1;else{var J=new Map,B=new Map,H=[];X[q].forEach(function(Q){Y.get(Q).forEach(function(ie){ie.direction=="horizontal"?(J.has(Q)?J.get(Q).push(ie):J.set(Q,[ie]),J.has(ie.id)||J.set(ie.id,[]),H.push({left:Q,right:ie.id})):(B.has(Q)?B.get(Q).push(ie):B.set(Q,[ie]),B.has(ie.id)||B.set(ie.id,[]),H.push({top:Q,bottom:ie.id}))})}),I(H),L=!1;var j=R(J,"horizontal"),G=R(B,"vertical");X[q].forEach(function(Q,ie){T[ie]=[E[v.get(Q)],w[v.get(Q)]],A[ie]=[],j.has(Q)?A[ie][0]=j.get(Q):A[ie][0]=E[v.get(Q)],G.has(Q)?A[ie][1]=G.get(Q):A[ie][1]=w[v.get(Q)]}),O=!0}}if(O){for(var re=void 0,K=f.transpose(A),_e=f.transpose(T),ve=0;ve<K.length;ve++)K[ve]=f.multGamma(K[ve]),_e[ve]=f.multGamma(_e[ve]);var dt=f.multMat(K,f.transpose(_e)),ut=p.svd(dt);re=f.multMat(ut.V,f.transpose(ut.U));for(var Me=0;Me<v.size;Me++){var rn=[E[Me],w[Me]],In=[re[0][0],re[1][0]],Ti=[re[0][1],re[1][1]];E[Me]=f.dotProduct(rn,In),w[Me]=f.dotProduct(rn,Ti)}L&&I(y.relativePlacementConstraint)}}if(h.ENFORCE_CONSTRAINTS){if(y.fixedNodeConstraint&&y.fixedNodeConstraint.length>0){var Wt={x:0,y:0};y.fixedNodeConstraint.forEach(function(Q,ie){var he={x:E[v.get(Q.nodeId)],y:w[v.get(Q.nodeId)]},fe=Q.position,ue=M(fe,he);Wt.x+=ue.x,Wt.y+=ue.y}),Wt.x/=y.fixedNodeConstraint.length,Wt.y/=y.fixedNodeConstraint.length,E.forEach(function(Q,ie){E[ie]+=Wt.x}),w.forEach(function(Q,ie){w[ie]+=Wt.y}),y.fixedNodeConstraint.forEach(function(Q){E[v.get(Q.nodeId)]=Q.position.x,w[v.get(Q.nodeId)]=Q.position.y})}if(y.alignmentConstraint){if(y.alignmentConstraint.vertical)for(var Fr=y.alignmentConstraint.vertical,At=function(ie){var he=new Set;Fr[ie].forEach(function(Ce){he.add(Ce)});var fe=new Set([].concat(c(he)).filter(function(Ce){return P.has(Ce)})),ue=void 0;fe.size>0?ue=E[v.get(fe.values().next().value)]:ue=S(he).x,he.forEach(function(Ce){P.has(Ce)||(E[v.get(Ce)]=ue)})},sn=0;sn<Fr.length;sn++)At(sn);if(y.alignmentConstraint.horizontal)for(var Ln=y.alignmentConstraint.horizontal,ki=function(ie){var he=new Set;Ln[ie].forEach(function(Ce){he.add(Ce)});var fe=new Set([].concat(c(he)).filter(function(Ce){return P.has(Ce)})),ue=void 0;fe.size>0?ue=w[v.get(fe.values().next().value)]:ue=S(he).y,he.forEach(function(Ce){P.has(Ce)||(w[v.get(Ce)]=ue)})},gn=0;gn<Ln.length;gn++)ki(gn)}y.relativePlacementConstraint&&function(){var Q=new Map,ie=new Map,he=new Map,fe=new Map,ue=new Map,Ce=new Map,je=new Set,Ge=new Set;if(P.forEach(function(Et){je.add(Et),Ge.add(Et)}),y.alignmentConstraint){if(y.alignmentConstraint.vertical)for(var ge=y.alignmentConstraint.vertical,oe=function(Te){he.set("dummy"+Te,[]),ge[Te].forEach(function(qe){Q.set(qe,"dummy"+Te),he.get("dummy"+Te).push(qe),P.has(qe)&&je.add("dummy"+Te)}),ue.set("dummy"+Te,E[v.get(ge[Te][0])])},$e=0;$e<ge.length;$e++)oe($e);if(y.alignmentConstraint.horizontal)for(var ze=y.alignmentConstraint.horizontal,Ie=function(Te){fe.set("dummy"+Te,[]),ze[Te].forEach(function(qe){ie.set(qe,"dummy"+Te),fe.get("dummy"+Te).push(qe),P.has(qe)&&Ge.add("dummy"+Te)}),Ce.set("dummy"+Te,w[v.get(ze[Te][0])])},Tt=0;Tt<ze.length;Tt++)Ie(Tt)}var ce=new Map,de=new Map,We=function(Te){Y.get(Te).forEach(function(qe){var Si=void 0,ir=void 0;qe.direction=="horizontal"?(Si=Q.get(Te)?Q.get(Te):Te,Q.get(qe.id)?ir={id:Q.get(qe.id),gap:qe.gap,direction:qe.direction}:ir=qe,ce.has(Si)?ce.get(Si).push(ir):ce.set(Si,[ir]),ce.has(ir.id)||ce.set(ir.id,[])):(Si=ie.get(Te)?ie.get(Te):Te,ie.get(qe.id)?ir={id:ie.get(qe.id),gap:qe.gap,direction:qe.direction}:ir=qe,de.has(Si)?de.get(Si).push(ir):de.set(Si,[ir]),de.has(ir.id)||de.set(ir.id,[]))})},be=!0,me=!1,kt=void 0;try{for(var ke=Y.keys()[Symbol.iterator](),Fe;!(be=(Fe=ke.next()).done);be=!0){var lt=Fe.value;We(lt)}}catch(Et){me=!0,kt=Et}finally{try{!be&&ke.return&&ke.return()}finally{if(me)throw kt}}var tt=_(ce),an=_(de),at=x(tt),Cn=x(an),ii=C(ce),Pn=C(de),Rr=[],si=[];at.forEach(function(Et,Te){Rr[Te]=[],Et.forEach(function(qe){ii.get(qe).length==0&&Rr[Te].push(qe)})}),Cn.forEach(function(Et,Te){si[Te]=[],Et.forEach(function(qe){Pn.get(qe).length==0&&si[Te].push(qe)})});var ai=R(ce,"horizontal",je,ue,Rr),Mr=R(de,"vertical",Ge,Ce,si),Zs=function(Te){he.get(Te)?he.get(Te).forEach(function(qe){E[v.get(qe)]=ai.get(Te)}):E[v.get(Te)]=ai.get(Te)},le=!0,$=!1,ee=void 0;try{for(var ae=ai.keys()[Symbol.iterator](),Ze;!(le=(Ze=ae.next()).done);le=!0){var bt=Ze.value;Zs(bt)}}catch(Et){$=!0,ee=Et}finally{try{!le&&ae.return&&ae.return()}finally{if($)throw ee}}var pt=function(Te){fe.get(Te)?fe.get(Te).forEach(function(qe){w[v.get(qe)]=Mr.get(Te)}):w[v.get(Te)]=Mr.get(Te)},Ot=!0,rr=!1,oi=void 0;try{for(var is=Mr.keys()[Symbol.iterator](),xt;!(Ot=(xt=is.next()).done);Ot=!0){var bt=xt.value;pt(bt)}}catch(Et){rr=!0,oi=Et}finally{try{!Ot&&is.return&&is.return()}finally{if(rr)throw oi}}}()}for(var nr=0;nr<N.length;nr++){var mn=N[nr];mn.getChild()==null&&mn.setCenter(E[v.get(mn.id)],w[v.get(mn.id)])}},o.exports=g},551:o=>{o.exports=n}},i={};function s(o){var u=i[o];if(u!==void 0)return u.exports;var l=i[o]={exports:{}};return r[o](l,l.exports,s),l.exports}var a=s(45);return a})()})}(dh)),dh.exports}export{PV as $,ur as A,gq as B,yq as C,xa as D,ZV as E,te as F,GN as G,Jt as H,en as I,ll as J,Kt as K,gi as L,xq as M,Ae as N,Eq as O,iq as P,LX as Q,zr as R,nt as S,eq as T,ad as U,XX as V,Fq as W,OV as X,IV as Y,DS as Z,wS as _,sq as a,Oq as a$,XV as a0,UV as a1,GV as a2,qV as a3,BV as a4,zV as a5,Jk as a6,jV as a7,LV as a8,VV as a9,hX as aA,cX as aB,aX as aC,uX as aD,oX as aE,sX as aF,tX as aG,eX as aH,iX as aI,rX as aJ,nX as aK,bX as aL,NX as aM,Je as aN,DX as aO,_X as aP,wX as aQ,xX as aR,EX as aS,FX as aT,Zq as aU,xx as aV,RX as aW,MX as aX,ni as aY,IX as aZ,OX as a_,Pu as aa,HV as ab,KV as ac,$V as ad,YV as ae,JV as af,WV as ag,Uf as ah,Rq as ai,$q as aj,Bq as ak,Pq as al,Lq as am,Iq as an,yL as ao,Uq as ap,Yq as aq,yX as ar,vX as as,mX as at,gX as au,pX as av,dX as aw,fX as ax,r7 as ay,lX as az,rt as b,MU as b0,WH as b1,zH as b2,$X as b3,KY as b4,SD as b5,qY as b6,VY as b7,jq as b8,zq as b9,zX as bA,VX as bB,pV as bC,YX as bD,HX as bE,WX as bF,Kq as bG,qX as bH,GC as bI,WC as bJ,Xq as bK,Cr as bL,Se as bM,Gq as ba,k5 as bb,Vq as bc,Hq as bd,ZC as be,A1 as bf,pd as bg,L5 as bh,I5 as bi,Ya as bj,O5 as bk,M5 as bl,Kh as bm,Dl as bn,_1 as bo,w1 as bp,ma as bq,jh as br,Wq as bs,BX as bt,UX as bu,GX as bv,Jq as bw,HC as bx,Qq as by,b5 as bz,wF as c,z2 as d,hq as e,lq as f,vF as g,xF as h,I2 as i,uq as j,aq as k,ul as l,oq as m,cq as n,_F as o,vq as p,DF as q,EF as r,bF as s,fq as t,pq as u,dq as v,mq as w,bq as x,ku as y,se as z};
